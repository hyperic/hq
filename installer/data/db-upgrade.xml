<?xml version="1.0"?>

<project name="db-upgrade" default="upgrade" basedir=".">

<!--
This target upgrades a database schema.  The parameters that it
accepts are:
  jdbc.url      = the jdbc url of the database to upgrade
  jdbc.user     = the user to connect to the database as
  jdbc.password = the database user's password
  typemap.file  = the typemap file to use for mapping column types
  schema.target = the schema version to upgrade to.  If this is
                  omitted then the schema is upgraded to the latest
                  version.

This target assumes that the taskdefs for the dbupgrade ant task
has already been defined.
-->
<target name="upgrade">

<dbupgrade
   jdbcUrl="${jdbc.url}" jdbcUser="${jdbc.user}" jdbcPassword="${jdbc.password}"

   valueColumn="VALUE" table="EAM_CONFIG_PROPS"
   keyColumn="KEY" keyMatch="CAM_SCHEMA_VERSION"

   typeMap="${typemap.file}"
   targetSchemaVersion="${schema.target}">

  <schemaSpec version="1.1">
    <schema-update table="EAM_MEASUREMENT"
                   column="dsn"
                   columnType="VARCHAR2"
                   value="ARG1"
                   where="dsn IS NULL"/>
  </schemaSpec>

  <schemaSpec version="1.2">
    <schema-addColumn table="EAM_APP_SERVICE"
                      column="SERVICE_TYPE_ID"
                      columnType="INTEGER">
      <initializer>
          UPDATE EAM_APP_SERVICE SET SERVICE_TYPE_ID= ( 
              SELECT EAM_SERVICE_TYPE.ID 
              FROM   EAM_SERVICE_TYPE, EAM_SERVICE 
              WHERE      EAM_SERVICE_TYPE.ID=EAM_SERVICE.SERVICE_TYPE_ID
                     AND EAM_SERVICE.ID=EAM_APP_SERVICE.SERVICE_ID)
      </initializer>
      <foreignKey constraintName="EAMAPPSVCTYPEID"
                  references="EAM_SERVICE_TYPE(ID)"/>
    </schema-addColumn>
  </schemaSpec>

  <!-- 1.3 upgrade: installed sort_name on most appdef and authz entities -->
  <schemaSpec version="1.3">
    <schema-addColumn table="EAM_AGENT_TYPE"
                      column="SORT_NAME"
                      columnType="VARCHAR2"
                      precision="80">
      <initializer>
        UPDATE EAM_AGENT_TYPE SET SORT_NAME=UPPER(NAME)
      </initializer>
    </schema-addColumn>
    <schema-addColumn table="EAM_APPLICATION_TYPE"
                      column="SORT_NAME"
                      columnType="VARCHAR2"
                      precision="200">
      <initializer>
        UPDATE EAM_APPLICATION_TYPE SET SORT_NAME=UPPER(NAME)
      </initializer>
    </schema-addColumn>
    <schema-addColumn table="EAM_PLATFORM_TYPE"
                      column="SORT_NAME"
                      columnType="VARCHAR2"
                      precision="80">
      <initializer>
        UPDATE EAM_PLATFORM_TYPE SET SORT_NAME=UPPER(NAME)
      </initializer>
    </schema-addColumn>
    <schema-addColumn table="EAM_PLATFORM"
                      column="SORT_NAME"
                      columnType="VARCHAR2"
                      precision="100">
      <initializer>
        UPDATE EAM_PLATFORM_TYPE SET SORT_NAME=UPPER(NAME)
      </initializer>
    </schema-addColumn>
    <schema-addColumn table="EAM_SERVER_TYPE"
                      column="SORT_NAME"
                      columnType="VARCHAR2"
                      precision="200">
      <initializer>
        UPDATE EAM_SERVER_TYPE SET SORT_NAME=UPPER(NAME)
      </initializer>
    </schema-addColumn>
    <schema-addColumn table="EAM_SERVICE_TYPE"
                      column="SORT_NAME"
                      columnType="VARCHAR2"
                      precision="200">
      <initializer>
        UPDATE EAM_SERVICE_TYPE SET SORT_NAME=UPPER(NAME)
      </initializer>
    </schema-addColumn>
    <schema-addColumn table="EAM_SERVER"
                      column="SORT_NAME"
                      columnType="VARCHAR2"
                      precision="200">
      <initializer>
        UPDATE EAM_SERVER SET SORT_NAME=UPPER(NAME)
      </initializer>
    </schema-addColumn>
    <schema-addColumn table="EAM_SERVICE"
                      column="SORT_NAME"
                      columnType="VARCHAR2"
                      precision="200">
      <initializer>
        UPDATE EAM_SERVICE SET SORT_NAME=UPPER(NAME)
      </initializer>
    </schema-addColumn>
    <schema-addColumn table="EAM_APPLICATION"
                      column="SORT_NAME"
                      columnType="VARCHAR2"
                      precision="100">
      <initializer>
        UPDATE EAM_APPLICATION SET SORT_NAME=UPPER(NAME)
      </initializer>
    </schema-addColumn>
    <schema-addColumn table="EAM_SVC_CLUSTER"
                      column="SORT_NAME"
                      columnType="VARCHAR2"
                      precision="200">
      <initializer>
        UPDATE EAM_SVC_CLUSTER SET SORT_NAME=UPPER(NAME)
      </initializer>
    </schema-addColumn>
    <schema-addColumn table="EAM_RESOURCE"
                      column="SORT_NAME"
                      columnType="VARCHAR2"
                      precision="200">
      <initializer>
        UPDATE EAM_RESOURCE SET SORT_NAME=UPPER(NAME)
      </initializer>
    </schema-addColumn>
    <schema-addColumn table="EAM_RESOURCE_GROUP"
                      column="SORT_NAME"
                      columnType="VARCHAR2"
                      precision="100">
      <initializer>
        UPDATE EAM_RESOURCE_GROUP SET SORT_NAME=UPPER(NAME)
      </initializer>
    </schema-addColumn>
    <schema-addColumn table="EAM_ROLE"
                      column="SORT_NAME"
                      columnType="VARCHAR2"
                      precision="100">
      <initializer>
        UPDATE EAM_ROLE SET SORT_NAME=UPPER(NAME)
      </initializer>
    </schema-addColumn>
    <schema-addColumn table="EAM_SUBJECT"
                      column="SORT_NAME"
                      columnType="VARCHAR2"
                      precision="100">
      <initializer>
        UPDATE EAM_SUBJECT SET SORT_NAME=UPPER(NAME)
      </initializer>
    </schema-addColumn>
  </schemaSpec>

  <schemaSpec version="1.4">
    <!-- Schema 1.4.  Change all Agent AUTOINVENTORYIDENTIFIER columns to
         CAM Agent Server in the EAM_SERVER table.  -->
    <schema-update table="EAM_SERVER"
                   column="AUTOINVENTORYIDENTIFIER"
                   columnType="VARCHAR2"
                   value="CAM Agent Server"
                   where="SERVER_TYPE_ID = (select id from EAM_SERVER_TYPE
                                           where name = 'CAM Agent 1.0')"/>
  </schemaSpec>

  <schemaSpec version="1.5">
    <!-- Schema 1.5.  Modify EAM_CONFIG_PROPS to allow for NULL values.
         Also add properties for LDAP authentication -->
    <schema-updateColumn table="EAM_CONFIG_PROPS"
                         column="DEFAULT_VALUE"
                         modifyCmd="NULL"/>
    <schema-insert table="EAM_CONFIG_PROPS"
                   insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES ('11', 'CAM_LDAP_NAMING_FACTORY_INITIAL', '', 'com.sun.jndi.ldap.LdapCtxFactory')"/>
    <schema-insert table="EAM_CONFIG_PROPS"
                   insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES ('12', 'CAM_LDAP_NAMING_PROVIDER_URL', '', 'ldap://localhost/')"/>
    <schema-insert table="EAM_CONFIG_PROPS"
                   insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES ('13', 'CAM_LDAP_LOGIN_PROPERTY', '', 'cn')"/>
    <schema-insert table="EAM_CONFIG_PROPS"
                   insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES ('14', 'CAM_LDAP_BASE_DN', '', 'o=Covalent Technologies,c=US')"/>
    <schema-insert table="EAM_CONFIG_PROPS"
                   insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES ('15', 'CAM_LDAP_BIND_DN', '', '')"/>
    <schema-insert table="EAM_CONFIG_PROPS"
                   insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES ('16', 'CAM_LDAP_BIND_PW', '', '')"/>
  </schemaSpec>

  <schemaSpec version="1.6">
    <!-- Setting service types values properly now -->
    <schema-directSQL>
      <verifySchema table="EAM_APP_SERVICE" column="SERVICE_TYPE_ID"/>
      <statement desc="Setting FK service type for service">
          UPDATE EAM_APP_SERVICE SET SERVICE_TYPE_ID= (
               SELECT EAM_SERVICE_TYPE.ID
               FROM   EAM_SERVICE_TYPE, EAM_SERVICE
               WHERE      EAM_SERVICE_TYPE.ID=EAM_SERVICE.SERVICE_TYPE_ID
                      AND EAM_SERVICE.ID=EAM_APP_SERVICE.SERVICE_ID)
           WHERE EAM_APP_SERVICE.SERVICE_ID IS NOT NULL
      </statement>
      <statement desc="Setting FK service type for cluster">
          UPDATE EAM_APP_SERVICE SET SERVICE_TYPE_ID= (
               SELECT EAM_SERVICE_TYPE.ID
               FROM   EAM_SERVICE_TYPE, EAM_SVC_CLUSTER
               WHERE      EAM_SERVICE_TYPE.ID=EAM_SVC_CLUSTER.SERVICE_TYPE_ID
                      AND EAM_SVC_CLUSTER.ID=EAM_APP_SERVICE.CLUSTER_ID)
           WHERE EAM_APP_SERVICE.CLUSTER_ID IS NOT NULL
      </statement>
    </schema-directSQL>
  </schemaSpec>

  <schemaSpec version="1.7">
     <!-- Schema 1.7.  Support for LDAP Filters and LDAP over SSL -->
     <schema-insert table="EAM_CONFIG_PROPS"
                    insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES (17, 'CAM_LDAP_PROTOCOL', '', '')"/>
     <schema-insert table="EAM_CONFIG_PROPS"
                    insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES (18, 'CAM_LDAP_FILTER', '', '')"/>
  </schemaSpec>

  <schemaSpec version="1.8">
    <schema-addColumn table="EAM_SERVICE"
                      column="SERVICE_RT"
                      columnType="BOOLEAN">
    </schema-addColumn>
    <schema-update table="EAM_SERVICE"
                   column="SERVICE_RT"
                   columnType="BOOLEAN"
                   value="FALSE" />

    <schema-addColumn table="EAM_SERVICE"
                      column="ENDUSER_RT"
                      columnType="BOOLEAN">
    </schema-addColumn>
    <schema-update table="EAM_SERVICE"
                   column="ENDUSER_RT"
                   columnType="BOOLEAN"
                   value="FALSE" />
  </schemaSpec>

  <schemaSpec version="1.9">
     <!-- Schema 1.9.  Change all Auth DSN's to CAM -->
    <schema-update table="EAM_SUBJECT"
                   column="DSN"
                   columnType="VARCHAR2"
                   value="CAM"
                   where="DSN='JDBC'"/>
  </schemaSpec>

  <schemaSpec version="1.10">
     <!-- Schema 1.10.  Add LASTAPPROVED column to AIQ_PLATFORM -->
    <schema-addColumn table="EAM_AIQ_PLATFORM"
                      column="LASTAPPROVED"
                      columnType="LONG">
    </schema-addColumn>
    <schema-update table="EAM_AIQ_PLATFORM"
                   column="LASTAPPROVED"
                   columnType="LONG"
                   value="0" />
  </schemaSpec>

  <schemaSpec version="1.11">
     <!-- Schema 1.11.  delete all schedule information -->
    <schema-directSQL>
      <verifySchema table="EAM_QRTZ_JOB_DETAILS" column="JOB_NAME"/>
      <statement desc="delete all job details">
        DELETE FROM EAM_QRTZ_JOB_DETAILS
      </statement>
      <verifySchema table="EAM_QRTZ_TRIGGERS" column="TRIGGER_NAME"/>
      <statement desc="delete all triggers">
        DELETE FROM EAM_QRTZ_TRIGGERS
      </statement>
      <verifySchema table="EAM_QRTZ_CRON_TRIGGERS" column="TRIGGER_NAME"/>
      <statement desc="delete all cron triggers">
        DELETE FROM EAM_QRTZ_CRON_TRIGGERS
      </statement>
      <verifySchema table="EAM_AUTOINV_SCHEDULE" column="TRIGGERNAME"/>
      <statement desc="delete all autoinventory schedule">
        DELETE FROM EAM_AUTOINV_SCHEDULE
      </statement>
      <verifySchema table="EAM_CONTROL_SCHEDULE" column="TRIGGERNAME"/>
      <statement desc="delete all control schedules">
        DELETE FROM EAM_QRTZ_TRIGGERS
      </statement>
    </schema-directSQL>
  </schemaSpec>

  <schemaSpec version="1.12">
    <!-- Update AIIDs for existing ERS-apache servers in server table 
         and AIQ server table.  Now they will match what the updated plugin
         expects to set/get.  -->
    <schema-prepend table="EAM_SERVER"
                    column="AUTOINVENTORYIDENTIFIER"
                    pkColumn="ID"
                    value="ERS-Apache "
                    where="SERVER_TYPE_ID = (SELECT ID FROM EAM_SERVER_TYPE WHERE NAME='Apache-ERS 2.3')"/>
    <schema-prepend table="EAM_AIQ_SERVER"
                    column="AUTOINVENTORYIDENTIFIER"
                    pkColumn="ID"
                    value="ERS-Apache "
                    where="SERVERTYPENAME='Apache-ERS 2.3'"/>
  </schemaSpec>

  <schemaSpec version="1.13">
    <!-- add High Availability attributes to the schema -->
    <schema-insert table="EAM_CONFIG_PROPS"
                   insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES ('19', 'CAM_MULTICAST_ADDRESS', '', '')"/>
    <schema-insert table="EAM_CONFIG_PROPS"
                   insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES ('20', 'CAM_MULTICAST_PORT', '', '')"/>
  </schemaSpec>

  <schemaSpec version="1.14">
     <!-- Schema 1.14.  Alter value column to higher precision -->
    <schema-alterColumn table="EAM_MEASUREMENT_DATA"
                        column="VALUE"
                        columnType="BIGDEC"/>
  </schemaSpec>

  <schemaSpec version="1.15">
    <!-- Schema 1.15.  Alter config column removing null requirement -->
    <schema-alterColumn table="EAM_AUTOINV_SCHEDULE"
                        column="CONFIG"
                        nullable="NULL"/>
  </schemaSpec>

  <schemaSpec version="1.16">
    <!-- Setting service types values properly now -->
    <schema-directSQL>
      <statement desc="Rename existing table">
        ALTER TABLE EAM_MEASUREMENT_DATA RENAME TO EAM_MEASUREMENT_DATA_BACKUP
      </statement>
      <statement desc="Create new table">
        CREATE TABLE EAM_MEASUREMENT_DATA (
            MEASUREMENT_ID NUMBER(22,0) NOT NULL,
            TIMESTAMP NUMBER(19,0) NOT NULL,
            VALUE NUMBER(24,5),
            CONSTRAINT MEASUREMENT_DATA_ID_TIME_PK PRIMARY KEY ( TIMESTAMP, MEASUREMENT_ID) )
      </statement>
      <!--
      <statement desc="Copy existing data">
        INSERT INTO EAM_MEASUREMENT_DATA
            (SELECT MEASUREMENT_ID, TIMESTAMP, VALUE FROM EAM_MEASUREMENT_DATA_BACKUP )
      </statement>
        -->
      <statement desc="Create new index for measurement_id">
        CREATE INDEX MEASUREMENT_DATA_ID_IDX ON EAM_MEASUREMENT_DATA ( MEASUREMENT_ID )
      </statement>
    </schema-directSQL>
  </schemaSpec>

  <schemaSpec version="1.17">
    <schema-directSQL>
      <statement desc="Create new SRN table">
        CREATE TABLE EAM_SRN (
            APPDEF_TYPE INTEGER NOT NULL,
            INSTANCE_ID INTEGER NOT NULL,
            SRN INTEGER NOT NULL,
            CONSTRAINT MEASUREMENT_SRN_RES_ID PRIMARY KEY ( APPDEF_TYPE, INSTANCE_ID ) )
      </statement>
    </schema-directSQL>
   </schemaSpec>

   <schemaSpec version="1.18">
     <schema-directSQL>
       <statement desc="Create index for eam_trigger_event for faster lookup">
         CREATE INDEX EAM_TRIGGER_EVENTS_IND ON EAM_TRIGGER_EVENT ( EVENT_ID )
       </statement>
     </schema-directSQL>
   </schemaSpec>
  <schemaSpec version="1.19">
    <schema-directSQL>
      <statement desc="Create index for eam_fired_trigger for faster lookup">
        CREATE INDEX EAM_FIRED_TRIGGER_ID_IND ON EAM_FIRED_TRIGGER ( TRIGGER_ID )
      </statement>
    </schema-directSQL>
  </schemaSpec>
  <schemaSpec version="1.20">
    <schema-insert table="EAM_CONFIG_PROPS"
                   insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES ('21', 'CAM_SYSLOG_ACTIONS_ENABLED', 'false', 'false')"/>
  </schemaSpec>
   <schemaSpec version="1.21">
       <schema-directSQL>
           <statement>
               INSERT INTO EAM_OPERATION (ID, CID, NAME, RESOURCE_TYPE_ID) 
               VALUES (400, 400, 'managePlatformAlerts', 301)
           </statement>
           <statement>
               INSERT INTO EAM_OPERATION (ID, CID, NAME, RESOURCE_TYPE_ID) 
               VALUES (401, 401, 'manageServerAlerts', 303)
           </statement>
           <statement>
               INSERT INTO EAM_OPERATION (ID, CID, NAME, RESOURCE_TYPE_ID) 
               VALUES (402, 402, 'manageServiceAlerts', 305)
           </statement>
           <statement>
               INSERT INTO EAM_OPERATION (ID, CID, NAME, RESOURCE_TYPE_ID) 
               VALUES (403, 403, 'manageApplicationAlerts', 308)
           </statement>
           <statement>
               INSERT INTO EAM_OPERATION (ID, CID, NAME, RESOURCE_TYPE_ID) 
               VALUES (404, 404, 'manageGroupAlerts', 303)
           </statement>
           <statement>
               INSERT INTO EAM_ROLE_OPERATION_MAP (OPERATION_ID, ROLE_ID)
               VALUES (400, 0)
           </statement>
           <statement>
               INSERT INTO EAM_ROLE_OPERATION_MAP (OPERATION_ID, ROLE_ID)
               VALUES (401, 0)
           </statement>
           <statement>
               INSERT INTO EAM_ROLE_OPERATION_MAP (OPERATION_ID, ROLE_ID)
               VALUES (402, 0)
           </statement>
           <statement>
               INSERT INTO EAM_ROLE_OPERATION_MAP (OPERATION_ID, ROLE_ID)
               VALUES (403, 0)
           </statement>
           <statement>
               INSERT INTO EAM_ROLE_OPERATION_MAP (OPERATION_ID, ROLE_ID)
               VALUES (404, 0)
           </statement>
        </schema-directSQL>
   </schemaSpec>
   <schemaSpec version="1.22">
        <schema-addColumn table="EAM_SUBJECT"
                          column="SMS_ADDRESS"
                          columnType="VARCHAR2"
                          precision="100"/>
   </schemaSpec>
    <schemaSpec version="1.23">
        <schema-directSQL>
            <statement>
                update eam_operation set RESOURCE_TYPE_ID = 3 where id = 404
            </statement>
        </schema-directSQL>
    </schemaSpec>
    <schemaSpec version="1.24">
        <schema-directSQL>
            <statement>
            CREATE INDEX MEASUREMENT_DATA_TIME_IDX ON EAM_MEASUREMENT_DATA ( TIMESTAMP ) NOLOGGING
            </statement>
        </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.25">
        <schema-directSQL>
            <statement>
            UPDATE EAM_CONFIG_PROPS SET VALUE='1209600000' WHERE ID = 5
            </statement>
        </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.26">
      <schema-addColumn table="EAM_ALERT_DEFINITION"
                        column="WILL_RECOVER"
                        columnType="BOOLEAN" >
        <initializer>
          UPDATE EAM_ALERT_DEFINITION SET WILL_RECOVER='0'
        </initializer>
      </schema-addColumn>
    </schemaSpec>
    
    <schemaSpec version="1.27">
      <schema-alterColumn table="EAM_ALERT_DEFINITION"
                        column="WILL_RECOVER"
                        default="0"
                        nullable="NOT NULL"/>
    </schemaSpec>

    <schemaSpec version="1.28">
      <schema-directSQL>
        <statement>
        INSERT INTO EAM_CONFIG_PROPS (ID, KEY, VALUE, DEFAULT_VALUE, FREAD_ONLY)
          VALUES (22, 'CAM_DATA_PURGE_DELETE_OLDER_THAN',
                  '7776000000', '7776000000', '0')
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.29">
      <schema-insert table="EAM_CONFIG_PROPS"
                     insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES (23, 'CAM_GUIDE_ENABLED', 'true', 'true')"/>
    </schemaSpec>

    <schemaSpec version="1.30">
      <schema-directSQL>
        <statement>UPDATE EAM_AGENT_TYPE SET SORT_NAME=UPPER(NAME)</statement>
        <statement>UPDATE EAM_APPLICATION_TYPE SET SORT_NAME=UPPER(NAME)</statement>
        <statement>UPDATE EAM_PLATFORM_TYPE SET SORT_NAME=UPPER(NAME)</statement>
        <statement>UPDATE EAM_PLATFORM_TYPE SET SORT_NAME=UPPER(NAME)</statement>
        <statement>UPDATE EAM_SERVER_TYPE SET SORT_NAME=UPPER(NAME)</statement>
        <statement>UPDATE EAM_SERVICE_TYPE SET SORT_NAME=UPPER(NAME)</statement>
        <statement>UPDATE EAM_SERVER SET SORT_NAME=UPPER(NAME)</statement>
        <statement>UPDATE EAM_SERVICE SET SORT_NAME=UPPER(NAME)</statement>
        <statement>UPDATE EAM_APPLICATION SET SORT_NAME=UPPER(NAME)</statement>
        <statement>UPDATE EAM_SVC_CLUSTER SET SORT_NAME=UPPER(NAME)</statement>
        <statement>UPDATE EAM_RESOURCE SET SORT_NAME=UPPER(NAME)</statement>
        <statement>UPDATE EAM_RESOURCE_GROUP SET SORT_NAME=UPPER(NAME)</statement>
        <statement>UPDATE EAM_ROLE SET SORT_NAME=UPPER(NAME)</statement>
        <statement>UPDATE EAM_SUBJECT SET SORT_NAME=UPPER(NAME)</statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.31">
      <schema-addColumn table="EAM_MEASUREMENT_BL"
                        column="COMPUTE_TIME"
                        columnType="LONG">
        <initializer>
          UPDATE EAM_MEASUREMENT_BL SET COMPUTE_TIME=END_DATE
        </initializer>
      </schema-addColumn>
      <schema-addColumn table="EAM_MEASUREMENT_BL"
                        column="MIN_EXPECTED_VAL"
                        columnType="DOUBLE">
        <initializer>
          UPDATE EAM_MEASUREMENT_BL SET MIN_EXPECTED_VAL=
            (SELECT MIN_EXPECTED_VAL FROM EAM_MEASUREMENT m
                WHERE MEASUREMENT_ID = m.ID)
        </initializer>
      </schema-addColumn>
      <schema-addColumn table="EAM_MEASUREMENT_BL"
                        column="MAX_EXPECTED_VAL"
                        columnType="DOUBLE">
        <initializer>
          UPDATE EAM_MEASUREMENT_BL SET MIN_EXPECTED_VAL=
            (SELECT MIN_EXPECTED_VAL FROM EAM_MEASUREMENT m
                WHERE MEASUREMENT_ID = m.ID)
        </initializer>
      </schema-addColumn>
      <schema-addColumn table="EAM_MEASUREMENT_BL"
                        column="USER_ENTERED"
                        columnType="BOOLEAN"/>
      <schema-update table="EAM_MEASUREMENT_BL"
                     column="USER_ENTERED"
                     columnType="BOOLEAN"
                     value="TRUE"/>
      <!-- drop unused columns -->
      <schema-directSQL>
        <statement desc="Drop unused column START_DATE.">
          ALTER TABLE EAM_MEASUREMENT_BL DROP COLUMN START_DATE
        </statement>
        <statement desc="Drop unused column END_DATE.">
          ALTER TABLE EAM_MEASUREMENT_BL DROP COLUMN END_DATE
        </statement>
        <statement desc="Drop unused column STD_DEV.">
          ALTER TABLE EAM_MEASUREMENT_BL DROP COLUMN STD_DEV
        </statement>
        <statement desc="Drop unused column NUM_PTS.">
          ALTER TABLE EAM_MEASUREMENT_BL DROP COLUMN NUM_PTS
        </statement>
      </schema-directSQL>
      <schema-directSQL>
        <statement>ALTER TABLE EAM_MEASUREMENT DROP COLUMN MIN_EXPECTED_VAL</statement>
        <statement>ALTER TABLE EAM_MEASUREMENT DROP COLUMN MAX_EXPECTED_VAL</statement>
      </schema-directSQL>
    </schemaSpec>
    
    <schemaSpec version="1.32">
    <schema-addColumn table="EAM_SERVER_TYPE"
                        column="FVIRTUAL"
                        columnType="BOOLEAN" >
        <initializer>
          UPDATE EAM_SERVER_TYPE SET FVIRTUAL = 0
        </initializer>
      </schema-addColumn>
      <schema-directSQL>
      <statement>UPDATE EAM_SERVER_TYPE SET FVIRTUAL = 1 WHERE plugin = 'system'</statement>
      </schema-directSQL>
    </schemaSpec>    

    <schemaSpec version="1.33">
      <schema-directSQL>
      <statement>CREATE INDEX EAM_PLATFORM_idx_CTIME ON EAM_PLATFORM(CTIME)</statement>
      <statement>CREATE INDEX EAM_SERVER_idx_CTIME ON EAM_SERVER(CTIME)</statement>
      <statement>CREATE INDEX EAM_SERVICE_idx_CTIME ON EAM_SERVICE(CTIME)</statement>
      <statement>CREATE INDEX MEASUREMENT_IDX_ENABLED ON EAM_MEASUREMENT(ENABLED)</statement>
      <statement>CREATE INDEX MTYPE_IDX_APPDEFTYPE ON EAM_MONITORABLE_TYPE(APPDEF_TYPE)</statement>
      <statement>CREATE INDEX EAM_RESOURCE_IDX_TYPE ON EAM_RESOURCE(RESOURCE_TYPE_ID)</statement>
      </schema-directSQL>
    </schemaSpec>    

    <schemaSpec version="1.34">
      <schema-directSQL>
        <statement>update eam_resource set fsystem = 1 WHERE name like('%NetworkServer%')</statement>
        <statement>update eam_resource set fsystem = 1 WHERE name like('%FileServer%')</statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.35">
      <schema-addColumn table="EAM_CONFIG_RESPONSE"
                        column="USERMANAGED"
                        columnType="BOOLEAN">
        <initializer>
          UPDATE EAM_CONFIG_RESPONSE SET USERMANAGED = %%TRUE%%
        </initializer>
      </schema-addColumn>
      <schema-alterColumn table="EAM_CONFIG_RESPONSE"
                          column="USERMANAGED"
                          nullable="NOT NULL"/>
    </schemaSpec>

    <schemaSpec version="1.36">
      <schema-addColumn table="EAM_CONFIG_RESPONSE"
                        column="VALIDATIONERR"
                        columnType="VARCHAR2"
                        precision="512">
        <initializer>
          UPDATE EAM_CONFIG_RESPONSE SET VALIDATIONERR = NULL
        </initializer>
      </schema-addColumn>
      <schema-directSQL>
      <statement>CREATE INDEX CRESP_VERR ON EAM_CONFIG_RESPONSE(VALIDATIONERR)</statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.37">
      <schema-directSQL>
        <statement>DROP INDEX MEASUREMENT_DATA_ID_IDX</statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.38">
      <schema-directSQL>
        <statement>CREATE INDEX ALERT_IDX_TIME ON EAM_ALERT(CTIME)</statement>
        <statement>CREATE INDEX ALERT_IDX_ALERTDEFINITION ON EAM_ALERT(ALERT_DEFINITION_ID)</statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.39">
        <schema-addColumn table="EAM_REQUEST_STAT"
                        column="IPADDR"
                        columnType="VARCHAR2"
                        precision="20">
          <initializer>
            UPDATE EAM_REQUEST_STAT SET IPADDR = '0.0.0.0'
          </initializer>
        </schema-addColumn>

        <schema-directSQL>
        <statement>CREATE INDEX REQSTAT_IDX_CLIENTIP ON EAM_REQUEST_STAT(IPADDR)</statement>
        </schema-directSQL>
        <schema-dropTable table="EAM_STAT_ERRORS"/>
        <schema-directSQL>
            <statement targetDB="oracle">
               CREATE TABLE EAM_STAT_ERRORS (
                 ID INTEGER NOT NULL PRIMARY KEY, 
                 ERROR_ID INTEGER REFERENCES EAM_ERROR_CODE(ID), 
                 COUNT INTEGER NOT NULL, 
                 REQSTAT_ID INTEGER,
                 CONSTRAINT STATERR_FK_STAT FOREIGN KEY (REQSTAT_ID)
                   REFERENCES EAM_REQUEST_STAT(ID) ON DELETE CASCADE
               ) STORAGE (freelists 5) NOLOGGING CACHE
            </statement>
            <statement targetDB="postgresql">
               CREATE TABLE EAM_STAT_ERRORS (
                 ID INTEGER NOT NULL PRIMARY KEY, 
                 ERROR_ID INTEGER REFERENCES EAM_ERROR_CODE(ID), 
                 COUNT INTEGER NOT NULL, 
                 REQSTAT_ID INTEGER,
                 CONSTRAINT STATERR_FK_STAT FOREIGN KEY (REQSTAT_ID)
                   REFERENCES EAM_REQUEST_STAT(ID) ON DELETE CASCADE
               )
            </statement>
        </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.40">
      <schema-insert table="EAM_CONFIG_PROPS"
                     dupFail="false"
                     insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES (24, 'CAM_RT_COLLECT_IP_ADDRS', 'true', 'true')"/>
    </schemaSpec>

    <schemaSpec version="1.41">
      <schema-directSQL>
        <statement desc="Create new Measurement PROBLEM table"
                   targetDB="oracle">
          CREATE TABLE EAM_METRIC_PROB (
            MEASUREMENT_ID INTEGER NOT NULL,
            TIMESTAMP NUMBER(19,0) NOT NULL,
            TYPE INTEGER NOT NULL,
            ADDITIONAL INTEGER
          )
        </statement>
        <statement desc="Create new Measurement PROBLEM table"
                   targetDB="postgresql">
          CREATE TABLE EAM_METRIC_PROB (
            MEASUREMENT_ID INTEGER NOT NULL,
            TIMESTAMP BIGINT NOT NULL,
            TYPE INTEGER NOT NULL,
            ADDITIONAL INTEGER
          )
        </statement>
        <statement desc="Create new index for measurement_id in Measurement Prob">
          CREATE INDEX METRIC_PROB_ID_IDX ON EAM_METRIC_PROB ( MEASUREMENT_ID )
        </statement>
        <statement desc="Create new index for measurement_id and time in Measurement Prob">
          CREATE INDEX METRIC_PROB_TIME_IDX ON EAM_METRIC_PROB ( TIMESTAMP, MEASUREMENT_ID )
        </statement>
        <statement desc="Create new problem view with appdef ID.">
        CREATE VIEW EAM_METRIC_PROB_VIEW AS
        SELECT
          appdef_type, instance_id, measurement_id, timestamp, type
            FROM eam_metric_prob, eam_measurement m,
                 eam_measurement_templ t, eam_monitorable_type mt
            WHERE measurement_id = m.id AND template_id = t.id AND
                  monitorable_type_id = mt.id
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <!-- HQ 2.0 STARTS HERE -->

    <schemaSpec version="1.42">
      <schema-directSQL>
        <statement desc="Update DataPurgeJob for HQ 2.0">
          UPDATE EAM_QRTZ_JOB_DETAILS SET 
          job_class_name='net.hyperic.hq.measurement.DataPurgeJob' WHERE
          job_class_name='net.covalent.spider.measurement.DataPurgeJob'
        </statement>
        <statement desc="Update AIScanJob for HQ 2.0">
          UPDATE EAM_QRTZ_JOB_DETAILS SET
          job_class_name='net.hyperic.hq.autoinventory.server.session.AIScanJob' WHERE
          job_class_name='net.covalent.spider.autoinventory.server.session.AIScanJob'
        </statement>
        <statement desc="Update ControlJob for HQ 2.0">
          UPDATE EAM_QRTZ_JOB_DETAILS SET
          job_class_name='net.hyperic.hq.control.server.session.ControlActionJob' WHERE
          job_class_name='net.covalent.spider.control.server.session.ControlActionJob'
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.43">
      <!-- Create tables for compressed data -->
      <schema-directSQL>
        <!-- 1 hour table -->
        <statement desc="Create Measurement Data Hourly Table"
                   targetDB="oracle">
          CREATE TABLE EAM_MEASUREMENT_DATA_1H (
            MEASUREMENT_ID INTEGER NOT NULL,
            TIMESTAMP NUMBER(19,0) NOT NULL,
            VALUE NUMBER(24,5),
            MINVALUE NUMBER(24,5),
            MAXVALUE NUMBER(24,5),
            CONSTRAINT MEASUREMENT_DATA_1H_ID_TIME_PK 
             PRIMARY KEY (TIMESTAMP, MEASUREMENT_ID)
          )
        </statement>
        <statement desc="Create Measurement Data Hourly Table"
                   targetDB="postgresql">
          CREATE TABLE EAM_MEASUREMENT_DATA_1H (
            MEASUREMENT_ID INTEGER NOT NULL,
            TIMESTAMP BIGINT NOT NULL,
            VALUE DECIMAL(24,5),
            MINVALUE DECIMAL(24,5),
            MAXVALUE DECIMAL(24,5),
            CONSTRAINT MEASUREMENT_DATA_1H_ID_TIME_PK 
             PRIMARY KEY (TIMESTAMP, MEASUREMENT_ID)
          )
        </statement>
        <statement desc="Create Measurement Data Hourly Index">
          CREATE INDEX MEASUREMENT_DATA_1H_TIME_IDX 
          ON EAM_MEASUREMENT_DATA_1H ( MEASUREMENT_ID )
        </statement>
        <!-- 6 hour table -->
        <statement desc="Create Measurement Data 6 Hour Table"
                   targetDB="oracle">
          CREATE TABLE EAM_MEASUREMENT_DATA_6H (
            MEASUREMENT_ID INTEGER NOT NULL,
            TIMESTAMP NUMBER(19,0) NOT NULL,
            VALUE NUMBER(24,5),
            MINVALUE NUMBER(24,5),
            MAXVALUE NUMBER(24,5),
            CONSTRAINT MEASUREMENT_DATA_6H_ID_TIME_PK 
             PRIMARY KEY (TIMESTAMP, MEASUREMENT_ID)
          )
        </statement>
        <statement desc="Create Measurement Data 6 Hour Table"
                   targetDB="postgresql">
          CREATE TABLE EAM_MEASUREMENT_DATA_6H (
            MEASUREMENT_ID INTEGER NOT NULL,
            TIMESTAMP BIGINT NOT NULL,
            VALUE DECIMAL(24,5),
            MINVALUE DECIMAL(24,5),
            MAXVALUE DECIMAL(24,5),
            CONSTRAINT MEASUREMENT_DATA_6H_ID_TIME_PK 
             PRIMARY KEY (TIMESTAMP, MEASUREMENT_ID)
          )
        </statement>
        <statement desc="Create Measurement Data 6 Hour Index">
          CREATE INDEX MEASUREMENT_DATA_6H_TIME_IDX 
          ON EAM_MEASUREMENT_DATA_6H ( MEASUREMENT_ID )
        </statement>
        <!-- 1 day table -->
        <statement desc="Create Measurement Data Daily Table"
                   targetDB="oracle">
          CREATE TABLE EAM_MEASUREMENT_DATA_1D (
            MEASUREMENT_ID INTEGER NOT NULL,
            TIMESTAMP NUMBER(19,0) NOT NULL,
            VALUE NUMBER(24,5),
            MINVALUE NUMBER(24,5),
            MAXVALUE NUMBER(24,5),
            CONSTRAINT MEASUREMENT_DATA_1D_ID_TIME_PK  
             PRIMARY KEY (TIMESTAMP, MEASUREMENT_ID)
          )
        </statement>
        <statement desc="Create Measurement Data Daily Table"
                   targetDB="postgresql">
          CREATE TABLE EAM_MEASUREMENT_DATA_1D (
            MEASUREMENT_ID INTEGER NOT NULL,
            TIMESTAMP BIGINT NOT NULL,
            VALUE DECIMAL(24,5),
            MINVALUE DECIMAL(24,5),
            MAXVALUE DECIMAL(24,5),
            CONSTRAINT MEASUREMENT_DATA_1D_ID_TIME_PK 
             PRIMARY KEY (TIMESTAMP, MEASUREMENT_ID)
          )
        </statement>
        <statement desc="Create Measurement Data Daily Index">
          CREATE INDEX MEASUREMENT_DATA_1D_TIME_IDX 
          ON EAM_MEASUREMENT_DATA_1D ( MEASUREMENT_ID )
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.44">
    <!-- Drop the old peaklow table.  Not used with new purge -->
      <schema-directSQL>
        <statement desc="Drop unused measurement_data_peaklow table">
          DROP TABLE EAM_MEASUREMENT_PEAKLOW
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.45">
    <!-- Update config properties with new data storage options -->
      <schema-directSQL>
        <statement desc="Drop CAM_DATA_PURGE_OLDER_THAN config property">
          DELETE FROM EAM_CONFIG_PROPS WHERE KEY='CAM_DATA_PURGE_OLDER_THAN'
        </statement>
        <statement desc="Drop CAM_DATA_PURGE_CONDENSE_TO config property">
          DELETE FROM EAM_CONFIG_PROPS WHERE KEY='CAM_DATA_PURGE_CONDENSE_TO'
        </statement>
        <statement desc="Drop CAM_DATA_PURGE_DELETE_OLDER_THAN config property">
          DELETE FROM EAM_CONFIG_PROPS WHERE KEY='CAM_DATA_PURGE_DELETE_OLDER_THAN'
        </statement>
      </schema-directSQL>
      <schema-insert table="EAM_CONFIG_PROPS"
                     dupFail="false"
                     insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES (25, 'CAM_DATA_PURGE_RAW', '172800000', '172800000')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                     dupFail="false"
                     insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES (26, 'CAM_DATA_PURGE_1H', '1209600000', '1209600000')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                     dupFail="false"
                     insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES (27, 'CAM_DATA_PURGE_6H', '2678400000', '2678400000')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                     dupFail="false"
                     insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES (28, 'CAM_DATA_PURGE_1D', '31536000000', '31536000000')"/>
    </schemaSpec>

    <schemaSpec version="1.46">
    <!-- DataCompress fixes and updates -->
      <schema-directSQL>
        <!-- Update detailed data to be kept for 2 days -->
        <statement>
          UPDATE EAM_CONFIG_PROPS SET VALUE='172800000' WHERE KEY='CAM_DATA_PURGE_RAW'
        </statement>
        <!-- Update hourly data to be kept for 2 weeks -->
        <statement>
          UPDATE EAM_CONFIG_PROPS SET VALUE='1209600000' WHERE KEY='CAM_DATA_PURGE_1H'
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.47">
      <!-- Add auto-baseline configuration -->
      <schema-insert table="EAM_CONFIG_PROPS"
                     dupFail="false"
                     insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES (29, 'CAM_BASELINE_FREQUENCY', '259200000', '259200000')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                     dupFail="false"
                     insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES (30, 'CAM_BASELINE_DATASET', '604800000', '604800000')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                     dupFail="false"
                     insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES (31, 'CAM_BASELINE_MINSET', '40', '40')"/>
    </schemaSpec>

    <schemaSpec version="1.48">
      <!-- How often to perform DB maintainence -->
      <schema-insert table="EAM_CONFIG_PROPS"
                     dupFail="false"
                     insertCmd="(ID, KEY, VALUE, DEFAULT_VALUE) VALUES (32, 'CAM_DATA_MAINTENANCE', '3600000', '3600000')"/>
    </schemaSpec>

    <schemaSpec version="1.49">
      <schema-directSQL>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='net.hyperic.hq.bizapp.server.trigger.conditional.AlertTrigger'
            WHERE CLASSNAME='net.covalent.spider.bizapp.server.trigger.conditional.AlertTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='net.hyperic.hq.bizapp.server.trigger.conditional.ControlEventTrigger'
            WHERE CLASSNAME='net.covalent.spider.bizapp.server.trigger.conditional.ControlEventTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='net.hyperic.hq.bizapp.server.trigger.conditional.MeasurementBaselineTrigger'
            WHERE CLASSNAME='net.covalent.spider.bizapp.server.trigger.conditional.MeasurementBaselineTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='net.hyperic.hq.bizapp.server.trigger.conditional.MeasurementThresholdTrigger'
            WHERE CLASSNAME='net.covalent.spider.bizapp.server.trigger.conditional.MeasurementThresholdTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='net.hyperic.hq.bizapp.server.trigger.conditional.MultiConditionTrigger'
            WHERE CLASSNAME='net.covalent.spider.bizapp.server.trigger.conditional.MultiConditionTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='net.hyperic.hq.bizapp.server.trigger.conditional.ValueChangeTrigger'
            WHERE CLASSNAME='net.covalent.spider.bizapp.server.trigger.conditional.ValueChangeTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='net.hyperic.hq.bizapp.server.trigger.frequency.AvertTrigger'
            WHERE CLASSNAME='net.covalent.spider.bizapp.server.trigger.frequency.AvertTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='net.hyperic.hq.bizapp.server.trigger.frequency.ConstantDurationTrigger'
            WHERE CLASSNAME='net.covalent.spider.bizapp.server.trigger.frequency.ConstantDurationTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='net.hyperic.hq.bizapp.server.trigger.frequency.CounterTrigger'
            WHERE CLASSNAME='net.covalent.spider.bizapp.server.trigger.frequency.CounterTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='net.hyperic.hq.bizapp.server.trigger.frequency.DurationTrigger'
            WHERE CLASSNAME='net.covalent.spider.bizapp.server.trigger.frequency.DurationTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='net.hyperic.hq.bizapp.server.trigger.frequency.EscalateTrigger'
            WHERE CLASSNAME='net.covalent.spider.bizapp.server.trigger.frequency.EscalateTrigger'
        </statement>
        <statement>
          UPDATE EAM_ACTION
              SET CLASSNAME='net.hyperic.hq.bizapp.server.action.alert.EnableAlertDefAction'
            WHERE CLASSNAME='net.covalent.spider.bizapp.server.action.alert.EnableAlertDefAction'
        </statement>
        <statement>
          UPDATE EAM_ACTION
              SET CLASSNAME='net.hyperic.hq.bizapp.server.action.control.ControlAction'
            WHERE CLASSNAME='net.covalent.spider.bizapp.server.action.control.ControlAction'
        </statement>
        <statement>
          UPDATE EAM_ACTION
              SET CLASSNAME='net.hyperic.hq.bizapp.server.action.email.EmailAction'
            WHERE CLASSNAME='net.covalent.spider.bizapp.server.action.email.EmailAction'
        </statement>
        <statement>
          UPDATE EAM_ACTION
              SET CLASSNAME='net.hyperic.hq.bizapp.server.action.log.SyslogAction'
            WHERE CLASSNAME='net.covalent.spider.bizapp.server.action.log.SyslogAction'
        </statement>
        <statement>
          UPDATE EAM_ACTION
              SET CLASSNAME='net.hyperic.hq.bizapp.server.action.rca.RCAAction'
            WHERE CLASSNAME='net.covalent.spider.bizapp.server.action.rca.RCAAction'
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.50">
      <schema-directSQL>
        <statement>
          DELETE FROM EAM_CONTROL_SCHEDULE
        </statement>
        <statement>
          DELETE FROM EAM_AUTOINV_SCHEDULE
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.51">
      <schema-directSQL>
        <statement>
        INSERT INTO EAM_CONFIG_PROPS (ID, KEY, VALUE, DEFAULT_VALUE, FREAD_ONLY)
          VALUES (33, 'DATA_STORE_ALL', 'true', 'true', '0')
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.52">
      <schema-directSQL>
        <statement>
        INSERT INTO EAM_CONFIG_PROPS (ID, KEY, VALUE, DEFAULT_VALUE, FREAD_ONLY)
          VALUES (34, 'RT_DATA_PURGE', '2678400000', '2678400000', '0')
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <!-- Update HQ related resources and blow away the server AI queue -->
    <schemaSpec version="1.53">
      <schema-directSQL>
        <statement>
        UPDATE EAM_SERVER SET AUTOINVENTORYIDENTIFIER='HQ PostgreSQL'  
          WHERE INSTALLPATH LIKE '%hqdb%' AND NAME LIKE '%PostgreSQL%'
        </statement>
        <statement>
        UPDATE EAM_SERVER SET AUTOINVENTORYIDENTIFIER='HQ Tomcat' 
        WHERE INSTALLPATH LIKE '%hq-engine%' AND NAME LIKE '%Tomcat%'
        </statement>
        <statement>
        UPDATE EAM_SERVER SET AUTOINVENTORYIDENTIFIER='HQ JBoss' WHERE 
        INSTALLPATH LIKE '%hq-engine%' AND NAME LIKE '%JBoss%' 
        </statement>
        <statement>
        DELETE FROM EAM_AIQ_SERVER
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.54">
      <schema-directSQL>
        <statement>
          CREATE INDEX METRIC_BASELINE_CALCULATED_IDX ON EAM_MEASUREMENT_BL (MEASUREMENT_ID, COMPUTE_TIME)
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.55">
        <schema-directSQL>
            <statement>
            CREATE INDEX TEMPL_MONITORABLE_TYPE_IDX ON EAM_MEASUREMENT_TEMPL (MONITORABLE_TYPE_ID)
            </statement>
            <statement>
            CREATE INDEX TEMPL_DESIG_MT_IDX ON EAM_MEASUREMENT_TEMPL (DESIGNATE, MONITORABLE_TYPE_ID)
            </statement>
            <statement>
            CREATE INDEX ALERT_COND_LOG_IDX ON EAM_ALERT_CONDITION_LOG (ALERT_ID)
            </statement>
            <statement>
            CREATE INDEX ALERT_ACTION_LOG_IDX ON EAM_ALERT_ACTION_LOG (ALERT_ID)
            </statement>
            <statement>
            CREATE INDEX ALERT_DEF_TRIGGER_IDX ON EAM_REGISTERED_TRIGGER (ALERT_DEFINITION_ID)
            </statement>
            <statement>
            CREATE INDEX USER_ALERT_IDX ON EAM_USER_ALERT (USER_ID)
            </statement>
            <statement>
            CREATE INDEX METRIC_BASELINE_IDX ON EAM_MEASUREMENT_BL (MEASUREMENT_ID)
            </statement>
        </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.56">
      <schema-directSQL>
        <statement targetDB="oracle">
        INSERT INTO EAM_CONFIG_PROPS (ID, KEY, VALUE, DEFAULT_VALUE) 
          VALUES (35, 'DATA_REINDEX_NIGHTLY', 'false', 'false')
        </statement>
        <statement targetDB="postgresql">
        INSERT INTO EAM_CONFIG_PROPS (ID, KEY, VALUE, DEFAULT_VALUE) 
          VALUES (35, 'DATA_REINDEX_NIGHTLY', 'true', 'true')
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.57">
      <schema-directSQL>
        <statement desc="Create new EAM_NUMBERS table" targetDB="oracle">
          CREATE TABLE EAM_NUMBERS2 (
            I NUMBER(19,0) NOT NULL,
            CONSTRAINT EAM_NUMBERS_PK PRIMARY KEY (I)
          )
        </statement>
        <statement desc="Create new EAM_NUMBERS table" targetDB="postgresql">
          CREATE TABLE EAM_NUMBERS2 (
            I BIGINT NOT NULL,
            CONSTRAINT EAM_NUMBERS_PK PRIMARY KEY (I)
          )
        </statement>
        <statement>
          INSERT INTO EAM_NUMBERS2 (SELECT I FROM EAM_NUMBERS)
        </statement>
        <statement>
          DROP TABLE EAM_NUMBERS
        </statement>
        <statement>
          ALTER TABLE EAM_NUMBERS2 RENAME TO EAM_NUMBERS
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.58">
      <schema-directSQL>
        <statement>
            ALTER TABLE EAM_CPROP_KEY RENAME COLUMN KEY TO PROPKEY
        </statement>
        <statement>
            ALTER TABLE EAM_CPROP RENAME COLUMN VALUE TO PROPVALUE
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.59">
      <schema-alterColumn table="EAM_IP" column="NETMASK" nullable="NULL"/>
      <schema-alterColumn table="EAM_AIQ_IP" column="NETMASK" nullable="NULL"/>
      <schema-directSQL>
        <statement>
          DROP INDEX EAM_ptype_idx_CERTDN
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.60">
      <schema-directSQL>
        <statement>
          DROP INDEX MEASUREMENT_IDX_ENABLED
        </statement>
        <statement>
          DROP INDEX EAM_MEASURE_BASELINE
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <!-- Delete old configText custom properties -->
    <schemaSpec version="1.61">
      <schema-directSQL>
        <statement>
          DELETE FROM EAM_CPROP_KEY WHERE propkey='configText'
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <!-- AI Platform ConfigResponses and Server/Service cprops -->
    <schemaSpec version="1.62">
      <schema-addColumn table="EAM_AIQ_PLATFORM"
                        column="PRODUCT_CONFIG"
                        columnType="BYTES"/>
      <schema-addColumn table="EAM_AIQ_PLATFORM"
                        column="CONTROL_CONFIG"
                        columnType="BYTES"/>
      <schema-addColumn table="EAM_AIQ_PLATFORM"
                        column="MEASUREMENT_CONFIG"
                        columnType="BYTES"/>

      <schema-addColumn table="EAM_AIQ_SERVER"
                        column="CUSTOM_PROPERTIES"
                        columnType="BYTES"/>

      <schema-addColumn table="EAM_AIQ_SERVICE"
                        column="CUSTOM_PROPERTIES"
                        columnType="BYTES"/>
    </schemaSpec>

    <!-- mysql5 support - change reserved words interval, key, value -->
    <schemaSpec version="1.63">
      <schema-directSQL>
        <statement>
            ALTER TABLE EAM_MEASUREMENT RENAME COLUMN INTERVAL TO COLL_INTERVAL
        </statement>
        <statement>
            ALTER TABLE EAM_CONFIG_PROPS RENAME COLUMN VALUE TO PROPVALUE
        </statement>
        <statement>
            ALTER TABLE EAM_CONFIG_PROPS RENAME COLUMN KEY TO PROPKEY
        </statement>
        <statement>
            ALTER TABLE EAM_CONFIG_PROPS RENAME COLUMN DEFAULT_VALUE TO DEFAULT_PROPVALUE
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.64">
      <schema-directSQL>
        <statement>
        INSERT INTO EAM_CONFIG_PROPS (ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE, FREAD_ONLY)
          VALUES (36, 'ALERT_PURGE', '2678400000', '2678400000', '0')
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <!-- description for AI resources, EAM_AIQ_SERVER already has it -->
    <schemaSpec version="1.65">
      <schema-addColumn table="EAM_AIQ_PLATFORM"
                        column="DESCRIPTION"
                        columnType="VARCHAR2"
                        precision="300"/>

      <schema-addColumn table="EAM_AIQ_SERVICE"
                        column="DESCRIPTION"
                        columnType="VARCHAR2"
                        precision="300"/>
    </schemaSpec>

    <schemaSpec version="1.66">
      <schema-addColumn table="EAM_ACTION"
                        column="PARENT_ID"
                        columnType="INTEGER"/>
    </schemaSpec>

    <schemaSpec version="1.67">
      <schema-insert table="EAM_CONFIG_PROPS"
                 insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE) VALUES ('37', 'SNMP_VERSION', '', '')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                 insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE) VALUES ('38', 'SNMP_AUTH_PROTOCOL', 'MD5', '')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                 insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE) VALUES ('39', 'SNMP_AUTH_PASSPHRASE', '', '')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                 insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE) VALUES ('40', 'SNMP_PRIV_PASSPHRASE', '', '')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                 insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE) VALUES ('41', 'SNMP_COMMUNITY', 'public', '')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                 insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE) VALUES ('42', 'SNMP_ENGINE_ID', '', '')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                 insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE) VALUES ('43', 'SNMP_CONTEXT_NAME', '', '')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                 insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE) VALUES ('44', 'SNMP_SECURITY_NAME', '', '')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                 insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE) VALUES ('45', 'SNMP_TRAP_OID', '', '')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                 insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE) VALUES ('46', 'SNMP_ENTERPRISE_OID', '', '')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                 insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE) VALUES ('47', 'SNMP_GENERIC_ID', '', '')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                 insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE) VALUES ('48', 'SNMP_SPECIFIC_ID', '', '')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                 insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE) VALUES ('49', 'SNMP_AGENT_ADDRESS', '', '')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                 insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE) VALUES ('50', 'SNMP_PRIVACY_PROTOCOL', '', '')"/>
    </schemaSpec>

    <schemaSpec version="1.68">
      <schema-directSQL>
        <statement desc="Drop unused column STATE.">
          ALTER TABLE EAM_SERVER DROP COLUMN STATE
        </statement>
        <statement desc="Drop unused column STATE.">
          ALTER TABLE EAM_SERVICE DROP COLUMN STATE
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.69">
      <schema-directSQL>
        <statement>
          CREATE INDEX EVENT_LOG_IDX ON EAM_EVENT_LOG (ENTITY_TYPE, ENTITY_ID, TIMESTAMP)
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <!-- Add version column for agents -->
    <schemaSpec version="1.70">
      <schema-addColumn table="EAM_AGENT"
                        column="VERSION"
                        columnType="VARCHAR2"
                        precision="20"/>
    </schemaSpec>

    <schemaSpec version="1.71">
      <schema-directSQL>
        <statement>
          CREATE INDEX CTL_HISTORY_STARTTIME ON EAM_CONTROL_HISTORY (STARTTIME)
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <!-- Re-create indicies on server and service names to not be unique -->
    <schemaSpec version="1.72">
      <schema-directSQL>
        <statement>
          DROP INDEX EAM_SERVER_NAME
        </statement>
        <statement>
          DROP INDEX EAM_SERVICE_NAME
        </statement>
        <statement>
          DROP INDEX AIQ_SERVER_NAME
        </statement>
        <statement>
           DROP INDEX AIQ_SERVICE_NAME
        </statement>
        <statement>
          CREATE INDEX EAM_SERVER_NAME ON EAM_SERVER (NAME)
        </statement>
        <statement>
          CREATE INDEX EAM_SERVICE_NAME ON EAM_SERVICE (NAME)
        </statement>
        <statement>
          CREATE INDEX AIQ_SERVER_NAME ON EAM_AIQ_SERVER (NAME)
        </statement>
        <statement>
          CREATE INDEX AIQ_SERVICE_NAME ON EAM_AIQ_SERVICE (NAME)
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.73">
      <schema-directSQL>
        <statement desc="Create new EAM_VIRTUAL table">
          CREATE TABLE EAM_VIRTUAL (
            RESOURCE_ID INTEGER NOT NULL,
            PROCESS_ID INTEGER NOT NULL,
            PHYSICAL_ID INTEGER,
            CONSTRAINT EAM_VIRTUAL_PK PRIMARY KEY (RESOURCE_ID)
          )
        </statement>
        <statement desc="Create new virtual platforms view.">
        CREATE VIEW EAM_VIRT_PLAT_VIEW AS
        SELECT 
          p.*, v.RESOURCE_ID, PROCESS_ID, PHYSICAL_ID
        FROM 
           EAM_PLATFORM p, EAM_RESOURCE r, EAM_RESOURCE_TYPE rt,
           EAM_VIRTUAL v
        WHERE rt.name = 'covalentEAMPlatform' AND
              r.resource_type_id = rt.id AND
              r.instance_id = p.id AND
              r.id = v.resource_id
        </statement>
        <statement desc="Create new virtual servers view.">
        CREATE VIEW EAM_VIRT_SVR_VIEW AS
        SELECT 
          s.*, v.RESOURCE_ID, PROCESS_ID, PHYSICAL_ID
        FROM 
           EAM_SERVER s, EAM_RESOURCE r, EAM_RESOURCE_TYPE rt,
           EAM_VIRTUAL v
        WHERE rt.name = 'covalentEAMServer' AND
              r.resource_type_id = rt.id AND
              r.instance_id = s.id AND
              r.id = v.resource_id
        </statement>
        <statement desc="Create new virtual services view.">
        CREATE VIEW EAM_VIRT_SVC_VIEW AS
        SELECT 
          s.*, v.RESOURCE_ID, PROCESS_ID, PHYSICAL_ID
        FROM 
           EAM_SERVICE s, EAM_RESOURCE r, EAM_RESOURCE_TYPE rt,
           EAM_VIRTUAL v
        WHERE rt.name = 'covalentEAMService' AND
              r.resource_type_id = rt.id AND
              r.instance_id = s.id AND
              r.id = v.resource_id
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <!-- Upgrade to Quartz 1.5.1 -->
    <schemaSpec version="1.74">
    
      <!-- JOB_DETAILS table -->
      <schema-addColumn table="EAM_QRTZ_JOB_DETAILS"
                        column="IS_VOLATILE"
                        columnType="BOOLEAN" />
      <schema-update table="EAM_QRTZ_JOB_DETAILS"
                     column="IS_VOLATILE"
                     columnType="BOOLEAN"
                     value="FALSE" />
      <schema-alterColumn table="EAM_QRTZ_JOB_DETAILS"
                          column="IS_VOLATILE"
                          nullable="NOT NULL" />

      <!-- TRIGGERS table -->
      <schema-addColumn table="EAM_QRTZ_TRIGGERS"
                        column="IS_VOLATILE"
                        columnType="BOOLEAN" />
      <schema-update table="EAM_QRTZ_TRIGGERS"
                     column="IS_VOLATILE"
                     columnType="BOOLEAN"
                     value="FALSE" />
      <schema-alterColumn table="EAM_QRTZ_TRIGGERS"
                          column="IS_VOLATILE"
                          nullable="NOT NULL"/>
      <schema-addColumn table="EAM_QRTZ_TRIGGERS"
                        column="PREV_FIRE_TIME"
                        columnType="LONG" />
      <schema-addColumn table="EAM_QRTZ_TRIGGERS"
                        column="JOB_DATA"
                        columnType="BLOB" />

      <!-- BLOB_TRIGGERS table -->
      <schema-alterColumn table="EAM_QRTZ_BLOB_TRIGGERS"
                          column="BLOB_DATA"
                          nullable="NULL"/>

      <!-- FIRED_TRIGGERS table -->
      <schema-directSQL>
        <statement>
            ALTER TABLE EAM_QRTZ_FIRED_TRIGGERS RENAME COLUMN TRIGGER_STATE TO STATE
        </statement>
      </schema-directSQL>
      <schema-addColumn table="EAM_QRTZ_FIRED_TRIGGERS"
                        column="IS_VOLATILE"
                        columnType="BOOLEAN" />
      <schema-update table="EAM_QRTZ_FIRED_TRIGGERS"
                     column="IS_VOLATILE"
                     columnType="BOOLEAN"
                     value="FALSE" />
      <schema-alterColumn table="EAM_QRTZ_FIRED_TRIGGERS"
                          column="IS_VOLATILE"
                          nullable="NOT NULL"/>
      <schema-addColumn table="EAM_QRTZ_FIRED_TRIGGERS"
                        column="JOB_NAME"
                        columnType="VARCHAR2"
                        precision="80" />
      <schema-addColumn table="EAM_QRTZ_FIRED_TRIGGERS"
                        column="JOB_GROUP"
                        columnType="VARCHAR2"
                        precision="80" />
      <schema-addColumn table="EAM_QRTZ_FIRED_TRIGGERS"
                        column="IS_STATEFUL"
                        columnType="BOOLEAN" />
      <schema-addColumn table="EAM_QRTZ_FIRED_TRIGGERS"
                        column="REQUESTS_RECOVERY"
                        columnType="BOOLEAN" />

      <!-- PAUSED_TRIGGER_GRPS -->
      <schema-directSQL>
        <statement desc="Create new Quartz table: EAM_QRTZ_PAUSED_TRIGGER_GRPS"
                   targetDB="oracle">
          CREATE TABLE EAM_QRTZ_PAUSED_TRIGGER_GRPS (
            TRIGGER_GROUP VARCHAR2(80) NOT NULL
          )
        </statement>
        <statement desc="Create new Quartz table: EAM_QRTZ_PAUSED_TRIGGER_GRPS"
                   targetDB="postgresql">
          CREATE TABLE EAM_QRTZ_PAUSED_TRIGGER_GRPS (
            TRIGGER_GROUP VARCHAR(80) NOT NULL
          )
        </statement>
      </schema-directSQL>

      <schema-directSQL>
        <statement desc="Creating primary key for EAM_QRTZ_PAUSED_TRIGGER_GRPS">
          ALTER TABLE EAM_QRTZ_PAUSED_TRIGGER_GRPS ADD PRIMARY KEY ( TRIGGER_GROUP )
        </statement>
      </schema-directSQL>

      <!-- SCHEDULER_STATE -->
      <schema-directSQL>
        <statement desc="Create new Quartz table: EAM_QRTZ_SCHEDULER_STATE"
                   targetDB="oracle">
          CREATE TABLE EAM_QRTZ_SCHEDULER_STATE (
            INSTANCE_NAME VARCHAR2(80) NOT NULL,
            LAST_CHECKIN_TIME NUMBER(24,5) NOT NULL,
            CHECKIN_INTERVAL NUMBER(24,5) NOT NULL,
            RECOVERER VARCHAR2(80) NULL
          )
        </statement>
        <statement desc="Create new Quartz table: EAM_QRTZ_SCHEDULER_STATE"
                   targetDB="postgresql">
          CREATE TABLE EAM_QRTZ_SCHEDULER_STATE (
            INSTANCE_NAME VARCHAR(80) NOT NULL,
            LAST_CHECKIN_TIME DECIMAL(24,5) NOT NULL,
            CHECKIN_INTERVAL DECIMAL(24,5) NOT NULL,
            RECOVERER VARCHAR(80) NULL
          )
        </statement>
      </schema-directSQL>
      <schema-directSQL>
        <statement desc="Creating primary key for EAM_QRTZ_SCHEDULER_STATE">
          ALTER TABLE EAM_QRTZ_SCHEDULER_STATE ADD PRIMARY KEY ( INSTANCE_NAME )
        </statement>
      </schema-directSQL>

      <!-- LOCKS -->        
      <schema-directSQL>
        <statement desc="Create new Quartz table: EAM_QRTZ_LOCKS"
                   targetDB="oracle">
          CREATE TABLE EAM_QRTZ_LOCKS (
            LOCK_NAME VARCHAR2(40) NOT NULL
          )
        </statement>
        <statement desc="Create new Quartz table: EAM_QRTZ_LOCKS"
                   targetDB="postgresql">
          CREATE TABLE EAM_QRTZ_LOCKS (
            LOCK_NAME VARCHAR(40) NOT NULL
          )
        </statement>
      </schema-directSQL>

      <schema-directSQL>
        <statement desc="Creating primary key for EAM_QRTZ_LOCKS">
          ALTER TABLE EAM_QRTZ_LOCKS ADD PRIMARY KEY ( LOCK_NAME )
        </statement>
      </schema-directSQL>

      <schema-insert table="EAM_QRTZ_LOCKS" insertCmd="(LOCK_NAME) VALUES ('TRIGGER_ACCESS')"/>
      <schema-insert table="EAM_QRTZ_LOCKS" insertCmd="(LOCK_NAME) VALUES ('JOB_ACCESS')"/>
      <schema-insert table="EAM_QRTZ_LOCKS" insertCmd="(LOCK_NAME) VALUES ('CALENDAR_ACCESS')"/>
      <schema-insert table="EAM_QRTZ_LOCKS" insertCmd="(LOCK_NAME) VALUES ('STATE_ACCESS')"/>
      <schema-insert table="EAM_QRTZ_LOCKS" insertCmd="(LOCK_NAME) VALUES ('MISFIRE_ACCESS')"/>

    </schemaSpec>

    <!-- part of the quartz upgrade, see JBNADM-440 -->
    <schemaSpec version="1.75">
          <schema-directSQL>
        <statement desc="Correcting the Quartz Cron String">
            UPDATE EAM_QRTZ_CRON_TRIGGERS
               SET CRON_EXPRESSION='0 10 0-23 * * ?'
             WHERE CRON_EXPRESSION='0 10 0-24 * * ?'
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.76">
      <schema-directSQL>
        <statement>
            ALTER TABLE EAM_CONTROL_HISTORY RENAME COLUMN ERRORSTR TO MESSAGE
        </statement>
        <statement>
            ALTER TABLE EAM_AUTOINV_HISTORY RENAME COLUMN ERRORSTR TO MESSAGE
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <!-- Add args column to track control plugin arguments -->
    <schemaSpec version="1.77">
      <schema-addColumn table="EAM_CONTROL_HISTORY"
                        column="ARGS"
                        columnType="VARCHAR2"
                        precision="500"/>
    </schemaSpec>

    <schemaSpec version="1.78">
      <schema-directSQL>
        <statement desc="Update DataPurgeJob for HQ">
          UPDATE EAM_QRTZ_JOB_DETAILS SET 
          job_class_name='org.hyperic.hq.measurement.DataPurgeJob' WHERE
          job_class_name='net.hyperic.hq.measurement.DataPurgeJob'
        </statement>
        <statement desc="Update AIScanJob for HQ">
          UPDATE EAM_QRTZ_JOB_DETAILS SET
          job_class_name='org.hyperic.hq.autoinventory.server.session.AIScanJob' WHERE
          job_class_name='net.hyperic.hq.autoinventory.server.session.AIScanJob'
        </statement>
        <statement desc="Update ControlJob for HQ">
          UPDATE EAM_QRTZ_JOB_DETAILS SET
          job_class_name='org.hyperic.hq.control.server.session.ControlActionJob' WHERE
          job_class_name='net.hyperic.hq.control.server.session.ControlActionJob'
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.79">
      <schema-directSQL>
        <statement desc="Remove unused index: EAM_TRIGGER_EVENTS_IND">
          DROP INDEX EAM_TRIGGER_EVENTS_IND
        </statement>
        <statement desc="Remove unused index: MEASUREMENT_INSTANCE_DSN">
          DROP INDEX MEASUREMENT_INSTANCE_DSN
        </statement>
        <statement desc="Remove unused index: EAM_PLATFORM_idx_CTIME">
          DROP INDEX EAM_PLATFORM_idx_CTIME
        </statement>
        <statement desc="Remove unused index: EAM_PLATFORM_CID_IDX">
          DROP INDEX EAM_PLATFORM_CID_IDX
        </statement>
        <statement desc="Remove unused index: EAM_IP_CID_IDX">
          DROP INDEX EAM_IP_CID_IDX
        </statement>
        <statement desc="Remove unused index: EAM_SERVER_CID_IDX">
          DROP INDEX EAM_SERVER_CID_IDX
        </statement>
        <statement desc="Remove unused index: EAM_APPLICATION_CID_IDX">
          DROP INDEX EAM_APPLICATION_CID_IDX
        </statement>
        <statement desc="Remove unused index: EAM_RESOURCE_TYPE_RESOURCE_KEY">
          DROP INDEX EAM_RESOURCE_TYPE_RESOURCE_KEY
        </statement>
        <statement desc="Remove unused index: EAM_ROLE_RESOURCE_KEY">
          DROP INDEX EAM_ROLE_RESOURCE_KEY
        </statement>
        <statement desc="Remove unused index: EAM_SUBJECT_RESOURCE_KEY">
          DROP INDEX EAM_SUBJECT_RESOURCE_KEY
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.80">
      <schema-directSQL>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='org.hyperic.hq.bizapp.server.trigger.conditional.MeasurementThresholdTrigger'
            WHERE CLASSNAME='net.hyperic.hq.bizapp.server.trigger.conditional.MeasurementThresholdTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='org.hyperic.hq.bizapp.server.trigger.conditional.ValueChangeTrigger'
            WHERE CLASSNAME='net.hyperic.hq.bizapp.server.trigger.conditional.ValueChangeTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='org.hyperic.hq.bizapp.server.trigger.conditional.AlertTrigger'
            WHERE CLASSNAME='net.hyperic.hq.bizapp.server.trigger.conditional.AlertTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='org.hyperic.hq.bizapp.server.trigger.conditional.CustomPropertyTrigger'
            WHERE CLASSNAME='net.hyperic.hq.bizapp.server.trigger.conditional.CustomPropertyTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='com.covalent.spider.bizapp.server.trigger.conditional.ControlEventTrigger'
            WHERE CLASSNAME='net.hyperic.hq.bizapp.server.trigger.conditional.ControlEventTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='com.hyperic.hq.bizapp.server.trigger.conditional.MeasurementBaselineTrigger'
            WHERE CLASSNAME='net.hyperic.hq.bizapp.server.trigger.conditional.MeasurementBaselineTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='com.hyperic.hq.bizapp.server.trigger.conditional.LogEventTrigger'
            WHERE CLASSNAME='net.hyperic.hq.bizapp.server.trigger.conditional.LogEventTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='org.hyperic.hq.bizapp.server.trigger.conditional.MultiConditionTrigger'
            WHERE CLASSNAME='net.hyperic.hq.bizapp.server.trigger.conditional.MultiConditionTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='org.hyperic.hq.bizapp.server.trigger.frequency.AvertTrigger'
            WHERE CLASSNAME='net.hyperic.hq.bizapp.server.trigger.frequency.AvertTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='org.hyperic.hq.bizapp.server.trigger.frequency.ConstantDurationTrigger'
            WHERE CLASSNAME='net.hyperic.hq.bizapp.server.trigger.frequency.ConstantDurationTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='org.hyperic.hq.bizapp.server.trigger.frequency.CounterTrigger'
            WHERE CLASSNAME='net.hyperic.hq.bizapp.server.trigger.frequency.CounterTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='org.hyperic.hq.bizapp.server.trigger.frequency.DurationTrigger'
            WHERE CLASSNAME='net.hyperic.hq.bizapp.server.trigger.frequency.DurationTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='org.hyperic.hq.bizapp.server.trigger.frequency.EscalateTrigger'
            WHERE CLASSNAME='net.hyperic.hq.bizapp.server.trigger.frequency.EscalateTrigger'
        </statement>
        <statement>
          UPDATE EAM_ACTION
              SET CLASSNAME='com.hyperic.hq.bizapp.server.action.alert.EnableAlertDefAction'
            WHERE CLASSNAME='net.hyperic.hq.bizapp.server.action.alert.EnableAlertDefAction'
        </statement>
        <statement>
          UPDATE EAM_ACTION
              SET CLASSNAME='com.hyperic.hq.bizapp.server.action.alert.SnmpAction'
            WHERE CLASSNAME='net.hyperic.hq.bizapp.server.action.alert.SnmpAction'
        </statement>
        <statement>
          UPDATE EAM_ACTION
              SET CLASSNAME='com.hyperic.hq.bizapp.server.action.control.ControlAction'
            WHERE CLASSNAME='net.hyperic.hq.bizapp.server.action.control.ControlAction'
        </statement>
        <statement>
          UPDATE EAM_ACTION
              SET CLASSNAME='com.hyperic.hq.bizapp.server.action.email.EmailAction'
            WHERE CLASSNAME='net.hyperic.hq.bizapp.server.action.email.EmailAction'
        </statement>
        <statement>
          UPDATE EAM_ACTION
              SET CLASSNAME='com.hyperic.hq.bizapp.server.action.log.SyslogAction'
            WHERE CLASSNAME='net.hyperic.hq.bizapp.server.action.log.SyslogAction'
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.81">
      <schema-directSQL>
        <statement desc="Create index for EAM_MEASUREMENT_ARG for faster lookup">
          CREATE INDEX MEASUREMENT_ARG_TEMPL_IDX ON EAM_MEASUREMENT_ARG  ( MEASUREMENT_TEMPLATE_ID )
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.82">
      <schema-directSQL>
        <statement>
          UPDATE EAM_ACTION
              SET CLASSNAME='org.hyperic.hq.measurement.action.MetricAlertAction'
            WHERE CLASSNAME='net.hyperic.hq.measurement.action.MetricAlertAction'
        </statement>
        <statement>
          DELETE FROM EAM_TRIGGER_EVENT
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.83">
      <schema-addColumn table="EAM_MEASUREMENT_TEMPL"
                        column="CTIME"
                        columnType="LONG">
        <initializer>
          UPDATE EAM_MEASUREMENT_TEMPL SET CTIME = 0
        </initializer>
      </schema-addColumn>
      <schema-addColumn table="EAM_MEASUREMENT_TEMPL"
                        column="MTIME"
                        columnType="LONG">
        <initializer>
          UPDATE EAM_MEASUREMENT_TEMPL SET MTIME = 1
        </initializer>
      </schema-addColumn>
    </schemaSpec>

    <schemaSpec version="1.84">
      <schema-directSQL>
        <statement>
          UPDATE EAM_RESOURCE SET FSYSTEM = %%TRUE%% WHERE ID=6
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.85">
      <schema-directSQL>
        <statement desc="Create index for EAM_ALERT_DEFINITION for faster lookup by resource">
          CREATE INDEX ALERT_DEF_RES_IDX ON EAM_ALERT_DEFINITION ( APPDEF_ID, APPDEF_TYPE )
        </statement>
        <statement desc="Create index for EAM_ALERT_DEFINITION for faster lookup by parent">
          CREATE INDEX ALERT_DEF_CHILD_IDX ON EAM_ALERT_DEFINITION ( PARENT_ID )
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.86">
      <schema-directSQL>
        <statement desc="Delete EVENT_LOG_PURGE property if it exists so that we can upgrade from previous version correctly">
        DELETE FROM EAM_CONFIG_PROPS WHERE ID = 51
        </statement>
        <statement>
        INSERT INTO EAM_CONFIG_PROPS (ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE, FREAD_ONLY)
          VALUES (51, 'EVENT_LOG_PURGE', '2678400000', '2678400000', '0')
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.87">
      <schema-directSQL>
        <statement desc="Delete unused index">
        drop index reqstat_idx_clientip
        </statement>
        <statement desc="Delete unused index">
        drop index reqstat_idx_svctype
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="1.88">
      <schema-directSQL>
        <statement>
          UPDATE EAM_CONFIG_PROPS SET propvalue = '2678400000'
          WHERE propkey='RT_DATA_PURGE'
        </statement>
        <statement>
          UPDATE EAM_CONFIG_PROPS SET propvalue = '2678400000'
          WHERE propkey='EVENT_LOG_PURGE'
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.00">
        <!-- Need to execute the following in separate transaction, because there's a
             chance that they might not exist -->
        <schema-directSQL>
            <statement>
              drop index eam_subject_resource_key
            </statement>
            <statement>
              drop index eam_resource_type_resource_key
            </statement>
        </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.01">
        <schema-directSQL>
          <statement>
              delete from eam_aiq_ip
          </statement>
          <statement>
              delete from eam_aiq_service
          </statement>
          <statement>
              delete from eam_aiq_server
          </statement>
          <statement>
              delete from eam_aiq_platform
          </statement>
          <statement>
              drop index error_code
          </statement>
          <statement targetDB="postgresql">
              create index error_code on eam_error_code USING btree (code)
          </statement>
          <statement targetDB="oracle">
              create index error_code on eam_error_code (code)
          </statement>
          <statement>
              drop index aiq_server_name
          </statement>
          <statement>
              drop index aiq_service_name
          </statement>
          <statement>
              drop index alert_idx_alertdefinition
          </statement>
          <statement>
              drop index alert_idx_time
          </statement>
          <statement>
              drop index alert_def_child_idx
          </statement>
          <statement>
              drop index ai_hist_scanname
          </statement>
          <statement>
              drop index ai_schedule_entity
          </statement>
          <statement>
              drop index ai_schedule_nextfiretime
          </statement>
          <statement>
              drop index cresp_verr
          </statement>
          <statement>
              drop index ctl_history_starttime
          </statement>
          <statement>
              drop index ctl_schedule_entity
          </statement>
          <statement>
              drop index ctl_schedule_nextfiretime
          </statement>
          <statement>
              drop index eam_fired_trigger_id_ind
          </statement>
          <statement>
              drop index metric_prob_id_idx
          </statement>
          <statement>
              drop index metric_prob_time_idx
          </statement>
          <statement>
              drop index mtype_idx_appdeftype
          </statement>
          <statement>
              drop index eam_operation_cid_idx
          </statement>
          <statement>
              drop index eam_resource_idx_type
          </statement>
          <statement>
              drop index eam_resource_instance_id
          </statement>
          <statement>
              drop index eam_resource_owner_id
          </statement>
          <statement>
              drop index eam_res_group_res_key
          </statement>
          <statement>
              drop index eam_server_idx_ctime
          </statement>
          <statement>
              drop index eam_server_name
          </statement>
          <statement>
              drop index eam_service_idx_ctime
          </statement>
          <statement>
              drop index eam_service_name
          </statement>
          <statement>
              drop index eam_subject_cid_idx
          </statement>
          <statement>
              drop index eam_subj_role_map_cid_idx
          </statement>
          <statement>
              drop index eam_user_config_resp_user_idx
          </statement>            
          <statement>
              drop index aiq_ip_idx
          </statement>
          <statement>
              drop index aiq_platform_certdn
          </statement>
          <statement>
              drop index aiq_platform_agenttoken
          </statement>
          <statement>
              drop index aiq_platform_fqdn
          </statement>
          <statement>
              drop index aiq_platform_name
          </statement>
          <statement>
              drop index aiq_server_unique_key
          </statement>
          <statement>
              drop index eam_appservice_key
          </statement>
          <statement>
              drop index eam_application_name_key
          </statement>
          <statement>
              drop index ai_schedule_jobname
          </statement>
          <statement>
              drop index ai_schedule_scanname
          </statement>
          <statement>
              drop index ai_schedule_triggername
          </statement>
          <statement>
              drop index eam_configuration_key_indx
          </statement>
          <statement>
              drop index ctl_schedule_jobname
          </statement>
          <statement>
              drop index ctl_schedule_triggername
          </statement>
          <statement>
              drop index eam_cprop_unique
          </statement>
          <statement>
              drop index eam_cprop_key_unique
          </statement>
          <statement>
              drop index eam_ip_idx
          </statement>
          <statement>
              drop index measurement_instance
          </statement>
          <statement>
              drop index cat_name
          </statement>
          <statement>
              drop index type_name
          </statement>
          <statement>
              drop index eam_opname_res_type_idx
          </statement>
          <statement>
              drop index eam_platform_fqdn
          </statement>
          <statement>
              drop index eam_platform_name
          </statement>
          <statement>
              drop index plugin_name_unique
          </statement>
          <statement>
              drop index eam_principal_principal_key
          </statement>
          <statement>
              drop index eam_resource_instance_key
          </statement>
          <statement>
              drop index eam_res_group_name
          </statement>
          <statement>
              drop index eam_res_type_name_key
          </statement>
          <statement>
              drop index eam_role_name_key
          </statement>
          <statement>
              drop index eam_server_aiid_idx
          </statement>
          <statement>
              drop index eam_server_unique_key
          </statement>
          <statement>
              drop index eam_server_type_name_idx
          </statement>
          <statement>
              drop index eam_service_parent
          </statement>
          <statement>
              drop index eam_subject_auth_key
          </statement>
          <statement>
              drop index eam_trigger_event_ref
          </statement>
          <statement>
              drop index service_request_svcid
          </statement>
          <statement description="Drop EAM_METRIC_PROB_VIEW so that we can switch columns">
              DROP VIEW EAM_METRIC_PROB_VIEW
          </statement>
          <statement description="Drop EAM_VIRT_PLAT_VIEW so that we can switch columns">
              DROP VIEW EAM_VIRT_PLAT_VIEW 
          </statement>
          <statement description="Drop EAM_VIRT_SVR_VIEW so that we can switch columns">
              DROP VIEW EAM_VIRT_SVR_VIEW 
          </statement>
          <statement description="Drop EAM_VIRT_SVC_VIEW so that we can switch columns">
              DROP VIEW EAM_VIRT_SVC_VIEW 
          </statement>
        <statement targetDB="postgresql">
          CREATE TABLE eam_crispo (
              id integer NOT NULL,
              version_col bigint DEFAULT 0 NOT NULL
          )            
        </statement>
        <statement targetDB="oracle">
          CREATE TABLE eam_crispo (
              id integer NOT NULL,
              version_col NUMBER(19,0) DEFAULT 0 NOT NULL
          )            
        </statement>
        <statement targetDB="postgresql">
            CREATE TABLE eam_crispo_opt (
                id integer NOT NULL,
                version_col bigint DEFAULT 0 NOT NULL,
                "key" character varying(255) NOT NULL,
                val character varying(255),
                crispo_id integer NOT NULL
            )
        </statement>
        <statement targetDB="oracle">
            CREATE TABLE eam_crispo_opt (
                id integer NOT NULL,
                version_col NUMBER(19,0) DEFAULT 0 NOT NULL,
                key VARCHAR2(255) NOT NULL,
                val VARCHAR2(255),
                crispo_id integer NOT NULL
            )
        </statement>
        <statement targetDB="postgresql">
            CREATE TABLE eam_escalation (
                id integer NOT NULL,
                version_col bigint DEFAULT 0 NOT NULL,
                name character varying(200) NOT NULL,
                description character varying(250),
                allow_pause boolean NOT NULL,
                max_wait_time bigint NOT NULL,
                notify_all boolean NOT NULL,
                ctime bigint NOT NULL,
                mtime bigint NOT NULL
            )          
        </statement>
        <statement targetDB="oracle">
            CREATE TABLE eam_escalation (
                id integer NOT NULL,
                version_col NUMBER(19,0) DEFAULT 0 NOT NULL,
                name VARCHAR2(200) NOT NULL,
                description VARCHAR2(250),
                allow_pause NUMBER(1) NOT NULL,
                max_wait_time NUMBER(19,0) NOT NULL,
                notify_all NUMBER(1) NOT NULL,
                ctime NUMBER(19,0) NOT NULL,
                mtime NUMBER(19,0) NOT NULL
            )          
        </statement>
        <statement targetDB="postgresql">
            CREATE TABLE eam_escalation_action (
                escalation_id integer NOT NULL,
                wait_time bigint NOT NULL,
                action_id integer NOT NULL,
                idx integer NOT NULL
            )
         </statement>
        <statement targetDB="oracle">
            CREATE TABLE eam_escalation_action (
                escalation_id integer NOT NULL,
                wait_time NUMBER(19,0) NOT NULL,
                action_id integer NOT NULL,
                idx integer NOT NULL
            )
         </statement>
         <statement targetDB="postgresql">
            CREATE TABLE eam_exec_strategies (
                id integer NOT NULL,
                version_col bigint DEFAULT 0 NOT NULL,
                def_id integer NOT NULL,
                config_id integer NOT NULL,
                partition integer NOT NULL,
                type_id integer NOT NULL
            )          
          </statement>
         <statement targetDB="oracle">
            CREATE TABLE eam_exec_strategies (
                id integer NOT NULL,
                version_col NUMBER(19,0) DEFAULT 0 NOT NULL,
                def_id integer NOT NULL,
                config_id integer NOT NULL,
                partition integer NOT NULL,
                type_id integer NOT NULL
            )          
          </statement>
          <statement targetDB="postgresql">
             CREATE TABLE eam_exec_strategy_types (
                 id integer NOT NULL,
                 version_col bigint DEFAULT 0 NOT NULL,
                 type_class character varying(255) NOT NULL
             )
          </statement>
          <statement targetDB="oracle">
             CREATE TABLE eam_exec_strategy_types (
                 id integer NOT NULL,
                 version_col NUMBER(19,0) DEFAULT 0 NOT NULL,
                 type_class VARCHAR2(255) NOT NULL
             )
          </statement>
          <statement targetDB="postgresql">
            CREATE TABLE eam_galert_defs (
              id integer NOT NULL,
              version_col bigint DEFAULT 0 NOT NULL,
              name character varying(255) NOT NULL,
              descr character varying(255),
              severity integer NOT NULL,
              enabled boolean NOT NULL,
              ctime bigint NOT NULL,
              mtime bigint NOT NULL,
              group_id integer NOT NULL,
              escalation_id integer
           )
         </statement>
          <statement targetDB="oracle">
            CREATE TABLE eam_galert_defs (
              id integer NOT NULL,
              version_col NUMBER(19,0) DEFAULT 0 NOT NULL,
              name VARCHAR2(255) NOT NULL,
              descr VARCHAR2(255),
              severity integer NOT NULL,
              enabled NUMBER(1) NOT NULL,
              ctime NUMBER(19,0) NOT NULL,
              mtime NUMBER(19,0) NOT NULL,
              group_id integer NOT NULL,
              escalation_id integer
           )
         </statement>
         <statement targetDB="postgresql">
              CREATE TABLE eam_galert_logs (
                  id integer NOT NULL,
                  version_col bigint DEFAULT 0 NOT NULL,
                  "timestamp" bigint NOT NULL,
                  fixed boolean NOT NULL,
                  def_id integer NOT NULL,
                  short_reason character varying(256) NOT NULL,
                  long_reason character varying(2048) NOT NULL,
                  partition integer NOT NULL
              )
         </statement>
         <statement targetDB="oracle">
              CREATE TABLE eam_galert_logs (
                  id integer NOT NULL,
                  version_col NUMBER(19,0) DEFAULT 0 NOT NULL,
                  timestamp NUMBER(19,0) NOT NULL,
                  fixed NUMBER(1) NOT NULL,
                  def_id integer NOT NULL,
                  short_reason VARCHAR2(256) NOT NULL,
                  long_reason VARCHAR2(2048) NOT NULL,
                  partition integer NOT NULL
              )
         </statement>
         <statement targetDB="postgresql">
             CREATE TABLE eam_gtrigger_types (
                 id integer NOT NULL,
                 version_col bigint DEFAULT 0 NOT NULL,
                 type_class character varying(255) NOT NULL
             )
         </statement>
         <statement targetDB="oracle">
             CREATE TABLE eam_gtrigger_types (
                 id integer NOT NULL,
                 version_col NUMBER(19,0) DEFAULT 0 NOT NULL,
                 type_class VARCHAR2(255) NOT NULL
             )
         </statement>
         <statement targetDB="postgresql">
             CREATE TABLE eam_gtriggers (
                 id integer NOT NULL,
                 version_col bigint DEFAULT 0 NOT NULL,
                 config_id integer NOT NULL,
                 type_id integer NOT NULL,
                 strat_id integer NOT NULL,
                 lidx integer NOT NULL
             )
         </statement>
         <statement targetDB="oracle">
             CREATE TABLE eam_gtriggers (
                 id integer NOT NULL,
                 version_col NUMBER(19,0) DEFAULT 0 NOT NULL,
                 config_id integer NOT NULL,
                 type_id integer NOT NULL,
                 strat_id integer NOT NULL,
                 lidx integer NOT NULL
             )
         </statement>
         <statement targetDB="postgresql">
            CREATE TABLE eam_mescalation_state (
                id integer NOT NULL,
                version_col bigint DEFAULT 0 NOT NULL,
                next_action_idx integer NOT NULL,
                next_action_time bigint NOT NULL,
                escalation_id integer NOT NULL,
                alert_type integer NOT NULL,
                alert_def_id integer NOT NULL,
                alert_id integer NOT NULL,
                acknowledged_by integer
            )
         </statement>
         <statement targetDB="oracle">
            CREATE TABLE eam_mescalation_state (
                id integer NOT NULL,
                version_col NUMBER(19,0) DEFAULT 0 NOT NULL,
                next_action_idx integer NOT NULL,
                next_action_time NUMBER(19,0) NOT NULL,
                escalation_id integer NOT NULL,
                alert_type integer NOT NULL,
                alert_def_id integer NOT NULL,
                alert_id integer NOT NULL,
                acknowledged_by integer
            )
         </statement>
          <statement>
             ALTER TABLE eam_galert_defs ADD CONSTRAINT eam_galert_defs_pkey PRIMARY KEY (id)
          </statement>
          <statement>
             ALTER TABLE eam_escalation ADD CONSTRAINT eam_escalation_pkey PRIMARY KEY (id)
          </statement>
          <statement>
            ALTER TABLE eam_galert_logs ADD CONSTRAINT eam_galert_logs_pkey PRIMARY KEY (id)
          </statement>
          <statement>
            ALTER TABLE eam_exec_strategy_types ADD CONSTRAINT eam_exec_strategy_types_pkey PRIMARY KEY (id)
          </statement>
          <statement>
              ALTER TABLE eam_crispo ADD CONSTRAINT eam_crispo_pkey PRIMARY KEY (id)
          </statement>
          <statement>
              ALTER TABLE eam_crispo_opt ADD CONSTRAINT eam_crispo_opt_pkey PRIMARY KEY (id)
          </statement>
          <statement targetDB="postgresql">
            CREATE SEQUENCE eam_crispo_id_seq
                START WITH 10001
                INCREMENT BY 1
                NO MAXVALUE
                NO MINVALUE
                CACHE 1
          </statement>          
          <statement targetDB="oracle">
            CREATE SEQUENCE eam_crispo_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
          </statement>          
          <statement targetDB="postgresql">
            CREATE SEQUENCE eam_crispo_opt_id_seq
                START WITH 10001
                INCREMENT BY 1
                NO MAXVALUE
                NO MINVALUE
                CACHE 1
          </statement>         
          <statement targetDB="oracle">
            CREATE SEQUENCE eam_crispo_opt_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
          </statement>          
          <statement targetDB="postgresql">
            CREATE SEQUENCE eam_escalation_id_seq
                START WITH 10001
                INCREMENT BY 1
                NO MAXVALUE
                NO MINVALUE
                CACHE 1
          </statement>         
          <statement targetDB="oracle">
            CREATE SEQUENCE eam_escalation_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
          </statement>          
          <statement targetDB="postgresql">
            CREATE SEQUENCE eam_exec_strategies_id_seq
                START WITH 10001
                INCREMENT BY 1
                NO MAXVALUE
                NO MINVALUE
                CACHE 1
          </statement>         
          <statement targetDB="oracle">
            CREATE SEQUENCE eam_exec_strategies_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
          </statement>          
          <statement targetDB="postgresql">
            CREATE SEQUENCE eam_exec_strategy_types_id_seq
                START WITH 10001
                INCREMENT BY 1
                NO MAXVALUE
                NO MINVALUE
                CACHE 1
          </statement>         
          <statement targetDB="oracle">
            CREATE SEQUENCE eam_exec_strategy_types_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
          </statement>          
          <statement targetDB="postgresql">
            CREATE SEQUENCE eam_galert_defs_id_seq
                START WITH 10001
                INCREMENT BY 1
                NO MAXVALUE
                NO MINVALUE
                CACHE 1
          </statement>         
          <statement targetDB="oracle">
            CREATE SEQUENCE eam_galert_defs_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
          </statement>          
          <statement targetDB="postgresql">
            CREATE SEQUENCE eam_galert_logs_id_seq
                START WITH 10001
                INCREMENT BY 1
                NO MAXVALUE
                NO MINVALUE
                CACHE 1
          </statement>         
          <statement targetDB="oracle">
            CREATE SEQUENCE eam_galert_logs_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
          </statement>          
          <statement targetDB="postgresql">
            CREATE SEQUENCE eam_gtrigger_types_id_seq
                  START WITH 10001
                  INCREMENT BY 1
                  NO MAXVALUE
                  NO MINVALUE
                  CACHE 1
          </statement>
          <statement targetDB="oracle">
            CREATE SEQUENCE eam_gtrigger_types_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
          </statement>          
          <statement targetDB="postgresql">
              CREATE SEQUENCE eam_gtriggers_id_seq
                  START WITH 10001
                  INCREMENT BY 1
                  NO MAXVALUE
                  NO MINVALUE
                  CACHE 1
          </statement>
          <statement targetDB="oracle">
            CREATE SEQUENCE eam_gtriggers_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
          </statement>          
          <statement targetDB="postgresql">
              CREATE SEQUENCE eam_mescalation_state_id_seq
                  START WITH 10001
                  INCREMENT BY 1
                  NO MAXVALUE
                  NO MINVALUE
                  CACHE 1
          </statement>
          <statement targetDB="oracle">
            CREATE SEQUENCE eam_mescalation_state_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
          </statement>          
        </schema-directSQL>
        <schema-addColumn table="EAM_ACTION"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_ACTION SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_ACTION" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
        <schema-addColumn table="EAM_AIQ_SERVER"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_AIQ_SERVER SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_AIQ_SERVER" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_AIQ_SERVICE"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_AIQ_SERVICE SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_AIQ_SERVICE" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_ALERT"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_ALERT SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_ALERT" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_ALERT_CONDITION"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_ALERT_CONDITION SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_ALERT_CONDITION" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
        <schema-addColumn table="EAM_APP_SERVICE"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_APP_SERVICE SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_APP_SERVICE" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_APPLICATION"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_APPLICATION SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_APPLICATION" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_IP"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_IP SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_IP" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_MEASUREMENT"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_MEASUREMENT SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
        <schema-alterColumn table="EAM_MEASUREMENT" quoteDefault="f" 
                            column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_MEASUREMENT_ARG"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_MEASUREMENT_ARG SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_MEASUREMENT_ARG" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_MEASUREMENT_TEMPL"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_MEASUREMENT_TEMPL SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_MEASUREMENT_TEMPL" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_OPERATION"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_OPERATION SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_OPERATION" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
        <schema-addColumn table="EAM_PLATFORM"
                          column="VERSION_COL" columnType="LONG">
          <initializer>
            UPDATE EAM_PLATFORM SET VERSION_COL=0
          </initializer>
        </schema-addColumn>
        <schema-alterColumn table="EAM_PLATFORM" quoteDefault="f" 
                            column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_REGISTERED_TRIGGER"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_REGISTERED_TRIGGER SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_REGISTERED_TRIGGER" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_RESOURCE"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_RESOURCE SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_RESOURCE" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_RESOURCE_GROUP"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_RESOURCE_GROUP SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_RESOURCE_GROUP" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_ROLE"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_ROLE SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_ROLE" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_SERVER"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_SERVER SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_SERVER" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_SERVICE"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_SERVICE SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_SERVICE" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_SERVICE_TYPE"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_SERVICE_TYPE SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_SERVICE_TYPE" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_SRN"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_SRN SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_SRN" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_SUBJECT"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_SUBJECT SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_SUBJECT" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_SVC_CLUSTER"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_SVC_CLUSTER SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_SVC_CLUSTER" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_USER_CONFIG_RESP"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_USER_CONFIG_RESP SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_USER_CONFIG_RESP" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
        <schema-addColumn table="EAM_AGENT"
                          column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_AGENT SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
        <schema-alterColumn table="EAM_AGENT" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
        <schema-addColumn table="EAM_AGENT_TYPE"
                           column="VERSION_COL" columnType="LONG">
            <initializer>
               UPDATE EAM_AGENT_TYPE SET VERSION_COL=0
            </initializer>
        </schema-addColumn>
        <schema-alterColumn table="EAM_AGENT_TYPE" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_AIQ_IP"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_AIQ_IP SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_AIQ_IP" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
        <schema-addColumn table="EAM_AIQ_PLATFORM"
                          column="VERSION_COL" columnType="LONG">
          <initializer>
            UPDATE EAM_AIQ_PLATFORM SET VERSION_COL=0
          </initializer>
        </schema-addColumn>
        <schema-alterColumn table="EAM_AIQ_PLATFORM" quoteDefault="f" 
                            column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_ALERT_DEFINITION"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_ALERT_DEFINITION SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_ALERT_DEFINITION" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_APPLICATION_TYPE"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_APPLICATION_TYPE SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_APPLICATION_TYPE" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_AUTOINV_HISTORY"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_AUTOINV_HISTORY SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_AUTOINV_HISTORY" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_AUTOINV_SCHEDULE"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_AUTOINV_SCHEDULE SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_AUTOINV_SCHEDULE" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_CONFIG_PROPS"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_CONFIG_PROPS SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_CONFIG_PROPS" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_CONFIG_RESPONSE"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_CONFIG_RESPONSE SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_CONFIG_RESPONSE" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_CONTROL_SCHEDULE"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_CONTROL_SCHEDULE SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_CONTROL_SCHEDULE" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_CPROP"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_CPROP SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_CPROP" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_CPROP_KEY"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_CPROP_KEY SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_CPROP_KEY" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_EVENT"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_EVENT SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_EVENT" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_MEASUREMENT_BL"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_MEASUREMENT_BL SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_MEASUREMENT_BL" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_MEASUREMENT_CAT"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_MEASUREMENT_CAT SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_MEASUREMENT_CAT" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_METRIC_PROB"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_METRIC_PROB SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_METRIC_PROB" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_MONITORABLE_TYPE"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_MONITORABLE_TYPE SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_MONITORABLE_TYPE" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_PLATFORM_TYPE"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_PLATFORM_TYPE SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_PLATFORM_TYPE" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_PLUGIN"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_PLUGIN SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_PLUGIN" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_PRINCIPAL"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_PRINCIPAL SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_PRINCIPAL" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_RESOURCE_TYPE"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_RESOURCE_TYPE SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_RESOURCE_TYPE" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_SERVER_TYPE"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_SERVER_TYPE SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_SERVER_TYPE"
                             column="NAME" nullable="NOT NULL"/>
         <schema-alterColumn table="EAM_SERVER_TYPE" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_VIRTUAL"
                           column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_VIRTUAL SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_VIRTUAL" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>   
        <schema-addColumn table="EAM_STAT_ERRORS"
                          column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_STAT_ERRORS SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_STAT_ERRORS" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
        <schema-addColumn table="EAM_SERVICE_REQUEST"
                          column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_SERVICE_REQUEST SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_SERVICE_REQUEST" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
        <schema-addColumn table="EAM_ERROR_CODE"
                          column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_ERROR_CODE SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_ERROR_CODE" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
        <schema-addColumn table="EAM_REQUEST_STAT"
                          column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_REQUEST_STAT SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_REQUEST_STAT" quoteDefault="f" 
                             column="VERSION_COL" default="0" nullable="NOT NULL"/>
        <schema-directSQL>
          <statement>
              alter table eam_action rename column alert_definition_id to alert_definition_id_orig
          </statement>
          <statement>
              alter table eam_action rename column parent_id to parent_id_orig
          </statement>
          <statement>
              alter table eam_request_stat rename column svcreq_id to svcreq_id_orig
          </statement>
        </schema-directSQL>
        <schema-addColumn table="EAM_ACTION "
                           column="ALERT_DEFINITION_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_ACTION SET ALERT_DEFINITION_ID=ALERT_DEFINITION_ID_ORIG
           </initializer>
        </schema-addColumn>
        <schema-addColumn table="EAM_ACTION "
                           column="PARENT_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_ACTION SET PARENT_ID=PARENT_ID_ORIG
           </initializer>
        </schema-addColumn>
        <schema-addColumn table="EAM_REQUEST_STAT"
                          column="SVCREQ_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_REQUEST_STAT SET SVCREQ_ID=SVCREQ_ID_ORIG
           </initializer>
        </schema-addColumn>
        <schema-directSQL>
          <statement>
              alter table eam_action drop column alert_definition_id_orig
          </statement>
          <statement>
              alter table eam_action drop column parent_id_orig
          </statement>
          <statement>
              alter table eam_action add constraint "fkd0189b04b5af9d12" 
                    FOREIGN KEY (alert_definition_id) 
                    REFERENCES eam_alert_definition(id)
                    ON DELETE CASCADE
          </statement>
          <statement>
              delete from eam_alert_action_log where action_id in
              (select id from eam_action where alert_definition_id is null) or
              action_id is null or alert_id is null
          </statement>
          <statement>
              delete from eam_action where alert_definition_id is null or
              id in (select a.id from eam_action a, eam_alert_definition d
                     where a.alert_definition_id = d.id and d.deleted = %%TRUE%%
                       and a.id not in (select action_id from eam_alert_action_log))
          </statement>
          <statement>
              ALTER TABLE eam_action ADD CONSTRAINT "fkd0189b04c0bb4c7" 
                    FOREIGN KEY (parent_id) REFERENCES eam_action(id) 
                    ON DELETE CASCADE
          </statement>
          <statement>
              alter table eam_request_stat drop column svcreq_id_orig
          </statement>
          <statement>
              alter table eam_request_stat add constraint fke8ebbc725a959c18 
                    FOREIGN KEY (svcreq_id) REFERENCES eam_service_request(id) 
                    ON DELETE CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_aiq_server RENAME COLUMN aiq_platform_id TO aiq_platform_id_orig
          </statement>
          <statement targetDB="postgresql">
            CREATE INDEX aiq_server_name ON eam_aiq_server USING btree (name)
          </statement>
          <statement targetDB="oracle">
            CREATE INDEX aiq_server_name ON eam_aiq_server (name)
          </statement>
        </schema-directSQL>
        <schema-addColumn table="EAM_AIQ_SERVER"
                          column="AIQ_PLATFORM_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_AIQ_SERVER SET AIQ_PLATFORM_ID=AIQ_PLATFORM_ID_ORIG
           </initializer>
        </schema-addColumn>
        <schema-directSQL>
          <statement>
            ALTER TABLE eam_aiq_server DROP COLUMN aiq_platform_id_orig
          </statement>
          <statement>
             ALTER TABLE eam_aiq_server ADD CONSTRAINT aiq_server_unique_key UNIQUE (aiq_platform_id, autoinventoryidentifier)
          </statement>
          <statement>
            ALTER TABLE eam_aiq_server ADD CONSTRAINT fk60c6c4e71bff8500 FOREIGN KEY (aiq_platform_id) REFERENCES eam_aiq_platform(id) ON DELETE CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_aiq_service RENAME COLUMN server_id TO server_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_alert RENAME COLUMN alert_definition_id to alert_definition_id_orig 
          </statement>
          <statement>
            ALTER TABLE eam_alert_action_log RENAME COLUMN action_id TO action_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_alert_action_log RENAME COLUMN alert_id TO alert_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_alert_condition RENAME COLUMN alert_definition_id TO alert_definition_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_alert_condition_log RENAME COLUMN alert_id TO alert_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_alert_condition_log RENAME COLUMN condition_id TO condition_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_app_service RENAME COLUMN application_id TO application_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_app_service RENAME COLUMN cluster_id TO cluster_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_app_service RENAME COLUMN service_id TO service_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_app_service RENAME COLUMN service_type_id TO service_type_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_app_type_service_type_map RENAME COLUMN application_type_id TO application_type_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_app_type_service_type_map RENAME COLUMN service_type_id TO service_type_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_application RENAME COLUMN application_type_id TO application_type_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_ip RENAME COLUMN platform_id TO platform_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_measurement_templ RENAME COLUMN category_id TO category_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_measurement_templ RENAME COLUMN monitorable_type_id TO monitorable_type_id_orig 
          </statement>
          <statement>
            ALTER TABLE eam_measurement RENAME COLUMN template_id TO template_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_measurement_arg RENAME COLUMN measurement_template_arg_id TO template_arg_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_measurement_arg RENAME COLUMN measurement_template_id TO measurement_template_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_resource RENAME COLUMN resource_type_id TO resource_type_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_operation RENAME COLUMN resource_type_id TO resource_type_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_platform RENAME COLUMN config_response_id TO config_response_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_platform RENAME COLUMN platform_type_id TO platform_type_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_platform RENAME COLUMN agent_id TO agent_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_platform_server_type_map RENAME COLUMN platform_type_id TO platform_type_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_platform_server_type_map RENAME COLUMN server_type_id TO server_type_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_registered_trigger RENAME COLUMN alert_definition_id TO alert_definition_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_resource_group RENAME COLUMN resource_id TO resource_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_role RENAME COLUMN resource_id TO resource_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_server RENAME COLUMN config_response_id TO config_response_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_server RENAME COLUMN platform_id TO platform_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_server RENAME COLUMN server_type_id TO server_type_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_service RENAME COLUMN config_response_id TO config_response_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_service RENAME COLUMN server_id TO server_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_service RENAME COLUMN service_type_id TO service_type_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_service RENAME COLUMN svc_cluster_id TO svc_cluster_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_service_type RENAME COLUMN server_type_id TO server_type_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_subject RENAME COLUMN resource_id TO resource_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_svc_cluster RENAME COLUMN service_type_id TO service_type_id_ORIG 
          </statement>
          <statement>
            ALTER TABLE eam_trigger_event RENAME COLUMN event_id TO event_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_stat_errors RENAME COLUMN error_id TO error_id_orig
          </statement>            
          <statement>
            ALTER TABLE eam_stat_errors RENAME COLUMN reqstat_id TO reqstat_id_orig
          </statement>            
          <statement>
              ALTER TABLE eam_agent RENAME COLUMN agent_type_id TO agent_type_id_orig 
          </statement>
          <statement targetDB="postgresql">
            CREATE INDEX aiq_service_name_idx ON eam_aiq_service USING btree (name)
          </statement>
          <statement targetDB="oracle">
            CREATE INDEX aiq_service_name_idx ON eam_aiq_service (name)
          </statement>
        </schema-directSQL>
         <schema-addColumn table="EAM_AIQ_SERVICE"
                           column="SERVER_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_AIQ_SERVICE SET SERVER_ID=SERVER_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_AIQ_SERVICE" 
                             column="SERVER_ID" nullable="NOT NULL"/>

        <schema-directSQL>
          <statement>
            ALTER TABLE eam_aiq_service DROP COLUMN server_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_aiq_service ADD CONSTRAINT fkb811e571ea5ff386 FOREIGN KEY (server_id) REFERENCES eam_server(id)
          </statement>
        </schema-directSQL>
        <schema-addColumn table="EAM_ALERT"
                          column="FIXED" columnType="BOOLEAN"/>
        <schema-update table="EAM_ALERT" column="FIXED"
                       columnType="BOOLEAN" value="FALSE" />
        <schema-alterColumn table="EAM_ALERT" 
                            column="FIXED" nullable="NOT NULL"/>

         <schema-directSQL>
            <statement>
                UPDATE EAM_ALERT SET ALERT_DEFINITION_ID_ORIG = 0
                       WHERE ALERT_DEFINITION_ID_ORIG IS NULL
            </statement>
         </schema-directSQL>
        <schema-addColumn table="EAM_ALERT"
                          column="ALERT_DEFINITION_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_ALERT SET ALERT_DEFINITION_ID=ALERT_DEFINITION_ID_ORIG 
           </initializer>
        </schema-addColumn>
        <schema-alterColumn table="EAM_ALERT" 
                            column="ALERT_DEFINITION_ID" nullable="NOT NULL"/>
        <schema-addColumn table="EAM_ALERT_ACTION_LOG"
                          column="SUBJECT_ID" columnType="INTEGER"/>
        <schema-addColumn table="EAM_ALERT_ACTION_LOG"
                          column="GALERT_ID" columnType="INTEGER"/>
        <schema-addColumn table="EAM_ALERT_ACTION_LOG"
                          column="ACTION_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_ALERT_ACTION_LOG SET ACTION_ID=ACTION_ID_ORIG 
           </initializer>
        </schema-addColumn>
        <schema-addColumn table="EAM_ALERT_ACTION_LOG"
                          column="ALERT_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_ALERT_ACTION_LOG SET ALERT_ID=ALERT_ID_ORIG 
           </initializer>
        </schema-addColumn>
        <schema-update table="EAM_ALERT_ACTION_LOG" column="ALERT_ID"
                       columnType="INTEGER" value="0" where="alert_id is null"/>
        <schema-alterColumn table="EAM_ALERT_ACTION_LOG" 
                            column="ALERT_ID" nullable="NOT NULL"/>
        <schema-addColumn table="EAM_ALERT_CONDITION"
                          column="ALERT_DEFINITION_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_ALERT_CONDITION SET ALERT_DEFINITION_ID=ALERT_DEFINITION_ID_ORIG 
           </initializer>
        </schema-addColumn>
        <schema-directSQL>
          <statement>
            ALTER TABLE eam_alert DROP COLUMN alert_definition_id_orig
          </statement>
          <statement targetDB="postgresql">
            CREATE INDEX alert_time_idx ON eam_alert USING btree (ctime)
          </statement>
          <statement targetDB="oracle">
            CREATE INDEX alert_time_idx ON eam_alert (ctime)
          </statement>
          <statement targetDB="postgresql">
            CREATE INDEX alert_alertdefinition_idx ON eam_alert 
                    USING btree (alert_definition_id)
          </statement>
          <statement targetDB="oracle">
            CREATE INDEX alert_alertdefinition_idx ON eam_alert (alert_definition_id)
          </statement>
          <statement>
            ALTER TABLE eam_alert ADD CONSTRAINT fke5b216aeb5af9d12 FOREIGN KEY (alert_definition_id) REFERENCES eam_alert_definition(id)
          </statement>
             <statement>
               ALTER TABLE eam_alert_action_log DROP COLUMN action_id_orig
             </statement>
             <statement>
               ALTER TABLE eam_alert_action_log DROP COLUMN alert_id_orig
             </statement>
          <statement>
            ALTER TABLE eam_alert_action_log ADD CONSTRAINT fk423fa3cc1aa4e259 FOREIGN KEY (alert_id) REFERENCES eam_alert(id) ON DELETE CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_alert_action_log ADD CONSTRAINT fk423fa3cc9c76c3bb FOREIGN KEY (action_id) REFERENCES eam_action(id) ON DELETE CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_alert_action_log ADD CONSTRAINT fk423fa3cce82fbc FOREIGN KEY (subject_id) REFERENCES eam_subject(id)
          </statement>
          <statement>
            ALTER TABLE eam_alert_condition DROP COLUMN alert_definition_id_orig
          </statement>
          <statement targetDB="postgresql">
            CREATE INDEX alert_cond_alert_def_idx ON eam_alert_condition USING btree (alert_definition_id)
          </statement>
          <statement targetDB="oracle">
            CREATE INDEX alert_cond_alert_def_idx ON eam_alert_condition (alert_definition_id)
          </statement>
          <statement>
            ALTER TABLE eam_alert_condition ADD CONSTRAINT fke4028caab5af9d12 FOREIGN KEY (alert_definition_id) REFERENCES eam_alert_definition(id) ON DELETE CASCADE
          </statement>
          <statement>
            UPDATE eam_alert_condition SET trigger_id = NULL WHERE trigger_id NOT IN (SELECT id FROM eam_registered_trigger)
          </statement>
          <statement>
            ALTER TABLE eam_alert_condition ADD CONSTRAINT fke4028caad448177 FOREIGN KEY (trigger_id) REFERENCES eam_registered_trigger(id)
          </statement>
        </schema-directSQL>
        <schema-addColumn table="EAM_ALERT_CONDITION_LOG"
                          column="ALERT_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_ALERT_CONDITION_LOG SET ALERT_ID=ALERT_ID_ORIG 
           </initializer>
        </schema-addColumn>
        <schema-addColumn table="EAM_ALERT_CONDITION_LOG"
                          column="CONDITION_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_ALERT_CONDITION_LOG SET CONDITION_ID=CONDITION_ID_ORIG 
           </initializer>
        </schema-addColumn>
        <schema-directSQL>
          <statement>
            ALTER TABLE eam_alert_condition_log DROP COLUMN alert_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_alert_condition_log DROP COLUMN condition_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_alert_condition_log ADD CONSTRAINT fkd1647e0f1aa4e259 FOREIGN KEY (alert_id) REFERENCES eam_alert(id) ON DELETE CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_alert_condition_log ADD CONSTRAINT fkd1647e0f2eaa2a9f FOREIGN KEY (condition_id) REFERENCES eam_alert_condition(id) ON DELETE CASCADE
          </statement>
          <statement targetDB="postgresql">
            CREATE INDEX alert_cond_log_idx ON eam_alert_condition_log 
              USING btree (alert_id)
          </statement>
          <statement targetDB="oracle">
            CREATE INDEX alert_cond_log_idx ON eam_alert_condition_log (alert_id)
          </statement>
        </schema-directSQL>
        <schema-update table="EAM_APP_SERVICE" column="FENTRY_POINT"
                       columnType="BOOLEAN" value="TRUE" 
                       where="FENTRY_POINT IS NULL"/>
         <schema-addColumn table="EAM_APP_SERVICE"
                           column="APPLICATION_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_APP_SERVICE SET APPLICATION_ID=APPLICATION_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-addColumn table="EAM_APP_SERVICE"
                           column="CLUSTER_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_APP_SERVICE SET CLUSTER_ID=CLUSTER_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-addColumn table="EAM_APP_SERVICE"
                           column="SERVICE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_APP_SERVICE SET SERVICE_ID=SERVICE_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-addColumn table="EAM_APP_SERVICE"
                           column="SERVICE_TYPE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_APP_SERVICE SET SERVICE_TYPE_ID=SERVICE_TYPE_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-addColumn table="EAM_APP_TYPE_SERVICE_TYPE_MAP"
                           column="APPLICATION_TYPE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_APP_TYPE_SERVICE_TYPE_MAP SET APPLICATION_TYPE_ID=APPLICATION_TYPE_ID_ORIG
           </initializer>
         </schema-addColumn>
        <schema-update table="EAM_APP_TYPE_SERVICE_TYPE_MAP" 
                       column="APPLICATION_TYPE_ID"
                       columnType="INTEGER" value="0" 
                       where="APPLICATION_TYPE_ID IS NULL"/>
        <schema-alterColumn table="EAM_APP_TYPE_SERVICE_TYPE_MAP"
                            column="APPLICATION_TYPE_ID" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_APP_TYPE_SERVICE_TYPE_MAP"
                           column="SERVICE_TYPE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_APP_TYPE_SERVICE_TYPE_MAP SET SERVICE_TYPE_ID=SERVICE_TYPE_ID_ORIG
           </initializer>
         </schema-addColumn>
        <schema-update table="EAM_APP_TYPE_SERVICE_TYPE_MAP" 
                       column="SERVICE_TYPE_ID"
                       columnType="INTEGER" value="0" 
                       where="SERVICE_TYPE_ID IS NULL"/>
        <schema-alterColumn table="EAM_APP_TYPE_SERVICE_TYPE_MAP"
                            column="SERVICE_TYPE_ID" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_APPLICATION"
                           column="APPLICATION_TYPE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_APPLICATION SET APPLICATION_TYPE_ID=APPLICATION_TYPE_ID_ORIG
           </initializer>
         </schema-addColumn>
        <schema-update table="EAM_APPLICATION" 
                       column="APPLICATION_TYPE_ID"
                       columnType="INTEGER" value="0" 
                       where="APPLICATION_TYPE_ID IS NULL"/>
        <schema-alterColumn table="EAM_APPLICATION"
                            column="APPLICATION_TYPE_ID" nullable="NOT NULL"/>
         <schema-directSQL>
          <statement>
            ALTER TABLE eam_app_service DROP COLUMN application_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_app_service DROP COLUMN cluster_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_app_service DROP COLUMN service_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_app_service DROP COLUMN service_type_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_app_service ADD CONSTRAINT eam_app_service_service_id_key UNIQUE (service_id, cluster_id, application_id)
          </statement>
          <statement>
            ALTER TABLE eam_app_service ADD CONSTRAINT fkd1cf8e4967a1226e FOREIGN KEY (service_id) REFERENCES eam_service(id) ON DELETE CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_app_service ADD CONSTRAINT fkd1cf8e4999ee4e8e FOREIGN KEY (application_id) REFERENCES eam_application(id) ON DELETE CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_app_service ADD CONSTRAINT fkd1cf8e49b648cf19 FOREIGN KEY (service_type_id) REFERENCES eam_service_type(id) ON DELETE CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_app_service ADD CONSTRAINT fkd1cf8e49ffb4c31c FOREIGN KEY (cluster_id) REFERENCES eam_svc_cluster(id) ON DELETE CASCADE
          </statement>
          <statement>
              ALTER TABLE eam_app_type_service_type_map DROP COLUMN application_type_id_orig
          </statement>
          <statement>
              ALTER TABLE eam_app_type_service_type_map DROP COLUMN service_type_id_orig
          </statement>
          <statement targetDB="postgresql">
              ALTER TABLE eam_app_type_service_type_map ADD CONSTRAINT eam_app_type_service_type_map_pkey PRIMARY KEY (service_type_id, application_type_id)
          </statement>
          <statement targetDB="oracle">
              ALTER TABLE eam_app_type_service_type_map ADD CONSTRAINT SYS_C10102982 PRIMARY KEY (service_type_id, application_type_id)
          </statement>
          <statement>
            ALTER TABLE eam_app_type_service_type_map ADD CONSTRAINT fk5a2c503aaac031cf FOREIGN KEY (application_type_id) REFERENCES eam_application_type(id)
          </statement>
          <statement>
            ALTER TABLE eam_app_type_service_type_map ADD CONSTRAINT fk5a2c503ab648cf19 FOREIGN KEY (service_type_id) REFERENCES eam_service_type(id)
          </statement>
          <statement>
             ALTER TABLE eam_application DROP COLUMN application_type_id_orig
          </statement>
          <statement>
             ALTER TABLE eam_application ADD CONSTRAINT eam_application_name_key UNIQUE (name)
          </statement>
          <statement>
            ALTER TABLE eam_application ADD CONSTRAINT fk6c0c122aac031cf FOREIGN KEY (application_type_id) REFERENCES eam_application_type(id) ON DELETE CASCADE
          </statement>
        </schema-directSQL>
         <schema-addColumn table="EAM_IP"
                           column="PLATFORM_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_IP SET PLATFORM_ID=PLATFORM_ID_ORIG
           </initializer>
         </schema-addColumn>
        <schema-update table="EAM_IP" column="PLATFORM_ID"
                       columnType="INTEGER" value="0" 
                       where="PLATFORM_ID IS NULL"/>
        <schema-alterColumn table="EAM_IP" column="PLATFORM_ID" 
                            nullable="NOT NULL"/>
        <!-- The measurement class must be filled out: XXX -->
        <schema-addColumn table="EAM_MEASUREMENT"
                           column="MEASUREMENT_CLASS" columnType="CHAR"
                           precision="1"/>
        <schema-update table="EAM_MEASUREMENT" column="MEASUREMENT_CLASS"
                       columnType="CHAR" value="R"
                       where="coll_interval is null"/>
        <schema-update table="EAM_MEASUREMENT" column="MEASUREMENT_CLASS"
                       columnType="CHAR" value="D"
                       where="coll_interval is not null"/>
        <schema-alterColumn table="EAM_MEASUREMENT" quoteDefault="f" 
                            column="MEASUREMENT_CLASS" default="0" 
                            nullable="NOT NULL"/>

         <schema-addColumn table="EAM_MEASUREMENT"
                           column="TEMPLATE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_MEASUREMENT SET TEMPLATE_ID=TEMPLATE_ID_ORIG
           </initializer>
         </schema-addColumn>
        <schema-alterColumn table="EAM_MEASUREMENT" 
                            column="TEMPLATE_ID" nullable="NOT NULL"/>
        <schema-alterColumn table="EAM_MEASUREMENT" 
                            column="ENABLED" nullable="NULL"/>
         <schema-addColumn table="EAM_MEASUREMENT_TEMPL"
                           column="CATEGORY_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_MEASUREMENT_TEMPL SET CATEGORY_ID=CATEGORY_ID_ORIG
           </initializer>
         </schema-addColumn>
        <schema-alterColumn table="EAM_MEASUREMENT_TEMPL" 
                            column="CATEGORY_ID" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_MEASUREMENT_TEMPL"
                           column="MONITORABLE_TYPE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_MEASUREMENT_TEMPL SET MONITORABLE_TYPE_ID=MONITORABLE_TYPE_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-directSQL>
          <statement>
             ALTER TABLE eam_ip DROP COLUMN platform_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_ip ADD CONSTRAINT eam_ip_platform_id_key UNIQUE (platform_id, address)
          </statement>
          <statement>
            ALTER TABLE eam_ip ADD CONSTRAINT fk7976c8f56796aa86 FOREIGN KEY (platform_id) REFERENCES eam_platform(id) ON DELETE CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_measurement DROP COLUMN template_id_orig
          </statement>
          <statement targetDB="postgresql">
            CREATE INDEX meas_id_class ON eam_measurement USING btree (id, measurement_class)
          </statement>
          <statement targetDB="oracle">
            CREATE INDEX meas_id_class ON eam_measurement (id, measurement_class)
          </statement>
          <statement targetDB="postgresql">
             ALTER TABLE eam_measurement ADD CONSTRAINT eam_measurement_instance_id_key UNIQUE (instance_id, template_id)
          </statement>
          <statement targetDB="oracle">
             ALTER TABLE eam_measurement ADD CONSTRAINT MEASUREMENT_INSTANCE UNIQUE (instance_id, template_id)
          </statement>
          <statement>
            ALTER TABLE eam_measurement ADD CONSTRAINT fk3e0f978ec37f24b8 FOREIGN KEY (template_id) REFERENCES eam_measurement_templ(id)
          </statement>
          <statement>
            ALTER TABLE eam_measurement_templ DROP COLUMN CATEGORY_ID_ORIG
          </statement>
          <statement>
            ALTER TABLE eam_measurement_templ DROP COLUMN MONITORABLE_TYPE_ID_ORIG
          </statement>
          <statement>
            ALTER TABLE eam_measurement_templ ADD CONSTRAINT fk253d70712a378d8 FOREIGN KEY (category_id) REFERENCES eam_measurement_cat(id)
          </statement>
          <statement>
            ALTER TABLE eam_measurement_templ ADD CONSTRAINT fk253d707ef33c225 FOREIGN KEY (monitorable_type_id) REFERENCES eam_monitorable_type(id) ON DELETE CASCADE
          </statement>
          <statement desc="Create new problem view with appdef ID.">
          CREATE VIEW EAM_METRIC_PROB_VIEW AS
          SELECT
            appdef_type, instance_id, measurement_id, timestamp, type
              FROM eam_metric_prob, eam_measurement m,
                   eam_measurement_templ t, eam_monitorable_type mt
              WHERE measurement_id = m.id AND template_id = t.id AND
                    monitorable_type_id = mt.id
          </statement>
        </schema-directSQL>
         <schema-addColumn table="EAM_MEASUREMENT_ARG"
                           column="MEASUREMENT_TEMPLATE_ARG_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_MEASUREMENT_ARG SET MEASUREMENT_TEMPLATE_ARG_ID=TEMPLATE_ARG_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-addColumn table="EAM_MEASUREMENT_ARG"
                           column="MEASUREMENT_TEMPLATE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_MEASUREMENT_ARG SET MEASUREMENT_TEMPLATE_ID=MEASUREMENT_TEMPLATE_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-directSQL>
          <statement>
            ALTER TABLE eam_measurement_arg DROP COLUMN template_arg_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_measurement_arg DROP COLUMN measurement_template_id_orig
          </statement>
          <statement targetDB="postgresql">
            CREATE INDEX measurement_arg_idx ON eam_measurement_arg USING btree (measurement_template_arg_id)
          </statement>
          <statement targetDB="oracle">
            CREATE INDEX measurement_arg_idx ON eam_measurement_arg (measurement_template_arg_id)
          </statement>
          <statement>
            ALTER TABLE eam_measurement_arg ADD CONSTRAINT fkf6694e051626a4b5 FOREIGN KEY (measurement_template_id) REFERENCES eam_measurement_templ(id) ON DELETE CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_measurement_arg ADD CONSTRAINT fkf6694e05a4c5a63e FOREIGN KEY (measurement_template_arg_id) REFERENCES eam_measurement_templ(id) ON DELETE CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_measurement_data DROP CONSTRAINT measurement_data_id_time_pk CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_measurement_data_1d DROP CONSTRAINT measurement_data_1d_id_time_pk CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_measurement_data_1h DROP CONSTRAINT measurement_data_1h_id_time_pk CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_measurement_data_6h DROP CONSTRAINT measurement_data_6h_id_time_pk CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_measurement_data ADD CONSTRAINT eam_measurement_data_pkey PRIMARY KEY (measurement_id, timestamp)
          </statement>
          <statement>
            ALTER TABLE eam_measurement_data_1d ADD CONSTRAINT eam_measurement_data_1d_pkey PRIMARY KEY (measurement_id, timestamp)
          </statement>
          <statement>
            ALTER TABLE eam_measurement_data_1h ADD CONSTRAINT eam_measurement_data_1h_pkey PRIMARY KEY (measurement_id, timestamp)
          </statement>
          <statement>
            ALTER TABLE eam_measurement_data_6h ADD CONSTRAINT eam_measurement_data_6h_pkey PRIMARY KEY (measurement_id, timestamp)
          </statement>
         </schema-directSQL>
         <schema-addColumn table="EAM_RESOURCE"
                           column="RESOURCE_TYPE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_RESOURCE SET RESOURCE_TYPE_ID=RESOURCE_TYPE_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-directSQL>
                <statement>
                  ALTER TABLE eam_resource DROP COLUMN RESOURCE_TYPE_ID_ORIG
                </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX eam_resource_idx_type_idx ON eam_resource USING btree (resource_type_id)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX eam_resource_idx_type_idx ON eam_resource (resource_type_id)
                </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX eam_resource_instance_id_idx ON eam_resource USING btree (instance_id)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX eam_resource_instance_id_idx ON eam_resource (instance_id)
                </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX eam_resource_owner_id_idx ON eam_resource USING btree (subject_id)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX eam_resource_owner_id_idx ON eam_resource (subject_id)
                </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_resource ADD CONSTRAINT eam_resource_resource_type_id_key UNIQUE (resource_type_id, instance_id)
          </statement>
          <statement targetDB="oracle">
            ALTER TABLE eam_resource ADD CONSTRAINT SYS_C10104432 UNIQUE (resource_type_id, instance_id)
          </statement>
          <statement>
            ALTER TABLE eam_resource ADD CONSTRAINT fk7ac0e15c9e309b2b FOREIGN KEY (resource_type_id) REFERENCES eam_resource_type(id)
          </statement>
          <statement>
            ALTER TABLE eam_resource ADD CONSTRAINT fk7ac0e15ce82fbc FOREIGN KEY (subject_id) REFERENCES eam_subject(id)
          </statement>
         </schema-directSQL>
         <schema-addColumn table="EAM_OPERATION"
                           column="RESOURCE_TYPE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_OPERATION SET RESOURCE_TYPE_ID=RESOURCE_TYPE_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-directSQL>
          <statement>
             ALTER TABLE eam_operation DROP COLUMN resource_type_id_orig
          </statement>
          <statement>
             ALTER TABLE eam_operation ADD CONSTRAINT eam_operation_name_key UNIQUE (name, resource_type_id)
          </statement>
          <statement>
            ALTER TABLE eam_operation ADD CONSTRAINT fkb6a961b99e309b2b FOREIGN KEY (resource_type_id) REFERENCES eam_resource_type(id) ON DELETE CASCADE
          </statement>
         </schema-directSQL>
        <schema-addColumn table="EAM_PLATFORM"
                          column="CONFIG_RESPONSE_ID" columnType="INTEGER">
          <initializer>
            UPDATE EAM_PLATFORM SET CONFIG_RESPONSE_ID=CONFIG_RESPONSE_ID_ORIG
          </initializer>
        </schema-addColumn>
        <schema-addColumn table="EAM_PLATFORM"
                          column="PLATFORM_TYPE_ID" columnType="INTEGER">
          <initializer>
            UPDATE EAM_PLATFORM SET PLATFORM_TYPE_ID=PLATFORM_TYPE_ID_ORIG
          </initializer>
        </schema-addColumn>
        <schema-alterColumn table="EAM_PLATFORM" 
                            column="PLATFORM_TYPE_ID" nullable="NOT NULL"/>
        <schema-addColumn table="EAM_PLATFORM"
                          column="AGENT_ID" columnType="INTEGER">
          <initializer>
            UPDATE EAM_PLATFORM SET AGENT_ID=AGENT_ID_ORIG
          </initializer>
        </schema-addColumn>
        <schema-directSQL>
            <statement>
                ALTER TABLE eam_platform DROP COLUMN config_response_id_orig
            </statement>
            <statement>
                ALTER TABLE eam_platform DROP COLUMN platform_type_id_orig
            </statement>
            <statement>
                ALTER TABLE eam_platform DROP COLUMN agent_id_orig
            </statement>
          <statement>
             ALTER TABLE eam_platform ADD CONSTRAINT eam_platform_fqdn_key UNIQUE (fqdn)
          </statement>
          <statement>
            ALTER TABLE eam_platform ADD CONSTRAINT eam_platform_name_key UNIQUE (name)
          </statement>
          <statement>
            ALTER TABLE eam_platform ADD CONSTRAINT fkfed285c1559691a3 FOREIGN KEY (agent_id) REFERENCES eam_agent(id) ON DELETE CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_platform ADD CONSTRAINT fkfed285c162b21414 FOREIGN KEY (config_response_id) REFERENCES eam_config_response(id)
          </statement>
          <statement>
            ALTER TABLE eam_platform ADD CONSTRAINT fkfed285c1e3e1026d FOREIGN KEY (platform_type_id) REFERENCES eam_platform_type(id) ON DELETE CASCADE
          </statement>
          <statement desc="Create new virtual platforms view.">
          CREATE VIEW EAM_VIRT_PLAT_VIEW AS
          SELECT 
            p.*, v.RESOURCE_ID, PROCESS_ID, PHYSICAL_ID
          FROM 
             EAM_PLATFORM p, EAM_RESOURCE r, EAM_RESOURCE_TYPE rt,
             EAM_VIRTUAL v
          WHERE rt.name = 'covalentEAMPlatform' AND
                r.resource_type_id = rt.id AND
                r.instance_id = p.id AND
                r.id = v.resource_id
          </statement>
         </schema-directSQL>
        <schema-addColumn table="EAM_PLATFORM_SERVER_TYPE_MAP"
                          column="PLATFORM_TYPE_ID" columnType="INTEGER">
          <initializer>
            UPDATE EAM_PLATFORM_SERVER_TYPE_MAP SET PLATFORM_TYPE_ID=PLATFORM_TYPE_ID_ORIG
          </initializer>
        </schema-addColumn>
        <schema-addColumn table="EAM_PLATFORM_SERVER_TYPE_MAP"
                          column="SERVER_TYPE_ID" columnType="INTEGER">
          <initializer>
            UPDATE EAM_PLATFORM_SERVER_TYPE_MAP SET SERVER_TYPE_ID=SERVER_TYPE_ID_ORIG
          </initializer>
        </schema-addColumn>
        <schema-alterColumn table="EAM_PLATFORM_SERVER_TYPE_MAP"
                            column="PLATFORM_TYPE_ID" nullable="NOT NULL"/>
        <schema-alterColumn table="EAM_PLATFORM_SERVER_TYPE_MAP"
                            column="SERVER_TYPE_ID" nullable="NOT NULL"/>
        <schema-directSQL>
            <statement>
                ALTER TABLE eam_platform_server_type_map DROP COLUMN platform_type_id_orig
            </statement>
            <statement>
                ALTER TABLE eam_platform_server_type_map DROP COLUMN server_type_id_orig
            </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_platform_server_type_map ADD CONSTRAINT eam_platform_server_type_map_pkey PRIMARY KEY (server_type_id, platform_type_id)
          </statement>
          <statement targetDB="oracle">
            ALTER TABLE eam_platform_server_type_map ADD CONSTRAINT SYS_C00203179 PRIMARY KEY (server_type_id, platform_type_id)
          </statement>
          <statement>
            ALTER TABLE eam_platform_server_type_map ADD CONSTRAINT fk4be3f5b539b1d30d FOREIGN KEY (server_type_id) REFERENCES eam_server_type(id)
          </statement>
          <statement>
            ALTER TABLE eam_platform_server_type_map ADD CONSTRAINT fk4be3f5b5e3e1026d FOREIGN KEY (platform_type_id) REFERENCES eam_platform_type(id)
          </statement>
         </schema-directSQL>
         <schema-addColumn table="EAM_REGISTERED_TRIGGER"
                           column="ALERT_DEFINITION_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_REGISTERED_TRIGGER SET ALERT_DEFINITION_ID=ALERT_DEFINITION_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-directSQL>
          <statement>
             ALTER TABLE eam_registered_trigger DROP COLUMN alert_definition_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_registered_trigger ADD CONSTRAINT fk4a8354a9b5af9d12 FOREIGN KEY (alert_definition_id) REFERENCES eam_alert_definition(id) ON DELETE CASCADE
          </statement>
             <statement>
               ALTER TABLE eam_res_grp_res_map DROP CONSTRAINT eam_res_group_res_mapping_key CASCADE
             </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_res_grp_res_map DROP CONSTRAINT "eam_res_grp_res_map_resource_group_id_fkey" CASCADE
             </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_res_grp_res_map DROP CONSTRAINT "eam_res_grp_res_map_resource_id_fkey" CASCADE
             </statement>
          <statement>
            ALTER TABLE eam_res_grp_res_map ADD CONSTRAINT eam_res_grp_res_map_pkey PRIMARY KEY (resource_group_id, resource_id)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_res_grp_res_map ADD CONSTRAINT fk1c835366da1b7c9 FOREIGN KEY (resource_group_id) REFERENCES eam_resource_group(id)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_res_grp_res_map ADD CONSTRAINT fk1c83536fc176ae FOREIGN KEY (resource_id) REFERENCES eam_resource(id)
          </statement>
         </schema-directSQL>
         <schema-addColumn table="EAM_RESOURCE_GROUP"
                           column="RESOURCE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_RESOURCE_GROUP SET RESOURCE_ID=RESOURCE_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-directSQL>
                <statement>
                  ALTER TABLE eam_resource_group DROP COLUMN resource_id_orig
                </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX eam_res_group_name_idx ON eam_resource_group USING btree (name)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX eam_res_group_name_idx ON eam_resource_group (name)
                </statement>
         </schema-directSQL>
         <schema-addColumn table="EAM_ROLE"
                           column="RESOURCE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_ROLE SET RESOURCE_ID=RESOURCE_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-directSQL>
          <statement>
            ALTER TABLE eam_role DROP COLUMN resource_id_orig
          </statement>
          <statement>
             ALTER TABLE eam_role ADD CONSTRAINT eam_role_name_key UNIQUE (name)
          </statement>
          <statement>
            ALTER TABLE eam_role ADD CONSTRAINT fkf6ec7cc4fc176ae FOREIGN KEY (resource_id) REFERENCES eam_resource(id)
          </statement>
             <statement>
               ALTER TABLE eam_role_operation_map DROP CONSTRAINT eam_role_operation_map_key CASCADE
             </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_role_operation_map DROP CONSTRAINT "eam_role_operation_map_operation_id_fkey" CASCADE
             </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_role_operation_map DROP CONSTRAINT "eam_role_operation_map_role_id_fkey" CASCADE
             </statement>
          <statement>
            ALTER TABLE eam_role_operation_map ADD CONSTRAINT eam_role_operation_map_pkey PRIMARY KEY (role_id, operation_id)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_role_operation_map ADD CONSTRAINT fkdfbea0999d737ae FOREIGN KEY (role_id) REFERENCES eam_role(id)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_role_operation_map ADD CONSTRAINT fkdfbea09c848f326 FOREIGN KEY (operation_id) REFERENCES eam_operation(id)
          </statement>
             <statement>
               ALTER TABLE eam_role_resource_group_map DROP CONSTRAINT eam_role_res_group_map_key CASCADE
             </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_role_resource_group_map DROP CONSTRAINT "eam_role_resource_group_map_resource_group_id_fkey" CASCADE
             </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_role_resource_group_map DROP CONSTRAINT "eam_role_resource_group_map_role_id_fkey" CASCADE
             </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_role_resource_group_map ADD CONSTRAINT eam_role_resource_group_map_pkey PRIMARY KEY (resource_group_id, role_id)
          </statement>
          <statement targetDB="oracle">
            ALTER TABLE eam_role_resource_group_map ADD CONSTRAINT SYS_C00252317 PRIMARY KEY (resource_group_id, role_id)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_role_resource_group_map ADD CONSTRAINT fk7d6efc66da1b7c9 FOREIGN KEY (resource_group_id) REFERENCES eam_resource_group(id)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_role_resource_group_map ADD CONSTRAINT fk7d6efc699d737ae FOREIGN KEY (role_id) REFERENCES eam_role(id)
          </statement>
         </schema-directSQL>
         <schema-addColumn table="EAM_SERVER"
                           column="CONFIG_RESPONSE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_SERVER SET CONFIG_RESPONSE_ID=CONFIG_RESPONSE_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-addColumn table="EAM_SERVER"
                           column="PLATFORM_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_SERVER SET PLATFORM_ID=PLATFORM_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-addColumn table="EAM_SERVER"
                           column="SERVER_TYPE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_SERVER SET SERVER_TYPE_ID=SERVER_TYPE_ID_ORIG
           </initializer>
         </schema-addColumn>
        <schema-alterColumn table="EAM_SERVER"
                            column="SERVER_TYPE_ID" nullable="NOT NULL"/>
         <schema-directSQL>
                <statement targetDB="postgresql">
                  CREATE INDEX eam_server_name_idx ON eam_server USING btree (name)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX eam_server_name_idx ON eam_server (name)
                </statement>
          <statement>
            ALTER TABLE eam_server DROP COLUMN config_response_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_server DROP COLUMN platform_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_server DROP COLUMN server_type_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_server ADD CONSTRAINT eam_server_platform_id_key UNIQUE (platform_id, autoinventoryidentifier)
          </statement>
          <statement>
            ALTER TABLE eam_server ADD CONSTRAINT fkeeeb4c1139b1d30d FOREIGN KEY (server_type_id) REFERENCES eam_server_type(id) ON DELETE CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_server ADD CONSTRAINT fkeeeb4c1162b21414 FOREIGN KEY (config_response_id) REFERENCES eam_config_response(id)
          </statement>
          <statement>
            ALTER TABLE eam_server ADD CONSTRAINT fkeeeb4c116796aa86 FOREIGN KEY (platform_id) REFERENCES eam_platform(id) ON DELETE CASCADE
          </statement>
          <statement targetDB="postgresql">
            CREATE INDEX eam_server_platform_idx ON eam_server USING btree (platform_id)
          </statement>
          <statement targetDB="oracle">
            CREATE INDEX eam_server_platform_idx ON eam_server (platform_id)
          </statement>
          <statement desc="Create new virtual servers view.">
          CREATE VIEW EAM_VIRT_SVR_VIEW AS
          SELECT 
            s.*, v.RESOURCE_ID, PROCESS_ID, PHYSICAL_ID
          FROM 
             EAM_SERVER s, EAM_RESOURCE r, EAM_RESOURCE_TYPE rt,
             EAM_VIRTUAL v
          WHERE rt.name = 'covalentEAMServer' AND
                r.resource_type_id = rt.id AND
                r.instance_id = s.id AND
                r.id = v.resource_id
          </statement>
        </schema-directSQL>
         <schema-addColumn table="EAM_SERVICE"
                           column="CONFIG_RESPONSE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_SERVICE SET CONFIG_RESPONSE_ID=CONFIG_RESPONSE_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-addColumn table="EAM_SERVICE"
                           column="SERVER_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_SERVICE SET SERVER_ID=SERVER_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-addColumn table="EAM_SERVICE"
                           column="SERVICE_TYPE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_SERVICE SET SERVICE_TYPE_ID=SERVICE_TYPE_ID_ORIG
           </initializer>
         </schema-addColumn>
        <schema-alterColumn table="EAM_SERVICE"
                            column="SERVICE_TYPE_ID" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_SERVICE"
                           column="SVC_CLUSTER_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_SERVICE SET SVC_CLUSTER_ID=SVC_CLUSTER_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-directSQL>
                <statement targetDB="postgresql">
                  CREATE INDEX eam_service_name_idx ON eam_service USING btree (name)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX eam_service_name_idx ON eam_service (name)
                </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX eam_service_server_idx ON eam_service USING btree (server_id)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX eam_service_server_idx ON eam_service (server_id)
                </statement>
          <statement>
            ALTER TABLE eam_service DROP COLUMN config_response_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_service DROP COLUMN server_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_service DROP COLUMN service_type_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_service DROP COLUMN svc_cluster_id_orig
          </statement>
          <statement>
             ALTER TABLE eam_service ADD CONSTRAINT eam_service_id_key UNIQUE (id, parent_service_id)
          </statement>
          <statement>
            ALTER TABLE eam_service ADD CONSTRAINT fkee7e438762b21414 FOREIGN KEY (config_response_id) REFERENCES eam_config_response(id)
          </statement>
          <statement>
            UPDATE eam_service SET parent_service_id = NULL WHERE parent_service_id = 0
          </statement>
          <statement>
            ALTER TABLE eam_service ADD CONSTRAINT fkee7e438784174123 FOREIGN KEY (parent_service_id) REFERENCES eam_service(id)
          </statement>
          <statement>
            ALTER TABLE eam_service ADD CONSTRAINT fkee7e4387a14c9e5b FOREIGN KEY (svc_cluster_id) REFERENCES eam_svc_cluster(id) ON DELETE CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_service ADD CONSTRAINT fkee7e4387b648cf19 FOREIGN KEY (service_type_id) REFERENCES eam_service_type(id) ON DELETE CASCADE
          </statement>
          <statement>
            ALTER TABLE eam_service ADD CONSTRAINT fkee7e4387ea5ff386 FOREIGN KEY (server_id) REFERENCES eam_server(id) ON DELETE CASCADE
          </statement>
          <statement desc="Create new virtual services view.">
          CREATE VIEW EAM_VIRT_SVC_VIEW AS
          SELECT 
            s.*, v.RESOURCE_ID, PROCESS_ID, PHYSICAL_ID
          FROM 
             EAM_SERVICE s, EAM_RESOURCE r, EAM_RESOURCE_TYPE rt,
             EAM_VIRTUAL v
          WHERE rt.name = 'covalentEAMService' AND
                r.resource_type_id = rt.id AND
                r.instance_id = s.id AND
                r.id = v.resource_id
          </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_service_dep_map DROP CONSTRAINT "eam_service_dep_map_appservice_id_fkey" CASCADE
             </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_service_dep_map DROP CONSTRAINT "eam_service_dep_map_dependent_service_id_fkey" CASCADE
             </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_service_dep_map ADD CONSTRAINT fkbdab4434642e0910 FOREIGN KEY (dependent_service_id) REFERENCES eam_app_service(id)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_service_dep_map ADD CONSTRAINT fkbdab443476c4c8b1 FOREIGN KEY (appservice_id) REFERENCES eam_app_service(id) ON DELETE CASCADE
          </statement>
             <statement>
               ALTER TABLE EAM_SERVICE_TYPE DROP COLUMN tier_type_id
             </statement>
         </schema-directSQL>
         <schema-alterColumn table="EAM_SERVICE_TYPE"
                             column="NAME" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_SERVICE_TYPE"
                           column="SERVER_TYPE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_SERVICE_TYPE SET SERVER_TYPE_ID=SERVER_TYPE_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-addColumn table="EAM_SUBJECT"
                           column="RESOURCE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_SUBJECT SET RESOURCE_ID=RESOURCE_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-addColumn table="EAM_SVC_CLUSTER"
                           column="SERVICE_TYPE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_SVC_CLUSTER SET SERVICE_TYPE_ID=SERVICE_TYPE_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-directSQL>
          <statement>
            ALTER TABLE eam_service_type DROP COLUMN server_type_id_orig
          </statement>
          <statement>
            ALTER TABLE eam_service_type ADD CONSTRAINT fkb0b418f239b1d30d FOREIGN KEY (server_type_id) REFERENCES eam_server_type(id) ON DELETE CASCADE
          </statement>
             <statement>
               ALTER TABLE eam_srn DROP CONSTRAINT measurement_srn_res_id CASCADE
             </statement>
          <statement>
            ALTER TABLE eam_srn ADD CONSTRAINT eam_srn_pkey PRIMARY KEY (appdef_type, instance_id)
          </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX eam_subject_resource_idx ON eam_subject USING btree (resource_id)
                </statement>          
                <statement targetDB="oracle">
                  CREATE INDEX eam_subject_resource_idx ON eam_subject (resource_id)
                </statement>          
          <statement>
            ALTER TABLE eam_subject DROP COLUMN resource_id_orig
          </statement>
          <statement>
             ALTER TABLE eam_subject ADD CONSTRAINT eam_subject_name_key UNIQUE (name, dsn)
          </statement>
          <statement>
            ALTER TABLE eam_subject ADD CONSTRAINT fk8e4d1fefc176ae FOREIGN KEY (resource_id) REFERENCES eam_resource(id)
          </statement>
             <statement>
               ALTER TABLE eam_subject_role_map DROP CONSTRAINT eam_subject_role_mapping_key CASCADE
             </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_subject_role_map DROP CONSTRAINT "eam_subject_role_map_role_id_fkey" CASCADE
             </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_subject_role_map DROP CONSTRAINT "eam_subject_role_map_subject_id_fkey" CASCADE
             </statement>
          <statement>
            ALTER TABLE eam_subject_role_map ADD CONSTRAINT eam_subject_role_map_pkey PRIMARY KEY (subject_id, role_id)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_subject_role_map ADD CONSTRAINT fk320f631499d737ae FOREIGN KEY (role_id) REFERENCES eam_role(id)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_subject_role_map ADD CONSTRAINT fk320f6314e82fbc FOREIGN KEY (subject_id) REFERENCES eam_subject(id)
          </statement>
          <statement>
             ALTER TABLE eam_svc_cluster DROP COLUMN SERVICE_TYPE_ID_ORIG
          </statement>
          <statement>
            ALTER TABLE eam_svc_cluster ADD CONSTRAINT fk39da6ecdb648cf19 FOREIGN KEY (service_type_id) REFERENCES eam_service_type(id) ON DELETE CASCADE
          </statement>
         </schema-directSQL>
         <schema-addColumn table="EAM_TRIGGER_EVENT"
                           column="EVENT_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_TRIGGER_EVENT SET EVENT_ID=EVENT_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-directSQL>
          <statement>
             ALTER TABLE eam_trigger_event DROP COLUMN EVENT_ID_ORIG
          </statement>
          <statement>
            ALTER TABLE eam_trigger_event ADD CONSTRAINT eam_trigger_event_pkey PRIMARY KEY (trigger_id, event_id)
          </statement>
          <statement>
            ALTER TABLE eam_trigger_event ADD CONSTRAINT fk82152085cb2c7199 FOREIGN KEY (event_id) REFERENCES eam_event(id) ON DELETE CASCADE
          </statement>
             <statement>
               DROP TABLE eam_user_alert
             </statement>          
          <statement>
            DROP SEQUENCE eam_user_alert_id_seq
          </statement>          
            <statement>
              ALTER TABLE eam_stat_errors DROP CONSTRAINT rt_errs_fk_rstat CASCADE
            </statement>            
         </schema-directSQL>
         <schema-addColumn table="EAM_STAT_ERRORS"
                           column="ERROR_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_STAT_ERRORS SET ERROR_ID=ERROR_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-addColumn table="EAM_STAT_ERRORS"
                           column="REQSTAT_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_STAT_ERRORS SET REQSTAT_ID=REQSTAT_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-directSQL>
          <statement>
             ALTER TABLE eam_stat_errors DROP COLUMN ERROR_ID_ORIG
          </statement>
          <statement>
             ALTER TABLE eam_stat_errors DROP COLUMN REQSTAT_ID_ORIG
          </statement>
          <statement>
            ALTER TABLE eam_stat_errors
                  ADD CONSTRAINT fk6f2383a828d8858d FOREIGN KEY (reqstat_id) 
                      REFERENCES eam_request_stat(id) ON DELETE CASCADE
          </statement>
          <statement>
              ALTER TABLE eam_stat_errors
                  ADD CONSTRAINT fk6f2383a8b931cec9 FOREIGN KEY (error_id) 
                      REFERENCES eam_error_code(id) ON DELETE CASCADE
          </statement>
          <statement>
            DROP TABLE eam_tier_type
          </statement>          
          <statement>
            DROP SEQUENCE eam_tier_type_id_seq
          </statement>          
           <statement>
             ALTER TABLE EAM_USER_CONFIG_RESP DROP COLUMN subject_id
           </statement>            
           <statement>
             ALTER TABLE eam_user_config_resp
                ADD CONSTRAINT fk622ab78723193fc9 FOREIGN KEY (id) 
                REFERENCES eam_subject(id)  ON DELETE CASCADE
           </statement>
          <statement>
             DROP SEQUENCE eam_user_config_resp_id_seq
          </statement>          
        </schema-directSQL>
        <schema-addColumn table="EAM_AGENT"
                          column="AGENT_TYPE_ID" columnType="INTEGER">
           <initializer>
             UPDATE EAM_AGENT SET AGENT_TYPE_ID=AGENT_TYPE_ID_ORIG
           </initializer>
         </schema-addColumn>
         <schema-alterColumn table="EAM_PLATFORM_TYPE"
                             column="NAME" nullable="NOT NULL"/>
         <schema-addColumn table="EAM_ALERT_DEFINITION"
                          column="ESCALATION_ID" columnType="INTEGER"/>
         <schema-insert table="EAM_ALERT_DEFINITION"
                        insertCmd="(id, version_col, name, ctime, mtime, priority, appdef_id, appdef_type, enabled, frequency_type, will_recover, notify_filtered, control_filtered, deleted) VALUES (0, 0, 'Resource Type Alerts', 0, 0, 0, 0, 0, %%FALSE%%, 0, %%FALSE%%, %%FALSE%%, %%FALSE%%, %%FALSE%%)"/>
        <schema-directSQL>
          <statement>
              drop index agent_address_port
          </statement>
          <statement>
              drop index agent_token_unique
          </statement>
          <statement>
              alter table eam_agent drop column agent_type_id_orig
          </statement>
          <statement>
              alter table eam_agent add constraint fke5afd057ccbe6e 
                    FOREIGN KEY (agent_type_id) REFERENCES eam_agent_type(id) 
                    ON DELETE CASCADE
          </statement>
            <statement>
                ALTER TABLE eam_agent 
                    ADD CONSTRAINT eam_agent_address_key UNIQUE (address, port)
            </statement>
            <statement>
                ALTER TABLE eam_agent 
                    ADD CONSTRAINT eam_agent_agenttoken_key UNIQUE (agenttoken)
            </statement>
            <statement targetDB="postgresql">
                drop index service_request_svcid_url
            </statement>
            <statement targetDB="postgresql">
                alter table eam_service_request
                      add constraint eam_service_request_serviceid_key
                          unique (serviceid, url)
            </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX service_request_svcid ON eam_service_request
                         USING btree (serviceid)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX service_request_svcid ON eam_service_request (serviceid)
                </statement>
             <statement>
                 ALTER TABLE eam_aiq_ip
                       ADD CONSTRAINT eam_aiq_ip_aiq_platform_id_key 
                       UNIQUE (aiq_platform_id, address)
             </statement>
             <statement>
                 ALTER TABLE eam_aiq_ip
                       ADD CONSTRAINT fkd06c1ccb1bff8500 
                       FOREIGN KEY (aiq_platform_id) 
                       REFERENCES eam_aiq_platform(id) ON DELETE CASCADE
             </statement>
            <statement>
                ALTER TABLE eam_aiq_platform
                    ADD CONSTRAINT eam_aiq_platform_certdn_key UNIQUE (certdn)
            </statement>
            <statement>
                ALTER TABLE eam_aiq_platform
                    ADD CONSTRAINT eam_aiq_platform_fqdn_key UNIQUE (fqdn)
            </statement>
            <statement>
                ALTER TABLE eam_aiq_platform
                    ADD CONSTRAINT eam_aiq_platform_name_key UNIQUE (name)
            </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX alert_def_child_idx ON eam_alert_definition USING btree (parent_id, priority)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX alert_def_child_idx ON eam_alert_definition (parent_id, priority)
                </statement>
          <statement>
            UPDATE eam_alert_definition SET act_on_trigger_id = NULL WHERE act_on_trigger_id = 0
          </statement>
          <statement>
            UPDATE eam_alert_definition SET act_on_trigger_id = NULL WHERE act_on_trigger_id NOT IN (SELECT id FROM eam_registered_trigger)
          </statement>
          <statement>
            UPDATE eam_alert_definition SET parent_id = NULL WHERE parent_id NOT IN (SELECT id FROM eam_alert_definition)
          </statement>
          <statement>
            ALTER TABLE eam_alert_definition ADD CONSTRAINT fk975407845bc79aea FOREIGN KEY (act_on_trigger_id) REFERENCES eam_registered_trigger(id)
          </statement>
          <statement>
            ALTER TABLE eam_alert_definition ADD CONSTRAINT fk97540784cb32abfe FOREIGN KEY (parent_id) REFERENCES eam_alert_definition(id) ON DELETE CASCADE
          </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX ai_hist_scanname_idx ON eam_autoinv_history USING btree (scanname)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX ai_hist_scanname_idx ON eam_autoinv_history (scanname)
                </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX ai_schedule_entity_idx ON eam_autoinv_schedule USING btree (entity_type, entity_id)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX ai_schedule_entity_idx ON eam_autoinv_schedule (entity_type, entity_id)
                </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX ai_schedule_nextfiretime_idx ON eam_autoinv_schedule USING btree (nextfiretime)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX ai_schedule_nextfiretime_idx ON eam_autoinv_schedule (nextfiretime)
                </statement>
          <statement targetDB="postgresql">
             ALTER TABLE eam_autoinv_schedule ADD CONSTRAINT eam_autoinv_schedule_jobname_key UNIQUE (jobname)
          </statement>
          <statement targetDB="oracle">
             ALTER TABLE eam_autoinv_schedule ADD CONSTRAINT SYS_C10104128 UNIQUE (jobname)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_autoinv_schedule ADD CONSTRAINT eam_autoinv_schedule_scanname_key UNIQUE (scanname)
          </statement>
          <statement targetDB="oracle">
            ALTER TABLE eam_autoinv_schedule ADD CONSTRAINT SYS_C10104129 UNIQUE (scanname)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_autoinv_schedule ADD CONSTRAINT eam_autoinv_schedule_triggername_key UNIQUE (triggername)
          </statement>
          <statement targetDB="oracle">
            ALTER TABLE eam_autoinv_schedule ADD CONSTRAINT SYS_C10104130 UNIQUE (triggername)
          </statement>
          <statement>
            ALTER TABLE eam_config_props ADD CONSTRAINT eam_config_props_prefix_key UNIQUE (prefix, propkey)
          </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX cresp_err_idx ON eam_config_response USING btree (validationerr)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX cresp_err_idx ON eam_config_response (validationerr)
                </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX ctl_schedule_entity_idx ON eam_control_schedule USING btree (entity_type, entity_id)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX ctl_schedule_entity_idx ON eam_control_schedule (entity_type, entity_id)
                </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX ctl_schedule_jobname_idx ON eam_control_schedule USING btree (jobname)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX ctl_schedule_jobname_idx ON eam_control_schedule (jobname)
                </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX ctl_schedule_nextfiretime_idx ON eam_control_schedule USING btree (nextfiretime)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX ctl_schedule_nextfiretime_idx ON eam_control_schedule (nextfiretime)
                </statement>
          <statement targetDB="postgresql" desc="drop default value constraint on eam_cprop">
              alter table eam_cprop alter column id drop default
          </statement>
          <statement targetDB="oracle" desc="drop default value constraint on eam_cprop">
              alter table eam_cprop modify id default NULL
          </statement>
          <statement>
             ALTER TABLE eam_cprop ADD CONSTRAINT eam_cprop_keyid_key UNIQUE (keyid, appdef_id, value_idx)
          </statement>
          <statement>
            ALTER TABLE eam_cprop_key
               ADD CONSTRAINT eam_cprop_key_appdef_type_key UNIQUE 
                    (appdef_type, appdef_typeid, propkey)
          </statement>
          <statement>
            ALTER TABLE eam_cprop ADD CONSTRAINT fke5d047984eaeab4a FOREIGN KEY (keyid) REFERENCES eam_cprop_key(id) ON DELETE CASCADE
          </statement>
          <statement>
            DELETE FROM  eam_measurement_bl WHERE measurement_id NOT IN (SELECT id FROM eam_measurement)
          </statement>
          <statement>
            ALTER TABLE eam_measurement_bl ADD CONSTRAINT fk1877029bae18683b FOREIGN KEY (measurement_id) REFERENCES eam_measurement(id)
          </statement>
          <statement>
             ALTER TABLE eam_measurement_cat ADD CONSTRAINT eam_measurement_cat_name_key UNIQUE (name)
          </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX metric_prob_id_idx ON eam_metric_prob USING btree (measurement_id)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX metric_prob_id_idx ON eam_metric_prob (measurement_id)
                </statement>
          <statement>
            UPDATE eam_metric_prob SET additional = 0 WHERE additional IS NULL
          </statement>
          <statement>
            DELETE FROM  eam_metric_prob WHERE measurement_id IN (SELECT measurement_id FROM (SELECT measurement_id, timestamp, count(*) AS count FROM  eam_metric_prob WHERE additional = 0 GROUP BY measurement_id, timestamp) p WHERE count > 1)
          </statement>
          <statement>
            ALTER TABLE eam_metric_prob ADD CONSTRAINT eam_metric_prob_pkey PRIMARY KEY (measurement_id, timestamp, additional)
          </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX mtype_idx_appdeftype_idx ON eam_monitorable_type USING btree (appdef_type)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX mtype_idx_appdeftype_idx ON eam_monitorable_type (appdef_type)
                </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX type_name_idx ON eam_monitorable_type USING btree (name)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX type_name_idx ON eam_monitorable_type (name)
                </statement>
          <statement>
             ALTER TABLE eam_plugin ADD CONSTRAINT eam_plugin_name_key UNIQUE (name)
          </statement>
          <statement>
            ALTER TABLE eam_principal ADD CONSTRAINT eam_principal_principal_key UNIQUE (principal)
          </statement>
          <statement>
             ALTER TABLE eam_server_type ADD CONSTRAINT eam_server_type_name_key UNIQUE (name)
          </statement>
          <statement>
            ALTER TABLE eam_virtual ADD CONSTRAINT fk94039bddfc176ae FOREIGN KEY (resource_id) REFERENCES eam_resource(id) ON DELETE CASCADE
          </statement>          
          <statement targetDB="postgresql" desc="drop default value constraint on eam_cprop">
              alter table eam_cprop alter column id drop default
          </statement>
          <statement targetDB="oracle" desc="drop default value constraint on eam_cprop">
              alter table eam_cprop modify id default NULL
          </statement>
          <statement desc="drop default value constraint on eam_fired_trigger"
                     targetDB="postgresql">
              alter table eam_fired_trigger alter column id drop default
          </statement>
          <statement desc="drop default value constraint on eam_fired_trigger"
                     targetDB="oracle">
              alter table eam_fired_trigger modify id default NULL
          </statement>
          <statement>
            ALTER TABLE eam_alert_action_log ADD CONSTRAINT fk423fa3ccc7d09794 FOREIGN KEY (galert_id) REFERENCES eam_galert_logs(id)
          </statement>
          <statement>
            ALTER TABLE eam_alert_definition ADD CONSTRAINT fk975407845029efd7 FOREIGN KEY (escalation_id) REFERENCES eam_escalation(id)
          </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX ctl_history_starttime_idx ON eam_control_history USING btree (starttime)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX ctl_history_starttime_idx ON eam_control_history (starttime)
                </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX crispo_idx ON eam_crispo_opt USING btree (crispo_id)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX crispo_idx ON eam_crispo_opt (crispo_id)
                </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX eam_fired_trigger_idx ON eam_fired_trigger USING btree (trigger_id)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX eam_fired_trigger_idx ON eam_fired_trigger (trigger_id)
                </statement>
                <statement targetDB="postgresql">
                  CREATE INDEX state_idx ON eam_mescalation_state USING btree (alert_type, alert_def_id)
                </statement>
                <statement targetDB="oracle">
                  CREATE INDEX state_idx ON eam_mescalation_state (alert_type, alert_def_id)
                </statement>
          <statement targetDB="postgresql">
             ALTER TABLE eam_control_schedule ADD CONSTRAINT eam_control_schedule_jobname_key UNIQUE (jobname)
          </statement>
          <statement targetDB="oracle">
             ALTER TABLE eam_control_schedule ADD CONSTRAINT SYS_C10104162 UNIQUE (jobname)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_control_schedule ADD CONSTRAINT eam_control_schedule_triggername_key UNIQUE (triggername)
          </statement>
          <statement targetDB="oracle">
            ALTER TABLE eam_control_schedule ADD CONSTRAINT SYS_C10104163 UNIQUE (triggername)
          </statement>
          <statement>
            ALTER TABLE eam_crispo_opt ADD CONSTRAINT fkc161913a6364efcd FOREIGN KEY (crispo_id) REFERENCES eam_crispo(id)
          </statement>
          <statement>
            ALTER TABLE eam_escalation ADD CONSTRAINT eam_escalation_name_key UNIQUE (name)
          </statement>
          <statement>
              ALTER TABLE eam_escalation_action ADD CONSTRAINT eam_escalation_action_pkey PRIMARY KEY (escalation_id, idx)
          </statement>
          <statement>
             ALTER TABLE eam_exec_strategies ADD CONSTRAINT eam_exec_strategies_pkey PRIMARY KEY (id)
          </statement>
          <statement>
              ALTER TABLE eam_gtrigger_types ADD CONSTRAINT eam_gtrigger_types_pkey PRIMARY KEY (id)
          </statement>
          <statement>
            ALTER TABLE eam_escalation_action ADD CONSTRAINT fk846de1925029efd7 FOREIGN KEY (escalation_id) REFERENCES eam_escalation(id)
          </statement>
          <statement>
            ALTER TABLE eam_escalation_action ADD CONSTRAINT fk846de1929c76c3bb FOREIGN KEY (action_id) REFERENCES eam_action(id)
          </statement>
          <statement>
            ALTER TABLE eam_exec_strategies ADD CONSTRAINT fkdc5c7eb11dab49e3 FOREIGN KEY (config_id) REFERENCES eam_crispo(id)
          </statement>
          <statement>
            ALTER TABLE eam_exec_strategies ADD CONSTRAINT fkdc5c7eb127e934b3 FOREIGN KEY (type_id) REFERENCES eam_exec_strategy_types(id)
          </statement>
          <statement>
            ALTER TABLE eam_exec_strategies ADD CONSTRAINT fkdc5c7eb1706267a5 FOREIGN KEY (def_id) REFERENCES eam_galert_defs(id)
          </statement>
          <statement>
            ALTER TABLE eam_galert_defs ADD CONSTRAINT fk64f3daa5029efd7 FOREIGN KEY (escalation_id) REFERENCES eam_escalation(id)
          </statement>
          <statement>
            ALTER TABLE eam_galert_defs ADD CONSTRAINT fk64f3daacce79ab8 FOREIGN KEY (group_id) REFERENCES eam_resource_group(id)
          </statement>
          <statement>
            ALTER TABLE eam_galert_logs ADD CONSTRAINT fk653064b706267a5 FOREIGN KEY (def_id) REFERENCES eam_galert_defs(id)
          </statement>
          <statement>
            ALTER TABLE eam_gtriggers ADD CONSTRAINT eam_gtriggers_pkey PRIMARY KEY (id)
          </statement>
          <statement>
            ALTER TABLE eam_gtriggers ADD CONSTRAINT fk54ae97741dab49e3 FOREIGN KEY (config_id) REFERENCES eam_crispo(id)
          </statement>
          <statement>
            ALTER TABLE eam_gtriggers ADD CONSTRAINT fk54ae97747d9b78af FOREIGN KEY (strat_id) REFERENCES eam_exec_strategies(id)
          </statement>
          <statement>
            ALTER TABLE eam_gtriggers ADD CONSTRAINT fk54ae9774ce0ff839 FOREIGN KEY (type_id) REFERENCES eam_gtrigger_types(id)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_mescalation_state ADD CONSTRAINT eam_mescalation_state_escalation_id_key UNIQUE (escalation_id, alert_type, alert_def_id, alert_id)
          </statement>
          <statement targetDB="oracle">
            ALTER TABLE eam_mescalation_state ADD CONSTRAINT SYS_C10104263 UNIQUE (escalation_id, alert_type, alert_def_id, alert_id)
          </statement>
          <statement>
            ALTER TABLE eam_mescalation_state ADD CONSTRAINT eam_mescalation_state_pkey PRIMARY KEY (id)
          </statement>
          <statement>
            ALTER TABLE eam_mescalation_state ADD CONSTRAINT fk3b73b3065029efd7 FOREIGN KEY (escalation_id) REFERENCES eam_escalation(id)
          </statement>
          <statement>
            ALTER TABLE eam_mescalation_state ADD CONSTRAINT fk3b73b3068c8d4d5c FOREIGN KEY (acknowledged_by) REFERENCES eam_subject(id)
          </statement>
          <statement>
             ALTER TABLE eam_resource_group ADD CONSTRAINT eam_resource_group_name_key UNIQUE (name)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_resource_group ADD CONSTRAINT eam_resource_group_resource_id_key UNIQUE (resource_id)
          </statement>
          <statement targetDB="oracle">
            ALTER TABLE eam_resource_group ADD CONSTRAINT SYS_C10104437 UNIQUE (resource_id)
          </statement>
          <statement>
            ALTER TABLE eam_resource_group ADD CONSTRAINT fk6dbccdbcfc176ae FOREIGN KEY (resource_id) REFERENCES eam_resource(id)
          </statement>
          <statement>
             ALTER TABLE eam_resource_type ADD CONSTRAINT eam_resource_type_name_key UNIQUE (name)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE eam_resource_type ADD CONSTRAINT eam_resource_type_resource_id_key UNIQUE (resource_id)
          </statement>
          <statement targetDB="oracle">
            ALTER TABLE eam_resource_type ADD CONSTRAINT SYS_C10104443 UNIQUE (resource_id)
          </statement>
          <statement>
            ALTER TABLE eam_resource_type ADD CONSTRAINT fkd203d83dfc176ae FOREIGN KEY (resource_id) REFERENCES eam_resource(id)
          </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_qrtz_blob_triggers DROP CONSTRAINT "eam_pk_qrtz_blob_triggers" CASCADE
             </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_qrtz_blob_triggers DROP CONSTRAINT "eam_fk_qbt_qt" CASCADE
             </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_qrtz_cron_triggers DROP CONSTRAINT "eam_pk_qrtz_cron_triggers" CASCADE
             </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_qrtz_cron_triggers DROP CONSTRAINT "eam_fk_qct_qt" CASCADE
             </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_qrtz_job_details DROP CONSTRAINT "eam_pk_qrtz_job_details" CASCADE
             </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_qrtz_job_listeners DROP CONSTRAINT "eam_pk_qrtz_job_listeners" CASCADE
             </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_qrtz_simple_triggers DROP CONSTRAINT "eam_pk_qrtz_simple_triggers" CASCADE
             </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_qrtz_simple_triggers DROP CONSTRAINT "eam_fk_qst_qt" CASCADE
             </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_qrtz_trigger_listeners DROP CONSTRAINT "eam_pk_qrtz_trigger_listeners" CASCADE
             </statement>
             <statement targetDB="postgresql">
               ALTER TABLE eam_qrtz_triggers DROP CONSTRAINT "eam_pk_qrtz_triggers" CASCADE
             </statement>
          <statement targetDB="postgresql">
              ALTER TABLE ONLY eam_qrtz_triggers ADD CONSTRAINT eam_qrtz_triggers_pkey PRIMARY KEY (trigger_name, trigger_group)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE ONLY eam_qrtz_blob_triggers ADD CONSTRAINT eam_qrtz_blob_triggers_pkey PRIMARY KEY (trigger_name, trigger_group)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE ONLY eam_qrtz_blob_triggers ADD CONSTRAINT eam_fk_qbt_qt FOREIGN KEY (trigger_name, trigger_group) REFERENCES eam_qrtz_triggers(trigger_name, trigger_group)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE ONLY eam_qrtz_cron_triggers ADD CONSTRAINT eam_qrtz_cron_triggers_pkey PRIMARY KEY (trigger_name, trigger_group)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE ONLY eam_qrtz_cron_triggers ADD CONSTRAINT eam_fk_qct_qt FOREIGN KEY (trigger_name, trigger_group) REFERENCES eam_qrtz_triggers(trigger_name, trigger_group)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE ONLY eam_qrtz_job_details ADD CONSTRAINT eam_qrtz_job_details_pkey PRIMARY KEY (job_name, job_group)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE ONLY eam_qrtz_job_listeners ADD CONSTRAINT eam_qrtz_job_listeners_pkey PRIMARY KEY (job_name, job_group, job_listener)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE ONLY eam_qrtz_job_listeners ADD CONSTRAINT eam_fk_qjl_qjd FOREIGN KEY (job_name, job_group) REFERENCES eam_qrtz_job_details(job_name, job_group) ON DELETE CASCADE
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE ONLY eam_qrtz_simple_triggers ADD CONSTRAINT eam_qrtz_simple_triggers_pkey PRIMARY KEY (trigger_name, trigger_group)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE ONLY eam_qrtz_simple_triggers ADD CONSTRAINT eam_fk_qst_qt FOREIGN KEY (trigger_name, trigger_group) REFERENCES eam_qrtz_triggers(trigger_name, trigger_group)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE ONLY eam_qrtz_trigger_listeners ADD CONSTRAINT eam_qrtz_trigger_listeners_pkey PRIMARY KEY (trigger_name, trigger_group, trigger_listener)
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE ONLY eam_qrtz_trigger_listeners ADD CONSTRAINT eam_fk_qtl_qt FOREIGN KEY (trigger_name, trigger_group) REFERENCES eam_qrtz_triggers(trigger_name, trigger_group) ON DELETE CASCADE
          </statement>
          <statement targetDB="postgresql">
            ALTER TABLE ONLY eam_qrtz_triggers ADD CONSTRAINT eam_fk_qt_qjd FOREIGN KEY (job_name, job_group) REFERENCES eam_qrtz_job_details(job_name, job_group) ON DELETE CASCADE
          </statement>
          <statement targetDB="postgresql">
              CREATE INDEX measurement_arg_templ_idx ON eam_measurement_arg 
                  USING btree (measurement_template_id)
          </statement>
          <statement targetDB="oracle">
              CREATE INDEX measurement_arg_templ_idx ON eam_measurement_arg 
                  (measurement_template_id)
          </statement>
          <statement targetDB="postgresql">
              CREATE INDEX templ_desig_mt_idx ON eam_measurement_templ 
                  USING btree (designate, monitorable_type_id)
          </statement>
          <statement targetDB="oracle">
              CREATE INDEX templ_desig_mt_idx ON eam_measurement_templ 
                  (designate, monitorable_type_id)
          </statement>
          <statement targetDB="postgresql">
              CREATE INDEX templ_monitorable_type_idx ON eam_measurement_templ 
                  USING btree (monitorable_type_id)
          </statement>
          <statement targetDB="oracle">
              CREATE INDEX templ_monitorable_type_idx ON eam_measurement_templ 
                  (monitorable_type_id)
          </statement>
          <statement targetDB="postgresql">
              CREATE INDEX alert_def_trigger_idx ON eam_registered_trigger 
                  USING btree (alert_definition_id)
          </statement>
          <statement targetDB="oracle">
              CREATE INDEX alert_def_trigger_idx ON eam_registered_trigger 
                  (alert_definition_id)
          </statement>
        </schema-directSQL>
     </schemaSpec>

    <!-- Create escalation permissions -->
    <schemaSpec version="3.02">
      <schema-insert table="EAM_RESOURCE"
                     insertCmd="(ID, VERSION_COL, RESOURCE_TYPE_ID, INSTANCE_ID, CID, SUBJECT_ID, FSYSTEM) VALUES (401, 0, 0, 401, 401, 0, %%TRUE%%)"/>
      <schema-insert table="EAM_RESOURCE_TYPE"
                     insertCmd="(ID, VERSION_COL, NAME, CID, RESOURCE_ID, FSYSTEM) VALUES (401, 0, 'EscalationScheme', 401, 401, %%FALSE%%)"/>
      <schema-insert table="EAM_RES_GRP_RES_MAP"
                     insertCmd="(RESOURCE_GROUP_ID, RESOURCE_ID, CID) VALUES (0, 401, 6)"/>
      <schema-insert table="EAM_OPERATION"
                     insertCmd="(ID, VERSION_COL, NAME, RESOURCE_TYPE_ID, CID) VALUES (412, 0, 'createEscalation', 0, 412)"/>
      <schema-insert table="EAM_OPERATION"
                     insertCmd="(ID, VERSION_COL, NAME, RESOURCE_TYPE_ID, CID) VALUES (413, 0, 'modifyEscalation', 0, 413)"/>
      <schema-insert table="EAM_OPERATION"
                     insertCmd="(ID, VERSION_COL, NAME, RESOURCE_TYPE_ID, CID) VALUES (414, 0, 'removeEscalation', 0, 414)"/>
      <schema-insert table="EAM_OPERATION"
                     insertCmd="(ID, VERSION_COL, NAME, RESOURCE_TYPE_ID, CID) VALUES (415, 0, 'viewEscalation', 0, 415)"/>
      <schema-insert table="EAM_ROLE_OPERATION_MAP"
                     insertCmd="(ROLE_ID, OPERATION_ID, CID) VALUES (0, 412, 68)"/>
      <schema-insert table="EAM_ROLE_OPERATION_MAP"
                     insertCmd="(ROLE_ID, OPERATION_ID, CID) VALUES (0, 413, 69)"/>
      <schema-insert table="EAM_ROLE_OPERATION_MAP"
                     insertCmd="(ROLE_ID, OPERATION_ID, CID) VALUES (0, 414, 70)"/>
      <schema-insert table="EAM_ROLE_OPERATION_MAP"
                     insertCmd="(ROLE_ID, OPERATION_ID, CID) VALUES (0, 415, 71)"/>
    </schemaSpec>

    <schemaSpec version="3.03">
      <schema-directSQL>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='org.hyperic.hq.bizapp.server.trigger.conditional.ControlEventTrigger'
            WHERE CLASSNAME='com.hyperic.hq.bizapp.server.trigger.conditional.ControlEventTrigger'
        </statement>
        <statement>
          UPDATE EAM_REGISTERED_TRIGGER
              SET CLASSNAME='org.hyperic.hq.bizapp.server.trigger.conditional.LogEventTrigger'
            WHERE CLASSNAME='com.hyperic.hq.bizapp.server.trigger.conditional.LogEventTrigger'
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.04">
      <schema-directSQL>
        <statement>
          UPDATE EAM_ALERT SET FIXED=%%TRUE%%
        </statement>
      </schema-directSQL>
      <schema-directSQL>
        <statement>
          UPDATE EAM_GALERT_LOGS SET FIXED=%%TRUE%%
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.05">
      <schema-insert table="EAM_ESCALATION"
                     insertCmd="(ID, VERSION_COL, NAME, DESCRIPTION, ALLOW_PAUSE, MAX_WAIT_TIME, NOTIFY_ALL, CTIME, MTIME) VALUES (100, 0, 'Default Escalation', 'This is an Escalation Scheme created by HQ that performs no actions', %%FALSE%%, 300000, %%FALSE%%, 0, 0)"/>
    </schemaSpec>

    <schemaSpec version="3.06">
      <schema-directSQL>
        <statement>
          alter table EAM_MESCALATION_STATE rename to EAM_ESCALATION_STATE
        </statement>
        <statement targetDB="postgresql">
          alter table EAM_MESCALATION_STATE_ID_SEQ 
                rename to EAM_ESCALATION_STATE_ID_SEQ
        </statement>
        <statement targetDB="oracle">
          rename EAM_MESCALATION_STATE_ID_SEQ to EAM_ESCALATION_STATE_ID_SEQ
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.07">
      <schema-directSQL>
          <statement targetDB="postgresql">
             ALTER TABLE eam_service_dep_map ADD CONSTRAINT eam_service_dep_map_appservice_id_key UNIQUE (appservice_id, dependent_service_id)
          </statement>
          <statement targetDB="oracle">
             ALTER TABLE eam_service_dep_map ADD CONSTRAINT SYS_C10102139 UNIQUE (appservice_id, dependent_service_id)
          </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.08">
      <schema-alterColumn table="EAM_ALERT_ACTION_LOG"
                          column="ALERT_ID" nullable="NULL"/>
      <schema-addColumn table="EAM_ALERT_ACTION_LOG"
                        column="ALERT_TYPE" columnType="LONG">
        <initializer>
          UPDATE EAM_ALERT_ACTION_LOG SET ALERT_TYPE = 195934910
        </initializer>
      </schema-addColumn>
      <schema-alterColumn table="EAM_ALERT_ACTION_LOG"
                          column="ALERT_TYPE" nullable="NOT NULL"/>
    </schemaSpec>

    <!-- Events are no longer compatible, because they've been changed -->
    <schemaSpec version="3.09">
      <schema-directSQL>
        <statement>
          DELETE FROM EAM_TRIGGER_EVENT
        </statement>
        <statement>
          DELETE FROM EAM_EVENT
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <!-- Baselines cannot be null -->
    <schemaSpec version="3.10">
      <schema-directSQL>
        <statement>
          DELETE FROM eam_measurement_bl WHERE mean IS NULL OR min_expected_val IS NULL OR max_expected_val IS NULL
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <!-- Add the timeestamp column to alert_action_log -->
    <schemaSpec version="3.11">
        <schema-addColumn table="EAM_ALERT_ACTION_LOG"
                          column="TIMESTAMP" columnType="LONG">
          <initializer>
              update eam_alert_action_log
                set timestamp = (select ctime from eam_alert a 
                                 where a.id = alert_id) 
                where alert_id is not null
          </initializer>
        </schema-addColumn>
        <schema-directSQL>
          <statement>
            update eam_alert_action_log
              set timestamp = (select timestamp from eam_galert_logs a 
                               where a.id = galert_id) 
              where galert_id is not null
          </statement>
        </schema-directSQL>
        <schema-alterColumn table="EAM_ALERT_ACTION_LOG"
                            column="TIMESTAMP" nullable="NOT NULL"/>
    </schemaSpec>

    <!-- Remove the on delete cascade from svc cluster to svc and agent to 
         platform -->
    <schemaSpec version="3.12">
      <schema-directSQL>
        <statement>
          ALTER TABLE eam_service DROP CONSTRAINT fkee7e4387a14c9e5b CASCADE
        </statement>
        <statement>
          ALTER TABLE eam_service ADD CONSTRAINT fkee7e4387a14c9e5b 
            FOREIGN KEY (svc_cluster_id) REFERENCES eam_svc_cluster(id)
        </statement>
        <statement>
          ALTER TABLE eam_platform DROP CONSTRAINT fkfed285c1559691a3 CASCADE
        </statement>
        <statement>
          ALTER TABLE eam_platform ADD CONSTRAINT 
            fkfed285c1559691a3 FOREIGN KEY (agent_id) REFERENCES eam_agent(id)
        </statement>
      </schema-directSQL>
    </schemaSpec>
      
    <schemaSpec version="3.13">
      <schema-directSQL>
        <statement targetDB="postgresql">
          CREATE TABLE eam_galert_action_log (
             id integer NOT NULL,
             "timestamp" bigint NOT NULL,
             detail character varying(500) NOT NULL,
             galert_id integer NOT NULL,
             alert_type integer NOT NULL,
             action_id integer,
             subject_id integer)
        </statement>
        <statement targetDB="oracle">
            CREATE TABLE eam_galert_action_log (
               id integer NOT NULL,
               timestamp number(19, 0) NOT NULL,
               detail character varying(500) NOT NULL,
               galert_id integer NOT NULL,
               alert_type integer NOT NULL,
               action_id integer,
               subject_id integer)
        </statement>
        <statement targetDB="postgresql">
            CREATE SEQUENCE eam_galert_action_log_id_seq
                START WITH 10001
                INCREMENT BY 1
                NO MAXVALUE
                NO MINVALUE
                CACHE 1
        </statement>          
        <statement targetDB="oracle">
            CREATE SEQUENCE eam_galert_action_log_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
        </statement>
        <statement>  <!-- Now migrate the old action logs to the new table-->
             insert into eam_galert_action_log (id, timestamp, detail, 
                                                galert_id, alert_type, 
                                                action_id, subject_id)
             select id, timestamp, detail, galert_id, alert_type, action_id, 
                    subject_id from eam_alert_action_log 
             where galert_id is not null
        </statement> 
        <statement>
            delete from eam_alert_action_log where galert_id is not null
        </statement>
        <statement>
            alter table eam_alert_action_log drop column galert_id
        </statement>
        <statement>
            ALTER TABLE eam_galert_action_log
                ADD CONSTRAINT eam_galert_action_log_pkey PRIMARY KEY (id)
        </statement>
        <statement targetDB="postgresql">
            CREATE INDEX galert_action_log_idx ON eam_galert_action_log 
                USING btree (galert_id)
        </statement>
        <statement targetDB="oracle">
            CREATE INDEX galert_action_log_idx ON eam_galert_action_log (galert_id)
        </statement>
        <statement>
            ALTER TABLE eam_galert_action_log
                ADD CONSTRAINT fkef4421379c76c3bb FOREIGN KEY (action_id) 
                REFERENCES eam_action(id)
        </statement>
        <statement>
            ALTER TABLE eam_galert_action_log
                ADD CONSTRAINT fkef442137c7d09794 FOREIGN KEY (galert_id) 
                REFERENCES eam_galert_logs(id) ON DELETE CASCADE
        </statement>
        <statement>
            ALTER TABLE eam_galert_action_log
                ADD CONSTRAINT fkef442137e82fbc FOREIGN KEY (subject_id) 
                REFERENCES eam_subject(id)
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.14">
      <schema-addColumn table="EAM_GALERT_DEFS" column="DELETED" 
                        columnType="BOOLEAN"/>
      <schema-update table="EAM_GALERT_DEFS" column="DELETED"
                         columnType="BOOLEAN" value="FALSE" />
      <schema-alterColumn table="EAM_GALERT_DEFS" column="DELETED" 
                          nullable="NOT NULL"/>
    </schemaSpec>

    <schemaSpec version="3.15">
      <schema-insert table="EAM_CONFIG_PROPS"
                     dupFail="false"
                     insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE, FREAD_ONLY) VALUES (52, 'KERBEROS_REALM', '', '', '0')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                     dupFail="false"
                     insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE, FREAD_ONLY) VALUES (53, 'KERBEROS_KDC', '', '', '0')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                     dupFail="false"
                     insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE, FREAD_ONLY) VALUES (54, 'KERBEROS_DEBUG', '', '', '0')"/>
    </schemaSpec>

    <schemaSpec version="3.16">
      <schema-directSQL>
        <statement desc="Update ControlActionGroupJob for HQ">
          UPDATE EAM_QRTZ_JOB_DETAILS SET
          job_class_name='org.hyperic.hq.control.server.session.ControlActionGroupJob' WHERE
          job_class_name='net.hyperic.hq.control.server.session.ControlActionGroupJob'
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.17">
      <schema-directSQL>
        <statement targetDB="postgresql">
          alter table eam_measurement_data alter column value type float8
        </statement>
        <statement targetDB="postgresql">
          alter table eam_measurement_data_1h alter column value type  float8
        </statement>
        <statement targetDB="postgresql">
          alter table eam_measurement_data_1h alter column minvalue type float8
        </statement>
        <statement targetDB="postgresql">
          alter table eam_measurement_data_1h alter column maxvalue type float8
        </statement>

        <statement targetDB="postgresql">
          alter table eam_measurement_data_6h alter column value type float8
        </statement>
        <statement targetDB="postgresql">
          alter table eam_measurement_data_6h alter column minvalue type float8
        </statement>
        <statement targetDB="postgresql">
          alter table eam_measurement_data_6h alter column maxvalue type float8
        </statement>

        <statement targetDB="postgresql">
          alter table eam_measurement_data_1d alter column value type float8
        </statement>
        <statement targetDB="postgresql">
          alter table eam_measurement_data_1d alter column minvalue type float8
        </statement>
        <statement targetDB="postgresql">
          alter table eam_measurement_data_1d alter column maxvalue type float8
        </statement>

        <statement targetDB="oracle">
          alter table eam_measurement_data modify (
            value double precision
          )
        </statement>
        <statement targetDB="oracle">
          alter table eam_measurement_data_1h modify (
            value double precision,
            minvalue double precision,
            maxvalue double precision
          )
        </statement>
        <statement targetDB="oracle">
          alter table eam_measurement_data_6h modify (
            value double precision,
            minvalue double precision,
            maxvalue double precision
          )
        </statement>
        <statement targetDB="oracle">
          alter table eam_measurement_data_1d modify (
            value double precision,
            minvalue double precision,
            maxvalue double precision
          )
        </statement>
      
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.18">
      <schema-insert table="EAM_CONFIG_PROPS"
                     dupFail="false"
                     insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE, FREAD_ONLY) VALUES (55, 'HQ-GUID', '', '', '0')"/>
    </schemaSpec>

    <schemaSpec version="3.19">
      <schema-directSQL>
        <statement targetDB="postgresql">
           CREATE TABLE eam_update_status (
               id integer NOT NULL,
               version_col bigint DEFAULT 0 NOT NULL,
               report character varying(4000),
               upmode integer NOT NULL,
               ignored boolean NOT NULL
           )
        </statement>
        <statement targetDB="oracle">
           CREATE TABLE eam_update_status  (
               id integer NOT NULL,
               version_col NUMBER(19,0) DEFAULT 0 NOT NULL,
               report VARCHAR2(4000) NOT NULL,
               upmode integer NOT NULL,
               ignored NUMBER(1) NOT NULL
           )
        </statement>
        <statement targetDB="postgresql">
            CREATE SEQUENCE eam_update_status_id_seq
                START WITH 10001
                INCREMENT BY 1
                NO MAXVALUE
                NO MINVALUE
                CACHE 1
        </statement>          
        <statement targetDB="oracle">
            CREATE SEQUENCE eam_update_status_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.20">
        <schema-addColumn table="EAM_ACTION" column="DELETED" 
                          columnType="BOOLEAN"/>
        <schema-update table="EAM_ACTION" column="DELETED"
                           columnType="BOOLEAN" value="FALSE" />
        <schema-alterColumn table="EAM_ACTION" column="DELETED" 
                            nullable="NOT NULL"/>
    </schemaSpec>

    <schemaSpec version="3.21">
	  <schema-directSQL>
	    <statement targetDB="oracle" fail="false">
          update EAM_UPDATE_STATUS set REPORT='upgraded'
	    </statement>
	    <statement targetDB="oracle" fail="false">
          alter table EAM_UPDATE_STATUS MODIFY (REPORT NOT NULL)
	    </statement>
      </schema-directSQL>

      <schema-alterColumn table="EAM_UPDATE_STATUS" column="REPORT" 
                          nullable="NULL"/>
    </schemaSpec>

	<schemaSpec version="3.22">
	  <schema-directSQL>
	    <statement targetDB="postgresql">
	      alter table eam_measurement_data alter column value type NUMERIC(24,5)
	    </statement>
	    <statement targetDB="postgresql">
	      alter table eam_measurement_data_1h alter column value type  NUMERIC(24,5)
	    </statement>
	    <statement targetDB="postgresql">
	      alter table eam_measurement_data_1h alter column minvalue type NUMERIC(24,5)
	    </statement>
	    <statement targetDB="postgresql">
	      alter table eam_measurement_data_1h alter column maxvalue type NUMERIC(24,5)
	    </statement>
        <statement targetDB="postgresql">
          alter table eam_measurement_data_6h alter column value type NUMERIC(24,5)
        </statement>
        <statement targetDB="postgresql">
          alter table eam_measurement_data_6h alter column minvalue type NUMERIC(24,5)
        </statement>
        <statement targetDB="postgresql">
          alter table eam_measurement_data_6h alter column maxvalue type NUMERIC(24,5)
        </statement>
        <statement targetDB="postgresql">
          alter table eam_measurement_data_1d alter column value type NUMERIC(24,5)
        </statement>
        <statement targetDB="postgresql">
          alter table eam_measurement_data_1d alter column minvalue type NUMERIC(24,5)
        </statement>
        <statement targetDB="postgresql">
          alter table eam_measurement_data_1d alter column maxvalue type NUMERIC(24,5)
        </statement>

        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA rename column VALUE to VALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA add (VALUE NUMBER(24,5))
        </statement>
        <statement targetDB="oracle">
          update EAM_MEASUREMENT_DATA set VALUE=VALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA drop column VALUE_TMP
        </statement>

        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_1H rename column VALUE to VALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_1H rename column MINVALUE to MINVALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_1H rename column MAXVALUE to MAXVALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_1H add (
            VALUE NUMBER(24,5),
            MINVALUE NUMBER(24,5),
            MAXVALUE NUMBER(24,5)
          )
        </statement>
        <statement targetDB="oracle">
          update EAM_MEASUREMENT_DATA_1H set VALUE=VALUE_TMP
        </statement>
        <statement targetDB="oracle">
          update EAM_MEASUREMENT_DATA_1H set MINVALUE=MINVALUE_TMP
        </statement>
        <statement targetDB="oracle">
          update EAM_MEASUREMENT_DATA_1H set MAXVALUE=MAXVALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_1H DROP COLUMN VALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_1H DROP COLUMN MINVALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_1H DROP COLUMN MAXVALUE_TMP
        </statement>
            
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_6H rename column VALUE to VALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_6H rename column MINVALUE to MINVALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_6H rename column MAXVALUE to MAXVALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_6H add (
            VALUE NUMBER(24,5),
            MINVALUE NUMBER(24,5),
            MAXVALUE NUMBER(24,5)
          )
        </statement>
        <statement targetDB="oracle">
          update EAM_MEASUREMENT_DATA_6H set VALUE=VALUE_TMP
        </statement>
        <statement targetDB="oracle">
          update EAM_MEASUREMENT_DATA_6H set MINVALUE=MINVALUE_TMP
        </statement>
        <statement targetDB="oracle">
          update EAM_MEASUREMENT_DATA_6H set MAXVALUE=MAXVALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_6H DROP COLUMN VALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_6H DROP COLUMN MINVALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_6H DROP COLUMN MAXVALUE_TMP
        </statement>          

        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_1D rename column VALUE to VALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_1D rename column MINVALUE to MINVALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_1D rename column MAXVALUE to MAXVALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_1D add (
            VALUE NUMBER(24,5),
            MINVALUE NUMBER(24,5),
            MAXVALUE NUMBER(24,5)
          )
        </statement>
        <statement targetDB="oracle">
          update EAM_MEASUREMENT_DATA_1D set VALUE=VALUE_TMP
        </statement>
        <statement targetDB="oracle">
          update EAM_MEASUREMENT_DATA_1D set MINVALUE=MINVALUE_TMP
        </statement>
        <statement targetDB="oracle">
          update EAM_MEASUREMENT_DATA_1D set MAXVALUE=MAXVALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_1D DROP COLUMN VALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_1D DROP COLUMN MINVALUE_TMP
        </statement>
        <statement targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_1D DROP COLUMN MAXVALUE_TMP
        </statement>          
                                 
       </schema-directSQL>
    </schemaSpec>
	
    <schemaSpec version="3.23">
      <schema-directSQL>
        <statement desc="Drop redundant RESOURCE_ID column in EAM_RESOURCE_GROUP">
          ALTER TABLE EAM_RESOURCE_GROUP DROP COLUMN RESOURCE_ID 
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.23.1">
      <schema-directSQL>
        <statement>
            CREATE INDEX trigger_event_id_idx ON eam_trigger_event(event_id)
        </statement>
        <statement>
            CREATE INDEX meas_enabled_idx ON eam_measurement(enabled)
        </statement>
        <statement>
            CREATE INDEX templ_category_idx ON eam_measurement_templ(category_id)
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.23.2">
      <schema-directSQL>
        <statement targetDB="postgresql">
          alter table eam_agent alter column address type character varying(255)
        </statement>
        <statement targetDB="oracle">
          alter table eam_agent modify address varchar2(255)
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.24">
      <schema-directSQL>
        <statement>
            ALTER TABLE EAM_CRISPO_OPT RENAME COLUMN KEY TO PROPKEY
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <!-- Add the missing RT tables for .org.  Deliberately skipping Oracle, since
         users who use Oracle (likely Enterprise customers) will already have these
         tables -->
    <schemaSpec version="3.25">
      <schema-directSQL>
        <statement desc="Add eam_error_code table" fail="false" targetDB="postgresql">
          CREATE TABLE eam_error_code (
            id integer NOT NULL,
            version_col bigint DEFAULT 0 NOT NULL,
            code integer NOT NULL,
            description character varying(64) NOT NULL
          )
        </statement>
        <statement desc="Add eam_error_code constraint" fail="false" targetDB="postgresql">
          ALTER TABLE ONLY eam_error_code ADD CONSTRAINT eam_error_code_pkey PRIMARY KEY (id)
        </statement>
        <statement desc="Add eam_error_code index" fail="false" targetDB="postgresql">
          CREATE INDEX error_code ON eam_error_code USING btree (code)
        </statement>
        <statement desc="Add eam_service_request table" fail="false" targetDB="postgresql">
          CREATE TABLE eam_service_request (
              id integer NOT NULL,
              version_col bigint DEFAULT 0 NOT NULL,
              serviceid integer NOT NULL,
              url character varying(767) NOT NULL
          )
        </statement>
        <statement desc="Add eam_service_request primary key" fail="false" targetDB="postgresql">
          ALTER TABLE ONLY eam_service_request
              ADD CONSTRAINT eam_service_request_pkey PRIMARY KEY (id)
        </statement>
        <statement desc="Add eam_service_request unique constraint" fail="false" targetDB="postgresql">
          ALTER TABLE ONLY eam_service_request
              ADD CONSTRAINT eam_service_request_serviceid_key UNIQUE (serviceid, url)
        </statement>
        <statement desc="Add eam_service_request index" fail="false" targetDB="postgresql">
          CREATE INDEX service_request_svcid ON eam_service_request USING btree (serviceid)
        </statement>
        <statement desc="Add eam_service_request index" fail="false" targetDB="postgresql">
          CREATE INDEX service_request_url ON eam_service_request USING btree (url)
        </statement>
        <statement desc="Add eam_request_stat table" fail="false" targetDB="postgresql">
          CREATE TABLE eam_request_stat (
              id integer NOT NULL,
              version_col bigint DEFAULT 0 NOT NULL,
              ipaddr character varying(20) NOT NULL,
              min double precision NOT NULL,
              max double precision NOT NULL,
              total double precision NOT NULL,
              count integer NOT NULL,
              begintime bigint NOT NULL,
              endtime bigint NOT NULL,
              svctype integer NOT NULL,
              svcreq_id integer
          )
        </statement>
        <statement desc="Add eam_request_stat primary key" fail="false" targetDB="postgresql">
          ALTER TABLE ONLY eam_request_stat
              ADD CONSTRAINT eam_request_stat_pkey PRIMARY KEY (id)
        </statement>
        <statement desc="Add eam_request_stat index" fail="false" targetDB="postgresql">
          CREATE INDEX reqstat_idx_begintime ON eam_request_stat USING btree (begintime)
        </statement>
        <statement desc="Add eam_request_stat index" fail="false" targetDB="postgresql">
          CREATE INDEX reqstat_idx_endtime ON eam_request_stat USING btree (endtime)
        </statement>
        <statement desc="Add eam_request_stat index" fail="false" targetDB="postgresql">
          CREATE INDEX service_id ON eam_request_stat USING btree (svcreq_id)
        </statement>
        <statement desc="Add eam_request_stat foreign key" fail="false" targetDB="postgresql">
          ALTER TABLE ONLY eam_request_stat
            ADD CONSTRAINT fke8ebbc72154d0f55 FOREIGN KEY (svcreq_id) REFERENCES eam_service_request(id) ON DELETE CASCADE
        </statement>
        <statement desc="Add eam_stat_errors table" fail="false" targetDB="postgresql">
          CREATE TABLE eam_stat_errors (
            id integer NOT NULL,
            version_col bigint DEFAULT 0 NOT NULL,
            count integer NOT NULL,
            error_id integer,
            reqstat_id integer
          )
        </statement>
        <statement desc="Add eam_stat_errors primary key" fail="false" targetDB="postgresql">
          ALTER TABLE ONLY eam_stat_errors
            ADD CONSTRAINT eam_stat_errors_pkey PRIMARY KEY (id)
        </statement>
        <statement desc="Add eam_stat_errors index" fail="false" targetDB="postgresql">
          CREATE INDEX stat_errors_reqstat ON eam_stat_errors USING btree (reqstat_id)
        </statement>
        <statement desc="Add eam_stat_errors foreign key constraint" fail="false" targetDB="postgresql">
          ALTER TABLE ONLY eam_stat_errors
            ADD CONSTRAINT fk6f2383a8237d366c FOREIGN KEY (error_id) REFERENCES eam_error_code(id) ON DELETE CASCADE
        </statement>
        <statement desc="Add eam_stat_errors foreign key constraint" fail="false" targetDB="postgresql">
          ALTER TABLE ONLY eam_stat_errors
            ADD CONSTRAINT fk6f2383a82de89070 FOREIGN KEY (reqstat_id) REFERENCES eam_request_stat(id) ON DELETE CASCADE
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.26">
        <schema-addColumn table="EAM_ALERT_DEFINITION" column="RESOURCE_ID" 
                          columnType="INTEGER"/>
        <schema-directSQL>
          <statement desc="Update new resource_id column">
            update eam_alert_definition set resource_id =
              (select r.id from eam_resource r,
                (select id, 1 as appdef_type from eam_resource_type where cid = 301
                 union all
                 select id, 2 as appdef_type from eam_resource_type where cid = 303
                 union all
                 select id, 3 as appdef_type from eam_resource_type where cid = 305)
                 m
               where eam_alert_definition.appdef_id = r.instance_id and
                     r.resource_type_id = m.id and
                     eam_alert_definition.appdef_type = m.appdef_type)
            where parent_id is null or not parent_id = 0
          </statement>
        </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.27">
        <schema-directSQL>
          <statement desc="Drop index from eam_measurement_data"
                     targetDB="oracle">
            drop index measurement_data_time_idx
          </statement>
          <statement desc="Drop index from eam_measurement_data"
                     targetDB="postgresql">
            drop index measurement_data_time_idx
          </statement>

          <statement desc="Drop primary key from eam_measurement_data"
                     targetDB="oracle">
            alter table EAM_MEASUREMENT_DATA drop primary key
          </statement>
          <statement desc="Drop primary key from eam_measurement_data"
                     targetDB="postgresql">
            alter table EAM_MEASUREMENT_DATA drop constraint eam_measurement_data_pkey
          </statement>

          <statement desc="Change eam_measurement_data table name"
                     targetDB="oracle">
            alter table EAM_MEASUREMENT_DATA rename to HQ_METRIC_DATA_COMPAT
          </statement>
          <statement desc="Change eam_measurement_data table name"
                     targetDB="postgresql">
            alter table EAM_MEASUREMENT_DATA rename to HQ_METRIC_DATA_COMPAT
          </statement>

          <statement desc="Add new primary key to eam_measurement_data"
                     targetDB="oracle">
            alter table HQ_METRIC_DATA_COMPAT add
            constraint HQ_METRIC_DATA_COMPAT_PKEY
            primary key (TIMESTAMP, MEASUREMENT_ID)
          </statement>
          <statement desc="Add new primary key to eam_measurement_data"
                     targetDB="postgresql">
            alter table HQ_METRIC_DATA_COMPAT add
            primary key (TIMESTAMP, MEASUREMENT_ID)
          </statement>

          <statement targetDB="postgresql">
            create table HQ_METRIC_DATA_0D_0S (
                MEASUREMENT_ID int4 not null,
                TIMESTAMP int8 not null,
                VALUE numeric(24, 5),
                primary key (TIMESTAMP, MEASUREMENT_ID)
            )
          </statement>

         <statement targetDB="postgresql">
           create table HQ_METRIC_DATA_0D_1S (
               MEASUREMENT_ID int4 not null,
               TIMESTAMP int8 not null,
               VALUE numeric(24, 5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="postgresql">
           create table HQ_METRIC_DATA_1D_0S (
               MEASUREMENT_ID int4 not null,
               TIMESTAMP int8 not null,
               VALUE numeric(24, 5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="postgresql">
           create table HQ_METRIC_DATA_1D_1S (
               MEASUREMENT_ID int4 not null,
               TIMESTAMP int8 not null,
               VALUE numeric(24, 5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="postgresql">
           create table HQ_METRIC_DATA_2D_0S (
               MEASUREMENT_ID int4 not null,
               TIMESTAMP int8 not null,
               VALUE numeric(24, 5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="postgresql">
           create table HQ_METRIC_DATA_2D_1S (
               MEASUREMENT_ID int4 not null,
               TIMESTAMP int8 not null,
               VALUE numeric(24, 5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="postgresql">
           create table HQ_METRIC_DATA_3D_0S (
               MEASUREMENT_ID int4 not null,
               TIMESTAMP int8 not null,
               VALUE numeric(24, 5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="postgresql">
           create table HQ_METRIC_DATA_3D_1S (
               MEASUREMENT_ID int4 not null,
               TIMESTAMP int8 not null,
               VALUE numeric(24, 5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="postgresql">
           create table HQ_METRIC_DATA_4D_0S (
               MEASUREMENT_ID int4 not null,
               TIMESTAMP int8 not null,
               VALUE numeric(24, 5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="postgresql">
           create table HQ_METRIC_DATA_4D_1S (
               MEASUREMENT_ID int4 not null,
               TIMESTAMP int8 not null,
               VALUE numeric(24, 5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="postgresql">
           create table HQ_METRIC_DATA_5D_0S (
               MEASUREMENT_ID int4 not null,
               TIMESTAMP int8 not null,
               VALUE numeric(24, 5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="postgresql">
           create table HQ_METRIC_DATA_5D_1S (
               MEASUREMENT_ID int4 not null,
               TIMESTAMP int8 not null,
               VALUE numeric(24, 5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="postgresql">
           create table HQ_METRIC_DATA_6D_0S (
               MEASUREMENT_ID int4 not null,
               TIMESTAMP int8 not null,
               VALUE numeric(24, 5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="postgresql">
           create table HQ_METRIC_DATA_6D_1S (
               MEASUREMENT_ID int4 not null,
               TIMESTAMP int8 not null,
               VALUE numeric(24, 5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="postgresql">
           create table HQ_METRIC_DATA_7D_0S (
               MEASUREMENT_ID int4 not null,
               TIMESTAMP int8 not null,
               VALUE numeric(24, 5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="postgresql">
           create table HQ_METRIC_DATA_7D_1S (
               MEASUREMENT_ID int4 not null,
               TIMESTAMP int8 not null,
               VALUE numeric(24, 5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="postgresql">
           create table HQ_METRIC_DATA_8D_0S (
               MEASUREMENT_ID int4 not null,
               TIMESTAMP int8 not null,
               VALUE numeric(24, 5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="postgresql">
           create table HQ_METRIC_DATA_8D_1S (
               MEASUREMENT_ID int4 not null,
               TIMESTAMP int8 not null,
               VALUE numeric(24, 5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <!-- TODO: Wait until I fix SST_DirectSQL 
         <statement targetDB="mysql">
           create table HQ_METRIC_DATA_0D_0S (
               MEASUREMENT_ID integer not null,
               TIMESTAMP bigint not null,
               VALUE numeric(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           ) ENGINE=InnoDB
         </statement>

         <statement targetDB="mysql">
           create table HQ_METRIC_DATA_0D_1S (
               MEASUREMENT_ID integer not null,
               TIMESTAMP bigint not null,
               VALUE numeric(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           ) ENGINE=InnoDB
         </statement>

         <statement targetDB="mysql">
           create table HQ_METRIC_DATA_1D_0S (
               MEASUREMENT_ID integer not null,
               TIMESTAMP bigint not null,
               VALUE numeric(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           ) ENGINE=InnoDB
         </statement>

         <statement targetDB="mysql">
           create table HQ_METRIC_DATA_1D_1S (
               MEASUREMENT_ID integer not null,
               TIMESTAMP bigint not null,
               VALUE numeric(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           ) ENGINE=InnoDB
         </statement>

         <statement targetDB="mysql">
           create table HQ_METRIC_DATA_2D_0S (
               MEASUREMENT_ID integer not null,
               TIMESTAMP bigint not null,
               VALUE numeric(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           ) ENGINE=InnoDB
         </statement>

         <statement targetDB="mysql">
           create table HQ_METRIC_DATA_2D_1S (
               MEASUREMENT_ID integer not null,
               TIMESTAMP bigint not null,
               VALUE numeric(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           ) ENGINE=InnoDB
         </statement>

         <statement targetDB="mysql">
           create table HQ_METRIC_DATA_3D_0S (
               MEASUREMENT_ID integer not null,
               TIMESTAMP bigint not null,
               VALUE numeric(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           ) ENGINE=InnoDB
         </statement>

         <statement targetDB="mysql">
           create table HQ_METRIC_DATA_3D_1S (
               MEASUREMENT_ID integer not null,
               TIMESTAMP bigint not null,
               VALUE numeric(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           ) ENGINE=InnoDB
         </statement>

         <statement targetDB="mysql">
           create table HQ_METRIC_DATA_4D_0S (
               MEASUREMENT_ID integer not null,
               TIMESTAMP bigint not null,
               VALUE numeric(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           ) ENGINE=InnoDB
         </statement>

         <statement targetDB="mysql">
           create table HQ_METRIC_DATA_4D_1S (
               MEASUREMENT_ID integer not null,
               TIMESTAMP bigint not null,
               VALUE numeric(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           ) ENGINE=InnoDB
         </statement>

         <statement targetDB="mysql">
           create table HQ_METRIC_DATA_5D_0S (
               MEASUREMENT_ID integer not null,
               TIMESTAMP bigint not null,
               VALUE numeric(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           ) ENGINE=InnoDB
         </statement>

         <statement targetDB="mysql">
           create table HQ_METRIC_DATA_5D_1S (
               MEASUREMENT_ID integer not null,
               TIMESTAMP bigint not null,
               VALUE numeric(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           ) ENGINE=InnoDB
         </statement>

         <statement targetDB="mysql">
           create table HQ_METRIC_DATA_6D_0S (
               MEASUREMENT_ID integer not null,
               TIMESTAMP bigint not null,
               VALUE numeric(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           ) ENGINE=InnoDB
         </statement>

         <statement targetDB="mysql">
           create table HQ_METRIC_DATA_6D_1S (
               MEASUREMENT_ID integer not null,
               TIMESTAMP bigint not null,
               VALUE numeric(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           ) ENGINE=InnoDB
         </statement>

         <statement targetDB="mysql">
           create table HQ_METRIC_DATA_7D_0S (
               MEASUREMENT_ID integer not null,
               TIMESTAMP bigint not null,
               VALUE numeric(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           ) ENGINE=InnoDB
         </statement>

         <statement targetDB="mysql">
           create table HQ_METRIC_DATA_7D_1S (
               MEASUREMENT_ID integer not null,
               TIMESTAMP bigint not null,
               VALUE numeric(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           ) ENGINE=InnoDB
         </statement>

         <statement targetDB="mysql">
           create table HQ_METRIC_DATA_8D_0S (
               MEASUREMENT_ID integer not null,
               TIMESTAMP bigint not null,
               VALUE numeric(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           ) ENGINE=InnoDB
         </statement>

         <statement targetDB="mysql">
           create table HQ_METRIC_DATA_8D_1S (
               MEASUREMENT_ID integer not null,
               TIMESTAMP bigint not null,
               VALUE numeric(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           ) ENGINE=InnoDB
         </statement>

         -->
         <statement targetDB="oracle">
           create table HQ_METRIC_DATA_0D_0S (
               MEASUREMENT_ID number(10,0) not null,
               TIMESTAMP number(19,0) not null,
               VALUE number(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="oracle">
           create table HQ_METRIC_DATA_0D_1S (
               MEASUREMENT_ID number(10,0) not null,
               TIMESTAMP number(19,0) not null,
               VALUE number(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="oracle">
           create table HQ_METRIC_DATA_1D_0S (
               MEASUREMENT_ID number(10,0) not null,
               TIMESTAMP number(19,0) not null,
               VALUE number(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="oracle">
           create table HQ_METRIC_DATA_1D_1S (
               MEASUREMENT_ID number(10,0) not null,
               TIMESTAMP number(19,0) not null,
               VALUE number(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="oracle">
           create table HQ_METRIC_DATA_2D_0S (
               MEASUREMENT_ID number(10,0) not null,
               TIMESTAMP number(19,0) not null,
               VALUE number(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="oracle">
           create table HQ_METRIC_DATA_2D_1S (
               MEASUREMENT_ID number(10,0) not null,
               TIMESTAMP number(19,0) not null,
               VALUE number(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="oracle">
           create table HQ_METRIC_DATA_3D_0S (
               MEASUREMENT_ID number(10,0) not null,
               TIMESTAMP number(19,0) not null,
               VALUE number(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="oracle">
           create table HQ_METRIC_DATA_3D_1S (
               MEASUREMENT_ID number(10,0) not null,
               TIMESTAMP number(19,0) not null,
               VALUE number(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="oracle">
           create table HQ_METRIC_DATA_4D_0S (
               MEASUREMENT_ID number(10,0) not null,
               TIMESTAMP number(19,0) not null,
               VALUE number(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="oracle">
           create table HQ_METRIC_DATA_4D_1S (
               MEASUREMENT_ID number(10,0) not null,
               TIMESTAMP number(19,0) not null,
               VALUE number(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="oracle">
           create table HQ_METRIC_DATA_5D_0S (
               MEASUREMENT_ID number(10,0) not null,
               TIMESTAMP number(19,0) not null,
               VALUE number(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="oracle">
           create table HQ_METRIC_DATA_5D_1S (
               MEASUREMENT_ID number(10,0) not null,
               TIMESTAMP number(19,0) not null,
               VALUE number(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="oracle">
           create table HQ_METRIC_DATA_6D_0S (
               MEASUREMENT_ID number(10,0) not null,
               TIMESTAMP number(19,0) not null,
               VALUE number(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="oracle">
           create table HQ_METRIC_DATA_6D_1S (
               MEASUREMENT_ID number(10,0) not null,
               TIMESTAMP number(19,0) not null,
               VALUE number(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="oracle">
           create table HQ_METRIC_DATA_7D_0S (
               MEASUREMENT_ID number(10,0) not null,
               TIMESTAMP number(19,0) not null,
               VALUE number(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="oracle">
           create table HQ_METRIC_DATA_7D_1S (
               MEASUREMENT_ID number(10,0) not null,
               TIMESTAMP number(19,0) not null,
               VALUE number(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="oracle">
           create table HQ_METRIC_DATA_8D_0S (
               MEASUREMENT_ID number(10,0) not null,
               TIMESTAMP number(19,0) not null,
               VALUE number(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>

         <statement targetDB="oracle">
           create table HQ_METRIC_DATA_8D_1S (
               MEASUREMENT_ID number(10,0) not null,
               TIMESTAMP number(19,0) not null,
               VALUE number(24,5),
               primary key (TIMESTAMP, MEASUREMENT_ID)
           )
         </statement>
       </schema-directSQL>
    </schemaSpec>
    
    <schemaSpec version="3.28">
      <schema-insert table="EAM_CONFIG_PROPS"
                     dupFail="false"
                     insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE, FREAD_ONLY) VALUES (56, 'BATCH_AGGREGATE_WORKERS', '', '0', '0')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                     dupFail="false"
                     insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE, FREAD_ONLY) VALUES (57, 'BATCH_AGGREGATE_BATCHSIZE', '', '500', '0')"/>
      <schema-insert table="EAM_CONFIG_PROPS"
                     dupFail="false"
                     insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE, FREAD_ONLY) VALUES (58, 'BATCH_AGGREGATE_QUEUE', '', '20000', '0')"/>
    </schemaSpec>
    
    <schemaSpec version="3.28.1">
      <schema-directSQL>
        <statement>
          ALTER TABLE eam_alert_definition
            ADD CONSTRAINT fk97540784fc176ae FOREIGN KEY (resource_id) REFERENCES eam_resource(id)
        </statement>          
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.28.2">
      <schema-directSQL>
        <statement targetDB="postgresql">
          CREATE TABLE eam_galert_aux_logs (
                  id integer NOT NULL,
                  version_col bigint DEFAULT 0 NOT NULL,
                  "timestamp" bigint NOT NULL,
                  auxtype integer NOT NULL,
                  description character varying(255) NOT NULL,
                  galert_id integer NOT NULL,
                  parent integer
              )
        </statement>
        <statement targetDB="oracle">
          CREATE TABLE eam_galert_aux_logs (
                  id integer NOT NULL,
                  version_col NUMBER(19,0) NOT NULL,
                  "timestamp" NUMBER(19, 0) NOT NULL,
                  auxtype integer NOT NULL,
                  description VARCHAR2(255) NOT NULL,
                  galert_id integer NOT NULL,
                  parent integer
           )
        </statement>
        <statement targetDB="postgresql">
              CREATE SEQUENCE eam_galert_aux_logs_id_seq
                  START WITH 10001
                  INCREMENT BY 1
                  NO MAXVALUE
                  NO MINVALUE
                  CACHE 1
        </statement>
        <statement targetDB="oracle">
              CREATE SEQUENCE eam_galert_aux_logs_id_seq
                  START WITH 10001
                  INCREMENT BY 1
                  NOMAXVALUE
                  NOCYCLE
                  CACHE 10
        </statement>
        <statement>          
                ALTER TABLE eam_galert_aux_logs
                    ADD CONSTRAINT eam_galert_aux_logs_pkey PRIMARY KEY (id)
        </statement>
        <statement>          
                ALTER TABLE eam_galert_aux_logs
                    ADD CONSTRAINT fke20899066993629f FOREIGN KEY (parent) 
                    REFERENCES eam_galert_aux_logs(id)
        </statement>
        <statement>          
                ALTER TABLE eam_galert_aux_logs
                    ADD CONSTRAINT fke2089906c7d09794 FOREIGN KEY (galert_id) 
                    REFERENCES eam_galert_logs(id)
        </statement>
      </schema-directSQL>
    </schemaSpec>
    
    <schemaSpec version="3.28.3">
      <schema-directSQL>
        <statement targetDB="postgresql">
            CREATE TABLE eam_metric_aux_logs (
                id integer NOT NULL,
                version_col bigint DEFAULT 0 NOT NULL,
                aux_log_id integer NOT NULL,
                metric_id integer NOT NULL
            )            
        </statement>
        <statement targetDB="oracle">
            CREATE TABLE eam_metric_aux_logs (
                id integer NOT NULL,
                version_col NUMBER(19, 0) NOT NULL,
                aux_log_id integer NOT NULL,
                metric_id integer NOT NULL
            )            
        </statement>
        <statement targetDB="postgresql">
             CREATE SEQUENCE eam_metric_aux_log_id_seq
                START WITH 10001
                INCREMENT BY 1
                NO MAXVALUE
                NO MINVALUE
                CACHE 1
        </statement>
        <statement targetDB="oracle">
             CREATE SEQUENCE eam_metric_aux_logs_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
        </statement>
        <statement>          
            ALTER TABLE eam_metric_aux_logs
                ADD CONSTRAINT eam_metric_aux_logs_pkey PRIMARY KEY (id)
        </statement>
        <statement>
            CREATE INDEX aux_log_id_idx ON eam_metric_aux_logs (aux_log_id)
        </statement>
        <statement>
            ALTER TABLE eam_metric_aux_logs
                ADD CONSTRAINT fke7d70b0b993199c7 FOREIGN KEY (metric_id) 
                REFERENCES eam_measurement(id)
        </statement>
        <statement>
            ALTER TABLE eam_metric_aux_logs
                ADD CONSTRAINT fke7d70b0b997cfc6 FOREIGN KEY (aux_log_id) 
                REFERENCES eam_galert_aux_logs(id)
        </statement>
      </schema-directSQL>
    </schemaSpec>
    
    <schemaSpec version="3.28.4">
      <schema-directSQL>
        <statement targetDB="postgresql">
            CREATE TABLE eam_resource_aux_logs (
                id integer NOT NULL,
                version_col bigint DEFAULT 0 NOT NULL,
                aux_log_id integer NOT NULL,
                appdef_type integer NOT NULL,
                appdef_id integer NOT NULL
            )
        </statement>
        <statement targetDB="oracle">
            CREATE TABLE eam_resource_aux_logs (
                id integer NOT NULL,
                version_col NUMBER(19, 0) NOT NULL,
                aux_log_id integer NOT NULL,
                appdef_type integer NOT NULL,
                appdef_id integer NOT NULL
            )
        </statement>
        <statement targetDB="postgresql">
             CREATE SEQUENCE eam_resource_aux_log_id_seq
                START WITH 10001
                INCREMENT BY 1
                NO MAXVALUE
                NO MINVALUE
                CACHE 1
        </statement>
        <statement targetDB="oracle">
             CREATE SEQUENCE eam_resource_aux_log_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
        </statement>
        <statement>          
            ALTER TABLE eam_resource_aux_logs
                ADD CONSTRAINT eam_resource_aux_logs_pkey PRIMARY KEY (id)
        </statement>
        <statement>          
            CREATE INDEX metric_aux_log_id_idx ON eam_resource_aux_logs (aux_log_id)
        </statement>
        <statement>          
            ALTER TABLE eam_resource_aux_logs
                ADD CONSTRAINT fk859d15ed997cfc6 FOREIGN KEY (aux_log_id) 
                REFERENCES eam_galert_aux_logs(id)
        </statement>
      </schema-directSQL>
    </schemaSpec>
    
    <schemaSpec version="3.28.5">
      <schema-directSQL>
        <statement targetDB="postgresql">
            CREATE TABLE eam_ui_plugin (
                id integer NOT NULL,
                version_col bigint DEFAULT 0 NOT NULL,
                name character varying(100) NOT NULL,
                description character varying(255) NOT NULL,
                plugin_version character varying(30) NOT NULL
            )            
        </statement>
        <statement targetDB="oracle">
            CREATE TABLE eam_ui_plugin (
                id integer NOT NULL,
                version_col NUMBER(19, 0) NOT NULL,
                name VARCHAR2(100) NOT NULL,
                description VARCHAR2(255) NOT NULL,
                plugin_version VARCHAR2(30) NOT NULL
            )            
        </statement>
        <statement targetDB="postgresql">
             CREATE SEQUENCE eam_ui_plugin_id_seq
                START WITH 10001
                INCREMENT BY 1
                NO MAXVALUE
                NO MINVALUE
                CACHE 1
        </statement>
        <statement targetDB="oracle">
             CREATE SEQUENCE eam_ui_plugin_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
        </statement>
        <statement> 
            ALTER TABLE eam_ui_plugin
                ADD CONSTRAINT eam_ui_plugin_name_key UNIQUE (name)
        </statement>
        <statement> 
            ALTER TABLE eam_ui_plugin
                ADD CONSTRAINT eam_ui_plugin_pkey PRIMARY KEY (id)
        </statement>
      </schema-directSQL>
    </schemaSpec>
    
    <schemaSpec version="3.28.6">
      <schema-directSQL>
        <statement targetDB="postgresql">
            CREATE TABLE eam_ui_view (
                id integer NOT NULL,
                version_col bigint DEFAULT 0 NOT NULL,
                path character varying(255) NOT NULL,
                description character varying(255) NOT NULL,
                attach_type integer NOT NULL,
                ui_plugin_id integer NOT NULL
            )            
        </statement>
        <statement targetDB="oracle">
            CREATE TABLE eam_ui_view (
                id integer NOT NULL,
                version_col NUMBER(19, 0) NOT NULL,
                path VARCHAR2(255) NOT NULL,
                description VARCHAR2(255) NOT NULL,
                attach_type integer NOT NULL,
                ui_plugin_id integer NOT NULL
            )            
        </statement>
        <statement targetDB="postgresql">
             CREATE SEQUENCE eam_ui_view_id_seq
                START WITH 10001
                INCREMENT BY 1
                NO MAXVALUE
                NO MINVALUE
                CACHE 1
        </statement>
        <statement targetDB="oracle">
             CREATE SEQUENCE eam_ui_view_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
        </statement>
        <statement> 
          ALTER TABLE eam_ui_view
              ADD CONSTRAINT eam_ui_view_path_key UNIQUE (path)
        </statement>
        <statement> 
          ALTER TABLE eam_ui_view
              ADD CONSTRAINT eam_ui_view_pkey PRIMARY KEY (id)
        </statement>
        <statement> 
          ALTER TABLE eam_ui_view
              ADD CONSTRAINT fk5fd54e62b5f36a31 FOREIGN KEY (ui_plugin_id) 
              REFERENCES eam_ui_plugin(id)
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.28.7">
      <schema-directSQL>
        <statement targetDB="postgresql">
            CREATE TABLE eam_ui_attachment (
                id integer NOT NULL,
                version_col bigint DEFAULT 0 NOT NULL,
                attach_time bigint NOT NULL,
                view_id integer NOT NULL
            )            
        </statement>
        <statement targetDB="oracle">
            CREATE TABLE eam_ui_attachment (
                id integer NOT NULL,
                version_col NUMBER(19, 0) NOT NULL,
                attach_time NUMBER(19, 0) NOT NULL,
                view_id integer NOT NULL
            )            
        </statement>
        <statement targetDB="postgresql">
             CREATE SEQUENCE eam_ui_attachment_id_seq
                START WITH 10001
                INCREMENT BY 1
                NO MAXVALUE
                NO MINVALUE
                CACHE 1
        </statement>
        <statement targetDB="oracle">
             CREATE SEQUENCE eam_ui_attachment_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
        </statement>
        <statement> 
          ALTER TABLE eam_ui_attachment
              ADD CONSTRAINT eam_ui_attachment_pkey PRIMARY KEY (id)
        </statement>
        <statement> 
          ALTER TABLE eam_ui_attachment
              ADD CONSTRAINT fk2807df20f6253048 FOREIGN KEY (view_id) 
              REFERENCES eam_ui_view(id)
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.28.8">
      <schema-directSQL>
        <statement>
            CREATE TABLE eam_ui_view_admin (
                view_id integer NOT NULL
            )            
        </statement>
        <statement> 
            ALTER TABLE eam_ui_view_admin
                ADD CONSTRAINT eam_ui_view_admin_pkey PRIMARY KEY (view_id)
        </statement>
        <statement> 
            ALTER TABLE eam_ui_view_admin
                ADD CONSTRAINT fk7815eb12f6253048 FOREIGN KEY (view_id) 
                REFERENCES eam_ui_view(id) ON DELETE CASCADE
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.28.9">
      <schema-directSQL>
        <statement>
            CREATE TABLE eam_ui_view_masthead (
                view_id integer NOT NULL
            )            
        </statement>
        <statement>
          ALTER TABLE eam_ui_view_masthead
              ADD CONSTRAINT eam_ui_view_masthead_pkey PRIMARY KEY (view_id)
        </statement>
        <statement>
          ALTER TABLE eam_ui_view_masthead
              ADD CONSTRAINT fkc9583392f6253048 FOREIGN KEY (view_id) 
              REFERENCES eam_ui_view(id) ON DELETE CASCADE
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.29">
      <schema-directSQL>
        <statement>ALTER TABLE EAM_QRTZ_BLOB_TRIGGERS RENAME TO QRTZ_BLOB_TRIGGERS</statement>
        <statement>ALTER TABLE EAM_QRTZ_CALENDARS RENAME TO QRTZ_CALENDARS</statement>
        <statement>ALTER TABLE EAM_QRTZ_CRON_TRIGGERS RENAME TO QRTZ_CRON_TRIGGERS</statement>
        <statement>ALTER TABLE EAM_QRTZ_FIRED_TRIGGERS RENAME TO QRTZ_FIRED_TRIGGERS</statement>
        <statement>ALTER TABLE EAM_QRTZ_JOB_DETAILS RENAME TO QRTZ_JOB_DETAILS</statement>
        <statement>ALTER TABLE EAM_QRTZ_JOB_LISTENERS RENAME TO QRTZ_JOB_LISTENERS</statement>
        <statement>ALTER TABLE EAM_QRTZ_LOCKS RENAME TO QRTZ_LOCKS</statement>
        <statement>ALTER TABLE EAM_QRTZ_PAUSED_TRIGGER_GRPS RENAME TO QRTZ_PAUSED_TRIGGER_GRPS</statement>
        <statement>ALTER TABLE EAM_QRTZ_SCHEDULER_STATE RENAME TO QRTZ_SCHEDULER_STATE</statement>
        <statement>ALTER TABLE EAM_QRTZ_SIMPLE_TRIGGERS RENAME TO QRTZ_SIMPLE_TRIGGERS</statement>
        <statement>ALTER TABLE EAM_QRTZ_TRIGGER_LISTENERS RENAME TO QRTZ_TRIGGER_LISTENERS</statement>
        <statement>ALTER TABLE EAM_QRTZ_TRIGGERS RENAME TO QRTZ_TRIGGERS</statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.30">
      <schema-directSQL>
        <statement targetDB="postgresql">
          CREATE TABLE eam_calendar (
              id integer NOT NULL,
              version_col bigint DEFAULT 0 NOT NULL,
              name character varying(255) NOT NULL
          )
        </statement>
        <statement targetDB="oracle">
           CREATE TABLE eam_calendar (
               id integer NOT NULL,
               version_col NUMBER(19,0) DEFAULT 0 NOT NULL,
               name VARCHAR2(255) NOT NULL
           )
        </statement>
        <statement targetDB="postgresql">
          CREATE SEQUENCE eam_calendar_id_seq
              START WITH 10001
              INCREMENT BY 1
              NO MAXVALUE
              NO MINVALUE
              CACHE 1
        </statement>
        <statement targetDB="oracle">
          CREATE SEQUENCE eam_calendar_id_seq
              START WITH 10001
              INCREMENT BY 1
              NOMAXVALUE
              NOCYCLE
              CACHE 10
        </statement>
        <statement>
          ALTER TABLE eam_calendar
              ADD CONSTRAINT eam_calendar_name_key UNIQUE (name)
        </statement>
        <statement>
          ALTER TABLE eam_calendar
              ADD CONSTRAINT eam_calendar_pkey PRIMARY KEY (id)
        </statement>          
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.31">
      <schema-directSQL>
        <statement targetDB="postgresql">
          CREATE TABLE eam_calendar_ent (
              id integer NOT NULL,
              version_col bigint DEFAULT 0 NOT NULL,
              calendar_id integer NOT NULL
          )
        </statement>
        <statement targetDB="oracle">
          CREATE TABLE eam_calendar_ent (
              id integer NOT NULL,
              version_col NUMBER(19, 0) NOT NULL,
              calendar_id integer NOT NULL
          )
        </statement>
        <statement targetDB="postgresql">
          CREATE SEQUENCE eam_calendar_ent_id_seq
              START WITH 10001
              INCREMENT BY 1
              NO MAXVALUE
              NO MINVALUE
              CACHE 1
        </statement>
        <statement targetDB="oracle">
          CREATE SEQUENCE eam_calendar_ent_id_seq
              START WITH 10001
              INCREMENT BY 1
              NOMAXVALUE
              NOCYCLE
              CACHE 10
        </statement>
        <statement>          
            ALTER TABLE eam_calendar_ent
                ADD CONSTRAINT eam_calendar_ent_pkey PRIMARY KEY (id)
        </statement>
        <statement>          
            CREATE INDEX calendar_id_idx ON eam_calendar_ent (calendar_id)
        </statement>
        <statement>
            ALTER TABLE eam_calendar_ent
                ADD CONSTRAINT fk84892e98f8214d4d FOREIGN KEY (calendar_id) 
                REFERENCES eam_calendar(id)
        </statement>
      </schema-directSQL>
    </schemaSpec>
    
    <schemaSpec version="3.32">
      <schema-directSQL>
        <statement>
          CREATE TABLE eam_calendar_week (
              calendar_week_id integer NOT NULL,
              weekday integer NOT NULL,
              starttime integer NOT NULL,
              endtime integer NOT NULL
           )
        </statement>
        <statement>
            ALTER TABLE eam_calendar_week
                  ADD CONSTRAINT eam_calendar_week_pkey PRIMARY KEY (calendar_week_id)
        </statement>
        <statement>          
            ALTER TABLE eam_calendar_week
                  ADD CONSTRAINT fkca4afc7cd1984a6 FOREIGN KEY (calendar_week_id) 
                  REFERENCES eam_calendar_ent(id)
        </statement>
      </schema-directSQL>
    </schemaSpec>
    
    <schemaSpec version="3.33">
      <schema-directSQL>
        <statement targetDB="postgresql">
            CREATE TABLE eam_role_calendar (
                id integer NOT NULL,
                version_col bigint DEFAULT 0 NOT NULL,
                role_id integer NOT NULL,
                calendar_id integer NOT NULL,
                caltype integer NOT NULL
            )            
        </statement>
        <statement targetDB="oracle">
            CREATE TABLE eam_role_calendar (
                id integer NOT NULL,
                version_col NUMBER(19, 0) NOT NULL,
                role_id integer NOT NULL,
                calendar_id integer NOT NULL,
                caltype integer NOT NULL
            )            
        </statement>
        <statement targetDB="postgresql">
             CREATE SEQUENCE eam_role_calendar_id_seq
                START WITH 10001
                INCREMENT BY 1
                NO MAXVALUE
                NO MINVALUE
                CACHE 1
        </statement>
        <statement targetDB="oracle">
             CREATE SEQUENCE eam_role_calendar_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
        </statement>
        <statement> 
          ALTER TABLE eam_role_calendar
              ADD CONSTRAINT eam_role_calendar_pkey PRIMARY KEY (id)
        </statement>
        <statement> 
          ALTER TABLE eam_role_calendar
              ADD CONSTRAINT eam_role_calendar_role_id_key UNIQUE (role_id, calendar_id, caltype)
        </statement>
        <statement> 
          CREATE INDEX calendar_role_idx ON eam_role_calendar (role_id)
        </statement>
        <statement> 
          ALTER TABLE eam_role_calendar
              ADD CONSTRAINT fkd703bc5999d737ae FOREIGN KEY (role_id) 
              REFERENCES eam_role(id) ON DELETE CASCADE
        </statement>
        <statement> 
          ALTER TABLE eam_role_calendar
              ADD CONSTRAINT fkd703bc59f8214d4d FOREIGN KEY (calendar_id) 
              REFERENCES eam_calendar(id)
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <!-- Remove the on delete cascade from monitorable type to templates -->
    <schemaSpec version="3.34">
      <schema-directSQL>
        <statement>
          ALTER TABLE eam_measurement_templ DROP CONSTRAINT fk253d707ef33c225 CASCADE
        </statement>
        <statement>
          ALTER TABLE eam_measurement_templ
            ADD CONSTRAINT fk253d707ef33c225 FOREIGN KEY (monitorable_type_id) 
            REFERENCES eam_monitorable_type(id)
        </statement>
      </schema-directSQL>
    </schemaSpec>
    
    <schemaSpec version="3.35">
        <schema-addColumn table="EAM_SUBJECT" column="HTML_EMAIL" 
                          columnType="BOOLEAN"/>
        <schema-update table="EAM_SUBJECT" column="HTML_EMAIL"
                       columnType="BOOLEAN" value="FALSE" />
        <schema-alterColumn table="EAM_SUBJECT" column="HTML_EMAIL" 
                            nullable="NOT NULL"/>
    </schemaSpec>
    
    <schemaSpec version="3.36">
        <schema-addColumn table="EAM_RESOURCE_GROUP" column="RESOURCE_ID" 
                          columnType="INTEGER"/>
        <schema-directSQL>
          <statement>
              update eam_resource_group set resource_id = (
                  select r.id from eam_resource r 
                  where r.resource_type_id = 3 and 
                        r.instance_id = eam_resource_group.id)
          </statement>
        </schema-directSQL>

        <schema-alterColumn table="EAM_RESOURCE_GROUP" column="RESOURCE_ID" 
                            nullable="NOT NULL"/>
    </schemaSpec>

    <schemaSpec version="3.37">
        <schema-addColumn table="EAM_GALERT_AUX_LOGS" column="DEF_ID" 
                          columnType="INTEGER"/>
        <schema-directSQL>
          <statement>
              update eam_galert_aux_logs set def_id = (
                  select l.def_id from eam_galert_logs l
                  where l.id = galert_id)
          </statement>
        </schema-directSQL>

        <schema-alterColumn table="EAM_GALERT_AUX_LOGS" column="DEF_ID" 
                            nullable="NOT NULL"/>
    </schemaSpec>

    <schemaSpec version="3.38">
      <schema-directSQL>
        <statement> 
          CREATE INDEX aux_log_def_idx on eam_galert_aux_logs (def_id)
        </statement>
        <statement>
          ALTER TABLE eam_galert_aux_logs DROP CONSTRAINT fke20899066993629f CASCADE
        </statement>
        <statement>
          ALTER TABLE eam_galert_aux_logs
            ADD CONSTRAINT fke20899066993629f FOREIGN KEY (parent) 
            REFERENCES eam_galert_aux_logs(id) ON DELETE CASCADE
        </statement>
        <statement>
          ALTER TABLE  eam_galert_aux_logs
            ADD CONSTRAINT fke2089906706267a5 FOREIGN KEY (def_id) 
            REFERENCES eam_galert_defs(id)
        </statement>
        <statement>
          ALTER TABLE eam_galert_aux_logs DROP CONSTRAINT fke2089906c7d09794 CASCADE
        </statement>
        <statement>
          ALTER TABLE eam_galert_aux_logs
            ADD CONSTRAINT fke2089906c7d09794 FOREIGN KEY (galert_id) 
            REFERENCES eam_galert_logs(id) ON DELETE CASCADE
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.39">
      <schema-addColumn table="EAM_METRIC_AUX_LOGS" column="DEF_ID" 
                        columnType="INTEGER"/>
      <schema-directSQL>
        <statement>
          update eam_metric_aux_logs set def_id = (
              select l.def_id from eam_galert_aux_logs l
              where l.id = aux_log_id)
        </statement>
      </schema-directSQL>

      <schema-alterColumn table="EAM_METRIC_AUX_LOGS" column="DEF_ID" 
                          nullable="NOT NULL"/>
      <schema-directSQL>
        <statement> 
          CREATE INDEX metric_aux_log_idx ON eam_metric_aux_logs (def_id)
        </statement>
        <statement>
          ALTER TABLE eam_metric_aux_logs
            ADD CONSTRAINT fke7d70b0b706267a5 FOREIGN KEY (def_id) 
            REFERENCES eam_galert_defs(id)
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.40">
      <schema-addColumn table="EAM_RESOURCE_AUX_LOGS" column="DEF_ID" 
                        columnType="INTEGER"/>
      <schema-directSQL>
        <statement>
          update eam_resource_aux_logs set def_id = (
              select l.def_id from eam_galert_aux_logs l
              where l.id = aux_log_id)
        </statement>
      </schema-directSQL>

      <schema-alterColumn table="EAM_RESOURCE_AUX_LOGS" column="DEF_ID" 
                          nullable="NOT NULL"/>
      <schema-directSQL>
        <statement> 
          CREATE INDEX rsrc_aux_log_idx ON eam_resource_aux_logs (def_id)
        </statement>
        <statement> 
          ALTER TABLE eam_resource_aux_logs
            ADD CONSTRAINT fk859d15ed706267a5 FOREIGN KEY (def_id) 
            REFERENCES eam_galert_defs(id)
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.41">
      <schema-directSQL>
        <statement> 
          ALTER TABLE eam_resource_group
            ADD CONSTRAINT fk6dbccdbcfc176ae FOREIGN KEY (resource_id) 
            REFERENCES eam_resource(id)
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.42">
        <schema-directSQL>
          <statement>CREATE INDEX METRIC_DATA_0D_0S_MID_IDX ON HQ_METRIC_DATA_0D_0S(MEASUREMENT_ID)</statement>
          <statement>CREATE INDEX METRIC_DATA_0D_1S_MID_IDX ON HQ_METRIC_DATA_0D_1S(MEASUREMENT_ID)</statement>
          <statement>CREATE INDEX METRIC_DATA_1D_0S_MID_IDX ON HQ_METRIC_DATA_1D_0S(MEASUREMENT_ID)</statement>
          <statement>CREATE INDEX METRIC_DATA_1D_1S_MID_IDX ON HQ_METRIC_DATA_1D_1S(MEASUREMENT_ID)</statement>
          <statement>CREATE INDEX METRIC_DATA_2D_0S_MID_IDX ON HQ_METRIC_DATA_2D_0S(MEASUREMENT_ID)</statement>
          <statement>CREATE INDEX METRIC_DATA_2D_1S_MID_IDX ON HQ_METRIC_DATA_2D_1S(MEASUREMENT_ID)</statement>
          <statement>CREATE INDEX METRIC_DATA_3D_0S_MID_IDX ON HQ_METRIC_DATA_3D_0S(MEASUREMENT_ID)</statement>
          <statement>CREATE INDEX METRIC_DATA_3D_1S_MID_IDX ON HQ_METRIC_DATA_3D_1S(MEASUREMENT_ID)</statement>
          <statement>CREATE INDEX METRIC_DATA_4D_0S_MID_IDX ON HQ_METRIC_DATA_4D_0S(MEASUREMENT_ID)</statement>
          <statement>CREATE INDEX METRIC_DATA_4D_1S_MID_IDX ON HQ_METRIC_DATA_4D_1S(MEASUREMENT_ID)</statement>
          <statement>CREATE INDEX METRIC_DATA_5D_0S_MID_IDX ON HQ_METRIC_DATA_5D_0S(MEASUREMENT_ID)</statement>
          <statement>CREATE INDEX METRIC_DATA_5D_1S_MID_IDX ON HQ_METRIC_DATA_5D_1S(MEASUREMENT_ID)</statement>
          <statement>CREATE INDEX METRIC_DATA_6D_0S_MID_IDX ON HQ_METRIC_DATA_6D_0S(MEASUREMENT_ID)</statement>
          <statement>CREATE INDEX METRIC_DATA_6D_1S_MID_IDX ON HQ_METRIC_DATA_6D_1S(MEASUREMENT_ID)</statement>
          <statement>CREATE INDEX METRIC_DATA_7D_0S_MID_IDX ON HQ_METRIC_DATA_7D_0S(MEASUREMENT_ID)</statement>
          <statement>CREATE INDEX METRIC_DATA_7D_1S_MID_IDX ON HQ_METRIC_DATA_7D_1S(MEASUREMENT_ID)</statement>
          <statement>CREATE INDEX METRIC_DATA_8D_0S_MID_IDX ON HQ_METRIC_DATA_8D_0S(MEASUREMENT_ID)</statement>
          <statement>CREATE INDEX METRIC_DATA_8D_1S_MID_IDX ON HQ_METRIC_DATA_8D_1S(MEASUREMENT_ID)</statement>
        </schema-directSQL>
    </schemaSpec>
	
    <schemaSpec version="3.43">
        <schema-directSQL>
		  <statement desc="Create new index for alert_definition_id in eam_action for faster lookup of an alert definitions actions.">
			CREATE INDEX ACTION_ALERT_DEFINITION_ID_IDX ON EAM_ACTION ( ALERT_DEFINITION_ID )
		  </statement>			
        </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.44">
        <schema-directSQL>
        <statement targetDB="postgresql">ALTER TABLE QRTZ_BLOB_TRIGGERS DROP CONSTRAINT eam_qrtz_blob_triggers_pkey CASCADE</statement>
        <statement targetDB="oracle">ALTER TABLE QRTZ_BLOB_TRIGGERS DROP PRIMARY KEY CASCADE</statement>
        <statement>ALTER TABLE QRTZ_BLOB_TRIGGERS ADD CONSTRAINT qrtz_blob_triggers_pkey PRIMARY KEY (trigger_name, trigger_group)</statement>
        <statement targetDB="postgresql">ALTER TABLE QRTZ_CALENDARS DROP CONSTRAINT eam_qrtz_calendars_pkey CASCADE</statement>
        <statement targetDB="oracle">ALTER TABLE QRTZ_CALENDARS DROP PRIMARY KEY CASCADE</statement>
        <statement>ALTER TABLE QRTZ_CALENDARS ADD CONSTRAINT qrtz_calendars_pkey PRIMARY KEY (calendar_name)</statement>
        <statement targetDB="postgresql">ALTER TABLE QRTZ_CRON_TRIGGERS DROP CONSTRAINT eam_qrtz_cron_triggers_pkey CASCADE</statement>
        <statement targetDB="oracle">ALTER TABLE QRTZ_CRON_TRIGGERS DROP PRIMARY KEY CASCADE</statement>
        <statement>ALTER TABLE QRTZ_CRON_TRIGGERS ADD CONSTRAINT qrtz_cron_triggers_pkey PRIMARY KEY (trigger_name, trigger_group)</statement>
        <statement targetDB="postgresql">ALTER TABLE QRTZ_FIRED_TRIGGERS DROP CONSTRAINT eam_qrtz_fired_triggers_pkey CASCADE</statement>
        <statement targetDB="oracle">ALTER TABLE QRTZ_FIRED_TRIGGERS DROP PRIMARY KEY CASCADE</statement>
        <statement>ALTER TABLE QRTZ_FIRED_TRIGGERS ADD CONSTRAINT qrtz_fired_triggers_pkey PRIMARY KEY (entry_id)</statement>
        <statement targetDB="postgresql">ALTER TABLE QRTZ_JOB_DETAILS DROP CONSTRAINT eam_qrtz_job_details_pkey CASCADE</statement>
        <statement targetDB="oracle">ALTER TABLE QRTZ_JOB_DETAILS DROP PRIMARY KEY CASCADE</statement>
        <statement>ALTER TABLE QRTZ_JOB_DETAILS ADD CONSTRAINT qrtz_job_details_pkey PRIMARY KEY (job_name, job_group)</statement>
        <statement targetDB="postgresql">ALTER TABLE QRTZ_JOB_LISTENERS DROP CONSTRAINT eam_qrtz_job_listeners_pkey CASCADE</statement>
        <statement targetDB="oracle">ALTER TABLE QRTZ_JOB_LISTENERS DROP PRIMARY KEY CASCADE</statement>
        <statement>ALTER TABLE QRTZ_JOB_LISTENERS ADD CONSTRAINT qrtz_job_listeners_pkey PRIMARY KEY (job_name, job_group, job_listener)</statement>
        <statement targetDB="postgresql">ALTER TABLE QRTZ_LOCKS DROP CONSTRAINT eam_qrtz_locks_pkey CASCADE</statement>
        <statement targetDB="oracle">ALTER TABLE QRTZ_LOCKS DROP PRIMARY KEY CASCADE</statement>
        <statement>ALTER TABLE QRTZ_LOCKS ADD CONSTRAINT qrtz_locks_pkey PRIMARY KEY (lock_name)</statement>
        <statement targetDB="postgresql">ALTER TABLE QRTZ_PAUSED_TRIGGER_GRPS DROP CONSTRAINT eam_qrtz_paused_trigger_grps_pkey CASCADE</statement>
        <statement targetDB="oracle">ALTER TABLE QRTZ_PAUSED_TRIGGER_GRPS DROP PRIMARY KEY CASCADE</statement>
        <statement>ALTER TABLE QRTZ_PAUSED_TRIGGER_GRPS ADD CONSTRAINT qrtz_paused_trigger_grps_pkey PRIMARY KEY (trigger_group)</statement>
        <statement targetDB="postgresql">ALTER TABLE QRTZ_SCHEDULER_STATE DROP CONSTRAINT eam_qrtz_scheduler_state_pkey CASCADE</statement>
        <statement targetDB="oracle">ALTER TABLE QRTZ_SCHEDULER_STATE DROP PRIMARY KEY CASCADE</statement>
        <statement>ALTER TABLE QRTZ_SCHEDULER_STATE ADD CONSTRAINT qrtz_scheduler_state_pkey PRIMARY KEY (instance_name)</statement>
        <statement targetDB="postgresql">ALTER TABLE QRTZ_SIMPLE_TRIGGERS DROP CONSTRAINT eam_qrtz_simple_triggers_pkey CASCADE</statement>
        <statement targetDB="oracle">ALTER TABLE QRTZ_SIMPLE_TRIGGERS DROP PRIMARY KEY CASCADE</statement>
        <statement>ALTER TABLE QRTZ_SIMPLE_TRIGGERS ADD CONSTRAINT qrtz_simple_triggers_pkey PRIMARY KEY (trigger_name, trigger_group)</statement>
        <statement targetDB="postgresql">ALTER TABLE QRTZ_TRIGGER_LISTENERS DROP CONSTRAINT eam_qrtz_trigger_listeners_pkey CASCADE</statement>
        <statement targetDB="oracle">ALTER TABLE QRTZ_TRIGGER_LISTENERS DROP PRIMARY KEY CASCADE</statement>
        <statement>ALTER TABLE QRTZ_TRIGGER_LISTENERS ADD CONSTRAINT qrtz_trigger_listeners_pkey PRIMARY KEY (trigger_name, trigger_group, trigger_listener)</statement>
        <statement targetDB="postgresql">ALTER TABLE QRTZ_TRIGGERS DROP CONSTRAINT eam_qrtz_triggers_pkey CASCADE</statement>
        <statement targetDB="oracle">ALTER TABLE QRTZ_TRIGGERS DROP PRIMARY KEY CASCADE</statement>
        <statement>ALTER TABLE QRTZ_TRIGGERS ADD CONSTRAINT qrtz_triggers_pkey PRIMARY KEY (trigger_name, trigger_group)</statement>
        </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.45">
        <schema-directSQL>
          <statement targetDB="oracle" fail="false">ALTER TABLE EAM_ALERT_ACTION_LOG MODIFY DETAIL NULL</statement>
        </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.46">
      <schema-addColumn table="EAM_ALERT_DEFINITION" column="LAST_FIRED" 
                        columnType="LONG"/>
    </schemaSpec>

    <schemaSpec version="3.47">
      <schema-addColumn table="EAM_GALERT_DEFS" column="LAST_FIRED" 
                        columnType="LONG"/>
    </schemaSpec>
    
    <schemaSpec version="3.48">
      <schema-directSQL>
        <statement>
          update eam_gtrigger_types set type_class = 'org.hyperic.hq.measurement.galerts.MeasurementGtriggerType'
                 where type_class = 'org.hyperic.hq.galerts.triggers.measurement.MeasurementGtriggerType'
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.49">
      <metricDataUpgrade/>
    </schemaSpec>

    <schemaSpec version="3.50">
        <schema-addColumn table="EAM_CONTROL_HISTORY"
                          column="VERSION_COL" columnType="LONG">
           <initializer>
             UPDATE EAM_CONTROL_HISTORY SET VERSION_COL=0
           </initializer>
         </schema-addColumn>
    </schemaSpec>

    <schemaSpec version="3.51">
      <schema-directSQL>
        <statement targetDB="oracle" fail="false">
            ALTER TABLE EAM_GALERT_AUX_LOGS RENAME COLUMN "timestamp" TO "TIMESTAMP"
        </statement>
      </schema-directSQL>
    </schemaSpec>
    
    <schemaSpec version="3.51.1">
      <schema-directSQL>
        <statement>
          ALTER TABLE eam_svc_cluster
            ADD CONSTRAINT fk39da6ecdcce79ab8 FOREIGN KEY (group_id) 
            REFERENCES eam_resource_group(id)
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.51.2">
      <schema-directSQL>
        <statement>
			    CREATE INDEX EVENT_CTIME_IDX ON EAM_EVENT ( CTIME )
        </statement>
      </schema-directSQL>
    </schemaSpec>

    <schemaSpec version="3.51.3">
      <schema-directSQL>
        <statement targetDB="oracle">
             CREATE SEQUENCE eam_metric_aux_log_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
        </statement>
        <statement targetDB="oracle">
            DROP SEQUENCE eam_metric_aux_logs_id_seq
        </statement>
      </schema-directSQL>
    </schemaSpec>
    
	<schemaSpec version="3.51.4">
        <schema-directSQL>
		  <statement desc="Create new index for timestamp in eam_event_log for faster deletion of old event logs.">
			CREATE INDEX EVENT_LOG_TIMESTAMP_IDX ON EAM_EVENT_LOG ( TIMESTAMP )
		  </statement>			
        </schema-directSQL>
    </schemaSpec>   

    <schemaSpec version="3.52">
      <schema-directSQL>
        <statement targetDB="postgresql">
            CREATE TABLE eam_dash_config (
                id integer NOT NULL,
                config_type character varying(255) NOT NULL,
                version_col bigint DEFAULT 0 NOT NULL,
                name character varying(255) NOT NULL,
                crispo_id integer NOT NULL,
                role_id integer,
                user_id integer
            )            
        </statement>
        <statement targetDB="postgresql">
            CREATE SEQUENCE eam_dash_config_id_seq
                START WITH 10001
                INCREMENT BY 1
                NO MAXVALUE
                NO MINVALUE
                CACHE 1
        </statement>
        <statement targetDB="oracle">
            CREATE TABLE eam_dash_config (
                id integer NOT NULL,
                config_type VARCHAR2(255) NOT NULL,
                version_col NUMBER(19, 0) default 0 NOT NULL,
                name VARCHAR2(255) NOT NULL,
                crispo_id integer NOT NULL,
                role_id integer,
                user_id integer
            )            
        </statement>
        <statement targetDB="oracle">
             CREATE SEQUENCE eam_dash_config_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
        </statement>
        <statement>        
            ALTER TABLE eam_dash_config
                ADD CONSTRAINT eam_dash_config_pkey PRIMARY KEY (id)
        </statement>        
        <statement>        
            ALTER TABLE eam_dash_config
                ADD CONSTRAINT fk1ef56c811a5420bd FOREIGN KEY (user_id) REFERENCES eam_subject(id)
        </statement>        
        <statement>        
            ALTER TABLE eam_dash_config
                ADD CONSTRAINT fk1ef56c816364efcd FOREIGN KEY (crispo_id) REFERENCES eam_crispo(id)
        </statement>        
        <statement>        
            ALTER TABLE eam_dash_config
                ADD CONSTRAINT fk1ef56c8199d737ae FOREIGN KEY (role_id) REFERENCES eam_role(id)
        </statement>
      </schema-directSQL>
    </schemaSpec>
    
    <schemaSpec version="3.53">
      <schema-alterColumn table="EAM_CRISPO_OPT" column="VAL" precision="4000"
                          columnType="VARCHAR2" nullable="NULL"/>
      <schema-directSQL>
        <statement desc="Creating new EAM_CRISPO_ARRAY table">
          create table EAM_CRISPO_ARRAY (
            OPT_ID int not null,
            VAL varchar (512) not null,
            IDX int not null,
            primary key (OPT_ID, IDX)
          )
        </statement>
      </schema-directSQL>
    </schemaSpec>
    
    <schemaSpec version="3.54">
      <schema-addColumn table="EAM_USER_CONFIG_RESP" column="TMP_CRISPO_ID" 
                        columnType="LONG"/>
      <crisponizer table="eam_user_config_resp" column="pref_response"
                   crispoColumn="TMP_CRISPO_ID" onlyProperties=".dash[cC]ontent.*"
                   rewriteConfigResponse="true"/>
      
      <schema-directSQL>
        <statement>
          insert into eam_dash_config (id, config_type, version_col, name, crispo_id, user_id) 
              select id - 9000, 'USER', 0, 'user', tmp_crispo_id, id from eam_user_config_resp where id > 10
        </statement>
        <statement>
          insert into eam_dash_config (id, config_type, version_col, name, crispo_id, user_id) 
              select 1000, 'USER', 0, 'user', tmp_crispo_id, id from eam_user_config_resp where id = 1
        </statement>
        <statement>
          update eam_dash_config set name = (
              select name from eam_subject s where s.id = eam_dash_config.user_id
          ) where user_id is not null
        </statement>
      </schema-directSQL>
    </schemaSpec>
    
    <schemaSpec version="3.55">
      <!-- Migrate the rest of the user's config response to a crispo -->
      <crisponizer table="eam_user_config_resp" column="pref_response"
                   crispoColumn="TMP_CRISPO_ID" />
      <schema-addColumn table="EAM_SUBJECT" column="PREF_CRISPO_ID" 
                        columnType="LONG"/>
      <schema-directSQL>
        <statement>
          update eam_subject set pref_crispo_id = (
              select tmp_crispo_id from eam_user_config_resp r where r.id = eam_subject .id)
        </statement>
        <statement>
          drop table eam_user_config_resp  
        </statement>
      </schema-directSQL>                        
    </schemaSpec>

    <schemaSpec version="3.56">
      <schema-insert table="EAM_RESOURCE"
                     insertCmd="(ID, VERSION_COL, RESOURCE_TYPE_ID, INSTANCE_ID, CID, SUBJECT_ID, FSYSTEM) VALUES (501, 0, 0, 501, 501, 0, %%FALSE%%)"/>
      <schema-insert table="EAM_RESOURCE_TYPE"
                     insertCmd="(ID, VERSION_COL, NAME, CID, RESOURCE_ID, FSYSTEM) VALUES (501, 0, 'HQSystem', 501, 501, %%FALSE%%)"/>
      <schema-insert table="EAM_RES_GRP_RES_MAP"
                     insertCmd="(RESOURCE_GROUP_ID, RESOURCE_ID, CID) VALUES (0, 501, 7)"/>
    </schemaSpec>

    <schemaSpec version="3.57">
      <schema-directSQL>
        <statement targetDB="postgresql">
            CREATE TABLE eam_audit (
                id integer NOT NULL,
                klazz character varying(20) NOT NULL,
                version_col bigint DEFAULT 0 NOT NULL,
                start_time bigint NOT NULL,
                end_time bigint NOT NULL,
                nature integer NOT NULL,
                purpose integer NOT NULL,
                importance integer NOT NULL,
                original boolean NOT NULL,
                field character varying(30),
                old_val character varying(1000),
                new_val character varying(1000),
                message character varying(1000) NOT NULL,
                parent_id integer,
                resource_id integer NOT NULL,
                subject_id integer NOT NULL
            )
        </statement>
        <statement targetDB="postgresql">
            CREATE SEQUENCE eam_audit_id_seq
                START WITH 10001
                INCREMENT BY 1
                NO MAXVALUE
                NO MINVALUE
                CACHE 1
        </statement>
        <statement targetDB="oracle">
            CREATE TABLE eam_audit (
                id integer NOT NULL,
                klazz VARCHAR2(20) NOT NULL,
                version_col NUMBER(19, 0) NOT NULL,
                start_time NUMBER(19, 0) NOT NULL,
                end_time NUMBER(19, 0) NOT NULL,
                nature integer NOT NULL,
                purpose integer NOT NULL,
                importance integer NOT NULL,
                original NUMBER(1) NOT NULL,
                field VARCHAR2(30),
                old_val VARCHAR2(1000),
                new_val VARCHAR2(1000),
                message VARCHAR2(1000) NOT NULL,
                parent_id integer,
                resource_id integer NOT NULL,
                subject_id integer NOT NULL
            )
        </statement>
        <statement targetDB="oracle">
             CREATE SEQUENCE eam_audit_id_seq
                START WITH 10001
                INCREMENT BY 1
                NOMAXVALUE
                NOCYCLE
                CACHE 10
        </statement>
        <statement>
            ALTER TABLE eam_audit ADD CONSTRAINT eam_audit_pkey PRIMARY KEY (id)
        </statement>
        <statement>
            CREATE INDEX parent_id_idx ON eam_audit (parent_id)
        </statement>
        <statement>
            CREATE INDEX resource_id_idx ON eam_audit (resource_id)
        </statement>
        <statement>
            CREATE INDEX subject_id_idx ON eam_audit (subject_id)
        </statement>
        <statement>
            ALTER TABLE eam_audit
               ADD CONSTRAINT fke5b6292dc81f5938 FOREIGN KEY (parent_id) 
               REFERENCES eam_audit(id)
        </statement>
        <statement>
            ALTER TABLE eam_audit
                ADD CONSTRAINT fke5b6292de82fbc FOREIGN KEY (subject_id) 
                REFERENCES eam_subject(id)
        </statement>
        <statement>
            ALTER TABLE eam_audit
                ADD CONSTRAINT fke5b6292dfc176ae FOREIGN KEY (resource_id) 
                REFERENCES eam_resource(id)
        </statement>
      </schema-directSQL>                        
    </schemaSpec>

    <schemaSpec version="3.57.1">
      <removeOrphanedResources/>
    </schemaSpec>

    <schemaSpec version="3.58">
      <schema-addColumn table="EAM_RESOURCE" column="PROTO_ID" 
                        columnType="INTEGER"/>

      <!-- Resource types, associated with prototypes -->
      <schema-insert table="EAM_RESOURCE"
                     insertCmd="(ID, CID, INSTANCE_ID, RESOURCE_TYPE_ID, SUBJECT_ID, PROTO_ID, FSYSTEM) VALUES (601, 601, 601, 0, 0, 0, %%TRUE%%)"/>
      <schema-insert table="EAM_RESOURCE"
                     insertCmd="(ID, CID, INSTANCE_ID, RESOURCE_TYPE_ID, SUBJECT_ID, PROTO_ID, FSYSTEM) VALUES (602, 602, 602, 0, 0, 0, %%TRUE%%)"/>
      <schema-insert table="EAM_RESOURCE"
                     insertCmd="(ID, CID, INSTANCE_ID, RESOURCE_TYPE_ID, SUBJECT_ID, PROTO_ID, FSYSTEM) VALUES (603, 603, 603, 0, 0, 0, %%TRUE%%)"/>
      <schema-insert table="EAM_RESOURCE"
                     insertCmd="(ID, CID, INSTANCE_ID, RESOURCE_TYPE_ID, SUBJECT_ID, PROTO_ID, FSYSTEM) VALUES (604, 604, 604, 0, 0, 0, %%TRUE%%)"/>
      <schema-insert table="EAM_RES_GRP_RES_MAP"
                     insertCmd="(RESOURCE_GROUP_ID, RESOURCE_ID, CID) VALUES (0, 601, 8)"/>
      <schema-insert table="EAM_RES_GRP_RES_MAP"
                     insertCmd="(RESOURCE_GROUP_ID, RESOURCE_ID, CID) VALUES (0, 602, 9)"/>
      <schema-insert table="EAM_RES_GRP_RES_MAP"
                     insertCmd="(RESOURCE_GROUP_ID, RESOURCE_ID, CID) VALUES (0, 603, 10)"/>
      <schema-insert table="EAM_RES_GRP_RES_MAP"
                     insertCmd="(RESOURCE_GROUP_ID, RESOURCE_ID, CID) VALUES (0, 604, 11)"/>
      
      <schema-directSQL>
        <statement>
            update eam_resource set proto_id = 0
        </statement>
      </schema-directSQL>
      
      <schema-insert table="EAM_RESOURCE_TYPE"
                     insertCmd="(ID, VERSION_COL, NAME, CID, RESOURCE_ID, FSYSTEM) VALUES (601, 0, 'PlatformPrototype', 601, 601, %%TRUE%%)"/>
      <schema-insert table="EAM_RESOURCE_TYPE"
                     insertCmd="(ID, VERSION_COL, NAME, CID, RESOURCE_ID, FSYSTEM) VALUES (602, 0, 'ServerPrototype', 602, 602, %%TRUE%%)"/>
      <schema-insert table="EAM_RESOURCE_TYPE"
                     insertCmd="(ID, VERSION_COL, NAME, CID, RESOURCE_ID, FSYSTEM) VALUES (603, 0, 'ServicePrototype', 603, 603, %%TRUE%%)"/>
      <schema-insert table="EAM_RESOURCE_TYPE"
                     insertCmd="(ID, VERSION_COL, NAME, CID, RESOURCE_ID, FSYSTEM) VALUES (604, 0, 'ApplicationPrototype', 604, 604, %%TRUE%%)"/>

      <!-- Prototypes for apps get inserted manually -->
      <schema-insert table="EAM_RESOURCE"
                     insertCmd="(ID, CID, INSTANCE_ID, RESOURCE_TYPE_ID, SUBJECT_ID, PROTO_ID, FSYSTEM) VALUES (1600, 1600, 1, 604, 0, 0, %%TRUE%%)"/>
      <schema-insert table="EAM_RESOURCE"
                     insertCmd="(ID, CID, INSTANCE_ID, RESOURCE_TYPE_ID, SUBJECT_ID, PROTO_ID, FSYSTEM) VALUES (1601, 1601, 2, 604, 0, 0, %%TRUE%%)"/>

      <schema-directSQL>
        <statement targetDB="oracle">
            insert into eam_resource (id, version_col, resource_type_id, instance_id, cid, subject_id, proto_id, name, sort_name, fsystem)
            select (select count(*) from eam_platform_type st2 where st2.id &lt; st1.id) + 9000 as id,
            0, 601, id, id, 0, 0, name, sort_name, 1
            from eam_platform_type st1
        </statement>
        <statement targetDB="postgresql">
            insert into eam_resource (id, version_col, resource_type_id, instance_id, cid, subject_id, proto_id, name, sort_name, fsystem)
            select (select count(*) from eam_platform_type st2 where st2.id &lt; st1.id) + 9000 as id,
            0, 601, id, id, 0, 0, name, sort_name, true
            from eam_platform_type st1
        </statement>
        <statement targetDB="oracle">
            insert into eam_resource (id, version_col, resource_type_id, instance_id, cid, subject_id, proto_id, name, sort_name, fsystem)
            select (select count(*) from eam_server_type st2 where st2.id &lt; st1.id) + 7000 as id,
            0, 602, id, id, 0, 0, name, sort_name, 1
            from eam_server_type st1
        </statement>
        <statement targetDB="postgresql">
            insert into eam_resource (id, version_col, resource_type_id, instance_id, cid, subject_id, proto_id, name, sort_name, fsystem)
            select (select count(*) from eam_server_type st2 where st2.id &lt; st1.id) + 7000 as id,
            0, 602, id, id, 0, 0, name, sort_name, true
            from eam_server_type st1
        </statement>
        <statement targetDB="oracle">
            insert into eam_resource (id, version_col, resource_type_id, instance_id, cid, subject_id, proto_id, name, sort_name, fsystem)
            select (select count(*) from eam_service_type st2 where st2.id &lt; st1.id) + 5000 as id,
            0, 603, id, id, 0, 0, name, sort_name, 1
            from eam_service_type st1
        </statement>
        <statement targetDB="postgresql">
            insert into eam_resource (id, version_col, resource_type_id, instance_id, cid, subject_id, proto_id, name, sort_name, fsystem)
            select (select count(*) from eam_service_type st2 where st2.id &lt; st1.id) + 5000 as id,
            0, 603, id, id, 0, 0, name, sort_name, true
            from eam_service_type st1
        </statement>

        <statement>
            update eam_resource set proto_id = (
                select proto.id from eam_platform p
                join eam_platform_type pt on pt.id = p.platform_type_id
                join eam_resource proto on proto.resource_type_id = 601 and proto.instance_id = pt.id
                where p.id = eam_resource.instance_id)
            where eam_resource.resource_type_id = 301
        </statement>
        <statement>
            update eam_resource set proto_id = (
                select proto.id from eam_server s
                join eam_server_type st on st.id = s.server_type_id
                join eam_resource proto on proto.resource_type_id = 602 and proto.instance_id = st.id
                where s.id = eam_resource.instance_id)
            where eam_resource.resource_type_id = 303
        </statement>
        <statement>
            update eam_resource set proto_id = (
                select proto.id from eam_service s
                join eam_service_type st on st.id = s.service_type_id
                join eam_resource proto on proto.resource_type_id = 603 and proto.instance_id = st.id
                where s.id = eam_resource.instance_id)
            where eam_resource.resource_type_id = 305
        </statement>
        <statement>
            update eam_resource set proto_id = (
                select proto.id from eam_application a
                join eam_application_type at on at.id = a.application_type_id
                join eam_resource proto on proto.resource_type_id = 604 and proto.instance_id = at.id
                where a.id = eam_resource.instance_id)
            where eam_resource.resource_type_id = 308
        </statement>
      </schema-directSQL>                        
      <schema-alterColumn table="EAM_RESOURCE" column="PROTO_ID" 
                          nullable="NOT NULL"/>
    </schemaSpec>
    
    <schemaSpec version="3.59">
      <schema-directSQL>
        <statement>
          CREATE INDEX eam_resource_proto_idx ON eam_resource (proto_id)
        </statement>
        <statement>
          ALTER TABLE eam_resource
              ADD CONSTRAINT fk7ac0e15c8b366a94 FOREIGN KEY (proto_id) REFERENCES eam_resource(id)
        </statement>
      </schema-directSQL>
    </schemaSpec>
    
    <schemaSpec version="3.60">
      <schema-directSQL>
        <statement targetDB="postgresql">
          CREATE TABLE eam_ui_attach_rsrc (
              attach_id integer NOT NULL,
              resource_id integer NOT NULL,
              category character varying(255) NOT NULL)
        </statement>
        <statement targetDB="oracle">
          CREATE TABLE eam_ui_attach_rsrc (
              attach_id integer NOT NULL,
              resource_id integer NOT NULL,
              category VARCHAR2(255) NOT NULL)
        </statement>
        <statement>
          ALTER TABLE eam_ui_attach_rsrc
            ADD CONSTRAINT eam_ui_attach_rsrc_pkey PRIMARY KEY (attach_id)
        </statement>
        <statement>
          ALTER TABLE eam_ui_attach_rsrc
            ADD CONSTRAINT fkd9f7a78fd494bca6 FOREIGN KEY (attach_id) 
            REFERENCES eam_ui_attachment(id) ON DELETE CASCADE
        </statement>
        <statement>
          ALTER TABLE eam_ui_attach_rsrc
           ADD CONSTRAINT fkd9f7a78ffc176ae  FOREIGN KEY (resource_id) 
           REFERENCES eam_resource(id)
        </statement>
      </schema-directSQL>
    </schemaSpec>
      
    <schemaSpec version="3.61">
      <schema-directSQL>
        <statement>
          CREATE TABLE eam_ui_view_resource (
              view_id integer NOT NULL)
        </statement>
        <statement>
          ALTER TABLE eam_ui_view_resource
              ADD CONSTRAINT eam_ui_view_resource_pkey PRIMARY KEY (view_id)
        </statement>
        <statement>
          ALTER TABLE eam_ui_view_resource
              ADD CONSTRAINT fka416a54bf6253048 FOREIGN KEY (view_id) 
              REFERENCES eam_ui_view(id) ON DELETE CASCADE
        </statement>
      </schema-directSQL>
    </schemaSpec>
    
    <schemaSpec version="3.62">
      <schema-directSQL>
        <statement targetDB="postgresql">
          CREATE TABLE eam_ui_attach_mast (
              attach_id integer NOT NULL,
              category character varying(255) NOT NULL)
        </statement>
        <statement targetDB="oracle">
          CREATE TABLE eam_ui_attach_mast (
              attach_id integer NOT NULL,
              category VARCHAR2(255) NOT NULL)
        </statement>
        <statement>
          ALTER TABLE eam_ui_attach_mast
              ADD CONSTRAINT eam_ui_attach_mast_pkey PRIMARY KEY (attach_id)
        </statement>
        <statement>
          ALTER TABLE eam_ui_attach_mast
              ADD CONSTRAINT fkd9f51e52d494bca6 FOREIGN KEY (attach_id) 
              REFERENCES eam_ui_attachment(id) ON DELETE CASCADE
        </statement>
      </schema-directSQL>
    </schemaSpec>
    
    <schemaSpec version="3.63">
      <schema-directSQL>
        <statement>
          insert into eam_ui_attach_mast (attach_id, category) 
          select eam_ui_attachment.id, 'tracker' from eam_ui_attachment 
            join eam_ui_view on view_id = eam_ui_view.id 
          where eam_ui_view.description = 'Alert Center'
        </statement>
      </schema-directSQL>
    </schemaSpec>
    
    <schemaSpec version="3.64">
      <schema-directSQL>
        <statement>
          ALTER TABLE EAM_UI_PLUGIN DROP COLUMN DESCRIPTION
        </statement>
      </schema-directSQL>
    </schemaSpec>
    
    <schemaSpec version="3.65">
      <schema-directSQL>
        <statement targetDB="postgresql">
          CREATE TABLE eam_ui_attach_admin (
              attach_id integer NOT NULL,
              category character varying(255) NOT NULL)
        </statement>
        <statement targetDB="oracle">
          CREATE TABLE eam_ui_attach_admin (
              attach_id integer NOT NULL,
              category VARCHAR2(255) NOT NULL)
        </statement>
        <statement>
          ALTER TABLE eam_ui_attach_admin
              ADD CONSTRAINT eam_ui_attach_admin_pkey PRIMARY KEY (attach_id)
        </statement>
        <statement>
          ALTER TABLE eam_ui_attach_admin
              ADD CONSTRAINT fk6406d772d494bca6 FOREIGN KEY (attach_id) 
              REFERENCES eam_ui_attachment(id) ON DELETE CASCADE
        </statement>
      </schema-directSQL>
    </schemaSpec>
	
    <schemaSpec version="3.66">
      <schema-directSQL>
        <statement desc="Dropping unique constraint for EAM_SERVICE_REQUEST"
                   targetDB="postgresql">
          ALTER table EAM_SERVICE_REQUEST DROP constraint eam_service_request_serviceid_key
        </statement>
        <statement desc="Dropping unique constraint for EAM_SERVICE_REQUEST"
                   targetDB="oracle">
          ALTER table EAM_SERVICE_REQUEST DROP unique (serviceid, url)
        </statement>
      </schema-directSQL>
    </schemaSpec>	
	
    <schemaSpec version="3.67">
      <schema-directSQL>
		<statement desc="Dropping unnecessary index from eam_role_calendar">
		  DROP INDEX calendar_role_idx
		</statement>		  
		<statement desc="Dropping unnecessary index from eam_operation">
		  DROP INDEX eam_opname_idx
		</statement>	
		<statement desc="Dropping unnecessary index from eam_resource">
		  DROP INDEX eam_resource_idx_type_idx
		</statement>			  		  
		<statement desc="Dropping unnecessary index from eam_server">
		  DROP INDEX eam_server_platform_idx
		</statement>		  
		<statement desc="Dropping unnecessary index from eam_event_log">
		  DROP INDEX event_log_timestamp_idx
		</statement>		  
		<statement desc="Dropping unnecessary index from eam_measurement_bl">
		  DROP INDEX metric_baseline_idx
		</statement>		  
		<statement desc="Dropping unnecessary index from eam_metric_prob">
		  DROP INDEX metric_prob_id_idx
		</statement>		  
		<statement desc="Dropping unnecessary index from eam_monitorable_type">
		  DROP INDEX mtype_idx_appdeftype_idx
		</statement>		  
		<statement desc="Dropping unnecessary index from eam_measurement_templ">
		  DROP INDEX templ_monitorable_type_idx
		</statement>			  
		  
		<statement desc="Dropping index from eam_autoinv_schedule to reorder columns">
		  DROP INDEX ai_schedule_entity_idx
		</statement>		  
		<statement desc="Create index for eam_autoinv_schedule with highest cardinality column first" 
				   targetDB="oracle">
		  CREATE INDEX ai_schedule_entity_idx ON eam_autoinv_schedule ( entity_id, entity_type )				  
        </statement>		  
		<statement desc="Create index for eam_autoinv_schedule with highest cardinality column first" 
				   targetDB="postgresql">	
		  CREATE INDEX ai_schedule_entity_idx ON eam_autoinv_schedule USING btree ( entity_id, entity_type )				  
        </statement>

		<statement desc="Dropping index from eam_control_schedule to reorder columns">
		  DROP INDEX ctl_schedule_entity_idx
		</statement>		  
		<statement desc="Create index for eam_control_schedule with columns ordered highest cardinality first" 
				   targetDB="oracle">
		  CREATE INDEX ctl_schedule_entity_idx ON eam_control_schedule ( entity_id, entity_type )							  
        </statement>		  
		<statement desc="Create index for eam_control_schedule with columns ordered highest cardinality first" 
				   targetDB="postgresql">
		  CREATE INDEX ctl_schedule_entity_idx ON eam_control_schedule USING btree ( entity_id, entity_type )			  
        </statement>		  		  
				  
		<statement desc="Dropping index from eam_event_log to reorder columns">
		  DROP INDEX event_log_idx
		</statement>		  
		<statement desc="Create index for eam_event_log with columns ordered highest cardinality first" 
				   targetDB="oracle">
		  CREATE INDEX event_log_idx ON eam_event_log ( timestamp, entity_id, entity_type )									  
        </statement>		  
		<statement desc="Create index for eam_event_log with columns ordered highest cardinality first" 
				   targetDB="postgresql">
		  CREATE INDEX event_log_idx ON eam_event_log USING btree ( timestamp, entity_id, entity_type )			  
        </statement>
		  
		<statement desc="Dropping index from eam_escalation_state to reorder columns">
		  DROP INDEX state_idx
		</statement>		  
		<statement desc="Create index for eam_escalation_state with columns ordered highest cardinality first" 
				   targetDB="oracle">
		  CREATE INDEX state_idx ON eam_escalation_state ( alert_def_id, alert_type )					
        </statement>		  
		<statement desc="Create index for eam_escalation_state with columns ordered highest cardinality first" 
				   targetDB="postgresql">
		  CREATE INDEX state_idx ON eam_escalation_state USING btree ( alert_def_id, alert_type )		
        </statement>
		  
		<statement desc="Dropping index from eam_measurement_templ since we do not need to index monitorable_type_id">
		  DROP INDEX templ_desig_mt_idx
		</statement>		  
		<statement desc="Create index for eam_measurement_templ" targetDB="oracle">
		  CREATE INDEX templ_desig_idx ON eam_measurement_templ ( designate )							
        </statement>		  
		<statement desc="Create index for eam_measurement_templ" targetDB="postgresql">	
		  CREATE INDEX templ_desig_idx ON eam_measurement_templ USING btree ( designate )			
        </statement>		  		  	 
		  		  
		<statement desc="Create index for eam_action for faster lookup by parent"
			       targetDB="oracle">
		  CREATE INDEX action_child_idx ON eam_action ( parent_id ) 
        </statement>
		<statement desc="Create index for eam_action for faster lookup by parent"
			       targetDB="postgresql">
		  CREATE INDEX action_child_idx ON eam_action USING btree ( parent_id ) 
        </statement>

		<statement desc="Create index for eam_trigger_event for faster deletion 
			             by expiration date" targetDB="oracle">
		  CREATE INDEX trigger_expiration_idx ON eam_trigger_event ( expiration )			  
        </statement>		  
		<statement desc="Create index for eam_trigger_event for faster deletion 
			             by expiration date" targetDB="postgresql">	
		  CREATE INDEX trigger_expiration_idx ON eam_trigger_event USING btree ( expiration )				  
        </statement>  
		
		<!-- The table was renamed from eam_mescalation_state to eam_escalation_state 
			 but the constraint name was never changed. Dropping the constraint 
			 using one of the names should succeed.-->    
        <statement desc="Dropping unique constraint to reorder columns" 
			       targetDB="postgresql" fail="false">
		  ALTER TABLE eam_escalation_state DROP CONSTRAINT eam_mescalation_state_escalation_id_key CASCADE			
        </statement>		  		  
        <statement desc="Dropping unique constraint to reorder columns" 
			       targetDB="postgresql" fail="false">
		  ALTER TABLE eam_escalation_state DROP CONSTRAINT eam_escalation_state_escalation_id_key CASCADE			
        </statement> 
        <statement desc="Dropping unique constraint to reorder columns" 
                           targetDB="oracle">
            ALTER table eam_escalation_state DROP unique (escalation_id, alert_type, alert_def_id, alert_id)
        </statement>
        <statement desc="Create unique constraint with columns ordered highest cardinality first">
          ALTER TABLE EAM_ESCALATION_STATE ADD CONSTRAINT eam_escalation_state_id_key UNIQUE ( escalation_id, alert_def_id, alert_id, alert_type )
        </statement>		  
		
        <statement desc="Drop primary key from eam_srn" 
                   targetDB="oracle">
          ALTER TABLE EAM_SRN DROP primary key      
        </statement>
        <statement desc="Drop primary key from eam_srn"
                   targetDB="postgresql">
          ALTER TABLE EAM_SRN DROP CONSTRAINT eam_srn_pkey              
        </statement>
        <statement desc="Add new primary key to eam_srn"
                   targetDB="oracle">            
          ALTER TABLE EAM_SRN ADD CONSTRAINT eam_srn_pkey PRIMARY KEY ( instance_id, appdef_type )
        </statement>
        <statement desc="Add new primary key to eam_srn"
                   targetDB="postgresql">
          ALTER TABLE EAM_SRN ADD PRIMARY KEY ( instance_id, appdef_type )            
        </statement>
          

        <statement desc="Dropping index from eam_measurement_data_1h">
          drop index measurement_data_1h_time_idx
        </statement>
        <statement desc="Dropping primary key from eam_measurement_data_1h"
                   targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_1H drop primary key
        </statement>
        <statement desc="Dropping primary key from eam_measurement_data_1h"
                   targetDB="postgresql">
          alter table EAM_MEASUREMENT_DATA_1H drop constraint eam_measurement_data_1h_pkey
        </statement>          
        <statement desc="Add new primary key to eam_measurement_data_1h"
                   targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_1H add
          constraint EAM_MEASUREMENT_DATA_1H_PKEY
          primary key (TIMESTAMP, MEASUREMENT_ID)
        </statement>
        <statement desc="Add new primary key to eam_measurement_data_1h"
                   targetDB="postgresql">
          alter table EAM_MEASUREMENT_DATA_1H add
          primary key (TIMESTAMP, MEASUREMENT_ID)
        </statement>
        <statement desc="Creating index on eam_measurement_data_1h measurement_id"
                   targetDB="oracle">
          CREATE INDEX MEASUREMENT_DATA_1H_MID_IDX ON EAM_MEASUREMENT_DATA_1H (MEASUREMENT_ID)
        </statement>          
        <statement desc="Creating index on eam_measurement_data_1h measurement_id"
                   targetDB="postgresql">
          CREATE INDEX MEASUREMENT_DATA_1H_MID_IDX ON EAM_MEASUREMENT_DATA_1H USING btree (MEASUREMENT_ID)
        </statement>
          

        <statement desc="Dropping index from eam_measurement_data_6h">
          drop index measurement_data_6h_time_idx
        </statement>
        <statement desc="Dropping primary key from eam_measurement_data_6h"
                   targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_6H drop primary key
        </statement>
        <statement desc="Dropping primary key from eam_measurement_data_6h"
                   targetDB="postgresql">
          alter table EAM_MEASUREMENT_DATA_6H drop constraint eam_measurement_data_6h_pkey
        </statement>
        <statement desc="Add new primary key to eam_measurement_data_6h"
                   targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_6H add
          constraint EAM_MEASUREMENT_DATA_6H_PKEY
          primary key (TIMESTAMP, MEASUREMENT_ID)
        </statement>
        <statement desc="Add new primary key to eam_measurement_data_6h"
                   targetDB="postgresql">
          alter table EAM_MEASUREMENT_DATA_6H add
          primary key (TIMESTAMP, MEASUREMENT_ID)
        </statement>
        <statement desc="Creating index on eam_measurement_data_6h measurement_id"
                   targetDB="oracle">
          CREATE INDEX MEASUREMENT_DATA_6H_MID_IDX ON EAM_MEASUREMENT_DATA_6H(MEASUREMENT_ID)
        </statement>
        <statement desc="Creating index on eam_measurement_data_6h measurement_id" 
                   targetDB="postgresql">
          CREATE INDEX MEASUREMENT_DATA_6H_MID_IDX ON EAM_MEASUREMENT_DATA_6H USING btree (MEASUREMENT_ID)
        </statement>
          

        <statement desc="Dropping index from eam_measurement_data_1d">
          drop index measurement_data_1d_time_idx
        </statement>
        <statement desc="Dropping primary key from eam_measurement_data_1d"
                   targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_1D drop primary key
        </statement>
        <statement desc="Dropping primary key from eam_measurement_data_1d"
                   targetDB="postgresql">
          alter table EAM_MEASUREMENT_DATA_1D drop constraint eam_measurement_data_1d_pkey
        </statement>
        <statement desc="Add new primary key to eam_measurement_data_1d"
                   targetDB="oracle">
          alter table EAM_MEASUREMENT_DATA_1D add
          constraint EAM_MEASUREMENT_DATA_1D_PKEY
          primary key (TIMESTAMP, MEASUREMENT_ID)
        </statement>
        <statement desc="Add new primary key to eam_measurement_data_1d"
                   targetDB="postgresql">
          alter table EAM_MEASUREMENT_DATA_1D add
          primary key (TIMESTAMP, MEASUREMENT_ID)
        </statement>
        <statement desc="Creating index on eam_measurement_data_1d measurement_id"
                   targetDB="oracle">
          CREATE INDEX MEASUREMENT_DATA_1D_MID_IDX ON EAM_MEASUREMENT_DATA_1D(MEASUREMENT_ID)
        </statement>
        <statement desc="Creating index on eam_measurement_data_1d measurement_id"
                   targetDB="postgresql">
          CREATE INDEX MEASUREMENT_DATA_1D_MID_IDX ON EAM_MEASUREMENT_DATA_1D USING btree (MEASUREMENT_ID)
        </statement>
      </schema-directSQL>
    </schemaSpec>	
	
    <schemaSpec version="3.68">
      <schema-directSQL>
        <statement desc="Drop foreign key constraint from eam_alert to reduce 
						 contention between the alert and alert definition tables">
          ALTER TABLE EAM_ALERT DROP CONSTRAINT fke5b216aeb5af9d12
        </statement>
      </schema-directSQL>
    </schemaSpec>	

  <schemaSpec version="3.69">
    <schema-directSQL>
      <statement desc="reserve two crispo IDs for the guest user">
        INSERT INTO EAM_CRISPO (ID) VALUES ('2')
      </statement>
      <statement>
        INSERT INTO EAM_CRISPO (ID) VALUES ('3')
      </statement>
    </schema-directSQL>
    <schema-insert table="EAM_SUBJECT" desc="create a guest subject"
                   insertCmd="(CID,DSN,FACTIVE,FIRST_NAME,FSYSTEM,HTML_EMAIL,ID,LAST_NAME,NAME,PREF_CRISPO_ID) VALUES ('2','CAM',%%FALSE%%,'Guest',%%FALSE%%,%%FALSE%%,'2','User','guest','3')"/>
    <schema-insert table="EAM_RESOURCE" desc="add a resource for the guest subject"
                   insertCmd="(CID,FSYSTEM,ID,INSTANCE_ID,PROTO_ID,RESOURCE_TYPE_ID,SUBJECT_ID) VALUES ('10',%%FALSE%%,'10','2','0','1','0')"/>
    <schema-directSQL>
      <statement>
        UPDATE EAM_SUBJECT SET CID = '2', RESOURCE_ID = '10', EMAIL_ADDRESS = (SELECT EMAIL_ADDRESS FROM EAM_SUBJECT WHERE CID = 1) WHERE CID = 2
      </statement>
      <statement desc="set the default dashboard for view only role">
        INSERT INTO EAM_CRISPO_OPT (CRISPO_ID,ID,PROPKEY,VAL) VALUES ('3','2','.user.dashboard.default.id','2')
      </statement>
    </schema-directSQL>
    <schema-insert table="EAM_ROLE" desc="Define a view only role which includes the guest user and has all the read operations availble on the authz resource group"
                   insertCmd="(CID,FSYSTEM,ID,NAME) VALUES ('2',%%FALSE%%,'2','Guest Role')"/>
    <schema-insert table="EAM_RESOURCE" desc="add the role resource"
                   insertCmd="(CID,FSYSTEM,ID,INSTANCE_ID,PROTO_ID,RESOURCE_TYPE_ID,SUBJECT_ID) VALUES ('11',%%FALSE%%,'11','2','0','2','0')"/>
    <schema-directSQL>
      <statement>
        UPDATE EAM_ROLE SET CID = '2',RESOURCE_ID = '11' WHERE CID = '2'
      </statement>
      <statement desc="add the user to the root resource group">
        INSERT INTO EAM_RES_GRP_RES_MAP (RESOURCE_GROUP_ID,RESOURCE_ID) VALUES ('1','10')
      </statement>
      <statement desc="add the role to the root resource group">
        INSERT INTO EAM_RES_GRP_RES_MAP (RESOURCE_GROUP_ID,RESOURCE_ID) VALUES ('1','11')
      </statement>
      <statement desc="add the guest user to view only role">
        INSERT INTO EAM_SUBJECT_ROLE_MAP (CID,ROLE_ID,SUBJECT_ID) VALUES ('2','2','2')
      </statement>
      <statement desc="the read operations for all resource types to the view only role">
        INSERT INTO EAM_ROLE_OPERATION_MAP (CID,OPERATION_ID,ROLE_ID) VALUES ('71','8','2')
      </statement>
      <statement>
        INSERT INTO EAM_ROLE_OPERATION_MAP (CID,OPERATION_ID,ROLE_ID) VALUES ('72','16','2')
      </statement>
      <statement>
        INSERT INTO EAM_ROLE_OPERATION_MAP (CID,OPERATION_ID,ROLE_ID) VALUES ('73','28','2')
      </statement>
      <statement>
        INSERT INTO EAM_ROLE_OPERATION_MAP (CID,OPERATION_ID,ROLE_ID) VALUES ('74','305','2')
      </statement>
      <statement>
        INSERT INTO EAM_ROLE_OPERATION_MAP (CID,OPERATION_ID,ROLE_ID) VALUES ('75','311','2')
      </statement>
      <statement>
        INSERT INTO EAM_ROLE_OPERATION_MAP (CID,OPERATION_ID,ROLE_ID) VALUES ('76','315','2')
      </statement>
      <statement>
        INSERT INTO EAM_ROLE_OPERATION_MAP (CID,OPERATION_ID,ROLE_ID) VALUES ('77','319','2')
      </statement>
    </schema-directSQL>
  </schemaSpec>	

  <schemaSpec version="3.70">
    <schema-alterColumn table="EAM_AUDIT" column="FIELD" precision="100"
                        columnType="VARCHAR2" />
  </schemaSpec>

  <schemaSpec version="3.71">
    <schema-insert table="EAM_CONFIG_PROPS" dupFail="false"
                   insertCmd="(ID, PROPKEY, PROPVALUE, DEFAULT_PROPVALUE, FREAD_ONLY) VALUES (59, 'REPORT_STATS_SIZE', '1000', '1000', '0')"/>
  </schemaSpec>

  <schemaSpec version="3.72">
    <roledashboard></roledashboard>
  </schemaSpec>
	
  <schemaSpec version="3.73">
    <schema-directSQL>
        <statement desc="Creating new EAM_TRIGGER_EVENT table" 
                   targetDB="oracle">
            create table NEW_EAM_TRIGGER_EVENT (
              ID number(19,0) not null,
              EVENT_OBJECT blob not null,
              TRIGGER_ID number(10,0) not null,
              CTIME number(19,0) not null,
              EXPIRATION number(19,0) not null,
              primary key (ID)
            )
        </statement>		
        <statement desc="Creating new EAM_TRIGGER_EVENT table" 
                   targetDB="postgresql">
			create table NEW_EAM_TRIGGER_EVENT (
			  ID int8 not null,
			  EVENT_OBJECT bytea not null,
			  TRIGGER_ID int4 not null,
			  CTIME int8 not null,
			  EXPIRATION int8 not null,
			  primary key (ID)
			)
        </statement>		
        <statement desc="Creating EAM_TRIGGER_EVENT_ID_SEQ sequence" 
                   targetDB="oracle">
            create sequence EAM_TRIGGER_EVENT_ID_SEQ start with 10001 increment by 1
        </statement>		
        <statement desc="Creating EAM_TRIGGER_EVENT_ID_SEQ sequence" 
                   targetDB="postgresql">
			create sequence EAM_TRIGGER_EVENT_ID_SEQ start 10001 increment 1
        </statement>        
    </schema-directSQL>
	<migrateTriggerEvents table="NEW_EAM_TRIGGER_EVENT" sequence="EAM_TRIGGER_EVENT_ID_SEQ"/>
	<schema-dropTable table="EAM_TRIGGER_EVENT"/>  
    <schema-dropTable table="EAM_EVENT"/>
    <schema-dropSequence sequence="EAM_EVENT_ID_SEQ"/>
	<schema-directSQL>
        <statement desc="Rename the new EAM_TRIGGER_EVENT table">
			alter table NEW_EAM_TRIGGER_EVENT rename to EAM_TRIGGER_EVENT
        </statement>
        <statement desc="Creating index on EAM_TRIGGER_EVENT ctime"
                   targetDB="oracle">
			create index TRIGGER_EVENT_CTIME_IDX on EAM_TRIGGER_EVENT (CTIME)
        </statement>          
        <statement desc="Creating index on EAM_TRIGGER_EVENT ctime"
                   targetDB="postgresql">
			create index TRIGGER_EVENT_CTIME_IDX on EAM_TRIGGER_EVENT using btree (CTIME)
        </statement>
        <statement desc="Creating index on EAM_TRIGGER_EVENT trigger_id"
                   targetDB="oracle">
            create index TRIGGER_EVENT_TRIGGER_ID_IDX on EAM_TRIGGER_EVENT (TRIGGER_ID)
        </statement>          
        <statement desc="Creating index on EAM_TRIGGER_EVENT trigger_id"
                   targetDB="postgresql">
            create index TRIGGER_EVENT_TRIGGER_ID_IDX on EAM_TRIGGER_EVENT using btree (TRIGGER_ID)
        </statement>
        <statement desc="Creating index on EAM_TRIGGER_EVENT expiration"
                   targetDB="oracle">
            create index TRIGGER_EVENT_EXPIRATION_IDX on EAM_TRIGGER_EVENT (EXPIRATION)
        </statement>          
        <statement desc="Creating index on EAM_TRIGGER_EVENT expiration"
                   targetDB="postgresql">
            create index TRIGGER_EVENT_EXPIRATION_IDX on EAM_TRIGGER_EVENT using btree (EXPIRATION)
        </statement>						
    </schema-directSQL>  	  
  </schemaSpec>

  <schemaSpec version="3.74">
    <schema-directSQL>
        <statement>
          ALTER TABLE EAM_ALERT_DEFINITION DROP COLUMN LAST_FIRED
        </statement>
    </schema-directSQL>
  </schemaSpec>

  <schemaSpec version="3.75">
    <schema-directSQL>
        <statement desc="Enable the batch aggregate data inserter by default">
            update EAM_CONFIG_PROPS set propvalue=5 where id=56
        </statement>
        <statement desc="Set default batch size to 2000">
            update EAM_CONFIG_PROPS set propvalue=2000 where id=57
        </statement>
        <statement>
            update EAM_CONFIG_PROPS set propvalue=100000 where id=58
        </statement>
    </schema-directSQL>
  </schemaSpec>
	
  <!-- Some of the postgres changes in schema spec 3.67 may have failed because of 
       the connection being rolled back when dropping the unique constraint 
       on the EAM_ESCALATION_STATE table. Drop the unique constraint again 
       in its own schema spec version so the statement uses its own connection. -->     
  <schemaSpec version="3.76">
    <schema-directSQL>
        <statement desc="Dropping unique constraint to reorder columns" 
                   targetDB="postgresql" fail="false">
          ALTER TABLE EAM_ESCALATION_STATE DROP CONSTRAINT eam_mescalation_state_escalation_id_key CASCADE          
        </statement>
    </schema-directSQL>
  </schemaSpec> 

  <!-- Some of the postgres changes in schema spec 3.67 may have failed because of 
       the connection being rolled back when dropping the unique constraint 
       on the EAM_ESCALATION_STATE table. Drop the unique constraint again 
       in its own schema spec version so the statement uses its own connection. -->         
  <schemaSpec version="3.77">
    <schema-directSQL>                 
        <statement desc="Dropping unique constraint to reorder columns" 
                   targetDB="postgresql" fail="false">
          ALTER TABLE EAM_ESCALATION_STATE DROP CONSTRAINT eam_escalation_state_escalation_id_key CASCADE           
        </statement>
    </schema-directSQL>
  </schemaSpec>    

  <!-- Now let's set the correct name for the unique constraint on the 
	   EAM_ESCALATION_STATE table. We can't use the eam_escalation_state_escalation_id_key 
	   name for Oracle since that name is too long. -->		
  <schemaSpec version="3.78">
    <schema-directSQL>		                 
        <statement desc="Dropping old unique constraint to create with correct name" 
                   targetDB="postgresql" fail="false">
          ALTER TABLE EAM_ESCALATION_STATE DROP CONSTRAINT eam_escalation_state_id_key CASCADE           
        </statement>
        <statement desc="Create unique constraint with correct name" 
				   targetDB="postgresql">
          ALTER TABLE EAM_ESCALATION_STATE ADD CONSTRAINT eam_escalation_state_escalation_id_key UNIQUE ( escalation_id, alert_def_id, alert_id, alert_type )
        </statement> 
    </schema-directSQL>
  </schemaSpec>	

  <!-- Now rerun the postgres changes in schema spec 3.67 before the failed drop of the 
       unique constraint on the EAM_ESCALATION_STATE table caused the connection 
       to be rolled back. None of these changes should fail. -->    
  <schemaSpec version="3.79">
      <schema-directSQL>
        <statement desc="Dropping unnecessary index from EAM_ROLE_CALENDAR"
                   targetDB="postgresql">
          DROP INDEX calendar_role_idx
        </statement>          
        <statement desc="Dropping unnecessary index from EAM_OPERATION" 
                   targetDB="postgresql">
          DROP INDEX eam_opname_idx
        </statement>    
        <statement desc="Dropping unnecessary index from EAM_RESOURCE" 
                   targetDB="postgresql">
          DROP INDEX eam_resource_idx_type_idx
        </statement>                      
        <statement desc="Dropping unnecessary index from EAM_SERVER" 
                   targetDB="postgresql">
          DROP INDEX eam_server_platform_idx
        </statement>          
        <statement desc="Dropping unnecessary index from EAM_EVENT_LOG" 
                   targetDB="postgresql">
          DROP INDEX event_log_timestamp_idx
        </statement>          
        <statement desc="Dropping unnecessary index from EAM_MEASUREMENT_BL" 
                   targetDB="postgresql">
          DROP INDEX metric_baseline_idx
        </statement>          
        <statement desc="Dropping unnecessary index from EAM_METRIC_PROB" 
                   targetDB="postgresql">
          DROP INDEX metric_prob_id_idx
        </statement>          
        <statement desc="Dropping unnecessary index from EAM_MONITORABLE_TYPE" 
                   targetDB="postgresql">
          DROP INDEX mtype_idx_appdeftype_idx
        </statement>          
        <statement desc="Dropping unnecessary index from EAM_MEASUREMENT_TEMPL" 
                   targetDB="postgresql">
          DROP INDEX templ_monitorable_type_idx
        </statement>              
          
        <statement desc="Dropping index from EAM_AUTOINV_SCHEDULE to reorder columns" 
                   targetDB="postgresql">
          DROP INDEX ai_schedule_entity_idx
        </statement>         
        <statement desc="Create index for EAM_AUTOINV_SCHEDULE with highest cardinality column first" 
                   targetDB="postgresql">   
          CREATE INDEX ai_schedule_entity_idx ON EAM_AUTOINV_SCHEDULE USING btree ( entity_id, entity_type )                  
        </statement>

        <statement desc="Dropping index from EAM_CONTROL_SCHEDULE to reorder columns" 
                   targetDB="postgresql">
          DROP INDEX ctl_schedule_entity_idx
        </statement>         
        <statement desc="Create index for EAM_CONTROL_SCHEDULE with columns ordered highest cardinality first" 
                   targetDB="postgresql">
          CREATE INDEX ctl_schedule_entity_idx ON EAM_CONTROL_SCHEDULE USING btree ( entity_id, entity_type )             
        </statement>                  
                  
        <statement desc="Dropping index from EAM_EVENT_LOG to reorder columns" 
                   targetDB="postgresql">
          DROP INDEX event_log_idx
        </statement>                  
        <statement desc="Create index for EAM_EVENT_LOG with columns ordered highest cardinality first" 
                   targetDB="postgresql">
          CREATE INDEX event_log_idx ON EAM_EVENT_LOG USING btree ( timestamp, entity_id, entity_type )           
        </statement>
          
        <statement desc="Dropping index from EAM_ESCALATION_STATE to reorder columns" 
                   targetDB="postgresql">
          DROP INDEX state_idx
        </statement>                   
        <statement desc="Create index for EAM_ESCALATION_STATE with columns ordered highest cardinality first" 
                   targetDB="postgresql">
          CREATE INDEX state_idx ON EAM_ESCALATION_STATE USING btree ( alert_def_id, alert_type )       
        </statement>
          
        <statement desc="Dropping index from EAM_MEASUREMENT_TEMPL since we do not need to index monitorable_type_id" 
                   targetDB="postgresql">
          DROP INDEX templ_desig_mt_idx
        </statement>                   
        <statement desc="Create index for EAM_MEASUREMENT_TEMPL" 
                   targetDB="postgresql"> 
          CREATE INDEX templ_desig_idx ON EAM_MEASUREMENT_TEMPL USING btree ( designate )           
        </statement>                     
                  
        <statement desc="Create index for EAM_ACTION for faster lookup by parent"
                   targetDB="postgresql">
          CREATE INDEX action_child_idx ON EAM_ACTION USING btree ( parent_id ) 
        </statement>
	  </schema-directSQL>       
  </schemaSpec> 
	
  <!-- Need to rename the primary key for the EAM_TRIGGER_EVENT table so that 
       the migration in schema spec 3.73 is the same as a fresh install. 
	   Don't worry about this for Oracle since it uses an auto-generated primary 
	   key name. -->                      
  <schemaSpec version="3.80">
    <schema-directSQL>
        <statement desc="Rename the primary key on EAM_TRIGGER_EVENT" 
                   targetDB="postgresql">
		  ALTER INDEX new_eam_trigger_event_pkey rename TO eam_trigger_event_pkey
        </statement>
    </schema-directSQL>
  </schemaSpec> 
	
  <schemaSpec version="3.81">
    <schema-alterColumn table="EAM_AUDIT" column="KLAZZ" precision="255"
                        targetDB="postgresql" columnType="VARCHAR2"
                        nullable="not null" />
    <schema-alterColumn table="EAM_AUDIT" column="KLAZZ" precision="255"
                        targetDB="oracle" columnType="VARCHAR2" />
  </schemaSpec>	

  <!-- For Postgres the SST_AlterColumn task will create a new column, copy the 
	   data, then drop the old column. Hence, we need to create the index again 
	   on the EAM_CONFIG_RESPONSE validationerr column. We don't need to worry 
	   about creating the index for Oracle since we are truly altering the column. -->		
  <schemaSpec version="3.82">	  
    <schema-alterColumn table="EAM_CONFIG_RESPONSE" column="VALIDATIONERR" 
						precision="512" columnType="VARCHAR2"/>
	
    <schema-directSQL>
      <statement desc="Creating index on EAM_CONFIG_RESPONSE validationerr"
                 targetDB="postgresql">
        CREATE INDEX cresp_err_idx ON EAM_CONFIG_RESPONSE USING btree (validationerr)
      </statement>
    </schema-directSQL>	  
  </schemaSpec>

  <schemaSpec version="3.83">
    <schema-alterColumn table="EAM_CRISPO_OPT" column="VAL" precision="4000"
                        targetDB="postgresql" columnType="VARCHAR2" />
    <schema-alterColumn table="EAM_CRISPO_OPT" column="VAL" precision="4000"
                        targetDB="oracle" columnType="VARCHAR2" />
  </schemaSpec>

  <!-- For Postgres the SST_AlterColumn task will create a new column, copy the 
       data, then drop the old column. Hence, we need to create the FK constraint 
	   again on the EAM_SUBJECT pref_crispo_id column. We don't need to worry 
       about the FK constraint for Oracle since we are truly altering the column. -->  	
  <schemaSpec version="3.84">
	<schema-alterColumn table="EAM_SUBJECT" column="PREF_CRISPO_ID" 
					    columnType="INTEGER"/>

	<schema-directSQL>
		<statement desc="Creating FK constraint on EAM_SUBJECT pref_crispo_id" 
			       targetDB="postgresql">
			ALTER TABLE EAM_SUBJECT add constraint fk8e4d1fe6e3c7cb1 
            FOREIGN KEY (pref_crispo_id) REFERENCES EAM_CRISPO(id)
		</statement>	  
	</schema-directSQL>  		     
  </schemaSpec>
  
  <!-- Oracle and Postgres do not need the HQ_SEQUENCE table. -->	
  <schemaSpec version="3.85">
    <schema-dropTable table="HQ_SEQUENCE" targetDB="oracle"/>           
    <schema-dropTable table="HQ_SEQUENCE" targetDB="postgresql"/>           	  
  </schemaSpec>	

  <schemaSpec version="3.86">
	  <schema-directSQL>
		  <statement desc="Clear out UI attachment">
          delete from eam_ui_attachment
      </statement>
		  <statement desc="Clear out UI admin view table">
          delete from eam_ui_view_admin
      </statement>
		  <statement desc="Clear out UI masthead view table">
          delete from eam_ui_view_masthead
      </statement>
		  <statement desc="Clear out UI view table">
          delete from eam_ui_view
      </statement>
		  <statement desc="Clear out UI plugin table">
          delete from eam_ui_plugin
      </statement>
	  </schema-directSQL>
  </schemaSpec>	

  <schemaSpec version="3.87">
	  <schema-directSQL>
        <statement desc="Creating EAM_ALERT_DEF_STATE table" targetDB="oracle">
          create table EAM_ALERT_DEF_STATE (
              ALERT_DEFINITION_ID number(10,0) not null,
              LAST_FIRED number(19,0) not null,
              primary key (ALERT_DEFINITION_ID)
          )
        </statement>		
        <statement desc="Creating EAM_ALERT_DEF_STATE table" targetDB="postgresql">
          create table EAM_ALERT_DEF_STATE (
              ALERT_DEFINITION_ID int4 not null,
              LAST_FIRED int8 not null,
              primary key (ALERT_DEFINITION_ID)
          )
        </statement>		
        <statement desc="Creating EAM_ALERT_DEF_STATE table" targetDB="mysql">
          create table EAM_ALERT_DEF_STATE (
              ALERT_DEFINITION_ID integer not null,
              LAST_FIRED bigint not null,
              primary key (ALERT_DEFINITION_ID)
          ) ENGINE=InnoDB
        </statement>
        <statement desc="Populate the EAM_ALERT_DEF_STATE table">
          INSERT INTO EAM_ALERT_DEF_STATE (ALERT_DEFINITION_ID, LAST_FIRED)
            SELECT ID, 0 FROM EAM_ALERT_DEFINITION
        </statement>
	  </schema-directSQL>
  </schemaSpec>	
	
  <schemaSpec version="3.88">
      <schema-addColumn table="EAM_ALERT_DEFINITION"
                        column="ACTIVE"
                        columnType="boolean"/>
      <schema-directSQL>
          <statement desc="Set all alert definitions to active by default"
                     targetDB="postgresql">
            UPDATE EAM_ALERT_DEFINITION SET ACTIVE=TRUE
          </statement>
          <statement desc="Set all alert definitions to active by default"
                     targetDB="oracle">
            UPDATE EAM_ALERT_DEFINITION SET ACTIVE=1
          </statement>
          <statement desc="Set all alert definitions to active by default"
                     targetDB="mysql">
            UPDATE EAM_ALERT_DEFINITION SET ACTIVE=1
          </statement>		  
          <statement desc="The root resource type alert should be inactive"
			         targetDB="postgresql">
            UPDATE EAM_ALERT_DEFINITION SET ACTIVE=FALSE WHERE ID=0
          </statement>
		  <statement desc="The root resource type alert should be inactive"
			         targetDB="oracle">
            UPDATE EAM_ALERT_DEFINITION SET ACTIVE=0 WHERE ID=0
          </statement>
          <statement desc="The root resource type alert should be inactive"
                     targetDB="mysql">
            UPDATE EAM_ALERT_DEFINITION SET ACTIVE=0 WHERE ID=0
          </statement>		  
      </schema-directSQL>
      <schema-alterColumn table="EAM_ALERT_DEFINITION"
                          column="ACTIVE"
                          nullable="NOT NULL"/> 
  </schemaSpec>	

  <schemaSpec version="3.89">
	<schema-directSQL>
    <statement targetDB="postgresql">
      create table EAM_AI_AGENT_REPORT (
          id integer not null,
          version_col bigint DEFAULT 0 NOT NULL,
          agent_id integer not null,
          report_time bigint not null,
          service_dirty boolean not null
       )
    </statement>
    <statement targetDB="postgresql">
      CREATE SEQUENCE eam_ai_agent_report_id_seq start 10001 increment 1
    </statement>
    <statement targetDB="mysql">
      create table EAM_AI_AGENT_REPORT (
          id integer not null,
          version_col bigint not null,
          agent_id integer not null,
          report_time bigint not null,
          service_dirty boolean not null
       ) ENGINE=InnoDB
    </statement>
    <statement targetDB="oracle">
      create table EAM_AI_AGENT_REPORT (
          id INTEGER not null,
          version_col NUMBER(19,0) DEFAULT 0 NOT NULL,
          agent_id NUMBER(10,0) not null,
          report_time NUMBER(19,0) not null,
          service_dirty NUMBER(1) not null
       ) 
    </statement>
    <statement targetDB="oracle">
      create sequence eam_ai_agent_report_id_seq start with 10001 increment by 1
    </statement>
    <statement>
      ALTER TABLE EAM_AI_AGENT_REPORT
         ADD CONSTRAINT eam_ai_agent_report_pkey PRIMARY KEY (id)
    </statement>
    <statement targetDB="oracle">
      ALTER TABLE EAM_AI_AGENT_REPORT
        ADD CONSTRAINT SYS_C0070598 UNIQUE (agent_id)
    </statement>
    <statement targetDB="postgresql">
      ALTER TABLE EAM_AI_AGENT_REPORT
        ADD CONSTRAINT eam_agent_report_agent_id_key UNIQUE (agent_id)
    </statement>
    <statement targetDB="mysql">
      ALTER TABLE EAM_AI_AGENT_REPORT
        ADD CONSTRAINT eam_agent_report_agent_id_key UNIQUE (agent_id)
    </statement>
    <statement>
      ALTER TABLE EAM_AI_AGENT_REPORT
        ADD CONSTRAINT fk9723a177559691a3 FOREIGN KEY (agent_id) 
        REFERENCES eam_agent(id)
    </statement>
	</schema-directSQL>
  </schemaSpec>

  <schemaSpec version="3.90">
    <schema-directSQL>
      <statement desc="Creating new EAM_CRISPO_ARRAY table" fail="false">
        create table EAM_CRISPO_ARRAY (
          OPT_ID int not null,
          VAL varchar (255) not null,
          IDX int not null,
          primary key (OPT_ID, IDX)
        )
      </statement>
      <statement desc="Creating fk constraint to match the hbm-ddl constraint on EAM_CRISPO_ARRAY table" targetDB="oracle">
        alter table EAM_CRISPO_ARRAY add constraint fkee7dcb20ef4e2527 
                    FOREIGN KEY (OPT_ID) REFERENCES EAM_CRISPO_OPT(id) 
                    ON DELETE CASCADE
      </statement>
      
      <statement desc="Creating fk constraint to match the hbm-ddl constraint on EAM_CRISPO_ARRAY table" targetDB="postgresql">
        alter table EAM_CRISPO_ARRAY add constraint fkee7dcb20ef4e2527 
                    FOREIGN KEY (OPT_ID) REFERENCES EAM_CRISPO_OPT(id) 
                    ON DELETE CASCADE
      </statement>
      
      <statement desc="Creating fk constraint to match the hbm-ddl constraint on EAM_CRISPO_ARRAY table" targetDB="mysql">
        alter table EAM_CRISPO_ARRAY add constraint FKEE7DCB20EF4E2527
                    FOREIGN KEY (OPT_ID) REFERENCES EAM_CRISPO_OPT(id) 
                    ON DELETE CASCADE
      </statement>
    </schema-directSQL>    
  </schemaSpec>

  <schemaSpec version="3.91">
    <schema-directSQL>
      <statement targetDB="postgresql">
          alter table EAM_ALERT_DEFINITION rename column RANGE to TRANGE
      </statement>
      <statement targetDB="mysql">
          alter table EAM_ALERT_DEFINITION change RANGE TRANGE bigint(20)
      </statement>
      <statement targetDB="oracle">
          alter table EAM_ALERT_DEFINITION rename column RANGE to TRANGE
      </statement>
    </schema-directSQL>
  </schemaSpec>

  <schemaSpec version="3.92">
    <schema-alterColumn table="EAM_ALERT_DEFINITION" column="NAME" precision="255"
                        columnType="VARCHAR2" />
  </schemaSpec>

  <schemaSpec version="3.93">
    <schema-directSQL>
      <statement targetDB="mysql">
          alter table HQ_SEQUENCE add primary key (seq_name)
      </statement>
    </schema-directSQL>
  </schemaSpec>

  <schemaSpec version="3.94">
    <schema-directSQL>
      <statement>
        ALTER TABLE EAM_CONTROL_HISTORY DROP COLUMN DURATION
      </statement>
    </schema-directSQL>    
  </schemaSpec>

  <!-- Re-size again for upgrades to 3.2.0 which may not have this change -->
  <schemaSpec version="3.95">
    <schema-alterColumn table="EAM_CRISPO_ARRAY" column="VAL" precision="512"
                        columnType="VARCHAR2" />
  </schemaSpec>

  <!-- Increase worker count and decrease batch size where the defaults from 3.2.0 have not been changed. -->
  <schemaSpec version="3.96">
    <schema-directSQL>
      <statement>
        UPDATE EAM_CONFIG_PROPS set PROPVALUE=10 WHERE PROPKEY='BATCH_AGGREGATE_WORKERS' and PROPVALUE=5
      </statement>
      <statement>
        UPDATE EAM_CONFIG_PROPS set PROPVALUE=200 WHERE PROPKEY='BATCH_AGGREGATE_BATCHSIZE' and PROPVALUE=2000
      </statement>
    </schema-directSQL>
  </schemaSpec>

  <schemaSpec version="3.96.1">
    <schema-directSQL>
      <statement desc="Clean up orphaned group resource IDs in eam_crispo_array">
        DELETE FROM EAM_CRISPO_ARRAY WHERE VAL LIKE '5:%' AND VAL NOT IN (SELECT '5:'||ID FROM EAM_RESOURCE_GROUP)
      </statement>
    </schema-directSQL>
  </schemaSpec>

  <schemaSpec version="3.97">
    <schema-addColumn table="EAM_MEASUREMENT" column="RESOURCE_ID" 
                      columnType="INTEGER">
      <initializer>
          UPDATE EAM_MEASUREMENT SET RESOURCE_ID =
              (SELECT r.ID FROM EAM_RESOURCE r,
               (SELECT ID, 1 AS APPDEF_TYPE FROM EAM_RESOURCE_TYPE WHERE CID = 301
                UNION ALL
                SELECT ID, 2 AS APPDEF_TYPE FROM EAM_RESOURCE_TYPE WHERE CID = 303
                UNION ALL
                SELECT ID, 3 AS APPDEF_TYPE FROM EAM_RESOURCE_TYPE WHERE CID = 305) m,
               EAM_MONITORABLE_TYPE mt INNER JOIN EAM_MEASUREMENT_TEMPL t
                 ON MONITORABLE_TYPE_ID = mt.ID
               WHERE EAM_MEASUREMENT.INSTANCE_ID = r.INSTANCE_ID AND
                     r.RESOURCE_TYPE_ID = m.ID AND
                     mt.APPDEF_TYPE = m.APPDEF_TYPE AND t.id = EAM_MEASUREMENT.TEMPLATE_ID)
      </initializer>
      <foreignKey constraintName="FK3E0F978EFC176AE"
                  references="EAM_RESOURCE(ID)"/>
    </schema-addColumn>
    <schema-directSQL>
      <statement desc="Create new index for resource_id">
        CREATE INDEX MEAS_RES_IDX ON EAM_MEASUREMENT ( RESOURCE_ID )
      </statement>
    </schema-directSQL>
  </schemaSpec>
  
  <schemaSpec version="3.98">
	<schema-directSQL>
    <statement targetDB="postgresql">
      create table EAM_RESOURCE_EDGE (
          id integer not null,
          version_col bigint DEFAULT 0 NOT NULL,
          from_id     integer not null,
          to_id       integer not null,
          rel_id      integer not null,
          distance    integer not null
       )
    </statement>
    <statement targetDB="postgresql">
      create table EAM_RESOURCE_RELATION (
          id integer not null,
          version_col bigint DEFAULT 0 NOT NULL,
          name        character varying(255) not null,
          is_hier     boolean not null
       )
    </statement>
    <statement targetDB="postgresql">
      CREATE SEQUENCE eam_resource_edge_id_seq start 10001 increment 1
    </statement>
    <statement targetDB="postgresql">
      CREATE SEQUENCE eam_resource_relation_id_seq start 10001 increment 1
    </statement>


    <statement targetDB="mysql">
      create table EAM_RESOURCE_EDGE (
          id integer not null,
          version_col bigint not null,
          from_id     integer not null,
          to_id       integer not null,
          rel_id      integer not null,
          distance    integer not null
       ) ENGINE=InnoDB
    </statement>
    <statement targetDB="mysql">
      create table EAM_RESOURCE_RELATION (
          id integer not null,
          version_col bigint not null,
          name        varchar(255) not null,
          is_hier     bit not null
       ) ENGINE=InnoDB
    </statement>

    
    <statement targetDB="oracle">
      create table EAM_RESOURCE_EDGE (
          id INTEGER not null,
          version_col NUMBER(19,0) DEFAULT 0 NOT NULL,
          from_id NUMBER(19,0) not null,
          to_id NUMBER(19,0) not null,
          rel_id NUMBER(19,0) not null,
          distance NUMBER(10,0) not null
       ) 
    </statement>
    <statement targetDB="oracle">
      create table EAM_RESOURCE_RELATION (
          id INTEGER not null,
          version_col NUMBER(19,0) DEFAULT 0 NOT NULL,
          name VARCHAR(255) NOT NULL,
          is_hier NUMBER(1) not null
       ) 
    </statement>
    <statement targetDB="oracle">
      create sequence eam_resource_edge_id_seq start with 10001 increment by 1
    </statement>
    <statement targetDB="oracle">
      create sequence eam_resource_relation_id_seq start with 10001 increment by 1
    </statement>


    <statement>
      ALTER TABLE EAM_RESOURCE_RELATION
        ADD CONSTRAINT eam_resource_relation_name_key UNIQUE (name)
    </statement>
    <statement>
      ALTER TABLE EAM_RESOURCE_RELATION
        ADD CONSTRAINT eam_resource_relation_pkey PRIMARY KEY (id)
    </statement>
    
    <statement>
      ALTER TABLE EAM_RESOURCE_EDGE
        ADD CONSTRAINT eam_resource_edge_from_id_key UNIQUE (from_id, to_id, distance)
    </statement>
    <statement>
      ALTER TABLE EAM_RESOURCE_EDGE
        ADD CONSTRAINT eam_resource_edge_pkey PRIMARY KEY (id)
    </statement>
    <statement>
      CREATE INDEX eam_resource_from_id_idx ON EAM_RESOURCE_EDGE (from_id)
    </statement>
    <statement>
      CREATE INDEX eam_resource_to_id_idx ON EAM_RESOURCE_EDGE (to_id)
    </statement>
    <statement>
      ALTER TABLE EAM_RESOURCE_EDGE
        ADD CONSTRAINT fkd1fcb6c0a2bf2d92 FOREIGN KEY (from_id) REFERENCES EAM_RESOURCE(id)
    </statement>
    <statement>
      ALTER TABLE EAM_RESOURCE_EDGE
        ADD CONSTRAINT fkd1fcb6c0ccc27921 FOREIGN KEY (to_id) REFERENCES EAM_RESOURCE(id)
    </statement>
    <statement>
      ALTER TABLE EAM_RESOURCE_EDGE
        ADD CONSTRAINT fkd1fcb6c04405ae5f FOREIGN KEY (rel_id) REFERENCES EAM_RESOURCE_RELATION(id)
    </statement>

	</schema-directSQL>
  </schemaSpec>

  <schemaSpec version="3.99">
    <schema-insert table="EAM_RESOURCE_RELATION"
                   insertCmd="(ID, VERSION_COL, NAME, IS_HIER) VALUES (1, 0, 'containment', %%TRUE%%)"/>
  </schemaSpec>
  
  <schemaSpec version="3.100">
    <!-- For these statements we have to give the target table so the next id
         generator knows which table to generate ids for. -->
    <schema-directSQL>
    <statement desc="Create self-edges for platforms" table="EAM_RESOURCE_EDGE">
      insert into EAM_RESOURCE_EDGE (id, version_col, from_id, to_id, rel_id, distance)
        select r.id, 0 as version_col, r.id as from_id, r.id as to_id, 1 as rel_id, 0 as distance
        from EAM_PLATFORM p
        join EAM_RESOURCE r on r.instance_id = p.id
        and r.resource_type_id = 301
    </statement>
    <statement desc="Create self-edges for servers" table="EAM_RESOURCE_EDGE">
      insert into EAM_RESOURCE_EDGE (id, version_col, from_id, to_id, rel_id, distance)
        select %%NEXTID%% + r.id as id, 0 as version_col, r.id as from_id, r.id as to_id, 1 as rel_id, 0 as distance
        from EAM_SERVER s
        join EAM_RESOURCE r on r.instance_id = s.id
        and r.resource_type_id = 303    
    </statement>
    <statement desc="Platform->server edges, distance of 1" table="EAM_RESOURCE_EDGE">
      insert into EAM_RESOURCE_EDGE (id, version_col, from_id, to_id, rel_id, distance)
        select %%NEXTID%% + rServer.id, 0, rPlat.id, rServer.id, 1, 1
        from EAM_SERVER s
        join EAM_PLATFORM p on s.platform_id = p.id
        join EAM_RESOURCE rServer on rServer.instance_id = s.id
        join EAM_RESOURCE rPlat on rPlat.instance_id = p.id
        where 
          rServer.resource_type_id = 303
        and  rPlat.resource_type_id = 301
    </statement>
    <statement desc="Servers->Platform edges, distance of -1" table="EAM_RESOURCE_EDGE">
      insert into EAM_RESOURCE_EDGE (id, version_col, from_id, to_id, rel_id, distance)
        select %%NEXTID%% + rServer.id, 0, rServer.id, rPlat.id, 1, -1
        from EAM_SERVER s
        join EAM_PLATFORM p on s.platform_id = p.id
        join EAM_RESOURCE rServer on rServer.instance_id = s.id
        join EAM_RESOURCE rPlat on rPlat.instance_id = p.id
        where 
         rServer.resource_type_id = 303
        and  rPlat.resource_type_id = 301    
    </statement>
    <statement desc="Service self-edges" table="EAM_RESOURCE_EDGE">
      insert into EAM_RESOURCE_EDGE (id, version_col, from_id, to_id, rel_id, distance)
        select %%NEXTID%% + r.id, 0, r.id, r.id, 1, 0
        from EAM_SERVICE v
        join EAM_RESOURCE r on r.instance_id = v.id
        where r.resource_type_id = 305
    </statement>
    <statement desc="Platform->Service edges, distance of 2" table="EAM_RESOURCE_EDGE">
      insert into EAM_RESOURCE_EDGE (id, version_col, from_id, to_id, rel_id, distance)
        select %%NEXTID%% + rService.id, 0, rPlat.id, rService.id, 1, 2
        from EAM_SERVICE v
        join EAM_SERVER s on v.server_id = s.id
        join EAM_PLATFORM p on s.platform_id = p.id
        join EAM_RESOURCE rService on rService.instance_id = v.id
        join EAM_RESOURCE rPlat on rPlat.instance_id = p.id
      where
        rService.resource_type_id = 305
        and rPlat.resource_type_id = 301
    </statement>
    <statement desc="Server->Service edges, distance of 1" table="EAM_RESOURCE_EDGE">
      insert into EAM_RESOURCE_EDGE (id, version_col, from_id, to_id, rel_id, distance)
        select %%NEXTID%% + rService.id, 0, rServer.id, rService.id, 1, 1
        from EAM_SERVICE v
        join EAM_SERVER s on v.server_id = s.id
        join EAM_RESOURCE rService on rService.instance_id = v.id
        join EAM_RESOURCE rServer on rServer.instance_id = s.id
      where
        rService.resource_type_id = 305
        and rServer.resource_type_id = 303    
    </statement>
    <statement desc="Services->Server edges, distance of -1" table="EAM_RESOURCE_EDGE">
      insert into EAM_RESOURCE_EDGE (id, version_col, from_id, to_id, rel_id, distance)
        select %%NEXTID%% + rService.id, 0, rService.id, rServer.id, 1, -1
        from EAM_SERVICE v
        join EAM_SERVER s on v.server_id = s.id
        join EAM_RESOURCE rService on rService.instance_id = v.id
        join EAM_RESOURCE rServer on rServer.instance_id = s.id
      where
        rService.resource_type_id = 305
        and rServer.resource_type_id = 303    
    </statement>
    <statement desc="Services->Platform edges, distance of -2" table="EAM_RESOURCE_EDGE">
      insert into EAM_RESOURCE_EDGE (id, version_col, from_id, to_id, rel_id, distance)
        select %%NEXTID%% + rService.id, 0, rService.id, rPlat.id, 1, -2
        from EAM_SERVICE v
        join EAM_SERVER s on v.server_id = s.id
        join EAM_PLATFORM p on s.platform_id = p.id
        join EAM_RESOURCE rService on rService.instance_id = v.id
        join EAM_RESOURCE rPlat on rPlat.instance_id = p.id
      where
        rService.resource_type_id = 305
        and rPlat.resource_type_id = 301    
    </statement>
    
    <!-- Update the next sequence value for the edge table -->
    <statement targetDB="postgresql">
      select setval('eam_resource_edge_id_seq', max(e.id) + 1) from eam_resource_edge e
    </statement>
    <statement targetDB="mysql">
      insert into HQ_SEQUENCE (seq_name, seq_val) 
        select 'EAM_RESOURCE_EDGE', ifnull(max(id), 10000)/100+1 from EAM_RESOURCE_EDGE
    </statement>
    <statement targetDB="oracle">
      DROP SEQUENCE eam_resource_edge_id_seq
    </statement>
    </schema-directSQL>
    <groovy targetDB="oracle">
      def maxId = SQL.firstRow('select max(id) as M from eam_resource_edge')['M'] + 1
      String s = "create sequence eam_resource_edge_id_seq start with ${maxId} increment by 1"
      SQL.execute(s)
    </groovy> 
  </schemaSpec>

  <schemaSpec version="3.101">

      <schema-directSQL>
        <statement desc="Replace pass-through ARG1 with actual DSN" targetDB="postgresql">
            UPDATE EAM_MEASUREMENT SET dsn = (SELECT m.dsn FROM EAM_MEASUREMENT m WHERE m.id = EAM_MEASUREMENT.id - 1) WHERE MEASUREMENT_CLASS = 'D'
        </statement>
        <statement desc="Replace pass-through ARG1 with actual Template" targetDB="postgresql">
            UPDATE EAM_MEASUREMENT_TEMPL SET template = (SELECT template from EAM_MEASUREMENT_TEMPL t WHERE id = EAM_MEASUREMENT_TEMPL.id - 1) WHERE default_interval != 0
        </statement>
      </schema-directSQL>
      <schema-directSQL>
        <statement desc="Replace pass-through ARG1 with actual DSN" targetDB="oracle">
            UPDATE EAM_MEASUREMENT SET dsn = (SELECT m.dsn FROM EAM_MEASUREMENT m WHERE m.id = EAM_MEASUREMENT.id - 1) WHERE MEASUREMENT_CLASS = 'D'
        </statement>
        <statement desc="Replace pass-through ARG1 with actual Template" targetDB="oracle">
            UPDATE EAM_MEASUREMENT_TEMPL SET template = (SELECT template from EAM_MEASUREMENT_TEMPL t WHERE id = EAM_MEASUREMENT_TEMPL.id - 1) WHERE default_interval != 0
        </statement>
      </schema-directSQL>
      <schema-directSQL>
        <statement desc="Create TMP update Table" targetDB="mysql">
            CREATE TABLE EAM_MEASUREMENT_TMP AS SELECT (ID+1) ID, DSN FROM EAM_MEASUREMENT WHERE MEASUREMENT_CLASS='R'
        </statement>
        <statement desc="Index TMP table for performance on UPDATE" targetDB="mysql">
            ALTER TABLE EAM_MEASUREMENT_TMP ADD PRIMARY KEY (ID);
        </statement>
        <statement desc="Replace pass-through ARG1 with actual DSN" targetDB="mysql">
            UPDATE EAM_MEASUREMENT SET dsn = (SELECT m.dsn FROM EAM_MEASUREMENT_TMP m where m.id = EAM_MEASUREMENT.id) WHERE MEASUREMENT_CLASS='D'
        </statement>
        <statement desc="Clean up TMP table" targetDB="mysql">
           DROP TABLE EAM_MEASUREMENT_TMP
        </statement>
        <statement desc="Create TMP update Table" targetDB="mysql">
            CREATE TABLE EAM_MEASUREMENT_TEMPL_TMP AS SELECT (ID+1) ID, TEMPLATE FROM EAM_MEASUREMENT_TEMPL WHERE DEFAULT_INTERVAL=0
        </statement>
        <statement desc="Index TMP table for performance on update" targetDB="mysql">
            ALTER TABLE EAM_MEASUREMENT_TEMPL_TMP ADD PRIMARY KEY (ID)
        </statement>
        <statement desc="Replace pass-through ARG1 with actual Template" targetDB="mysql">
            UPDATE EAM_MEASUREMENT_TEMPL SET template = (SELECT t.template FROM EAM_MEASUREMENT_TEMPL_TMP t WHERE t.ID = EAM_MEASUREMENT_TEMPL.ID) WHERE DEFAULT_INTERVAL != 0
        </statement>
        <statement desc="Clean up TMP table" targetDB="mysql">
            DROP TABLE EAM_MEASUREMENT_TEMPL_TMP
        </statement>
      </schema-directSQL>
      <schema-directSQL>
        <statement desc="Remove Raw Measurements">
            DELETE FROM EAM_MEASUREMENT WHERE measurement_class='R'
        </statement>
        <statement desc="Remove Raw Templates">
            DELETE FROM EAM_MEASUREMENT_TEMPL WHERE default_interval=0
        </statement>
        <statement desc="Drop unused expression_data column">
            ALTER TABLE EAM_MEASUREMENT_TEMPL DROP COLUMN expression_data
        </statement>
        <statement desc="Drop unused cid column">
            ALTER TABLE EAM_MEASUREMENT_TEMPL DROP COLUMN cid
        </statement>
        <statement desc="Drop unused cid column">
            ALTER TABLE EAM_MEASUREMENT_CAT DROP COLUMN cid
        </statement>
        <statement desc="Drop unused cid column">
            ALTER TABLE EAM_MONITORABLE_TYPE DROP COLUMN cid
        </statement>
        <statement desc="Drop unused cid column">
            ALTER TABLE EAM_MEASUREMENT DROP COLUMN cid
        </statement>
        <!-- XXX: fail="false" here due to possible primary key re-org on
                  oracle dump/restore -->
        <statement targetDB="oracle" fail="false" desc="Drop discriminator column on EAM_MEASUREMENT">
            ALTER TABLE EAM_MEASUREMENT DROP COLUMN measurement_class
        </statement>
        <statement targetDB="mysql" desc="Drop discriminator column on EAM_MEASUREMENT">
            ALTER TABLE EAM_MEASUREMENT DROP COLUMN measurement_class
        </statement>
        <statement targetDB="postgresql" desc="Drop discriminator column on EAM_MEASUREMENT">
            ALTER TABLE EAM_MEASUREMENT DROP COLUMN measurement_class
        </statement>
        <statement desc="Drop unused Measurement argument table">
            DROP TABLE EAM_MEASUREMENT_ARG
        </statement>
        <statement targetDB='postgresql'>
            DROP SEQUENCE EAM_MEASUREMENT_ARG_ID_SEQ
        </statement>
        <statement targetDB='oracle'>
            DROP SEQUENCE EAM_MEASUREMENT_ARG_ID_SEQ
        </statement>
        <statement targetDB="mysql">
            DELETE FROM HQ_SEQUENCE where seq_name = 'EAM_MEASUREMENT_ARG'
        </statement>
      </schema-directSQL>
  </schemaSpec>

  <schemaSpec version="3.102">
      <schema-alterColumn columnType="BOOLEAN"
                          table="EAM_MEASUREMENT"
                          column="ENABLED"
                          nullable="NOT NULL"/>

      <schema-alterColumn columnType="INTEGER"
                          table="EAM_MEASUREMENT"
                          column="COLL_INTERVAL"
                          nullable="NOT NULL"/>
  </schemaSpec>

  <schemaSpec version="3.103">
    <schema-addColumn table="EAM_EVENT_LOG" column="RESOURCE_ID" 
                      columnType="INTEGER">
      <initializer>
        update EAM_EVENT_LOG  set RESOURCE_ID =
          (select r.ID from EAM_RESOURCE r,
                  (select ID, 1 AS APPDEF_TYPE from EAM_RESOURCE_TYPE WHERE CID = 301
                   union all
                   select ID, 2 AS APPDEF_TYPE from EAM_RESOURCE_TYPE WHERE CID = 303
                   union all
                   select ID, 3 AS APPDEF_TYPE from EAM_RESOURCE_TYPE WHERE CID = 305) m
           where EAM_EVENT_LOG.entity_id = r.INSTANCE_ID and
                 r.RESOURCE_TYPE_ID = m.ID and
                 EAM_EVENT_LOG.entity_type = m.APPDEF_TYPE )
      </initializer>
    </schema-addColumn>
    <schema-directSQL>
      <statement desc="Create new index for resource_id">
        delete from EAM_EVENT_LOG where resource_id is null
      </statement>
      <statement>
        alter table EAM_EVENT_LOG drop column entity_id
      </statement>
      <statement>
        alter table EAM_EVENT_LOG drop column entity_type
      </statement>
    </schema-directSQL>
    <schema-alterColumn table="EAM_EVENT_LOG"
                        column="RESOURCE_ID"
                        columnType="INTEGER"
                        nullable="NOT NULL"/>
  </schemaSpec>
  
  <schemaSpec version="3.104">
    <schema-directSQL>
      <statement targetDB="oracle" fail="false">
        drop index event_log_idx
      </statement>                  
      <statement targetDB="postgresql" fail="false">
        drop index event_log_idx
      </statement>                  
      <statement targetDB="mysql" fail="false">
        drop index event_log_idx on EAM_EVENT_LOG
      </statement>                  
      <statement>
        create index EVENT_LOG_IDX on EAM_EVENT_LOG (timestamp, resource_id)
      </statement>
      <statement>
        alter table EAM_EVENT_LOG 
          add constraint fk55818051fc176ae foreign key (resource_id) 
              references EAM_RESOURCE(id)
      </statement>
    </schema-directSQL>
  </schemaSpec>

  <schemaSpec version="3.105">
    <schema-directSQL>
      <statement desc="Creating new HQ_AVAIL_DATA_RLE table">
        create table HQ_AVAIL_DATA_RLE (
          MEASUREMENT_ID int not null
        )
      </statement>
      <statement targetDB="postgresql">
        alter table HQ_AVAIL_DATA_RLE add AVAILVAL numeric(24,5)
      </statement>
      <statement targetDB="postgresql">
        alter table HQ_AVAIL_DATA_RLE add STARTIME int8 NOT NULL
      </statement>
      <statement targetDB="postgresql">
        alter table HQ_AVAIL_DATA_RLE add ENDTIME int8 default 9223372036854775807 NOT NULL
      </statement>
      <statement targetDB="oracle">
        alter table HQ_AVAIL_DATA_RLE add AVAILVAL number(24,5)
      </statement>
      <statement targetDB="oracle">
        alter table HQ_AVAIL_DATA_RLE add STARTIME number(19,0) NOT NULL
      </statement>
      <statement targetDB="oracle">
        alter table HQ_AVAIL_DATA_RLE add ENDTIME number(19,0) default 9223372036854775807 NOT NULL
      </statement>
      <statement targetDB="mysql">
        alter table HQ_AVAIL_DATA_RLE add AVAILVAL numeric(24,5)
      </statement>
      <statement targetDB="mysql">
        alter table HQ_AVAIL_DATA_RLE add STARTIME bigint NOT NULL
      </statement>
      <statement targetDB="mysql">
        alter table HQ_AVAIL_DATA_RLE add ENDTIME bigint default 9223372036854775807 NOT NULL
      </statement>
      <statement desc="Add foreign key constraint for measurement_id">
        alter table HQ_AVAIL_DATA_RLE add constraint FK6E8F9E9CAE18683B foreign key (MEASUREMENT_ID)
          references EAM_MEASUREMENT (ID)
      </statement>

      <statement desc="Insert data from HQ_METRIC_DATA_0D_0S table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from HQ_METRIC_DATA_0D_0S d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from HQ_METRIC_DATA_0D_0S d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from HQ_METRIC_DATA_0D_0S d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from HQ_METRIC_DATA_0D_1S table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from HQ_METRIC_DATA_1D_0S d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from HQ_METRIC_DATA_1D_0S d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from HQ_METRIC_DATA_1D_0S d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from HQ_METRIC_DATA_1D_0S table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from HQ_METRIC_DATA_1D_0S d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from HQ_METRIC_DATA_1D_0S d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from HQ_METRIC_DATA_1D_0S d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from HQ_METRIC_DATA_1D_1S table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from HQ_METRIC_DATA_1D_1S d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from HQ_METRIC_DATA_1D_1S d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from HQ_METRIC_DATA_1D_1S d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from HQ_METRIC_DATA_2D_0S table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from HQ_METRIC_DATA_2D_0S d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from HQ_METRIC_DATA_2D_0S d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from HQ_METRIC_DATA_2D_0S d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from HQ_METRIC_DATA_2D_1S table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from HQ_METRIC_DATA_2D_1S d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from HQ_METRIC_DATA_2D_1S d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from HQ_METRIC_DATA_2D_1S d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from HQ_METRIC_DATA_3D_0S table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from HQ_METRIC_DATA_3D_0S d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from HQ_METRIC_DATA_3D_0S d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from HQ_METRIC_DATA_3D_0S d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from HQ_METRIC_DATA_3D_1S table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from HQ_METRIC_DATA_3D_1S d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from HQ_METRIC_DATA_3D_1S d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from HQ_METRIC_DATA_3D_1S d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from HQ_METRIC_DATA_4D_0S table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from HQ_METRIC_DATA_4D_0S d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from HQ_METRIC_DATA_4D_0S d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from HQ_METRIC_DATA_4D_0S d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from HQ_METRIC_DATA_4D_1S table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from HQ_METRIC_DATA_4D_1S d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from HQ_METRIC_DATA_4D_1S d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from HQ_METRIC_DATA_4D_1S d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from HQ_METRIC_DATA_5D_0S table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from HQ_METRIC_DATA_5D_0S d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from HQ_METRIC_DATA_5D_0S d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from HQ_METRIC_DATA_5D_0S d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from HQ_METRIC_DATA_5D_1S table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from HQ_METRIC_DATA_5D_1S d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from HQ_METRIC_DATA_5D_1S d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from HQ_METRIC_DATA_5D_1S d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from HQ_METRIC_DATA_6D_0S table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from HQ_METRIC_DATA_6D_0S d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from HQ_METRIC_DATA_6D_0S d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from HQ_METRIC_DATA_6D_0S d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from HQ_METRIC_DATA_6D_1S table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from HQ_METRIC_DATA_6D_1S d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from HQ_METRIC_DATA_6D_1S d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from HQ_METRIC_DATA_6D_1S d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from HQ_METRIC_DATA_7D_0S table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from HQ_METRIC_DATA_7D_0S d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from HQ_METRIC_DATA_7D_0S d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from HQ_METRIC_DATA_7D_0S d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from HQ_METRIC_DATA_7D_1S table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from HQ_METRIC_DATA_7D_1S d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from HQ_METRIC_DATA_7D_1S d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from HQ_METRIC_DATA_7D_1S d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from HQ_METRIC_DATA_8D_0S table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from HQ_METRIC_DATA_8D_0S d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from HQ_METRIC_DATA_8D_0S d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from HQ_METRIC_DATA_8D_0S d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from HQ_METRIC_DATA_8D_1S table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from HQ_METRIC_DATA_8D_1S d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from HQ_METRIC_DATA_8D_1S d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from HQ_METRIC_DATA_8D_1S d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from EAM_MEASUREMENT_DATA_1H table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from EAM_MEASUREMENT_DATA_1H d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from EAM_MEASUREMENT_DATA_1H d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from EAM_MEASUREMENT_DATA_1H d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from EAM_MEASUREMENT_DATA_6H table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from EAM_MEASUREMENT_DATA_6H d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from EAM_MEASUREMENT_DATA_6H d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from EAM_MEASUREMENT_DATA_6H d2
                                 where measurement_id = d1.measurement_id))
      </statement>
      <statement desc="Insert data from EAM_MEASUREMENT_DATA_1D table">
        insert into HQ_AVAIL_DATA_RLE (startime, availval, measurement_id)
          select d1.timestamp, d1.value, d1.measurement_id
          from EAM_MEASUREMENT_DATA_1D d1, EAM_MEASUREMENT m, EAM_MEASUREMENT_TEMPL t
          where alias = 'Availability' and m.template_id = t.id and measurement_id = m.id and
                (not value = (select value from EAM_MEASUREMENT_DATA_1D d2
                              where measurement_id = d1.measurement_id and timestamp =
                                   (d1.timestamp - m.coll_interval))
                 or timestamp = (select min(timestamp) from EAM_MEASUREMENT_DATA_1D d2
                                 where measurement_id = d1.measurement_id))
      </statement>
    </schema-directSQL>
  </schemaSpec>

  <schemaSpec version="3.105.1">
    <availRLEUpgrade/>
  </schemaSpec>

  <schemaSpec version="3.105.2">
    <schema-directSQL>
      <statement desc="Add primary key to HQ_AVAIL_DATA_RLE">
        alter table HQ_AVAIL_DATA_RLE add primary key (STARTIME , MEASUREMENT_ID)
      </statement>
      <statement desc="adding index to HQ_AVAIL_DATA_RLE (AVAILVAL)">
        create index AVAIL_RLE_VAL_IDX ON HQ_AVAIL_DATA_RLE (AVAILVAL)
      </statement>
      <statement desc="adding index to HQ_AVAIL_DATA_RLE (ENDTIME,AVAILVAL)">
        create index AVAIL_RLE_ENDTIME_VAL_IDX ON HQ_AVAIL_DATA_RLE (ENDTIME,AVAILVAL)
      </statement>
      <statement desc="adding index to HQ_AVAIL_DATA_RLE (ENDTIME)">
        create index AVAIL_RLE_ENDTIME_IDX ON HQ_AVAIL_DATA_RLE (ENDTIME)
      </statement>
      <statement desc="adding index to HQ_AVAIL_DATA_RLE (MEASUREMENT_ID)">
        create index AVAIL_RLE_MEASID_IDX on HQ_AVAIL_DATA_RLE (MEASUREMENT_ID)
      </statement>
      <statement targetDB="mysql" desc="(MySQL only) adding index to HQ_AVAIL_DATA_RLE (MEASUREMENT_ID)">
        create index MEASUREMENT_ID_YY on HQ_AVAIL_DATA_RLE (MEASUREMENT_ID)
      </statement>
    </schema-directSQL>
  </schemaSpec>

  <schemaSpec version="3.106">
    <schema-directSQL>
      <statement desc="Clean up orphaned group resource IDs in eam_crispo_array">
        DELETE FROM EAM_CRISPO_ARRAY WHERE VAL LIKE '5:%' AND VAL NOT IN (SELECT '5:'||ID FROM EAM_RESOURCE_GROUP)
      </statement>
    </schema-directSQL>
  </schemaSpec>

</dbupgrade>
</target>

</project>
