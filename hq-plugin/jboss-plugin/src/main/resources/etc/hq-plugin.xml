<?xml version="1.0"?>
<!--

    NOTE: This copyright does *not* cover user programs that use HQ
    program services by normal system calls through the application
    program interfaces provided as part of the Hyperic Plug-in Development
    Kit or the Hyperic Client Development Kit - this is merely considered
    normal use of the program, and does *not* fall under the heading of
     "derived work".

     Copyright (C) [2009-2010], VMware, Inc.
     This file is part of HQ.

     HQ is free software; you can redistribute it and/or modify
     it under the terms version 2 of the GNU General Public License as
     published by the Free Software Foundation. This program is distributed
     in the hope that it will be useful, but WITHOUT ANY WARRANTY; without
     even the implied warranty of MERCHANTABILITY or FITNESS FOR A
     PARTICULAR PURPOSE. See the GNU General Public License for more
     details.

     You should have received a copy of the GNU General Public License
     along with this program; if not, write to the Free Software
     Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307
     USA.


-->


<!DOCTYPE plugin [
  <!ENTITY hibernate-plugin SYSTEM "/pdk/plugins/hibernate-services.xml">
]>

<!--
  NOTE: This copyright does *not* cover user programs that use HQ
  program services by normal system calls through the application
  program interfaces provided as part of the Hyperic Plug-in Development
  Kit or the Hyperic Client Development Kit - this is merely considered
  normal use of the program, and does *not* fall under the heading of
  "derived work".
  
  Copyright (C) [2004, 2005, 2006], Hyperic, Inc.
  This file is part of HQ.
  
  HQ is free software; you can redistribute it and/or modify
  it under the terms version 2 of the GNU General Public License as
  published by the Free Software Foundation. This program is distributed
  in the hope that it will be useful, but WITHOUT ANY WARRANTY; without
  even the implied warranty of MERCHANTABILITY or FITNESS FOR A
  PARTICULAR PURPOSE. See the GNU General Public License for more
  details.
  
 You should have received a copy of the GNU General Public License
 along with this program; if not, write to the Free Software
 Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307
 USA.
-->

<plugin name="jboss" class="JBossProductPlugin">
    <property name="PLUGIN_VERSION" value="@project.version@"/>

    <classpath>
        <include name="client/jnp-client.jar"/>
        <include name="client/jboss-common-client.jar"/>
        <include name="client/jboss-jsr77-client.jar"/>
        <include name="client/jbossall-client.jar"/>
        <include name="client/log4j.jar"/>
        <include name="client/jmx-rmi-connector-client.jar"/>
        <include name="lib/jboss-system.jar"/>
        <include name="lib/jboss-jmx.jar"/>
        <include name="lib/jboss-management.jar"/>
        <include name="lib/dom4j.jar"/>
        <!-- used underneath javax.management.Query.match() -->
        <include name="lib/gnu-regexp.jar"/>
        <!-- required for MainDeployer.listDeployed() -->
        <include name="lib/endorsed/xercesImpl.jar"/>
        <include name="lib/endorsed/xml-apis.jar"/>

        <include name="server/default/lib/jboss-management.jar"/>
        <include name="server/all/lib/jboss-management.jar"/>
        <!-- for jndi authentication -->
        <include name="server/default/lib/jbosssx.jar"/>
        <include name="server/all/lib/jbosssx.jar"/>

        <!-- relative to $installpath incase
        server/{default,all} do not exist -->
        <include name="lib/jboss-management.jar"/>
        <include name="lib/jbosssx.jar"/>
    </classpath>

    <filter name="url" value="java.naming.provider.url"/>

    <filter name="user" value="java.naming.security.principal"/>

    <filter name="pass" value="java.naming.security.credentials"/>
    
    <filter name="template" value="${OBJECT_NAME}:${alias}" />
	
    <property name="template" value="${OBJECT_NAME}:${alias}" />

    <!-- appended to each template by MeasurementInfoXML -->
    <property name="template-config"
              value="${url}=%${url}%,${user}=%${user}%,${pass}=%${pass}%"/>

    <filter name="TxManager"
            value="jboss:service=TransactionManager"/>

    <filter name="JMSMessageCache"
            value="jboss.mq:service=MessageCache"/>

    <filter name="EJB"
            value="jboss.management.local:name=%ejb.name%,J2EEServer=Local,J2EEApplication=%j2ee.application%,EJBModule=%ejb.jar%"/>

    <filter name="EJBService"
            value="jboss.j2ee:jndiName=%ejb.name%,service=EJB"/>

    <filter name="EJBPool" value="${EJBService},plugin=pool"/>
  			
    <filter name="EJBCache" value="${EJBService},plugin=cache"/>

    <!-- ObjectName properties used in the control plugins -->

    <property name="JCAConnectionPool"
              value="jboss.jca:service=ManagedConnectionPool,name=%jca.connpool%"/>
  
    <property name="measurement-class"
              value="org.hyperic.hq.plugin.jboss.JBossMeasurementPlugin" />
  
    <property name="control-class"
              value="org.hyperic.hq.plugin.jboss.JBossServiceControlPlugin" />

    <metrics name="JBoss 3.2">
        <metric name="Availability"
                alias="Availability"
                template="jboss.system:service=MainDeployer:StateString"
                category="AVAILABILITY"
                indicator="true"
                units="percentage"
                collectionType="dynamic"/>

        <!-- ServerInfo metrics -->
        <metric name="Active Thread Count"
                alias="ActiveThreadCount"
                template="jboss.system:type=ServerInfo:${alias}"
                category="THROUGHPUT"
                indicator="true"
                units="none"
                collectionType="dynamic"/>

        <metric name="Active Thread Group Count"
                alias="ActiveThreadGroupCount"
                template="jboss.system:type=ServerInfo:${alias}"
                category="THROUGHPUT"
                units="none"
                collectionType="dynamic"/>

        <metric name="JVM Free Memory"
                alias="FreeMemory"
                template="jboss.system:type=ServerInfo:${alias}"
                category="UTILIZATION"
                units="B"
                collectionType="dynamic"/>

        <metric name="JVM Total Memory"
                alias="TotalMemory"
                template="jboss.system:type=ServerInfo:${alias}"
                category="UTILIZATION"
                indicator="true"
                units="B"
                collectionType="dynamic"/>

        <metric name="JVM Max Memory"
                alias="MaxMemory"
                template="jboss.system:type=ServerInfo:${alias}"
                category="UTILIZATION"
                units="B"
                collectionType="static"/>

        <!-- transaction manager -->
        <metric name="Transactions Active"
                alias="TxCount"
                template="${TxManager}:TransactionCount"
                category="UTILIZATION"
                units="none"
                collectionType="dynamic"/>

        <metric name="Transactions Committed"
                alias="TxCommits"
                template="${TxManager}:CommitCount"
                category="UTILIZATION"
                units="none"
                collectionType="trendsup"/>

        <metric name="Transactions Rolledback"
                alias="TxRollbacks"
                template="${TxManager}:RollbackCount"
                category="UTILIZATION"
                units="none"
                collectionType="trendsup"/>

        <metric name="JMS Message Cache Size"
                alias="TotalCacheSize"
                template="${JMSMessageCache}:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="dynamic"/>

        <metric name="JMS Message Cache Hits"
                alias="CacheHits"
                template="${JMSMessageCache}:${alias}"
                category="THROUGHPUT"
                units="none"
                collectionType="trendsup"/>

        <metric name="JMS Message Cache Misses"
                alias="CacheMisses"
                template="${JMSMessageCache}:${alias}"
                category="THROUGHPUT"
                units="none"
                collectionType="trendsup"/>

        <metric name="JMS Message Cache Current Memory Usage"
                alias="CurrentMemoryUsage"
                template="${JMSMessageCache}:${alias}"
                category="UTILIZATION"
                units="B"
                collectionType="dynamic"/>

        <metric name="JMS Message Cache High Memory Mark"
                alias="HighMemoryMark"
                template="${JMSMessageCache}:${alias}"
                category="UTILIZATION"
                units="B"
                collectionType="static"/>

        <metric name="JMS Message Cache Max Memory Mark"
                alias="MaxMemoryMark"
                template="${JMSMessageCache}:${alias}"
                category="UTILIZATION"
                units="B"
                collectionType="static"/>
    </metrics>

    <metrics name="JBoss 5.0">
        <metric name="Availability"
                alias="Availability"
                template="jboss.system:service=MainDeployer:StateString"
                category="AVAILABILITY"
                indicator="true"
                units="percentage"
                collectionType="dynamic"/>

        <!-- ServerInfo metrics -->
        <metric name="Active Thread Count"
                alias="ActiveThreadCount"
                template="jboss.system:type=ServerInfo:${alias}"
                category="THROUGHPUT"
                indicator="true"
                units="none"
                collectionType="dynamic"/>

        <metric name="Active Thread Group Count"
                alias="ActiveThreadGroupCount"
                template="jboss.system:type=ServerInfo:${alias}"
                category="THROUGHPUT"
                units="none"
                collectionType="dynamic"/>

        <metric name="JVM Free Memory"
                alias="FreeMemory"
                template="jboss.system:type=ServerInfo:${alias}"
                category="UTILIZATION"
                units="B"
                collectionType="dynamic"/>

        <metric name="JVM Total Memory"
                alias="TotalMemory"
                template="jboss.system:type=ServerInfo:${alias}"
                category="UTILIZATION"
                indicator="true"
                units="B"
                collectionType="dynamic"/>

        <metric name="JVM Max Memory"
                alias="MaxMemory"
                template="jboss.system:type=ServerInfo:${alias}"
                category="UTILIZATION"
                units="B"
                collectionType="static"/>

        <!-- transaction manager -->
        <metric name="Transactions Active"
                alias="TxCount"
                template="${TxManager}:TransactionCount"
                category="UTILIZATION"
                units="none"
                collectionType="dynamic"/>

        <metric name="Transactions Committed"
                alias="TxCommits"
                template="${TxManager}:CommitCount"
                category="UTILIZATION"
                units="none"
                collectionType="trendsup"/>

        <metric name="Transactions Rolledback"
                alias="TxRollbacks"
                template="${TxManager}:RollbackCount"
                category="UTILIZATION"
                units="none"
                collectionType="trendsup"/>
    </metrics>

    <metrics name="JBoss 3.2 JCA Connection Pool">
        <metric name="Min Connections"
                alias="MinSize"
                template="${JCAConnectionPool}:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="static"/>

        <metric name="Max Connections"
                alias="MaxSize"
                template="${JCAConnectionPool}:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="static"/>

        <metric name="Total Connections"
                alias="ConnectionCount"
                template="${JCAConnectionPool}:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="dynamic"/>

        <metric name="Available Connections"
                alias="AvailableConnectionCount"
                template="${JCAConnectionPool}:${alias}"
                category="UTILIZATION"
                indicator="true"
                units="none"
                collectionType="dynamic"/>

        <metric name="Active Connections"
                alias="InUseConnectionCount"
                template="${JCAConnectionPool}:${alias}"
                category="UTILIZATION"
                indicator="true"
                units="none"
                collectionType="dynamic"/>

        <metric name="Connections Created"
                alias="ConnectionCreatedCount"
                template="${JCAConnectionPool}:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="trendsup"/>

        <metric name="Connections Destroyed"
                alias="ConnectionDestroyedCount"
                template="${JCAConnectionPool}:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="trendsup"/>

        <metric name="Availability"
                alias="Availability"
                template="${JCAConnectionPool}:StateString"
                category="AVAILABILITY"
                indicator="true"
                units="percentage"
                collectionType="dynamic"/>
    </metrics>

    <metrics name="JBoss 3.2 Stateless Session EJB">
        <metric name="Create Calls"
                alias="StatisticCreateCount"
                template="${EJB},j2eeType=StatelessSessionBean:${alias}"
                category="UTILIZATION"
                indicator="true"
                units="none"
                collectionType="trendsup"/>

        <metric name="Remove Calls"
                alias="StatisticRemoveCount"
                template="${EJB},j2eeType=StatelessSessionBean:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="trendsup"/>

        <metric name="Method-Ready Beans"
                alias="StatisticMethodReadyCount"
                template="${EJB},j2eeType=StatelessSessionBean:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="dynamic"/>

        <metric name="PoolSize"
                alias="CurrentSize"
                template="${EJBPool}:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="dynamic"/>

        <metric name="MaxPoolSize"
                alias="MaxSize"
                template="${EJBPool}:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="dynamic"/>

        <metric name="Availability"
                alias="Availability"
                template="${EJB},j2eeType=StatelessSessionBean:StateManageable"
                category="AVAILABILITY"
                indicator="true"
                units="percentage"
                collectionType="dynamic"/>
    </metrics>

    <metrics name="JBoss 3.2 Stateful Session EJB">
        <metric name="Create Calls"
                alias="StatisticCreateCount"
                template="${EJB},j2eeType=StatefulSessionBean:${alias}"
                category="UTILIZATION"
                indicator="true"
                units="none"
                collectionType="dynamic"/>

        <metric name="Remove Calls"
                alias="StatisticRemoveCount"
                template="${EJB},j2eeType=StatefulSessionBean:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="dynamic"/>

        <metric name="Method-Ready Beans"
                alias="StatisticMethodReadyCount"
                template="${EJB},j2eeType=StatefulSessionBean:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="dynamic"/>

        <metric name="Passive Beans"
                alias="StatisticPassiveCount"
                template="${EJB},j2eeType=StatefulSessionBean:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="dynamic"/>

        <metric name="Availability"
                alias="Availability"
                template="${EJB},j2eeType=StatefulSessionBean:StateManageable"
                category="AVAILABILITY"
                indicator="true"
                units="percentage"
                collectionType="dynamic"/>
    </metrics>

    <metrics name="JBoss 3.2 Entity EJB">
        <metric name="Create Calls"
                alias="StatisticCreateCount"
                template="${EJB},j2eeType=EntityBean:${alias}"
                category="UTILIZATION"
                indicator="true"
                units="none"
                collectionType="trendsup"/>

        <metric name="Remove Calls"
                alias="StatisticRemoveCount"
                template="${EJB},j2eeType=EntityBean:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="trendsup"/>

        <metric name="Ready Beans"
                alias="StatisticReadyCount"
                template="${EJB},j2eeType=EntityBean:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="dynamic"/>

        <metric name="Pooled Beans"
                alias="StatisticPooledCount"
                template="${EJB},j2eeType=EntityBean:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="dynamic"/>

        <metric name="CacheSize"
                alias="CacheSize"
                template="${EJBCache}:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="dynamic"/>

        <metric name="PassivatedCount"
                alias="PassivatedCount"
                template="${EJBCache}:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="trendsup"/>

        <metric name="PoolSize"
                alias="CurrentSize"
                template="${EJBPool}:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="dynamic"/>

        <metric name="MaxPoolSize"
                alias="MaxSize"
                template="${EJBPool}:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="dynamic"/>

        <metric name="Availability"
                alias="Availability"
                template="${EJB},j2eeType=EntityBean:StateManageable"
                category="AVAILABILITY"
                indicator="true"
                units="percentage"
                collectionType="dynamic"/>
    </metrics>

    <metrics name="JBoss 3.2 Message Driven EJB">
        <metric name="Create Calls"
                alias="StatisticCreateCount"
                template="${EJB},j2eeType=MessageDrivenBean:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="trendsup"/>

        <metric name="Remove Calls"
                alias="StatisticRemoveCount"
                template="${EJB},j2eeType=MessageDrivenBean:${alias}"
                category="UTILIZATION"
                units="none"
                collectionType="trendsup"/>

        <metric name="Messages Received"
                alias="StatisticMessageCount"
                template="${EJB},j2eeType=MessageDrivenBean:${alias}"
                category="UTILIZATION"
                indicator="true"
                units="none"
                collectionType="trendsup"/>

        <metric name="Availability"
                alias="Availability"
                template="${EJB},j2eeType=MessageDrivenBean:StateManageable"
                category="AVAILABILITY"
                indicator="true"
                units="percentage"
                collectionType="dynamic"/>
    </metrics>

    <!-- note that the templates are not exactly the same.
    jboss 4.0 changed the case of some attribute names,
    the JBoss4MeasurementPlugin.translate method makes the
    adjustments.  -->
    <metrics name="JBoss 4.0" include="JBoss 3.2"/>

    <metrics name="JBoss 4.0 JCA Connection Pool"
             include="JBoss 3.2 JCA Connection Pool"/>

    <metrics name="JBoss 4.0 Stateless Session EJB"
             include="JBoss 3.2 Stateless Session EJB"/>

    <metrics name="JBoss 4.0 Stateful Session EJB"
             include="JBoss 3.2 Stateful Session EJB"/>

    <metrics name="JBoss 4.0 Entity EJB"
             include="JBoss 3.2 Entity EJB"/>

    <metrics name="JBoss 4.0 Message Driven EJB"
             include="JBoss 3.2 Message Driven EJB"/>

    <metrics name="jchannel">
        <metric name="Availability"
                template="${JCHANNEL_OBJECT_NAME}:Connected"
                indicator="true"/>

        <metric name="Number of Messages"
                template="${JCHANNEL_OBJECT_NAME}:NumMessages"
                category="THROUGHPUT"
                indicator="true"
                collectionType="trendsup"/>

        <metric name="Sent Messages"
                template="${JCHANNEL_OBJECT_NAME}:SentMessages"
                category="THROUGHPUT"
                indicator="true"
                collectionType="trendsup"/>

        <metric name="Sent Bytes"
                template="${JCHANNEL_OBJECT_NAME}:SentBytes"
                category="THROUGHPUT"
                indicator="true"
                units="B"
                collectionType="trendsup"/>

        <metric name="Received Bytes"
                template="${JCHANNEL_OBJECT_NAME}:ReceivedBytes"
                category="THROUGHPUT"
                indicator="true"
                units="B"
                collectionType="trendsup"/>
    </metrics>

    <filter name="JCHANNEL_OBJECT_NAME"
            value="JGroups:channel=%channel%"/>

    <metrics name="JBoss 4.0 JGroups Channel" include="jchannel"/>

    <filter name="JCHANNEL_OBJECT_NAME"
            value="jboss.jgroups:type=channel,cluster=%cluster%"/>

    <metrics name="JBoss 4.2 JGroups Channel" include="jchannel"/>

    <help name="header">
  <![CDATA[
    <p>
    <b>jboss.installpath</b> must be configured in agent.properties,
    for example:
    </p>
    <pre>   jboss.installpath=]]>
    </help>

    <help name="footer">
  <![CDATA[
    </pre>
  ]]>
    </help>

    <config name="EJB">
        <option name="ejb.name"
                description="EJB Name"
                default=""/>
        <option name="ejb.jar"
                description="EJB Module (JAR)"
                default=""/>
        <option name="j2ee.application"
                description="J2EE Application"
                default=""/>
        <option name="listen.ports"
                description="Listening Ports" optional="true"/>
    </config>

    <server name="JBoss"
            version="3.2"
            description="Application Server"
            platforms="Unix,Win32">

        <config>
            <option name="${url}"
                    description="Naming Provider URL"
                    default="jnp://localhost:1099"/>
            <option name="${user}"
                    optional="true"
                    description="Username"/>
            <option name="${pass}"
                    type="secret"
                    optional="true"
                    description="Password"/>
            <option name="listen.ports"
                    description="Listening Ports" optional="true"/>
        </config>

        <config type="control">
            <option name="start.args"
                    description="Server start program arguments"
                    optional="true"/>
            <option name="stop.program"
                    description="Server stop program (default uses JMX)"
                    optional="true"/>
            <option name="stop.args"
                    description="Server stop program arguments"
                    optional="true"
                    default="-S"/>
            <option name="configSet"
                    description="Server config file set"
                    optional="true"
                    default="default"/>
        </config>

        <properties>
            <property name="version"
                      description="JBoss Version"/>
            <property name="JavaVersion"
                      description="Java Version"/>
            <property name="JavaVendor"
                      description="Java Vendor"/>
            <property name="BuildDate"
                      description="Build Date"/>
            <property name="VersionName"
                      description="Version Name"/>
        </properties>

        <plugin type="measurement"
                class="JBossMeasurementPlugin"/>

        <plugin type="autoinventory"
                class="JBossDetector"/>

        <plugin type="control"
                class="JBossServerControlPlugin"/>

        <!-- default control plugin impl for services -->
        <property name="SERVICE_CONTROL_PLUGIN"
                  value="${package}.JBossServiceControlPlugin"/>

        <property name="DEFAULT_LOG_FILE"
                  value="log/server.log"/>

        <plugin type="log_track"
                class="org.hyperic.hq.product.Log4JLogTrackPlugin"/>

        <actions include="stop,start,restart,runGarbageCollector"/>

        <scan>
            <include name="/**/server/*/conf/jboss-service.xml"/>
        </scan>

    &hibernate-plugin;

        <service name="JGroups Channel">
            <property name="OBJECT_NAME"
                      value="JGroups:channel=%channel%"/>

            <plugin type="autoinventory"/>

            <config>
                <option name="channel"
                        description="Channel Name"
                        default=""/>
            </config>
        </service>

        <service name="Stateless Session EJB">
            <config include="EJB"/>
        </service>

        <service name="Stateful Session EJB">
            <config include="EJB"/>
        </service>

        <service name="Entity EJB">
            <config include="EJB"/>
        </service>

        <service name="Message Driven EJB">
            <config include="EJB"/>
        </service>

        <service name="JMS Destination" internal="true">
            <config>
                <option name="name"
                        description="JMS Destination"
                        default=""/>
            </config>

            <property name="OBJECT_NAME"
                      value="jboss.mq.destination:service=Queue,name=%name%"/>

            <plugin type="autoinventory"/>

            <plugin type="control"
                    class="JBossStateServiceControlPlugin"/>

            <actions include="stop,start,removeAllMessages"/>

            <properties>
                <property name="InMemory"
                          description="In Memory"/>

                <property name="RedeliveryDelay"
                          description="Redelivery Delay"/>

                <property name="RedeliveryLimit"
                          description="Redelivery Limit"/>

                <property name="MaxDepth"
                          description="Max Depth"/>

                <property name="JNDIName"
                          description="JNDI Name"/>
            </properties>

            <metric name="Availability"
                    template="${OBJECT_NAME}:StateString"
                    indicator="true"/>

            <metric name="Messages in Queue"
                    template="${OBJECT_NAME}:QueueDepth"
                    category="THROUGHPUT"
                    indicator="true"/>

            <metric name="Receivers Count"
                    template="${OBJECT_NAME}:ReceiversCount"
                    indicator="true"/>

            <metric name="Scheduled Message Count"
                    template="${OBJECT_NAME}:ScheduledMessageCount"/>
        </service>

        <service name="JMS Topic" internal="true">
            <config>
                <option name="name"
                        description="JMS Topic"
                        default=""/>
            </config>

            <property name="OBJECT_NAME"
                      value="jboss.mq.destination:service=Topic,name=%name%"/>

            <plugin type="autoinventory"/>

            <plugin type="control"
                    class="JBossStateServiceControlPlugin"/>

            <actions include="stop,start,removeAllMessages"/>

            <properties>
                <property name="InMemory"
                          description="In Memory"/>

                <property name="RedeliveryDelay"
                          description="Redelivery Delay"/>

                <property name="RedeliveryLimit"
                          description="Redelivery Limit"/>

                <property name="MaxDepth"
                          description="Max Depth"/>

                <property name="JNDIName"
                          description="JNDI Name"/>
            </properties>

            <metric name="Availability"
                    template="${OBJECT_NAME}:StateString"
                    indicator="true"/>

            <metric name="All Subscriptions Count"
                    template="${OBJECT_NAME}:AllSubscriptionsCount"
                    category="UTILIZATION"
                    indicator="true"/>

            <metric name="Non Durable Subscriptions Count"
                    template="${OBJECT_NAME}:NonDurableSubscriptionsCount"
                    category="UTILIZATION"/>

            <metric name="Durable Subscriptions Count"
                    template="${OBJECT_NAME}:DurableSubscriptionsCount"
                    category="UTILIZATION"
                    indicator="true"/>

            <metric name="All Message Count"
                    template="${OBJECT_NAME}:AllMessageCount"
                    category="THROUGHPUT"
                    indicator="true"/>

            <metric name="Durable Message Count"
                    template="${OBJECT_NAME}:DurableMessageCount"
                    category="THROUGHPUT"
                    indicator="true"/>

            <metric name="NonDurableMessageCount"
                    template="${OBJECT_NAME}:NonDurableMessageCount"
                    category="THROUGHPUT"/>
        </service>

        <service name="JCA Connection Pool" internal="true">
            <config>
                <option name="jca.connpool"
                        description="JCA Connection Pool"
                        default=""/>
            </config>

            <properties>
                <property name="Criteria"
                          description="Connection Pool Criteria"/>
            </properties>

            <plugin type="control"
                    class="JBossJCAControlPlugin"/>

            <actions include="stop,start,restart,flush"/>
        </service>
        
        <filter name="conf" value=".*\.xml|.*\.cfg|.*\.properties|.*\.ini|.*\.conf|.*\.config|.*\.policy"/>
        <filter name="code" value=".*\.jar|.*\.dll|.*\.class|.*\.asp|.*\.aspx|.*\.php|.*\.pl|.*\.py|.*\.pyc|.*\.cgi"/>    
        <plugin type="config_track"
                class="org.hyperic.hq.product.FileChangeTrackPlugin">
            <monitored>
                <folder path="conf" recursive="true" filter="${conf}"/>
                <folder path="deploy" recursive="true" filter="${code}|${conf}"/>
            </monitored>
        </plugin>
        <property name="DEFAULT_CONFIG_TRACK_ENABLE" value="false" />
        
    </server>

    <server name="JBoss"
            version="4.0"
            include="3.2">

        <plugin type="measurement"
                class="JBoss4MeasurementPlugin"/>

        <service name="JCA Data Source">
            <config>
                <option name="name"
                        description="JNDI Name"
                        default="DefaultDS"/>
            </config>

            <property name="OBJECT_NAME"
                      value="jboss.jca:name=%name%,service=DataSourceBinding"/>

            <metric name="Availability"
                    template="${OBJECT_NAME}:StateString"
                    indicator="true"/>

            <plugin type="autoinventory"/>

            <plugin type="control"
                    class="JBossStateServiceControlPlugin"/>
            <actions include="stop,start"/>
        </service>

        <service name="EJB3">
            <config>
                <option name="module"
                        description="Module Name"
                        default="EJB3Trail-ejb3.ejb3"/>
            </config>

            <property name="OBJECT_NAME"
                      value="jboss.j2ee:module=%module%,service=EJB3"/>

            <metric name="Availability"
                    template="${OBJECT_NAME}:StateString"
                    indicator="true"/>

            <plugin type="autoinventory"/>

            <plugin type="control"
                    class="JBossStateServiceControlPlugin"/>
            <actions include="stop,start"/>
        </service>
    </server>

    <server name="JBoss"
            version="4.2"
            include="4.0">

        <service name="JGroups Channel">
            <property name="OBJECT_NAME"
                      value="jboss.jgroups:type=channel,cluster=%cluster%"/>

            <plugin type="autoinventory"/>

            <config>
                <option name="cluster"
                        description="Cluster Name"
                        default="DefaultCluster"/>
                <option name="listen.ports"
                        description="Listening Ports" optional="true"/>
            </config>
        </service>
    </server>

    <server name="JBoss"
            version="4.3"
            include="4.2">
        <service name="JMS Queue Destination" internal="true">
            <config>
                <option name="name"
                        description="JMS Destination"
                        default=""/>
            </config>

            <property name="OBJECT_NAME"
                      value="jboss.messaging.destination:service=Queue,name=%name%"/>

            <plugin type="autoinventory"/>

            <plugin type="measurement" class="JBoss5MeasurementPlugin"/>
            <plugin type="control"
                    class="JBoss5ServiceControlPlugin"/>

            <actions include="stop,start,removeAllMessages"/>

            <properties>
                <property name="RedeliveryDelay" description="Redelivery Delay" />
                <property name="JNDIName" description="JNDI Name" />
                <property name="ServerPeer" description="Server Peer" />
                <property name="CreatedProgrammatically" description="Created Programmatically" />
                <property name="MaxSize" description="Max Size" />
                <property name="FullSize" description="Full Size" />
                <property name="PageSize" description="Page Size" />
                <property name="DownCacheSize" description="Down Cache Size" />
                <property name="Clustered" description="Clustered" />
                <property name="MaxDeliveryAttempts" description="Max Delivery Attempts" />
                <property name="MessageCount" description="All Message Count" />
                <property name="ConsumerCount" description="All Subscriptions Count" />
            </properties>

            <metric name="Availability" template="jboss.system:service=MainDeployer:StateString"
                    indicator="true" />

            <metric name="Messages in Queue"
                    alias="MessageCount"
                    template="${OBJECT_NAME}:${alias}"
                    category="THROUGHPUT"
                    indicator="true"/>

            <metric name="Delivering Count"
                    alias="DeliveringCount"
                    template="${OBJECT_NAME}:${alias}"
                    indicator="true"/>

            <metric name="Consumer Count"
                    alias="ConsumerCount"
                    template="${OBJECT_NAME}:${alias}"
                    indicator="true"/>

            <metric name="Scheduled Message Count"
                    alias="ScheduledMessageCount"
                    template="${OBJECT_NAME}:${alias}"/>
        </service>

        <service name="JMS Topic" internal="true">
            <config>
                <option name="name"
                        description="JMS Topic"
                        default=""/>
            </config>

            <property name="OBJECT_NAME"
                      value="jboss.messaging.destination:service=Topic,name=%name%"/>

            <plugin type="autoinventory"/>

            <plugin type="control"
                    class="JBoss5ServiceControlPlugin"/>

            <actions include="stop,start,removeAllMessages"/>

            <properties>
                <property name="RedeliveryDelay" description="Redelivery Delay" />
                <property name="ServerPeer" description="Server Peer" />
                <property name="JNDIName" description="JNDI Name" />
                <property name="CreatedProgrammatically" description="Created Programmatically" />
                <property name="MaxSize" description="Max Size" />
                <property name="FullSize" description="Full Size" />
                <property name="PageSize" description="Page Size" />
                <property name="DownCacheSize" description="Down Cache Size" />
                <property name="Clustered" description="Clustered" />
                <property name="MaxDeliveryAttempts" description="Max Delivery Attempts" />
                <property name="AllMessageCount" description="All Message Count" />
                <property name="AllSubscriptionsCount" description="All Subscriptions Count" />
            </properties>

            <metric name="Availability" template="jboss.system:service=MainDeployer:StateString"
                    indicator="true" />

            <metric name="All Subscriptions Count"
                    template="${OBJECT_NAME}:AllSubscriptionsCount"
                    category="UTILIZATION"
                    indicator="true"/>

            <metric name="Non Durable Subscriptions Count"
                    template="${OBJECT_NAME}:NonDurableSubscriptionsCount"
                    category="UTILIZATION"/>

            <metric name="Durable Subscriptions Count"
                    template="${OBJECT_NAME}:DurableSubscriptionsCount"
                    category="UTILIZATION"
                    indicator="true"/>

            <metric name="All Message Count"
                    template="${OBJECT_NAME}:AllMessageCount"
                    category="THROUGHPUT"
                    indicator="true"/>

            <metric name="Durable Message Count"
                    template="${OBJECT_NAME}:DurableMessageCount"
                    category="THROUGHPUT"
                    indicator="true"/>

            <metric name="NonDurableMessageCount"
                    template="${OBJECT_NAME}:NonDurableMessageCount"
                    category="THROUGHPUT"/>
        </service>
          
    </server>

    <metrics name="JBoss 5.0 JCA Connection Pool" include="JBoss 4.2 JCA Connection Pool"/>
    <metrics name="JBoss 5.0 JGroups Channel" include="JBoss 4.2 JGroups Channel"/>
    <metrics name="JBoss 5.0 Entity EJB" include="JBoss 4.2 Entity EJB"/>

    <server name="JBoss" version="5.0">

        <config>
            <option name="${url}"
                    description="Naming Provider URL"
                    default="jnp://localhost:1099"/>
            <option name="${user}"
                    optional="true"
                    description="Username"/>
            <option name="${pass}"
                    type="secret"
                    optional="true"
                    description="Password"/>
            <option name="listen.ports"
                    description="Listening Ports" optional="true"/>
        </config>

        <config type="control">
            <option name="start.args"
                    description="Server start program arguments"
                    optional="true"/>
            <option name="stop.program"
                    description="Server stop program (default uses JMX)"
                    optional="true"/>
            <option name="stop.args"
                    description="Server stop program arguments"
                    optional="true"
                    default="-S"/>
            <option name="configSet"
                    description="Server config file set"
                    optional="true"
                    default="default"/>
        </config>

        <properties>
            <property name="version"
                      description="JBoss Version"/>
            <property name="JavaVersion"
                      description="Java Version"/>
            <property name="JavaVendor"
                      description="Java Vendor"/>
            <property name="BuildDate"
                      description="Build Date"/>
            <property name="VersionName"
                      description="Version Name"/>
        </properties>

        <plugin type="measurement"
                class="JBoss5MeasurementPlugin"/>

        <plugin type="autoinventory"
                class="JBossDetector"/>

        <plugin type="control"
                class="JBossServerControlPlugin"/>

        <!-- default control plugin impl for services -->
        <property name="SERVICE_CONTROL_PLUGIN"
                  value="${package}.JBossServiceControlPlugin"/>

        <property name="DEFAULT_LOG_FILE"
                  value="log/server.log"/>

        <plugin type="log_track"
                class="org.hyperic.hq.product.Log4JLogTrackPlugin"/>

        <plugin type="config_track"
                class="org.hyperic.hq.product.FileChangeTrackPlugin">
            <monitored>
                <folder path="conf" recursive="true" filter="${conf}"/>
                <folder path="deploy" recursive="true" filter="${code}|${conf}"/>
            </monitored>
        </plugin>
        <property name="DEFAULT_CONFIG_TRACK_ENABLE" value="false" />
	    
        <actions include="stop,start,restart,runGarbageCollector"/>

        <scan>
            <include name="/**/server/*/conf/jboss-service.xml"/>
        </scan>

    &hibernate-plugin;

        <service name="JGroups Channel">
            <metric name="Timer Threads"
                    template="${JCHANNEL_OBJECT_NAME}:TimerThreads"
                    category="THROUGHPUT"
                    indicator="true"/>

            <metric name="Tasks In Timer"
                    template="${JCHANNEL_OBJECT_NAME}:NumberOfTasksInTimer"
                    category="THROUGHPUT"
                    indicator="true"/>

        </service>

        <service name="Stateless Session EJB">
            <config>
                <option name="name" description="EJB Name"/>
                <option name="jar" description="Module Name"/>
                <option name="ear" description="Ear File" optional="true"/>
            </config>
            <property name="MBEAN_CLASS" value="org.jboss.ejb3.stateless.StatelessDelegateWrapper"/>
            <property name="OBJECT_NAME" value="jboss.j2ee:jar=%jar%,ear=_%ear%,name=%name%,service=EJB3"/>
            
            <plugin type="autoinventory"/>

            <plugin type="measurement" class="JBoss5MeasurementPlugin"/>

            <metrics >
                <metric name="Availability"
                        template="${OBJECT_NAME}:${alias}"
                        indicator="true"/>
                <metric name="AvailableCount"
                        alias="AvailableCount"
                        template="${OBJECT_NAME}:${alias}"
                        category="UTILIZATION"
                        indicator="true"
                        units="none"/>

                <metric name="MaxSize"
                        alias="MaxSize"
                        template="${OBJECT_NAME}:${alias}"
                        category="UTILIZATION"
                        units="none"/>

                <metric name="CurrentSize"
                        alias="CurrentSize"
                        template="${OBJECT_NAME}:${alias}"
                        category="UTILIZATION"
                        units="none"/>

                <metric name="CreateCount"
                        alias="CreateCount"
                        template="${OBJECT_NAME}:${alias}"
                        category="UTILIZATION"
                        units="none"
                        collectionType="trendsup"/>

                <metric name="RemoveCount"
                        alias="RemoveCount"
                        template="${OBJECT_NAME}:${alias}"
                        category="UTILIZATION"
                        units="none"
                        collectionType="trendsup"/>
            </metrics>

        </service>

        <service name="Stateful Session EJB">
            <config>
                <option name="name" description="EJB Name"/>
                <option name="jar" description="Module Name"/>
                <option name="ear" description="Ear File" optional="true"/>
            </config>

            <property name="MBEAN_CLASS" value="org.jboss.ejb3.stateful.StatefulDelegateWrapper"/>
            <property name="OBJECT_NAME" value="jboss.j2ee:jar=%jar%,ear=_%ear%,name=%name%,service=EJB3"/>

            <plugin type="autoinventory"/>

            <plugin type="measurement" class="JBoss5MeasurementPlugin"/>

            <metrics>
                <metric name="Availability"
                        template="${OBJECT_NAME}:${alias}"
                        indicator="true"/>

                <metric name="Cache Size"
                        alias="CacheSize"
                        template="${OBJECT_NAME}:${alias}"
                        category="UTILIZATION"
                        indicator="true"
                        units="none"/>

                <metric name="Available Count"
                        alias="AvailableCount"
                        template="${OBJECT_NAME}:${alias}"
                        category="UTILIZATION"
                        units="none"/>

                <metric name="Max Size"
                        alias="MaxSize"
                        template="${OBJECT_NAME}:${alias}"
                        category="UTILIZATION"
                        units="none"/>

                <metric name="Total Size"
                        alias="TotalSize"
                        template="${OBJECT_NAME}:${alias}"
                        category="UTILIZATION"
                        units="none"/>

                <metric name="Current Size"
                        alias="CurrentSize"
                        template="${OBJECT_NAME}:${alias}"
                        category="UTILIZATION"
                        indicator="true"
                        units="none"/>

                <metric name="Create Count"
                        alias="CreateCount"
                        template="${OBJECT_NAME}:${alias}"
                        category="UTILIZATION"
                        units="none"
                        collectionType="trendsup"/>

                <metric name="Remove Count"
                        alias="RemoveCount"
                        template="${OBJECT_NAME}:${alias}"
                        category="UTILIZATION"
                        units="none"
                        collectionType="trendsup"/>

                <metric name="Passivated Count"
                        alias="PassivatedCount"
                        template="${OBJECT_NAME}:${alias}"
                        category="UTILIZATION"
                        units="none"
                        collectionType="trendsup"/>
            </metrics>
        </service>

        <!--service name="Entity EJB">
            <config include="EJB"/>
        </service-->

        <service name="Message Driven EJB">
            <config>
                <option name="name" description="EJB Name"/>
                <option name="jar" description="Module Name"/>
                <option name="ear" description="Ear File" optional="true"/>
            </config>

            <property name="MBEAN_CLASS" value="org.jboss.ejb3.mdb.MessagingDelegateWrapper"/>
            <property name="OBJECT_NAME" value="jboss.j2ee:jar=%jar%,ear=_%ear%,name=%name%,service=EJB3"/>

            <plugin type="autoinventory"/>

            <plugin type="measurement" class="JBoss5MeasurementPlugin"/>

            <metric name="Availability"
                    template="${OBJECT_NAME}:${alias}"
                    indicator="true"/>
            <metric name="Min Pool Size"
                    alias="MinPoolSize"
                    template="${OBJECT_NAME}:${alias}"
                    category="UTILIZATION"
                    units="none"/>

            <metric name="Max Messages"
                    alias="MaxMessages"
                    template="${OBJECT_NAME}:${alias}"
                    category="UTILIZATION"
                    units="none"/>

            <metric name="Keep AliveMillis"
                    alias="KeepAliveMillis"
                    template="${OBJECT_NAME}:${alias}"
                    category="UTILIZATION"
                    units="sec"
                    collectionType="static"/>

            <metric name="Max Pool Size"
                    alias="MaxPoolSize"
                    template="${OBJECT_NAME}:${alias}"
                    category="UTILIZATION"
                    indicator="true"
                    units="none"/>

        </service>

        <service name="JMS QUEUE Destination" internal="true">
            <config>
                <option name="name"
                        description="JMS Destination"
                        default=""/>
            </config>

            <property name="OBJECT_NAME"
                      value="jboss.messaging.destination:service=Queue,name=%name%"/>

            <plugin type="autoinventory"/>

            <plugin type="measurement" class="JBoss5MeasurementPlugin"/>
            <plugin type="control"
                    class="JBoss5ServiceControlPlugin"/>

            <actions include="stop,start,removeAllMessages"/>

            <properties>
                <property name="InMemory"
                          description="In Memory"/>

                <property name="RedeliveryDelay"
                          description="Redelivery Delay"/>

                <property name="RedeliveryLimit"
                          description="Redelivery Limit"/>

                <property name="MaxDepth"
                          description="Max Depth"/>

                <property name="JNDIName"
                          description="JNDI Name"/>
            </properties>

            <metric name="Availability"
                    template="${OBJECT_NAME}:${alias}"
                    indicator="true"/>

            <metric name="Messages in Queue"
                    alias="MessageCount"
                    template="${OBJECT_NAME}:${alias}"
                    category="THROUGHPUT"
                    indicator="true"/>

            <metric name="Delivering Count"
                    alias="DeliveringCount"
                    template="${OBJECT_NAME}:${alias}"
                    indicator="true"/>

            <metric name="Consumer Count"
                    alias="ConsumerCount"
                    template="${OBJECT_NAME}:${alias}"
                    indicator="true"/>

            <metric name="Scheduled Message Count"
                    alias="ScheduledMessageCount"
                    template="${OBJECT_NAME}:${alias}"/>
        </service>

        <service name="JMS Topic" internal="true">
            <config>
                <option name="name"
                        description="JMS Topic"
                        default=""/>
            </config>

            <property name="OBJECT_NAME"
                      value="jboss.messaging.destination:service=Topic,name=%name%"/>

            <plugin type="autoinventory"/>

            <plugin type="control"
                    class="JBoss5ServiceControlPlugin"/>

            <actions include="stop,start,removeAllMessages"/>

            <properties>
                <property name="InMemory"
                          description="In Memory"/>

                <property name="RedeliveryDelay"
                          description="Redelivery Delay"/>

                <property name="RedeliveryLimit"
                          description="Redelivery Limit"/>

                <property name="MaxDepth"
                          description="Max Depth"/>

                <property name="JNDIName"
                          description="JNDI Name"/>
            </properties>

            <metric name="Availability"
                    template="${OBJECT_NAME}:AllMessageCount"
                    indicator="true"/>

            <metric name="All Subscriptions Count"
                    template="${OBJECT_NAME}:AllSubscriptionsCount"
                    category="UTILIZATION"
                    indicator="true"/>

            <metric name="Non Durable Subscriptions Count"
                    template="${OBJECT_NAME}:NonDurableSubscriptionsCount"
                    category="UTILIZATION"/>

            <metric name="Durable Subscriptions Count"
                    template="${OBJECT_NAME}:DurableSubscriptionsCount"
                    category="UTILIZATION"
                    indicator="true"/>

            <metric name="All Message Count"
                    template="${OBJECT_NAME}:AllMessageCount"
                    category="THROUGHPUT"
                    indicator="true"/>

            <metric name="Durable Message Count"
                    template="${OBJECT_NAME}:DurableMessageCount"
                    category="THROUGHPUT"
                    indicator="true"/>

            <metric name="NonDurableMessageCount"
                    template="${OBJECT_NAME}:NonDurableMessageCount"
                    category="THROUGHPUT"/>
        </service>

        <service name="JCA Connection Pool" internal="true">
            <config>
                <option name="jca.connpool"
                        description="JCA Connection Pool"
                        default=""/>
            </config>

            <properties>
                <property name="Criteria"
                          description="Connection Pool Criteria"/>
            </properties>

            <plugin type="control"
                    class="JBossJCAControlPlugin"/>

            <actions include="stop,start,flush"/>


        </service>

        <service name="JCA Data Source">
            <config>
                <option name="name"
                        description="JNDI Name"
                        default="DefaultDS"/>
            </config>

            <property name="OBJECT_NAME"
                      value="jboss.jca:name=%name%,service=DataSourceBinding"/>

            <metric name="Availability"
                    template="${OBJECT_NAME}:StateString"
                    indicator="true"/>

            <plugin type="autoinventory"/>

            <plugin type="control"
                    class="JBoss5ServiceControlPlugin"/>
            <actions include="stop,start"/>
        </service>

        <service name="EJB 3">
            <config>
                <option name="jar" description="Module Name"/>
                <option name="ear" description="Ear File"/>
            </config>

            <property name="MBEAN_CLASS"
                      value="org.jboss.ejb3.deployers.Ejb3JBoss5Deployment"/>
            <property name="OBJECT_NAME"
                      value="jboss.j2ee:jar=%jar%,ear=_%ear%,service=EJB3"/>


            <metric name="Availability"
                    template="${OBJECT_NAME}:State"
                    indicator="true"/>

            <plugin type="autoinventory"/>

            <plugin type="measurement" class="JBoss5MeasurementPlugin"/>
            <plugin type="control"
                    class="JBoss5ServiceControlPlugin"/>
            <actions include="stop,start"/>
        </service>

        <service name="WebApp" internal="true">
            <config>
                <option name="path"
                        description="URL path"
                        default=""/>
            </config>

            <property name="OBJECT_NAME"
                      value="jboss.web:host=localhost,path=%path%,type=Cache"/>

            <plugin type="autoinventory"/>

            <plugin type="measurement" class="JBoss5MeasurementPlugin"/>
            <plugin type="control"
                    class="JBossStateServiceControlPlugin"/>

            <actions include="stop,start"/>

            <metric name="Availability"
                    template="${OBJECT_NAME}:${alias}"
                    indicator="true"/>

            <metric name="Cache MaxSize"
                    alias="cacheMaxSize"
                    template="${OBJECT_NAME}:${alias}"
                    category="THROUGHPUT"
                    indicator="true"/>

            <metric name="Access Count"
                    alias="accessCount"
                    template="${OBJECT_NAME}:${alias}"
                    indicator="true"/>

            <metric name="Cache Size"
                    alias="cacheSize"
                    template="${OBJECT_NAME}:${alias}"
                    indicator="true"/>

            <metric name="Hits Count"
                    alias="hitsCount"
                    template="${OBJECT_NAME}:${alias}"/>
        </service>
    </server>
    
    <server name="JBoss" version="5.1" include="5.0"/>

    <server name="JBoss" version="6.0" include="5.0">
        <service name="JMS HornetQ QUEUE" internal="true">
            <config>
                <option name="name" description="JMS Destination" default=""/>
            </config>

            <property name="OBJECT_NAME"  value="org.hornetq:module=JMS,type=Queue,name=%name%"/>

            <plugin type="autoinventory"/>
            <plugin type="measurement" class="JBoss5MeasurementPlugin"/>
            <plugin type="control" class="JBoss5ServiceControlPlugin"/>

            <actions include="pause,resume"/>

            <properties>
                <property name="Address" description="Address"/>
                <property name="DeadLetterAddress" description="DeadLetter Address"/>
                <property name="ExpiryAddress" description="Expiry Address"/>
                <property name="JNDIBindings" description="JNDI Bindings"/>
            </properties>

            <filter name="template" value="${OBJECT_NAME}:${alias}"/>

            <metric name="Availability"  indicator="true"/>
            <metric name="Messages in Queue" alias="MessageCount" category="THROUGHPUT" indicator="true"/>
            <metric name="Messages Add" alias="MessagesAdded" collectionType="trendsup" indicator="true"/>
            <metric name="Delivering Count" alias="DeliveringCount" indicator="true"/>
            <metric name="Consumer Count" alias="ConsumerCount" indicator="true"/>
            <metric name="Scheduled Message Count" alias="ScheduledCount"/>
        </service>

        <service name="JMS HornetQ Topic" internal="true">
            <config>
                <option name="name" description="JMS Topic" default=""/>
            </config>

            <property name="OBJECT_NAME" value="org.hornetq:module=JMS,type=Topic,name=%name%"/>

            <plugin type="autoinventory"/>
            <plugin type="control" class="JBoss5ServiceControlPlugin"/>

            <actions include="stop,start,removeAllMessages"/>

            <properties>
                <property name="Address" description="Address"/>
                <property name="JNDIBindings" description="JNDI Bindings"/>
            </properties>
                    
            <filter name="template" value="${OBJECT_NAME}:${alias}"/>

            <metric name="Availability" indicator="true"/>
            <metric name="Subscriptions Count" alias="SubscriptionCount" category="UTILIZATION" indicator="true"/>
            <metric name="Non Durable Subscriptions Count" alias="NonDurableSubscriptionCount" category="UTILIZATION"/>
            <metric name="Durable Subscriptions Count" alias="DurableSubscriptionCount" category="UTILIZATION" indicator="true"/>
            <metric name="Message Count" alias="MessageCount" category="THROUGHPUT" indicator="true"/>
            <metric name="Durable Message Count" alias="DurableMessageCount" category="THROUGHPUT" indicator="true"/>
            <metric name="NonDurableMessageCount" alias="NonDurableMessageCount" category="THROUGHPUT"/>
        </service>
        <service name="WebApp" internal="true">
            <property name="CONTROL_OBJECT_NAME"
                      value="jboss.web:j2eeType=WebModule,name=//localhost%path%,J2EEApplication=none,J2EEServer=none"/>
            <plugin type="control" class="JBoss6StateServiceControlPlugin"/>
        </service>
    </server>
    
    <server name="JBoss Host Controller" version="7">
        <plugin type="autoinventory" class="org.hyperic.hq.plugin.jboss7.JBossHostControllerDetector"/>
        <plugin type="measurement" class="org.hyperic.hq.product.MeasurementPlugin"/>
        <plugin type="collector" class="org.hyperic.hq.plugin.jboss7.JBossHostControllerCollector"/>
        <plugin type="control" class="org.hyperic.hq.plugin.jboss7.JBoss7Control"/>

        <plugin type="config_track" class="org.hyperic.hq.product.FileChangeTrackPlugin">
            <monitored>
                <folder path="configuration" recursive="false" filter=".*\.xml|.*\.properties"/>
            </monitored>
        </plugin>
        <property name="DEFAULT_CONFIG_TRACK_ENABLE" value="false" />

        <config>
            <option name="jboss7.addr" description="Http Address" default="localhost"/>
            <option name="jboss7.port" description="Http Port" default="9990"/>
            <option name="jboss7.https" description="Use SSL" default="false" type="boolean"/>
            <option name="jboss7.user" description="Username" default="guest"/>
            <option name="jboss7.pass" description="Password" default="guest" type="secret"/>
            <option name="jboss7.host" description="Host Name"/>
            <option name="listen.ports" description="Listening Ports" optional="true"/>
        </config>
        
        <config type="control">
            <option name="jboss7.start.script" description="Abusulte start script path"/>
            <option name="jboss7.start.prefix" description="Start script prefix" optional="true"/>
            <option name="jboss7.start.args" description="Start script arguments" optional="true"/>
        </config>
        <help>
            <![CDATA[
                  <p>
                    <h2>Configure JBoss 7 Host Controller for Monitoring</h2>
                        <h3>Config properties</h3>
                        <ol>
                            <li><b>addr</b>: Management HTTP IP/HostName (usualy: localhost)</li>
                            <li><b>port</b>: Management HTTP Listen Port</li>
                            <li><b>https</b>: Use https/ssl</li>
                            <li><b>user</b>: Administrator User name</li>
                            <li><b>pass</b>: Administrator User password</li>
                            <li><b>host</b>: Host Controller Name</li>
                            <li><b>start.script</b>: Absolute path to the JBoss startup stacript (ei. /home/user/jboss-as-7/bin/standalone.sh)</li>
                            <li><b>start.prefix</b>: Prefix for the startup script (ei. "sudo -s")</li>
                            <li><b>start.args</b>: Argumnets for the startup script</li>
                        </ol>
                        <h3>SSL Configuration Requirements (Hyperic 4.6 and later)</h3>
                        There are new SSL configuration requirements for secure communication between a Hyperic 4.6 agent and a JBoss.
                        <ul>
                            <li>If the <b>accept.unverified.certificates</b> property is <b>false</b> (default value) in the <b>agent.properties</b> file, 
                            the JBoss's unverified SSL certificate needs to be manually imported to a keystore that the Hyperic 4.6 agent can access.
                            Otherwise, secure communication between the Hyperic 4.6 agent and JBoss will fail.
                            </li>
                            <li>If the <b>accept.unverified.certificates</b> property is <b>true</b> in the <b>agent.properties</b> file, the JBoss plugin will automatically
                            import the unverified SSL certificate of the JBoss to the keystore accessible to the Hyperic 4.6 agent.
                            <u>This is not recommended</u> because it is less secure and will expose the Hyperic agent to man-in-the-middle attacks.
                            </li>
                        </ul> 
                  </p>
                  <p>
                    <h3>Help Docs</h3>
                    <a href="http://support.hyperic.com/display/DOCS46/JBoss" target="_new">Monitoring and Managing JBoss</a>
                  </p>
            ]]>
        </help>

        <filter name="server-connection" value="jboss7.addr=%jboss7.addr%,jboss7.port=%jboss7.port%,jboss7.user=%jboss7.user%,jboss7.pass=%jboss7.pass%,jboss7.https=%jboss7.https%,jboss7.host=%jboss7.host%,jboss7.server=%jboss7.server%"/>
        <property name="template" value="jboss7:${server-connection}:${alias}"/>
        <metric name="Availability" alias="Availability" indicator="true"/>
        <metric name="thread-count"/>
        <metric name="peak-thread-count" />
        <metric name="total-started-thread-count" />
        <metric name="daemon-thread-count" />
        <metric name="current-thread-cpu-time" units="ns"/>
        <metric name="current-thread-user-time" units="ns"/>
        <metric name="Heap Used %" alias="h.used.p" units="percentage" indicator="true"/>
        <metric name="Heap Init" alias="h.init" units="B"/>
        <metric name="Heap used" alias="h.used" units="B"/>
        <metric name="Heap Commited" alias="h.committed" units="B"/>
        <metric name="Heap Max" alias="h.max" units="B"/>
        <metric name="Non-Heap Used %" alias="nh.used.p" units="percentage" indicator="true"/>
        <metric name="Non-Heap Init" alias="nh.init" units="B"/>
        <metric name="Non-Heap used" alias="nh.used" units="B"/>
        <metric name="Non-Heap Commited" alias="nh.committed" units="B"/>
        <metric name="Non-Heap Max" alias="nh.max" units="B"/>
    </server>
        
    <server name="JBoss Host Controller" version="7.1" include="JBoss Host Controller 7">
    </server>

    <server name="JBoss Host Controller" version="7.2" include="JBoss Host Controller 7">
    </server>

    <server name="JBoss Host Controller" version="7.3" include="JBoss Host Controller 7">
    </server>

    <server name="JBoss Host Controller" version="7.4" include="JBoss Host Controller 7">
    </server>

    <server name="JBoss" version="7" include="JBoss Host Controller 7">
        <plugin type="autoinventory" class="org.hyperic.hq.plugin.jboss7.JBossStandaloneDetector"/>
        <plugin type="collector" class="org.hyperic.hq.plugin.jboss7.JBoss7Collector"/>
        <config>
            <option name="jboss7.addr" description="Http Address" default="localhost"/>
            <option name="jboss7.port" description="Http Port" default="9990"/>
            <option name="jboss7.https" description="Use SSL" default="false" type="boolean"/>
            <option name="jboss7.user" description="Username" default="guest"/>
            <option name="jboss7.pass" description="Password" default="guest" type="secret"/>
            <option name="listen.ports"
                    description="Listening Ports" optional="true"/>
        </config>
        <plugin type="config_track" class="org.hyperic.hq.product.FileChangeTrackPlugin">
            <monitored>
                <folder path="configuration" recursive="false" filter=".*\.xml|.*\.properties"/>
            </monitored>
        </plugin>

        <help>
            <![CDATA[
                  <p>
                    <h2>Configure JBoss 7 for Monitoring</h2>
                        <h3>Config properties</h3>
                        <ol>
                            <li><b>addr</b>: Management HTTP IP/HostName (usualy: localhost)</li>
                            <li><b>port</b>: Management HTTP Listen Port</li>
                            <li><b>https</b>: Use https/ssl</li>
                            <li><b>user</b>: Administrator User name</li>
                            <li><b>pass</b>: Administrator User password</li>
                            <li><b>start.script</b>: Absolute path to the JBoss startup stacript (ei. /home/user/jboss-as-7/bin/standalone.sh)</li>
                            <li><b>start.prefix</b>: Prefix for the startup script (ei. "sudo -s")</li>
                            <li><b>start.args</b>: Argumnets for the startup script</li>
                        </ol>
                        <h3>SSL Configuration Requirements (Hyperic 4.6 and later)</h3>
                        There are new SSL configuration requirements for secure communication between a Hyperic 4.6 agent and a JBoss.
                        <ul>
                            <li>If the <b>accept.unverified.certificates</b> property is <b>false</b> (default value) in the <b>agent.properties</b> file, 
                            the JBoss's unverified SSL certificate needs to be manually imported to a keystore that the Hyperic 4.6 agent can access.
                            Otherwise, secure communication between the Hyperic 4.6 agent and JBoss will fail.
                            </li>
                            <li>If the <b>accept.unverified.certificates</b> property is <b>true</b> in the <b>agent.properties</b> file, the JBoss plugin will automatically
                            import the unverified SSL certificate of the JBoss to the keystore accessible to the Hyperic 4.6 agent.
                            <u>This is not recommended</u> because it is less secure and will expose the Hyperic agent to man-in-the-middle attacks.
                            </li>
                        </ul> 
                  </p>
                  <p>
                    <h3>Help Docs</h3>
                    <a href="http://support.hyperic.com/display/DOCS46/JBoss" target="_new">Monitoring and Managing JBoss</a>
                  </p>
            ]]>
        </help>

        <metric name="Object Pending Finalization" alias="object-pending-finalization-count"/>            
        <metric name="Aborted Transactions" alias="aborted-transactions" collectionType="trendsup"/>
        <metric name="Application Transactions Rollbacks" alias="application-rollbacks" collectionType="trendsup"/>
        <metric name="Committed Transactions" alias="committed-transactions" collectionType="trendsup"/>
        <metric name="Heuristics Transactions" alias="heuristics" collectionType="trendsup"/>
        <metric name="Inflight Transactions" alias="inflight-transactions"/>
        <metric name="Nested Transactions" alias="nested-transactions" collectionType="trendsup"/>
        <metric name="Resource Transactions Rollbacks" alias="resource-rollbacks" collectionType="trendsup"/>
        <metric name="Timed-out Transactions" alias="timed-out-transactions" collectionType="trendsup" indicator="true"/>
        <metric name="Number of Transactions" alias="transactions" collectionType="trendsup" indicator="true"/>

        <service name="Datasource">
            <plugin type="collector" class="org.hyperic.hq.plugin.jboss7.DataSourceCollector"/>
            <config>
                <option name="name" description="DataSource Name"/>
                <option name="type" description="DataSource Type (data-source or xa-data-source)"/>
            </config>
            <properties>
                <property name="jndi" description="JNDI Name"/>
                <property name="driver" description="Driver"/>
            </properties>
            <property name="template" value="jboss7:datasource=%name%,type=%type%,${server-connection}:${alias}"/>
            <metric name="Availability" alias="Availability" indicator="true"/>
            <metric name="ActiveCount" alias="ActiveCount" indicator="true"/>
            <metric name="AvailableCount" alias="AvailableCount" indicator="true"/>
            <metric name="AverageBlockingTime" alias="AverageBlockingTime" units="ms"/>
            <metric name="AverageCreationTime" alias="AverageCreationTime" units="ms"/>
            <metric name="CreatedCount" alias="CreatedCount" collectionType="trendsup"/>
            <metric name="DestroyedCount" alias="DestroyedCount" collectionType="trendsup"/>
            <metric name="MaxCreationTime" alias="MaxCreationTime" units="ms"/>
            <metric name="MaxUsedCount" alias="MaxUsedCount" collectionType="trendsup"/>
            <metric name="MaxWaitCount" alias="MaxWaitCount" collectionType="trendsup"/>
            <metric name="MaxWaitTime" alias="MaxWaitTime" units="ms" indicator="true"/>
            <metric name="PreparedStatementCacheAccessCount" alias="PreparedStatementCacheAccessCount" collectionType="trendsup"/>
            <metric name="PreparedStatementCacheAddCount" alias="PreparedStatementCacheAddCount" collectionType="trendsup"/>
            <metric name="PreparedStatementCacheCurrentSize" alias="PreparedStatementCacheCurrentSize" collectionType="trendsup"/>
            <metric name="PreparedStatementCacheDeleteCount" alias="PreparedStatementCacheDeleteCount" collectionType="trendsup"/>
            <metric name="PreparedStatementCacheHitCount" alias="PreparedStatementCacheHitCount" collectionType="trendsup" indicator="true"/>
            <metric name="PreparedStatementCacheMissCount" alias="PreparedStatementCacheMissCount" collectionType="trendsup" indicator="true"/>
            <metric name="TimedOut" alias="TimedOut" collectionType="trendsup"/>
            <metric name="TotalBlockingTime" alias="TotalBlockingTime" units="ms"/>
            <metric name="TotalCreationTime" alias="TotalCreationTime" units="ms"/>
        </service>
        <service name="Connector">
            <plugin type="collector" class="org.hyperic.hq.plugin.jboss7.ConnectorCollector"/>
            <config>
                <option name="name" description="Connector Name"/>
            </config>
            <properties>
                <property name="protocol" description="protocol"/>
                <property name="scheme" description="scheme"/>
            </properties>
            <property name="template" value="jboss7:connector=%name%,${server-connection}:${alias}"/>
            <metric name="Availability"  indicator="true"/>
            <metric name="errorCount" collectionType="trendsup" indicator="true"/>
            <metric name="requestCount" collectionType="trendsup" indicator="true"/>
            <metric name="maxTime" units="ms" indicator="true"/>
            <metric name="bytesSent" collectionType="trendsup"/>
            <metric name="bytesReceived" collectionType="trendsup"/>
            <metric name="processingTime" collectionType="trendsup" units="ms"/>
        </service>
        <service name="deployment">
            <plugin type="collector" class="org.hyperic.hq.plugin.jboss7.DeploymentCollector"/>
            <config>
                <option name="name" description="Deployment Name"/>
            </config>
            <properties>
                <property name="runtime-name" description="runtime-name"/>
            </properties>
            <property name="template" value="jboss7:${server-connection}:%name%.${alias}"/>
            <metric name="Availability"  indicator="true" />
        </service>
    </server>
    
    <server name="JBoss" version="7.1" include="JBoss 7">
    </server>
    
    <server name="JBoss" version="7.2" include="JBoss 7">
    </server>
    
    <server name="JBoss" version="7.3" include="JBoss 7">
    </server>
    
    <server name="JBoss" version="7.4" include="JBoss 7">
    </server>
    
    <server name="JBoss Managed" version="7" include="JBoss 7">
        <plugin type="autoinventory" class="org.hyperic.hq.plugin.jboss7.JBossManagedDetector"/>
        <plugin type="control" class="org.hyperic.hq.plugin.jboss7.JBoss7ManagedControl"/>
        <config>
            <option name="jboss7.addr" description="Http Address" default="localhost"/>
            <option name="jboss7.port" description="Http Port" default="9990"/>
            <option name="jboss7.https" description="Use SSL" default="false" type="boolean"/>
            <option name="jboss7.user" description="Username" default="guest"/>
            <option name="jboss7.pass" description="Password" default="guest" type="secret"/>
            <option name="jboss7.host" description="Host Name"/>
            <option name="jboss7.server" description="Server Name"/>
            <option name="listen.ports"
                    description="Listening Ports" optional="true"/>
        </config>
        <config type="control">
        </config>
        <help>
            <![CDATA[
                  <p>
                    <h2>Configure JBoss 7 Managed for Monitoring</h2>
                        <h3>Config properties</h3>
                        <ol>
                            <li><b>addr</b>: Management HTTP IP/HostName (usualy: localhost)</li>
                            <li><b>port</b>: Management HTTP Listen Port</li>
                            <li><b>https</b>: Use https/ssl</li>
                            <li><b>user</b>: Administrator User name</li>
                            <li><b>pass</b>: Administrator User password</li>
                            <li><b>host</b>: Host Controller Name</li>
                            <li><b>server</b>: Server Name</li>
                        </ol>
                        <h3>SSL Configuration Requirements (Hyperic 4.6 and later)</h3>
                        There are new SSL configuration requirements for secure communication between a Hyperic 4.6 agent and a JBoss.
                        <ul>
                            <li>If the <b>accept.unverified.certificates</b> property is <b>false</b> (default value) in the <b>agent.properties</b> file, 
                            the JBoss's unverified SSL certificate needs to be manually imported to a keystore that the Hyperic 4.6 agent can access.
                            Otherwise, secure communication between the Hyperic 4.6 agent and JBoss will fail.
                            </li>
                            <li>If the <b>accept.unverified.certificates</b> property is <b>true</b> in the <b>agent.properties</b> file, the JBoss plugin will automatically
                            import the unverified SSL certificate of the JBoss to the keystore accessible to the Hyperic 4.6 agent.
                            <u>This is not recommended</u> because it is less secure and will expose the Hyperic agent to man-in-the-middle attacks.
                            </li>
                        </ul> 
                  </p>
                  <p>
                    <h3>Help Docs</h3>
                    <a href="http://support.hyperic.com/display/DOCS46/JBoss" target="_new">Monitoring and Managing JBoss</a>
                  </p>
            ]]>
        </help>
    </server>
    
    <server name="JBoss Managed" version="7.1" include="JBoss Managed 7">
    </server>

    <server name="JBoss Managed" version="7.2" include="JBoss Managed 7">
    </server>

    <server name="JBoss Managed" version="7.3" include="JBoss Managed 7">
    </server>

    <server name="JBoss Managed" version="7.4" include="JBoss Managed 7">
    </server>

</plugin>
