<?xml version="1.0"?>
<!-- NOTE: This copyright does *not* cover user programs that use HQ program 
services by normal system calls through the application program interfaces 
provided as part of the Hyperic Plug-in Development Kit or the Hyperic Client 
Development Kit - this is merely considered normal use of the program, and 
does *not* fall under the heading of "derived work". Copyright (C) [2004-2008], 
Hyperic, Inc. This file is part of HQ. HQ is free software; you can redistribute 
it and/or modify it under the terms version 2 of the GNU General Public License 
as published by the Free Software Foundation. This program is distributed 
in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even 
the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. 
See the GNU General Public License for more details. You should have received 
a copy of the GNU General Public License along with this program; if not, 
write to the Free Software Foundation, Inc., 59 Temple Place, Suite 330, 
Boston, MA 02111-1307 USA. -->

<plugin name="exchange">
    <property name="PLUGIN_VERSION" value="@project.version@" />

    <filter name="store" value="win32:Object=MSExchangeIS" />
    <filter name="cas" value="win32:Object=MSExchangeFBA" />
    <filter name="mta" value="win32:Object=MSExchangeMTA" />
    <filter name="mbox" value="win32:Object=MSExchangeIS Mailbox,Instance=_Total" />
    <filter name="imap4" value="win32:Object=MSExchangeIMAP4,Instance=_Total" />
    <filter name="pop3" value="win32:Object=MSExchangePOP3,Instance=_Total" />
    <filter name="web" value="win32:Object=MSExchange Web Mail,Instance=_Total" />
    <filter name="addressbook" value="win32:Object=MSExchangeAB" />
    <filter name="queue"
            value="win32:Object=MSExchangeTransport Queues,Instance=_Total" />
    <filter name="RpcClientAccess"
            value="win32:Object=MSExchange RpcClientAccess" />
    <filter name="DatabaseInformationStore"
            value="win32:Object=MSExchange Database,Instance=Information Store" />
    <filter name="smtpsend"
            value="win32:Object=MSExchangeTransport SmtpSend,Instance=%name%" />
    <filter name="smtprecv"
            value="win32:Object=MSExchangeTransport SmtpReceive,Instance=%name%" />
    <filter name="smtprecv-total"
            value="win32:Object=MSExchangeTransport SmtpReceive,Instance=_Total" />

    <metrics name="exchange-is-avail">
        <metric name="Availability" template="win32:Service=MSExchangeIS:${alias}"
                indicator="true" />
    </metrics>

		
    <!-- metrics for Exchange Information Store -->
    <filter name="template" value="${store}:${name}" />
    <metrics name="exchange-is">
        <metric name="Availability" template="win32:Service=MSExchangeIS:${alias}"
                indicator="true" />

        <metric name="RPC Packets" template="${template}/sec" category="THROUGHPUT"
                collectionType="trendsup" />

        <metric name="RPC Operations" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" />

        <metric name="Read Bytes RPC Clients" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" units="B" />

        <metric name="Write Bytes RPC Clients" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" units="B" />

        <metric name="RPC Averaged Latency" category="THROUGHPUT"
                units="ms" indicator="true"/>

        <metric name="RPC Num. Of Slow Packets" category="THROUGHPUT"
                collectionType="trendsup" />

        <metric name="Push Notifications Generated" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" />

        <metric name="Push Notifications Skipped" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" />

        <metric name="RPC Requests" category="THROUGHPUT"/>

        <metric name="User Count" indicator="true"/>

        <metric name="Active User Count" />

        <metric name="Maximum Users" collectionType="static" />

        <metric name="Anonymous User Count" />

        <metric name="Active Anonymous User Count" />

        <metric name="Maximum Anonymous Users" collectionType="static" />

        <metric name="Connection Count" category="UTILIZATION" />

        <metric name="Active Connection Count" category="UTILIZATION" />

        <metric name="Maximum Connections" category="UTILIZATION"
                collectionType="static" />

        <metric name="Push Notifications Cache Size" />

        <metric name="Single Appointments Created" collectionType="trendsup" />

        <metric name="Recurring Appointments Created" collectionType="trendsup" />

        <metric name="Single Appointments Modified" collectionType="trendsup" />

        <metric name="Recurring Appointments Modified" collectionType="trendsup" />

        <metric name="Single Appointments Deleted" collectionType="trendsup" />

        <metric name="Recurring Appointments Deleted" collectionType="trendsup" />

        <metric name="Recurring Master Appointments Expanded"
                collectionType="trendsup" />

        <metric name="Appointment Instances Created" collectionType="trendsup" />

        <metric name="Appointment Instances Deleted" collectionType="trendsup" />

        <metric name="FB Publish Count" collectionType="trendsup" />

        <metric name="Background Expansion Queue Length" category="THROUGHPUT"
                collectionType="dynamic" />

        <metric name="Virus Scan Messages Processed" category="THROUGHPUT"
                collectionType="trendsup" />

        <metric name="Virus Scan Messages Cleaned" category="THROUGHPUT"
                collectionType="trendsup" />

        <metric name="Virus Scan Messages Quarantined" category="THROUGHPUT"
                collectionType="trendsup" />

        <metric name="Virus Scan Messages Deleted" category="THROUGHPUT"
                collectionType="trendsup" />

        <metric name="Virus Scan Files Scanned" category="THROUGHPUT"
                collectionType="trendsup" />

        <metric name="Virus Scan Files Cleaned" category="THROUGHPUT"
                collectionType="trendsup" />

        <metric name="Virus Scan Files Quarantined" category="THROUGHPUT"
                collectionType="trendsup" />

        <metric name="Virus Scan Bytes Scanned" category="THROUGHPUT"
                collectionType="trendsup" units="B" />

        <metric name="Virus Scan Queue Length" category="THROUGHPUT"
                collectionType="trendsup" />

        <metric name="Virus Scan Folders Scanned In Background"
                category="THROUGHPUT" collectionType="trendsup" />

        <metric name="Virus Scan Messages Scanned In Background"
                category="THROUGHPUT" collectionType="trendsup" />

        <metric name="VM Largest Block Size" />

        <metric name="VM Total Free Blocks" />

        <metric name="VM Total 16MB Free Blocks" />

        <metric name="VM Total Large Free Block Bytes" />

        <metric name="DL Membership Cache Entries Count" />

        <metric name="DL Membership Cache Size" />

        <metric name="DL Membership Cache Hits" collectionType="trendsup" />

        <metric name="DL Membership Cache Misses" collectionType="trendsup" />

        <metric name="RPC Clients Bytes Read" category="THROUGHPUT"
                collectionType="trendsup" units="B" />

        <metric name="RPC Clients Bytes Written" category="THROUGHPUT"
                collectionType="trendsup" units="B" />

        <metric name="RPC Clients Uncompressed Bytes Read" category="THROUGHPUT"
                collectionType="trendsup" units="B" />

        <metric name="RPC Clients Uncompressed Bytes Written" category="THROUGHPUT"
                collectionType="trendsup" units="B" />

        <metric name="Slow QP Threads" />

        <metric name="Slow Search Threads" />

    </metrics>


    <!-- fba avail-->
    <metrics name="fba_avail">
        <metric name="Availability" template="win32:Service=MSExchangeFBA:${alias}"
                indicator="true" />
    </metrics>

    <!-- metrics for Exchange client access -->
    <filter name="template" value="${RpcClientAccess}:${name}" />
    <metrics name="rpcClientAccess">
        <metric name="RPC Operations" collectionType="trendsup" category="THROUGHPUT" indicator="true"/>
        <metric name="RPC Averaged Latency" category="THROUGHPUT" indicator="true"/>
        <metric name="Connection Count" category="THROUGHPUT" />
        <metric name="User Count" />
        <metric name="RPC Active User Count" template="${RpcClientAccess}:Active User Count" indicator="true" />
    </metrics>
	
	
    <!-- metrics for Exchange Database(Information Store) -->
    <filter name="template" value="${DatabaseInformationStore}:${name}" />
    <metrics name="databaseInformationStore">
        <metric name="Database Page Fault Stalls" collectionType="trendsup" category="THROUGHPUT" indicator="true"/>
        <metric name="Log Record Stalls" collectionType="trendsup" category="THROUGHPUT" indicator="true"/>
	<metric name="Database Cache % Hit" category="UTILIZATION" indicator="true"/>
	<metric name="Log Threads Waiting" category="THROUGHPUT" indicator="true"/>
    </metrics>
    <filter name="template" value="collector:g=MSExchange Database(Information Store):${name}"/>
    <metrics name="databaseInformationStore2010">
        <metric name="I/O Database Reads Average Latency" category="THROUGHPUT" units="ms" indicator="true"/>
        <metric name="I/O Database Writes Average Latency" category="THROUGHPUT" units="ms" indicator="true"/>
    </metrics>
	
	
    <!-- metrics for Exchange client access 2007 availability-->	
    <metrics name="clientAccess2007Avail">
        <metric name="Availability" template="win32:Service=MSExchangeServiceHost:${alias}"
                indicator="true" />
    </metrics>

    <!-- template="${template}/sec" -->

    <filter name="template" value="MSExchange Availability Service:${name}" />
    <metrics name="Availability-Service">
        <metric name="Average Time to Process a Free Busy Request"
                collectionType="trendsup" indicator="true" />
        <metric name="Availability Requests" template="${template} (sec)"
                collectionType="trendsup" />
    </metrics>

    <filter name="template" value="MSExchange ActiveSync:" />
    <metrics name="ActiveSync">
        <metric name="ActiveSync Requests" template="${template}Requests/sec"
                collectionType="trendsup" category="THROUGHPUT" indicator="true"/>
        <metric name="ActiveSync Ping Commands Pending" template="${template}Ping Commands Pending"
                category="THROUGHPUT" />
        <metric name="ActiveSync Current Requests" template="${template}Current Requests"
                category="THROUGHPUT" />
        <metric name="ActiveSync Average Request Time" template="${template}Average Request Time"
                category="THROUGHPUT" />
        <metric name="ActiveSync Sync Commands" template="${template}Sync Commands/sec"
                collectionType="trendsup" category="THROUGHPUT" />
    </metrics>

    <filter name="template" value="MSExchange OWA:" />
    <metrics name="owa">
        <metric name="OWA Current Unique Users" template="${template}Current Unique Users" 
                indicator="true"/>

        <metric name="OWA Requests" template="${template}Requests/sec"
                collectionType="trendsup" category="THROUGHPUT" indicator="true"/>
        <metric name="OWA Average Response Time" template="${template}Average Response Time"
                category="THROUGHPUT" />
        <metric name="OWA Average Search Time" template="${template}Average Search Time"
                category="THROUGHPUT" indicator="true" />
    </metrics>

    <filter name="template" value="MSExchangeAB:${name}" />
    <metrics name="addressbook">
        <!-- 2010 service -->
        <metric name="Availability" template="win32:Service=MSExchangeAB:${alias}"
                category="AVAILABILITY" indicator="true" />
        <metric name="NSPI Connections Current" indicator="true" />
        <metric name="NSPI Connections" template="${template}/sec"
                collectionType="trendsup" />
        <metric name="NSPI RPC Requests" template="${template}/sec"
                collectionType="trendsup" category="THROUGHPUT" />
        <metric name="Referral RPC Requests" template="${template}/sec"
                collectionType="trendsup" category="THROUGHPUT" />
    </metrics>


    <filter name="template" value="MSExchangeWS:" />
    <metrics name="MSExchangeWS">
        <metric name="WS Requests" template="${template}Requests/sec"
                collectionType="trendsup" category="THROUGHPUT" />
    </metrics>


    <filter name="template" value="MSExchangeAutodiscover:" />
    <metrics name="MSExchangeAutodiscover">
        <metric name="Autodiscover Requests" template="${template}Requests/sec"
                collectionType="trendsup" category="THROUGHPUT" indicator="true"/>
    </metrics>



    <filter name="template" value="Web Service(_Total):" />
    <metrics name="MSExchangeWebService">
        <metric name="Web service Current Connections" template="${template}Current Connections"
                category="THROUGHPUT" />
        <metric name="Web Service Connection Attempts" template="${template}Connection Attempts/sec"
                collectionType="trendsup" category="THROUGHPUT" />
        <metric name="Web Service ISAPI Extension Requests" template="${template}ISAPI Extension Requests/sec"
                collectionType="trendsup" category="THROUGHPUT" />
        <metric name="Web Service Other Request Methods" template="${template}Other Request Methods/sec"
                collectionType="trendsup" category="THROUGHPUT" />
    </metrics>

    <filter name="template" value="LogicalDisk(_Total):${name}" />
    <metrics name="LogicalDisk">
        <metric name="Disk Reads" template="${template}/sec"
                collectionType="trendsup" />
        <metric name="Disk Writes" template="${template}/sec"
                collectionType="trendsup" category="THROUGHPUT" />
    </metrics>

    <filter name="template" value="${web}:${name} (total)" />
    <metrics name="Web">
        <metric name="Availability" template="${http.template}:${alias}"
                category="AVAILABILITY" indicator="true" />

        <metric name="Attachments Deleted" collectionType="trendsup" />

        <metric name="Message/Appointment Deletes" template="${web}:${name}* (total)"
                collectionType="trendsup" />

        <metric name="Message Moves/Copies" template="${web}:${name}* (total)"
                collectionType="trendsup" />

        <metric name="Message/Appointment Saves" collectionType="trendsup" />

        <metric name="Posts Submitted" collectionType="trendsup" />

        <metric name="Names Checked" collectionType="trendsup" />

        <metric name="Recipients Edited" collectionType="trendsup" />

        <metric name="Message Saves" collectionType="trendsup" />

        <metric name="Recipients Saved" collectionType="trendsup" />

        <metric name="Message Sends" indicator="true" collectionType="trendsup" />

        <metric name="Appointment Edit Recurrence" collectionType="trendsup" />

        <metric name="Appointment Updates" collectionType="trendsup" />

        <metric name="Appointment Resolve Free-Busy" collectionType="trendsup" />

        <metric name="Appointment Saves" collectionType="trendsup" />

        <metric name="Appointment Sends" collectionType="trendsup" />

        <metric name="Appointment Save Recurrences" collectionType="trendsup" />

        <metric name="Message Attachment Edits" collectionType="trendsup" />

        <metric name="Appointment Attachment Edits" collectionType="trendsup" />

        <metric name="Navigation Options Saves" collectionType="trendsup" />

        <metric name="Folder Creates" template="${web}:${name}* (total)"
                collectionType="trendsup" />

        <metric name="Folder Renames" template="${web}:${name}* (total)"
                collectionType="trendsup" />

        <metric name="Authentications" indicator="true" collectionType="trendsup" />

        <metric name="Authentication Cache Hits" collectionType="trendsup" />

        <metric name="Forms Sent" collectionType="trendsup" />

        <metric name="Get App Frame" collectionType="trendsup" />

        <metric name="Get Nav Bar" collectionType="trendsup" />

        <metric name="Folder Get Contents" indicator="true"
                collectionType="trendsup" />

        <metric name="Folder Get View" template="${web}:${name}* (total)"
                collectionType="trendsup" />

        <metric name="New Item URL" collectionType="trendsup" />

        <metric name="New Folder Template Data" collectionType="trendsup" />

        <metric name="Appointment Data Retrieves" collectionType="trendsup" />

        <metric name="Appointment Accept/Decline" collectionType="trendsup" />

        <metric name="Message/Appointment Opens" collectionType="trendsup" />

        <metric name="Message Opens" indicator="true" collectionType="trendsup" />

        <metric name="Appointment Opens" collectionType="trendsup" />

        <metric name="Views Of Calendars" collectionType="trendsup" />

        <metric name="Views Of Mail Folders" collectionType="trendsup" />

        <metric name="Authentications in Cache" template="${web}:Authentications (in cache)"
                collectionType="trendsup" />
    </metrics>

    <filter name="template" value="${mta}:${name}" />
    <metrics name="MTA">
        <metric name="Availability" template="win32:Service=MSExchangeMTA:${alias}"
                indicator="true" />

        <metric name="Adjacent MTA Associations" />

        <metric name="Messages Processed" template="${mta}:Messages/Sec"
                category="THROUGHPUT" indicator="true" collectionType="trendsup" />

        <metric name="Message Bytes" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" units="B" />

        <metric name="Free Buffer Elements" template="${mta}:Free Elements" />

        <metric name="Free Buffer Headers" template="${mta}:Free Headers" />

        <metric name="Admin Connections" />

        <metric name="Threads In Use" />

        <metric name="Work Queue Length" category="PERFORMANCE"
                indicator="true" />

        <metric name="XAPI Gateways" />

        <metric name="XAPI Clients" />

        <metric name="Disk File Deletes" template="${template}/sec"
                collectionType="trendsup" />

        <metric name="Disk File Syncs" template="${template}/sec"
                collectionType="trendsup" />

        <metric name="Disk File Opens" template="${template}/sec"
                indicator="true" collectionType="trendsup" />

        <metric name="Disk File Reads" template="${template}/sec"
                collectionType="trendsup" />

        <metric name="Disk File Writes" template="${template}/sec"
                collectionType="trendsup" />

        <metric name="Directory Service Read Calls" template="${mta}:ExDS Read Calls/sec"
                collectionType="trendsup" />

        <metric name="XAPI Receive Bytes" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" units="B" />

        <metric name="XAPI Transmit Bytes" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" units="B" />

        <metric name="Admin Interface Receive Bytes" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" units="B" />

        <metric name="Admin Interface Transmit Bytes" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" units="B" />

        <metric name="LAN Receive Bytes" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" units="B" />

        <metric name="LAN Transmit Bytes" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" units="B" />

        <metric name="RAS Receive Bytes" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" units="B" />

        <metric name="RAS Transmit Bytes" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" units="B" />

        <metric name="TCP/IP Receive Bytes" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" units="B" />

        <metric name="TCP/IP Transmit Bytes" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" units="B" />

        <metric name="TP4 Receive Bytes" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" units="B" />

        <metric name="TP4 Transmit Bytes" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" units="B" />

        <metric name="X.25 Receive Bytes" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" units="B" />

        <metric name="X.25 Transmit Bytes" template="${template}/sec"
                category="THROUGHPUT" collectionType="trendsup" units="B" />

        <metric name="Deferred Delivery Messages" template="${mta}:Deferred Delivery Msgs"
                category="THROUGHPUT" />

        <metric name="Total Recipients Queued" />

        <metric name="Total Successful Conversions" collectionType="trendsup" />

        <metric name="Total Failed Conversions" collectionType="trendsup" />

        <metric name="Total Loops Detected" collectionType="trendsup" />

        <metric name="Inbound Messages Total" collectionType="trendsup" />

        <metric name="Outbound Messages Total" collectionType="trendsup" />

        <metric name="Inbound Bytes Total" category="THROUGHPUT"
                indicator="true" collectionType="trendsup" units="B" />

        <metric name="Work Queue Bytes" category="THROUGHPUT" units="B" />

        <metric name="Outbound Bytes Total" category="THROUGHPUT"
                indicator="true" collectionType="trendsup" units="B" />

        <metric name="Total Recipients Inbound" collectionType="trendsup" />

        <metric name="Total Recipients Outbound" collectionType="trendsup" />
    </metrics>

    <filter name="template" value="${mbox}:${name}" />
    <metrics name="exchange-mbox">
        <metric name="Messages Delivered" category="THROUGHPUT"
                collectionType="trendsup"/>

        <metric name="Message Recipients Delivered" collectionType="trendsup" />

        <metric name="Messages Sent" collectionType="trendsup" indicator="true"/>

        <metric name="Messages Submitted" collectionType="trendsup"/>

        <metric name="Average Delivery Time" />

        <metric name="Total Size of Recoverable Items" />

        <metric name="Total Count of Recoverable Items" />

        <metric name="Client Logons" collectionType="trendsup" />

        <metric name="Active Client Logons" />

        <metric name="Local deliveries" />
    </metrics>

    <metrics name="MBOX_V5">
        <metric name="Send Queue Size" />

        <metric name="Receive Queue Size" indicator="true" />

        <metric name="Categorization Count" collectionType="trendsup" />

        <metric name="Single Instance Ratio" />

    </metrics>

    <metrics name="MBOX_V8">
        <metric name="Messages Queued For Submission" />

        <metric name="Receive Queue Size" indicator="true" />

        <metric name="Categorization Count" collectionType="trendsup" />

        <metric name="Single Instance Ratio" />

    </metrics>

    <filter name="template" value="${imap4}:${name}" />
    <metrics name="IMAP4">
        <metric name="APPEND Total" collectionType="trendsup" />

        <metric name="APPEND Failures" collectionType="trendsup" />

        <metric name="AUTHENTICATE Total" collectionType="trendsup" />

        <metric name="AUTHENTICATE Failures" collectionType="trendsup" />

        <metric name="CAPABILITY Total" collectionType="trendsup" />

        <metric name="CAPABILITY Failures" collectionType="trendsup" />

        <metric name="CHECK Total" collectionType="trendsup" />

        <metric name="CHECK Failures" collectionType="trendsup" />

        <metric name="CLOSE Total" collectionType="trendsup" />

        <metric name="CLOSE Failures" collectionType="trendsup" />

        <metric name="COPY Total" collectionType="trendsup" />

        <metric name="COPY Failures" collectionType="trendsup" />

        <metric name="CREATE Total" collectionType="trendsup" />

        <metric name="CREATE Failures" collectionType="trendsup" />

        <metric name="DELETE Total" collectionType="trendsup" />

        <metric name="DELETE Failures" collectionType="trendsup" />

        <metric name="EXAMINE Total" collectionType="trendsup" />

        <metric name="EXAMINE Failures" collectionType="trendsup" />

        <metric name="EXPUNGE Total" collectionType="trendsup" />

        <metric name="EXPUNGE Failures" collectionType="trendsup" />

        <metric name="FETCH Total" collectionType="trendsup" />

        <metric name="FETCH Failures" collectionType="trendsup" />

        <metric name="LIST Total" collectionType="trendsup" />

        <metric name="LIST Failures" collectionType="trendsup" />

        <metric name="LOGIN Total" indicator="true" collectionType="trendsup" />

        <metric name="LOGIN Failures" collectionType="trendsup" />

        <metric name="LOGOUT Total" collectionType="trendsup" />

        <metric name="LOGOUT Failures" collectionType="trendsup" />

        <metric name="LSUB Total" collectionType="trendsup" />

        <metric name="LSUB Failures" collectionType="trendsup" />

        <metric name="NOOP Total" collectionType="trendsup" />

        <metric name="NOOP Failures" collectionType="trendsup" />

        <metric name="RENAME Total" collectionType="trendsup" />

        <metric name="RENAME Failures" collectionType="trendsup" />

        <metric name="SEARCH Total" collectionType="trendsup" />

        <metric name="SEARCH Failures" collectionType="trendsup" />

        <metric name="SELECT Total" collectionType="trendsup" />

        <metric name="SELECT Failures" collectionType="trendsup" />

        <metric name="STATUS Total" indicator="true" collectionType="trendsup" />

        <metric name="STATUS Failures" collectionType="trendsup" />

        <metric name="STORE Total" collectionType="trendsup" />

        <metric name="STORE Failures" collectionType="trendsup" />

        <metric name="SUBSCRIBE Total" collectionType="trendsup" />

        <metric name="SUBSCRIBE Failures" collectionType="trendsup" />

        <metric name="UNSUBSCRIBE Total" collectionType="trendsup" />

        <metric name="UNSUBSCRIBE Failures" collectionType="trendsup" />

        <metric name="IDLE Total" collectionType="trendsup" />

        <metric name="IDLE Failures" collectionType="trendsup" />

        <metric name="NAMESPACE Total" collectionType="trendsup" />

        <metric name="NAMESPACE Failures" collectionType="trendsup" />

        <metric name="Invalid Commands" indicator="true"
                collectionType="trendsup" />

        <metric name="Connections Failed" collectionType="trendsup" />

        <metric name="Connections Rejected" collectionType="trendsup" />
    </metrics>

    <metrics name="IMAP4_V5" include="IMAP4">
        <metric name="Availability" template="win32:Service=IMAP4Svc:${alias}"
                category="AVAILABILITY" indicator="true" />

        <metric name="Connections Total" collectionType="trendsup" />

        <metric name="Connections Current" indicator="true" />

        <metric name="RLIST Total" collectionType="trendsup" />

        <metric name="RLIST Failures" collectionType="trendsup" />

        <metric name="RLSUB Total" collectionType="trendsup" />

        <metric name="RLSUB Failures" collectionType="trendsup" />

        <metric name="UID Total" collectionType="trendsup" />

        <metric name="UID Failures" collectionType="trendsup" />

    </metrics>

    <metrics name="IMAP4_V8" include="IMAP4">
        <!-- 2007 service name changearoo -->
        <metric name="Availability" template="win32:Service=MSExchangeImap4:${alias}"
                category="AVAILABILITY" indicator="true" />

        <!-- 2007 name swaparoo -->
        <metric name="Connections Total" template="${imap4}:Total Connections"
                collectionType="trendsup" />

        <metric name="Connections Current" template="${imap4}:Current Connections"
                indicator="true" />
    </metrics>

    <metrics name="IMAP4_V14" include="IMAP4">
        <metric name="Availability" template="win32:Service=MSExchangeImap4:${alias}"
                category="AVAILABILITY" indicator="true" />
        <metric name="Connections Total" template="${imap4}:Connections Total"
                collectionType="trendsup" />
        <metric name="Connections Current" template="${imap4}:Current Connections"
                indicator="true" />
    </metrics>

    <filter name="template" value="${pop3}:${name}" />
    <metrics name="POP3">
        <metric name="AUTH Total" collectionType="trendsup" />

        <metric name="AUTH Failures" collectionType="trendsup" />

        <metric name="PASS Total" collectionType="trendsup" />

        <metric name="PASS Failures" collectionType="trendsup" />

        <metric name="QUIT Total" collectionType="trendsup" />

        <metric name="QUIT Failures" collectionType="trendsup" />

        <metric name="STAT Total" indicator="true" collectionType="trendsup" />

        <metric name="STAT Failures" collectionType="trendsup" />

        <metric name="LIST Total" collectionType="trendsup" />

        <metric name="LIST Failures" collectionType="trendsup" />

        <metric name="RETR Total" indicator="true" collectionType="trendsup" />

        <metric name="RETR Failures" collectionType="trendsup" />

        <metric name="DELE Total" collectionType="trendsup" />

        <metric name="DELE Failures" collectionType="trendsup" />

        <metric name="NOOP Total" collectionType="trendsup" />

        <metric name="NOOP Failures" collectionType="trendsup" />

        <metric name="RSET Total" collectionType="trendsup" />

        <metric name="RSET Failures" collectionType="trendsup" />

        <metric name="TOP Total" collectionType="trendsup" />

        <metric name="TOP Failures" collectionType="trendsup" />

        <metric name="UIDL Total" collectionType="trendsup" />

        <metric name="UIDL Failures" collectionType="trendsup" />

        <metric name="USER Total" collectionType="trendsup" />

        <metric name="USER Failures" collectionType="trendsup" />

        <metric name="Invalid Commands" indicator="true"
                collectionType="trendsup" />

        <metric name="Connections Total" collectionType="trendsup" />

        <metric name="Connections Current" indicator="true"
                collectionType="trendsup" />

        <metric name="Connections Failed" collectionType="trendsup" />

        <metric name="Connections Rejected" collectionType="trendsup" />

        <metric name="CAPA Total" collectionType="trendsup" />

        <metric name="CAPA Failures" collectionType="trendsup" />
    </metrics>

    <metrics name="POP3_V5" include="POP3">
        <metric name="Availability" template="win32:Service=POP3Svc:${alias}"
                category="AVAILABILITY" indicator="true" />

        <!-- gone in 2007 -->
        <metric name="LAST Total" collectionType="trendsup" />

        <metric name="LAST Failures" collectionType="trendsup" />
    </metrics>

    <metrics name="POP3_V8" include="POP3">
        <!-- 2007 service name changearoo -->
        <metric name="Availability" template="win32:Service=MSExchangePop3:${alias}"
                category="AVAILABILITY" indicator="true" />
    </metrics>

    <!-- metrics for MSExchangeTransport SMTP Receive(total) -->
    <filter name="template" value="${smtprecv-total}:${name}" />
    <metrics name="exchange-smtprecv-total">
        <metric name="Messages Received" collectionType="trendsup" indicator="true"/>
    </metrics>

    <!-- metrics for MSExchangeTransport Queues -->
    <filter name="template" value="${queue}:${name}" />
    <metrics name="exchange-transport">
        <metric name="Availability" template="win32:Service=MSExchangeTransport:${alias}"
                indicator="true" />

        <metric name="Active Remote Delivery Queue Length" />

        <metric name="Retry Remote Delivery Queue Length" />

        <metric name="Active Mailbox Delivery Queue Length" indicator="true" />

        <metric name="Retry Mailbox Delivery Queue Length" />

        <metric name="Active Non-Smtp Delivery Queue Length" />

        <metric name="Retry Non-Smtp Delivery Queue Length" />

        <metric name="Aggregate Delivery Queue Length (All Queues)"
                indicator="true" />

        <metric name="Items Queued For Delivery Total" collectionType="trendsup" />

        <metric name="Items Completed Delivery Total" collectionType="trendsup" />

        <metric name="Items Queued For Delivery Expired Total"
                collectionType="trendsup" />

        <metric name="Items Deleted By Admin Total" collectionType="trendsup" />

        <metric name="Items Resubmitted Total" collectionType="trendsup" />

        <metric name="Messages Queued For Delivery Total"
                collectionType="trendsup" indicator="true"/>

        <metric name="Messages Completed Delivery Total" indicator="true"
                collectionType="trendsup" />

        <metric name="Unreachable Queue Length" />

        <metric name="Poison Queue Length" />

        <metric name="Submission Queue Length" indicator="true" />

        <metric name="Messages Submitted Total" collectionType="trendsup" />

        <metric name="Submission Queue Items Expired Total"
                collectionType="trendsup" />
    </metrics>

    <filter name="template" value="${smtpsend}:${name}" />
    <metrics name="exchange-smtpsend">
        <metric name="Availability" template="win32:Service=MSExchangeTransport:${alias}"
                indicator="true" />

        <metric name="Connections Current" />

        <metric name="Connections Total" indicator="true"
                collectionType="trendsup" />

        <metric name="Messages Sent Total" indicator="true"
                collectionType="trendsup" />

        <metric name="Message Bytes Sent Total" indicator="true" units="B"
                collectionType="trendsup" />

        <metric name="Bytes Sent Total" collectionType="trendsup" />

        <metric name="Recipients Sent" collectionType="trendsup" />

        <metric name="Average Recipients/message" />

        <metric name="Average Message bytes/message" units="B" />

        <metric name="Average Messages/connection" />

        <metric name="Average Bytes/connection" units="B" />
    </metrics>

    <filter name="template" value="${smtprecv}:${name}" />
    <metrics name="exchange-smtprecv">
        <metric name="Availability" template="win32:Service=MSExchangeTransport:${alias}"
                indicator="true" />

        <metric name="Connections Current" />

        <metric name="Connections Total" indicator="true" />

        <metric name="Disconnections By Agents" />

        <metric name="Messages Received Total" indicator="true"
                collectionType="trendsup" />

        <metric name="Message Bytes Received Total" collectionType="trendsup" />

        <metric name="Messages Refused for Size" />

        <metric name="Recipients Accepted Total" collectionType="trendsup" />

        <metric name="Average Bytes/message" units="B" />

        <metric name="Average Recipients/message" />

        <metric name="Average Bytes/connection" units="B" />

        <metric name="Average Messages/connection" />

        <metric name="Bytes Received Total" collectionType="trendsup" />

        <metric name="Tarpitting Delays Authenticated" />

        <metric name="Tarpitting Delays Anonymous" />
    </metrics>

    <metrics name="Exchange 2003" include="exchange-is,exchange-mbox,MBOX_V5" />
    <metrics name="Exchange Mailbox 2007" include="exchange-is,exchange-mbox,MBOX_V8,databaseInformationStore" />
    <metrics name="Exchange Mailbox 2010" include="exchange-is,exchange-mbox,databaseInformationStore,databaseInformationStore2010" />
    <metrics name="Exchange HubTransport 2007" include="exchange-transport,exchange-smtprecv-total" />
    <metrics name="Exchange ClientAccess 2007"
             include="clientAccess2007Avail,Availability-Service,ActiveSync,owa,MSExchangeWebService,LogicalDisk,MSExchangeAutodiscover,MSExchangeWS" />
    <metrics name="Exchange ClientAccess 2010"
             include="fba_avail,rpcClientAccess,Availability-Service,ActiveSync,owa,MSExchangeWebService,LogicalDisk,MSExchangeAutodiscover,MSExchangeWS" />

    <metrics name="Exchange 2003 POP3" include="POP3_V5" />
    <metrics name="Exchange ClientAccess 2007 POP3" include="POP3_V8" />

    <metrics name="Exchange 2003 IMAP4" include="IMAP4_V5" />
    <metrics name="Exchange ClientAccess 2007 IMAP4" include="IMAP4_V8" />
    <metrics name="Exchange ClientAccess 2010 IMAP4" include="IMAP4_V14" />
    <metrics name="Exchange ClientAccess 2010 AddressBook" include="addressbook" />

    <metrics name="Exchange 2003 MTA" include="MTA" />

    <metrics name="Exchange 2003 Web" include="Web" />
    <metrics name="Exchange Mailbox 2007 Web" include="Web" />

    <metrics name="Exchange HubTransport 2007 SmtpSend" include="exchange-smtpsend" />

    <metrics name="Exchange HubTransport 2007 SmtpReceive" include="exchange-smtprecv" />
	
    <server name="Exchange" description="Mail Server" version="2003"
            platforms="Win32">

        <plugin type="measurement" class="org.hyperic.hq.plugin.exchange.ExchangeMeasurement" />
        <plugin type="collector" class="org.hyperic.hq.plugin.exchange.ExchangeCollector" />

        <plugin type="autoinventory" class="ExchangeDetector" />

        <property name="EVENT_LOG_SOURCE_FILTER" value="MSExchange" />

        <plugin type="log_track" class="org.hyperic.hq.product.Win32EventLogTrackPlugin" />

        <property name="VERSION_FILE" value="masperf.dll" />
        <properties>
            <property name="version" description="Exchange Version" />
            <property name="build" description="Build Number" />
        </properties>

        <service name="POP3" internal="true">
            <plugin type="measurement" class="org.hyperic.hq.plugin.exchange.ExchangeMeasurement" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.ExchangeCollector" />
            <plugin type="log_track" />
            <property name="EVENT_LOG_SOURCE_FILTER" value="POP3SVC" />
            <plugin type="control" class="org.hyperic.hq.product.Win32ControlPlugin" />
            <config>
                <option name="service_name" description="Service name" />
            </config>
        </service>

        <service name="IMAP4" internal="true">
            <plugin type="measurement" class="org.hyperic.hq.plugin.exchange.ExchangeMeasurement" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.ExchangeCollector" />
            <plugin type="log_track" />
            <property name="EVENT_LOG_SOURCE_FILTER" value="IMAP4SVC" />
            <plugin type="control" class="org.hyperic.hq.product.Win32ControlPlugin" />
            <config>
                <option name="service_name" description="Service name" />
            </config>
        </service>

        <service name="MTA" internal="true">
            <plugin type="measurement" class="org.hyperic.hq.plugin.exchange.ExchangeMeasurement" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.ExchangeCollector" />
            <plugin type="log_track" />
            <property name="EVENT_LOG_SOURCE_FILTER" value="MSExchangeMTA" />
            <plugin type="control" class="org.hyperic.hq.product.Win32ControlPlugin" />
            <config>
                <option name="service_name" description="Service name" />
            </config>
        </service>

        <service name="Web">
            <plugin type="measurement" class="org.hyperic.hq.plugin.exchange.ExchangeMeasurement" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.ExchangeCollector" />
            <config type="measurement">
                <option name="hostname" description="Hostname" default="localhost" />
                <option name="port" description="Port" type="port" default="80" />
                <option name="sotimeout" description="Socket Timeout (in seconds)"
                        default="10" type="int" />
                <option name="path" description="Path" default="/owa" />
                <option name="user" description="Username" optional="true" />
                <option name="pass" type="secret" description="Password"
                        optional="true" />
                <option name="realm" description="Realm" optional="true" />
                <option name="ssl" description="Use SSL" type="boolean"
                        optional="true" default="true" />
                <option name="sslprotocol" type="enum" description="SSL Protocol">
                    <include name="None" />
                    <include name="SSL" />
                    <include name="TLS" />
                </option>
                <option name="method" type="enum" description="Request Method">
                    <include name="HEAD" />
                    <include name="GET" />
                </option>
                <option name="hostheader" description="Host Header" optional="true" />
                <option name="follow" description="Follow Redirects" type="boolean"
                        default="false" />
                <option name="pattern" description="Response Match (substring or regex)"
                        optional="true" />
            </config>
            <plugin type="control" class="org.hyperic.hq.product.Win32ControlPlugin" />
            <config type="control">
                <option name="service_name" description="Service name" />
            </config>
        </service>
    </server>

    <!-- not using include="2003": No MTA service New Transport service Service 
    name changes for EVENT_LOG_SOURCE_FILTER -->
    <server name="Exchange Mailbox" version="2007" platforms="Win32">

        <plugin type="measurement" class="org.hyperic.hq.plugin.exchange.ExchangeMeasurement" />
        <plugin type="collector" class="org.hyperic.hq.plugin.exchange.ExchangeCollector" />

        <plugin type="autoinventory" class="ExchangeDetector" />

        <property name="EVENT_LOG_SOURCE_FILTER" value="MSExchange" />

        <plugin type="log_track" class="org.hyperic.hq.product.Win32EventLogTrackPlugin" />

        <property name="VERSION_FILE" value="e12pidgen.dll" />
        <property name="EXCHANGE_ROLE_REG_KEY" value="SOFTWARE\Microsoft\Exchange\v8.0\MailboxRole" />
        <property name="SITE_DISCOVERY" value="true"/>	
        <config>
            <option name="active_directory.site" description="Active Directory site name" optional="true"/>
        </config>			

        <properties>
            <property name="version" description="Exchange Version" />
            <property name="build" description="Build Number" />
        </properties>

        <service name="Web">
            <plugin type="measurement" class="org.hyperic.hq.plugin.exchange.ExchangeMeasurement" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.ExchangeCollector" />
            <config type="measurement">
                <option name="hostname" description="Hostname" default="localhost" />
                <option name="port" description="Port" type="port" default="80" />
                <option name="sotimeout" description="Socket Timeout (in seconds)"
                        default="10" type="int" />
                <option name="path" description="Path" default="/owa" />
                <option name="user" description="Username" optional="true" />
                <option name="pass" type="secret" description="Password"
                        optional="true" />
                <option name="realm" description="Realm" optional="true" />
                <option name="ssl" description="Use SSL" type="boolean"
                        optional="true" default="true" />
                <option name="sslprotocol" type="enum" description="SSL Protocol">
                    <include name="None" />
                    <include name="SSL" />
                    <include name="TLS" />
                </option>
                <option name="method" type="enum" description="Request Method">
                    <include name="HEAD" />
                    <include name="GET" />
                </option>
                <option name="hostheader" description="Host Header" optional="true" />
                <option name="follow" description="Follow Redirects" type="boolean"
                        default="false" />
                <option name="pattern" description="Response Match (substring or regex)"
                        optional="true" />
            </config>
            <plugin type="control" class="org.hyperic.hq.product.Win32ControlPlugin" />
            <config type="control">
                <option name="service_name" description="Service name" />
            </config>
        </service>
    </server>

    <server name="Exchange Mailbox" version="2010" include="Exchange Mailbox 2007"
            platforms="Win32">
        <property name="VERSION_FILE" value="custsat.dll" />
        <property name="EXCHANGE_ROLE_REG_KEY"
                  value="SOFTWARE\Microsoft\ExchangeServer\v14\MailboxRole" />
        <property name="DAG_DISCOVERY" value="true"/>
        <config>
            <option name="DAG_name" description="Data Availability Group name" optional="true"/>
            <option name="active_directory.site" description="Active Directory site name" optional="true"/>
        </config>       
			
    </server>

    <server name="Exchange ClientAccess" version="2007" platforms="Win32">
        <property name="VERSION_FILE" value="e12pidgen.dll" />
        <property name="EXCHANGE_ROLE_REG_KEY"
                  value="SOFTWARE\Microsoft\Exchange\v8.0\ClientAccessRole" />
        `	<property name="SERVER_NAME" value="MSExchangeServiceHost"/>
        <plugin type="measurement" class="org.hyperic.hq.plugin.exchange.ExchangeMeasurement" />
        <plugin type="collector" class="org.hyperic.hq.plugin.exchange.ExchangeCollector" />

        <plugin type="autoinventory" class="ExchangeClientAccessDetector" />

        <plugin type="log_track" class="org.hyperic.hq.product.Win32EventLogTrackPlugin" />
        <properties>
            <property name="version" description="Exchange Version" />				
        </properties>
        <property name="SITE_DISCOVERY" value="true"/>	
        <config>
            <option name="active_directory.site" description="Active Directory site name" optional="true"/>
        </config>			
        <service name="POP3" internal="true">
            <plugin type="measurement" class="org.hyperic.hq.plugin.exchange.ExchangeMeasurement" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.ExchangeCollector" />
            <plugin type="log_track" />
            <property name="EVENT_LOG_SOURCE_FILTER" value="MSExchangePOP3" />
            <plugin type="control" class="org.hyperic.hq.product.Win32ControlPlugin" />
            <config>
                <option name="service_name" description="Service name" />
            </config>
        </service>

        <service name="IMAP4" internal="true">
            <plugin type="measurement" class="org.hyperic.hq.plugin.exchange.ExchangeMeasurement" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.ExchangeCollector" />
            <plugin type="log_track" />
            <property name="EVENT_LOG_SOURCE_FILTER" value="MSExchangeIMAP4" />
            <plugin type="control" class="org.hyperic.hq.product.Win32ControlPlugin" />
            <config>
                <option name="service_name" description="Service name" />
            </config>
        </service>
    </server>

    <server name="Exchange ClientAccess" version="2010" 
            include="Exchange ClientAccess 2007" platforms="Win32">
        <property name="VERSION_FILE" value="custsat.dll" />
        <property name="EXCHANGE_ROLE_REG_KEY"
                  value="SOFTWARE\Microsoft\ExchangeServer\v14\ClientAccessRole" />
        <property name="SERVER_NAME" value="MSExchangeFBA"/>
		
        <!-- another service for 2010 -->
        <service name="AddressBook" internal="true">
            <plugin type="measurement" class="org.hyperic.hq.plugin.exchange.ExchangeMeasurement" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.ExchangeCollector" />
            <plugin type="log_track" />
            <property name="EVENT_LOG_SOURCE_FILTER" value="MSExchangeAB" />
            <plugin type="control" class="org.hyperic.hq.product.Win32ControlPlugin" />
            <config>
                <option name="service_name" description="Service name" />
            </config>
        </service>
    </server>

    <server name="Exchange HubTransport" version="2007" platforms="Win32">
        <property name="VERSION_FILE" value="e12pidgen.dll" />
        <property name="EXCHANGE_ROLE_REG_KEY"
                  value="SOFTWARE\Microsoft\Exchange\v8.0\HubTransportRole" />

        <plugin type="measurement" class="org.hyperic.hq.plugin.exchange.ExchangeMeasurement" />
        <plugin type="collector" class="org.hyperic.hq.plugin.exchange.ExchangeCollector" />

        <plugin type="autoinventory" class="ExchangeTransportDetector" />

        <property name="EVENT_LOG_SOURCE_FILTER" value="MSExchangeTransport" />
        <property name="SITE_DISCOVERY" value="true"/>	

        <plugin type="log_track" class="org.hyperic.hq.product.Win32EventLogTrackPlugin" />

        <config>
            <option name="active_directory.site" description="Active Directory site name" optional="true"/>
        </config>			

        <service name="SmtpSend">
            <config>
                <option name="name" description="Name" />
            </config>
            <plugin type="measurement" class="org.hyperic.hq.plugin.exchange.ExchangeMeasurement" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.ExchangeCollector" />
        </service>

        <service name="SmtpReceive">
            <config>
                <option name="name" description="Name" />
            </config>
            <plugin type="measurement" class="org.hyperic.hq.plugin.exchange.ExchangeMeasurement" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.ExchangeCollector" />
        </service>
        <properties>
            <property name="version" description="Exchange Version" />
        </properties>
    </server>

    <server name="Exchange HubTransport" version="2010"
            include="Exchange HubTransport 2007" platforms="Win32">
        <property name="VERSION_FILE" value="custsat.dll" />
        <property name="EXCHANGE_ROLE_REG_KEY"
                  value="SOFTWARE\Microsoft\ExchangeServer\v14\HubTransportRole" />			
    </server>

    <metrics name="Windows Service">
        <metric name="Availability" alias="Availability" template="win32:Service=%service_name%:${alias}" category="AVAILABILITY" indicator="true" units="percentage" collectionType="dynamic"/>
        <metric name="Start Type" template="win32:Service=%service_name%:${alias}" category="AVAILABILITY" collectionType="static"/>
        <metric name="Memory Size" alias="MemSize" template="sigar:Type=ProcMem,Arg=Pid.Service.eq=%service_name%:Size" category="UTILIZATION" units="B" collectionType="dynamic"/>
        <metric name="Resident Memory Size" alias="ResidentMemSize" template="sigar:Type=ProcMem,Arg=Pid.Service.eq=%service_name%:Resident" category="UTILIZATION" indicator="true" units="B" collectionType="dynamic"/>
        <metric name="Cpu System Time" alias="SystemTime" template="sigar:Type=ProcTime,Arg=Pid.Service.eq=%service_name%:Sys" category="UTILIZATION" units="ms" collectionType="trendsup"/>
        <metric name="Cpu User Time" alias="UserTime" template="sigar:Type=ProcTime,Arg=Pid.Service.eq=%service_name%:User" category="UTILIZATION" units="ms" collectionType="trendsup"/>
        <metric name="Cpu Total Time" alias="TotalTime" template="sigar:Type=ProcTime,Arg=Pid.Service.eq=%service_name%:Total" category="UTILIZATION" units="ms" collectionType="trendsup"/>
        <metric name="Cpu Usage" alias="Usage" template="sigar:Type=ProcCpu,Arg=Pid.Service.eq=%service_name%:Percent" category="UTILIZATION" indicator="true" units="percentage" collectionType="dynamic"/>
        <metric name="Start Time" alias="StartTime" template="sigar:Type=ProcTime,Arg=Pid.Service.eq=%service_name%:StartTime" category="AVAILABILITY" units="epoch-millis" collectionType="static"/>
        <metric name="Open Handles" alias="OpenHandles" template="sigar:Type=ProcFd,Arg=Pid.Service.eq=%service_name%:Total" category="UTILIZATION" indicator="true" units="none" collectionType="dynamic"/>
        <metric name="Threads" template="sigar:Type=ProcState,Arg=Pid.Service.eq=%service_name%:Threads"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchangeIS Store(_total):${name}"/>
    <metrics name="MSExchangeIS_Store_c">
        <metric name="Search/sec"/>
        <metric name="Successful search/sec"/>
        <metric name="Search results/sec"/>
        <metric name="Average search results per query"/>
        <metric name="MultiMailbox Preview Search/sec"/>
        <metric name="MultiMailbox Keyword Stats Search/sec"/>
        <metric name="MultiMailbox Search Full Text Index Query/sec"/>
        <metric name="Average MultiMailbox Search time spent in FullTextIndex"/>
        <metric name="Average MultiMailbox Search time spent in Store calls"/>
        <metric name="Average Search Execution Time"/>
        <metric name="Average Keyword Stats Search Execution Time"/>
        <metric name="Average MultiMailbox Search Failed"/>
        <metric name="Average MultiMailbox Search Query Length"/>
        <metric name="Average number of Keywords in MultiMailbox Search"/>
        <metric name="Lazy indexes created/sec"/>
        <metric name="Lazy indexes deleted/sec"/>
        <metric name="Lazy index full refresh/sec"/>
        <metric name="Lazy index incremental refresh/sec"/>
        <metric name="Lazy index invalidation/sec"/>
        <metric name="Lazy index invalidation due to locale version change/sec"/>
        <metric name="Folders opened/sec"/>
        <metric name="Folders created/sec"/>
        <metric name="Folders deleted/sec"/>
        <metric name="Messages opened/sec"/>
        <metric name="Messages created/sec"/>
        <metric name="Messages updated/sec"/>
        <metric name="Messages deleted/sec"/>
        <metric name="Subobjects opened/sec"/>
        <metric name="Subobjects created/sec"/>
        <metric name="Subobjects deleted/sec"/>
        <metric name="Subobjects cleaned/sec"/>
        <metric name="Property promotions/sec"/>
        <metric name="Property promotion messages/sec"/>
        <metric name="Non recursive folder hierarchy reloads/sec"/>
        <metric name="Recursive folder hierarchy reloads/sec"/>
        <metric name="Messages Delivered/sec"/>
        <metric name="Messages Submitted/sec"/>
        <metric name="MAPI Messages Created/sec"/>
        <metric name="MAPI Messages Opened/sec"/>
        <metric name="MAPI Messages Modified/sec"/>
        <metric name="RPC Packets/sec"/>
        <metric name="RPC Operations/sec"/>
        <metric name="RPC Average Latency"/>
        <metric name="Mailbox Level Maintenances/sec"/>
        <metric name="Database Level Maintenances/sec"/>
        <metric name="Cache lookups in the AddressInfo cache/sec"/>
        <metric name="Cache misses in the AddressInfo cache/sec"/>
        <metric name="Cache hits in the AddressInfo cache/sec"/>
        <metric name="Cache inserts in the AddressInfo cache/sec"/>
        <metric name="Cache deletes in the AddressInfo cache/sec"/>
        <metric name="Cache lookups in the MailboxInfo cache/sec"/>
        <metric name="Cache misses in the MailboxInfo cache/sec"/>
        <metric name="Cache hits in the MailboxInfo cache/sec"/>
        <metric name="Cache inserts in the MailboxInfo cache/sec"/>
        <metric name="Cache deletes in the MailboxInfo cache/sec"/>
        <metric name="Cache lookups in the DatabaseInfo cache/sec"/>
        <metric name="Cache misses in the DatabaseInfo cache/sec"/>
        <metric name="Cache hits in the DatabaseInfo cache/sec"/>
        <metric name="Cache inserts in the DatabaseInfo cache/sec"/>
        <metric name="Cache deletes in the DatabaseInfo cache/sec"/>
        <metric name="Cache lookups in the Organization Container cache/sec"/>
        <metric name="Cache misses in the Organization Container cache/sec"/>
        <metric name="Cache hits in the Organization Container cache/sec"/>
        <metric name="Cache inserts in the Organization Container cache/sec"/>
        <metric name="Cache deletes in the Organization Container cache/sec"/>
        <metric name="Cache lookups in the DistributionListMembership cache/sec"/>
        <metric name="Cache misses in the DistributionListMembership cache/sec"/>
        <metric name="Cache hits in the DistributionListMembership cache/sec"/>
        <metric name="Cache inserts in the DistributionListMembership cache/sec"/>
        <metric name="Cache deletes in the DistributionListMembership cache/sec"/>
        <metric name="Cache lookups in the LogicalIndex cache/sec"/>
        <metric name="Cache misses in the LogicalIndex cache/sec"/>
        <metric name="Cache hits in the LogicalIndex cache/sec"/>
        <metric name="Cache inserts in the LogicalIndex cache/sec"/>
        <metric name="Cache deletes in the LogicalIndex cache/sec"/>
    </metrics>

    <filter name="template" value="pdh:MSExchangeIS Store(_total):${name}"/>
    <metrics name="MSExchangeIS_Store" include="MSExchangeIS_Store_c">
        <metric name="Total searches"/>
        <metric name="Total searches in progress"/>
        <metric name="Total search queries completed in 0-0.5 sec"/>
        <metric name="Total search queries completed in 0.5-2 sec"/>
        <metric name="Total search queries completed in 2-10 sec"/>
        <metric name="Total search queries completed in 10-60 sec"/>
        <metric name="Total search queries completed in > 60 sec"/>
        <metric name="Total number of successful search queries"/>
        <metric name="Total MultiMailbox preview searches"/>
        <metric name="Total MultiMailbox keyword statistics searches"/>
        <metric name="Total multi mailbox preview searches timed out"/>
        <metric name="Total multi mailbox searches Full Text Index Query Execution"/>
        <metric name="Total multi mailbox keyword statistics searches timed out"/>
        <metric name="Total failed multi mailbox Preview Searches"/>
        <metric name="Total failed multi mailbox keyword statistics Searches"/>
        <metric name="Total Multi Mailbox searches failed due to FullText failure"/>
        <metric name="Property Promotion Tasks"/>
        <metric name="Active mailboxes"/>
        <metric name="RPC Requests"/>
        <metric name="% RPC Requests"/>
        <metric name="RPC Pool: Pools"/>
        <metric name="RPC Pool: Context Handles"/>
        <metric name="RPC Pool: Parked Async Notification Calls"/>
        <metric name="Mailbox Level Maintenance Items"/>
        <metric name="Mailboxes With Maintenance Items"/>
        <metric name="Process ID"/>
        <metric name="Lost Diagnostic Entries"/>
        <metric name="Quarantined Mailbox Count"/>
        <metric name="Number of active background tasks"/>
        <metric name="Size of Address Info cache"/>
        <metric name="Size of the expiration queue for the AddressInfo cache"/>
        <metric name="Size of Mailbox Info cache"/>
        <metric name="Size of the expiration queue for the MailboxInfo cache"/>
        <metric name="Size of Database Info cache"/>
        <metric name="Size of the expiration queue for the DatabaseInfo cache"/>
        <metric name="Size of Organization Container cache"/>
        <metric name="Size of the expiration queue for the Organization Container cache"/>
        <metric name="Size of DistributionListMembership cache"/>
        <metric name="Size of the expiration queue for the DistributionListMembership cache"/>
        <metric name="Size of LogicalIndex cache"/>
        <metric name="Size of the expiration queue for the LogicalIndex cache"/>
        <metric name="Number of scheduled LogicalIndex maintenance tasks"/>
        <metric name="Number of processing LogicalIndex maintenance tasks"/>
        <metric name="Number of mailboxes marked for WLM LogicalIndex maintenance table maintenance"/>
        <metric name="Number of active WLM LogicalIndex maintenance table maintenances"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchangeSearch IndexAgent:${name}"/>
    <metrics name="MSExchangeSearch_IndexAgent_c">
        <metric name="Document Processing Rate Per Second"/>
        <metric name="Document Failure Rate Per Second"/>
        <metric name="Document Skip Rate Per Second"/>
        <metric name="Average Document Processing Time In Milliseconds"/>
    </metrics>

    <filter name="template" value="pdh:MSExchangeSearch IndexAgent:${name}"/>
    <metrics name="MSExchangeSearch_IndexAgent" include="MSExchangeSearch_IndexAgent_c">
        <metric name="Number Of Processed Documents"/>
        <metric name="Number Of Failed Documents"/>
        <metric name="Number Of Skipped Documents"/>
        <metric name="Documents processed under 250ms"/>
        <metric name="Documents processed under 500ms"/>
        <metric name="Documents processed under 1000ms"/>
        <metric name="Documents processed under 2000ms"/>
        <metric name="Documents processed under 5000ms"/>
        <metric name="Documents processed over 5000ms"/>
    </metrics>
    
    <filter name="template" value="pdh:MSExchangeSearch Mailbox Operators(_total):${alias}"/>
    <metrics name="MSExchangeSearch_Mailbox_Operators">
        <metric name="Retriever: Items processed 0-50 ms" alias="Retriever%3A Items processed 0-50 ms"/>
        <metric name="Retriever: Items processed 50-100 ms" alias="Retriever%3A Items processed 50-100 ms"/>
        <metric name="Retriever: Items processed 100-2000 ms" alias="Retriever%3A Items processed 100-2000 ms"/>
        <metric name="Retriever: Items processed in greater than 2000 ms" alias="Retriever%3A Items processed in greater than 2000 ms"/>
        <metric name="Retriever: Items with valid annotation token" alias="Retriever%3A Items with valid annotation token"/>
        <metric name="Retriever: Items without annotation token" alias="Retriever%3A Items without annotation token"/>
        <metric name="Retriever: Items with Rights Management attempted for processing." alias="Retriever%3A Items with Rights Management attempted for processing."/>
        <metric name="Retriever: Items with Rights Management partially processed." alias="Retriever%3A Items with Rights Management partially processed."/>
        <metric name="Retriever: Items with Rights Management skipped." alias="Retriever%3A Items with Rights Management skipped."/>
    </metrics>
    
    <filter name="template" value="pdh:MSExchangeSearch MailboxSession Cache(noderunner):${name}"/>
    <metrics name="MSExchangeSearch_MailboxSession_Cache">
        <metric name="Cache Requests"/>
        <metric name="Cache Hits"/>
        <metric name="Cache Misses"/>
        <metric name="Cache Hit Ratio"/>
        <metric name="Cache Miss Ratio"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchangePop3(cas):${name}"/>
    <metrics name="Exchange_2013_POP3_c">
        <metric name="Unauthenticated Connections/sec"/>
        <metric name="Invalid Commands Rate"/>
        <metric name="AUTH Rate"/>
        <metric name="CAPA Rate"/>
        <metric name="DELE Rate"/>
        <metric name="LIST Rate"/>
        <metric name="NOOP Rate"/>
        <metric name="PASS Rate"/>
        <metric name="QUIT Rate"/>
        <metric name="Request Rate"/>
        <metric name="RETR Rate"/>
        <metric name="RSET Rate"/>
        <metric name="STAT Rate"/>
        <metric name="STLS Rate"/>
        <metric name="TOP Rate"/>
        <metric name="UIDL Rate"/>
        <metric name="USER Rate"/>
        <metric name="XPRX Rate"/>
        <metric name="Connections Rate"/>
    </metrics>
    
    <filter name="template" value="pdh:MSExchangePop3(cas):${name}"/>
    <metrics name="Exchange_2013_POP3" include="Exchange_2013_POP3_c">
        <metric name="Connections Current"/>
        <metric name="Connections Failed"/>
        <metric name="Connections Rejected"/>
        <metric name="Connections Total"/>
        <metric name="Current Unauthenticated Connections"/>
        <metric name="Proxy Current Connections"/>
        <metric name="Proxy Connections Failed"/>
        <metric name="Proxy Total Connections"/>
        <metric name="Active SSL Connections"/>
        <metric name="SSL Connections"/>
        <metric name="Invalid Commands"/>
        <metric name="AUTH Failures"/>
        <metric name="AUTH Total"/>
        <metric name="CAPA Failures"/>
        <metric name="CAPA Total"/>
        <metric name="DELE Failures"/>
        <metric name="DELE Total"/>
        <metric name="LIST Failures"/>
        <metric name="LIST Total"/>
        <metric name="NOOP Failures"/>
        <metric name="NOOP Total"/>
        <metric name="PASS Failures"/>
        <metric name="PASS Total"/>
        <metric name="QUIT Failures"/>
        <metric name="QUIT Total"/>
        <metric name="Request Failures"/>
        <metric name="Request Total"/>
        <metric name="RETR Failures"/>
        <metric name="RETR Total"/>
        <metric name="RSET Failures"/>
        <metric name="RSET Total"/>
        <metric name="STAT Failures"/>
        <metric name="STAT Total"/>
        <metric name="STLS Failures"/>
        <metric name="STLS Total"/>
        <metric name="TOP Failures"/>
        <metric name="TOP Total"/>
        <metric name="UIDL Failures"/>
        <metric name="UIDL Total"/>
        <metric name="USER Failures"/>
        <metric name="USER Total"/>
        <metric name="XPRX Failures"/>
        <metric name="XPRX Total"/>
        <metric name="Average Command Processing Time (milliseconds)"/>
        <metric name="Transient Mailbox Connection Failures/minute"/>
        <metric name="Mailbox Offline Errors/minute"/>
        <metric name="Transient Storage Errors/minute"/>
        <metric name="Permanent Storage Errors/minute"/>
        <metric name="Transient Active Directory Errors/minute"/>
        <metric name="Permanent Active Directory Errors/minute"/>
        <metric name="Transient Errors/minute"/>
        <metric name="Average RPC Latency"/>
        <metric name="Average LDAP Latency"/>
    </metrics>
    
    <filter name="template" value="pdh_c:g=MSExchangePop3(mbx):${name}"/>
    <metrics name="Exchange_2013_POP3_Backend_c">
        <metric name="Unauthenticated Connections/sec"/>
        <metric name="Invalid Commands Rate"/>
        <metric name="AUTH Rate"/>
        <metric name="CAPA Rate"/>
        <metric name="DELE Rate"/>
        <metric name="LIST Rate"/>
        <metric name="NOOP Rate"/>
        <metric name="PASS Rate"/>
        <metric name="QUIT Rate"/>
        <metric name="Request Rate"/>
        <metric name="RETR Rate"/>
        <metric name="RSET Rate"/>
        <metric name="STAT Rate"/>
        <metric name="STLS Rate"/>
        <metric name="TOP Rate"/>
        <metric name="UIDL Rate"/>
        <metric name="USER Rate"/>
        <metric name="XPRX Rate"/>
        <metric name="Connections Rate"/>
    </metrics>
    
    <filter name="template" value="pdh:MSExchangePop3(mbx):${name}"/>
    <metrics name="Exchange_2013_POP3_Backend" include="Exchange_2013_POP3_Backend_c">
        <metric name="Connections Current"/>
        <metric name="Connections Failed"/>
        <metric name="Connections Rejected"/>
        <metric name="Connections Total"/>
        <metric name="Current Unauthenticated Connections"/>
        <metric name="Proxy Current Connections"/>
        <metric name="Proxy Connections Failed"/>
        <metric name="Proxy Total Connections"/>
        <metric name="Active SSL Connections"/>
        <metric name="SSL Connections"/>
        <metric name="Invalid Commands"/>
        <metric name="AUTH Failures"/>
        <metric name="AUTH Total"/>
        <metric name="CAPA Failures"/>
        <metric name="CAPA Total"/>
        <metric name="DELE Failures"/>
        <metric name="DELE Total"/>
        <metric name="LIST Failures"/>
        <metric name="LIST Total"/>
        <metric name="NOOP Failures"/>
        <metric name="NOOP Total"/>
        <metric name="PASS Failures"/>
        <metric name="PASS Total"/>
        <metric name="QUIT Failures"/>
        <metric name="QUIT Total"/>
        <metric name="Request Failures"/>
        <metric name="Request Total"/>
        <metric name="RETR Failures"/>
        <metric name="RETR Total"/>
        <metric name="RSET Failures"/>
        <metric name="RSET Total"/>
        <metric name="STAT Failures"/>
        <metric name="STAT Total"/>
        <metric name="STLS Failures"/>
        <metric name="STLS Total"/>
        <metric name="TOP Failures"/>
        <metric name="TOP Total"/>
        <metric name="UIDL Failures"/>
        <metric name="UIDL Total"/>
        <metric name="USER Failures"/>
        <metric name="USER Total"/>
        <metric name="XPRX Failures"/>
        <metric name="XPRX Total"/>
        <metric name="Average Command Processing Time (milliseconds)"/>
        <metric name="Transient Mailbox Connection Failures/minute"/>
        <metric name="Mailbox Offline Errors/minute"/>
        <metric name="Transient Storage Errors/minute"/>
        <metric name="Permanent Storage Errors/minute"/>
        <metric name="Transient Active Directory Errors/minute"/>
        <metric name="Permanent Active Directory Errors/minute"/>
        <metric name="Transient Errors/minute"/>
        <metric name="Average RPC Latency"/>
        <metric name="Average LDAP Latency"/>
    </metrics>
    
    <filter name="template" value="pdh_c:g=MSExchangeTransport Database(_total):${alias}"/>
    <metrics name="MSExchangeTransport_Database_c">
        <metric name="Database: Transactions/sec" alias="Transactions/sec"/>
        <metric name="Database: Transaction Commit Soft/sec" alias="Transaction Commit Soft/sec"/>
        <metric name="Database: Transaction Commit Hard/sec" alias="Transaction Commit Hard/sec"/>
        <metric name="Database: Transaction Aborts/sec" alias="Transaction Aborts/sec"/>
        <metric name="Database: Transaction Commit Async/sec" alias="Transaction Commit Async/sec"/>
        <metric name="Database: Transaction Durable Callback Count/sec" alias="Transaction Durable Callback Count/sec"/>
        <metric name="Database: Bootloaded Items/sec" alias="Bootloaded Items/sec"/>
        <metric name="Database: Replayed Items/sec" alias="Replayed Items/sec"/>
        <metric name="Database: DataRow seeks/sec" alias="DataRow seeks/sec"/>
        <metric name="Database: DataRow seeks prefix/sec" alias="DataRow seeks prefix/sec"/>
        <metric name="Database: DataRow loads/sec" alias="DataRow loads/sec"/>
        <metric name="Database: DataRow updates/sec" alias="DataRow updates/sec"/>
        <metric name="Database: DataRow new inserts/sec" alias="DataRow new inserts/sec"/>
        <metric name="Database: DataRow clones/sec" alias="DataRow clones/sec"/>
        <metric name="Database: DataRow moves/sec" alias="DataRow moves/sec"/>
        <metric name="Database: DataRow deletes/sec" alias="DataRow deletes/sec"/>
        <metric name="Database: DataRow minimize memory/sec" alias="DataRow minimize memory/sec"/>
        <metric name="Database: Stream read/sec" alias="Stream read/sec"/>
        <metric name="Database: Stream bytes read/sec" alias="Stream bytes read/sec"/>
        <metric name="Database: Stream writes/sec" alias="Stream writes/sec"/>
        <metric name="Database: Stream bytes written/sec" alias="Stream bytes written/sec"/>
        <metric name="Database: Stream set length/sec" alias="Stream set length/sec"/>
        <metric name="Database: Lazy bytes load requested/sec" alias="Lazy bytes load requested/sec"/>
        <metric name="Database: Lazy bytes load performed/sec" alias="Lazy bytes load performed/sec"/>
        <metric name="Database: Column cache load/sec" alias="Column cache load/sec"/>
        <metric name="Database: Column cache loaded columns/sec" alias="Column cache loaded columns/sec"/>
        <metric name="Database: Column cache loaded bytes/sec" alias="Column cache loaded bytes/sec"/>
        <metric name="Database: Column cache save/sec" alias="Column cache save/sec"/>
        <metric name="Database: Column cache saved columns/sec" alias="Column cache saved columns/sec"/>
        <metric name="Database: Column cache saved bytes/sec" alias="Column cache saved bytes/sec"/>
        <metric name="Database: Extended property writes/sec" alias="Extended property writes/sec"/>
        <metric name="Database: Extended property bytes written/sec" alias="Extended property bytes written/sec"/>
        <metric name="Database: Extended property reads/sec" alias="Extended property reads/sec"/>
        <metric name="Database: Extended property bytes read/sec" alias="Extended property bytes read/sec"/>
        <metric name="Database: MailItem new/sec" alias="MailItem new/sec"/>
        <metric name="Database: MailItem clone create/sec" alias="MailItem clone create/sec"/>
        <metric name="Database: MailItem dehydrate/sec" alias="MailItem dehydrate/sec"/>
        <metric name="Database: MailItem load/sec" alias="MailItem load/sec"/>
        <metric name="Database: MailItem commit immediate/sec" alias="MailItem commit immediate/sec"/>
        <metric name="Database: MailItem materialize/sec" alias="MailItem materialize/sec"/>
        <metric name="Database: MailItem begin commit/sec" alias="MailItem begin commit/sec"/>
        <metric name="Database: MailItem commit lazy/sec" alias="MailItem commit lazy/sec"/>
        <metric name="Database: MailItem delete lazy/sec" alias="MailItem delete lazy/sec"/>
        <metric name="Database: MailItem writeMimeTo/sec" alias="MailItem writeMimeTo/sec"/>
        <metric name="Database: Bootloaded Item Average Latency" alias="Bootloaded Item Average Latency"/>
        <metric name="Database: Replayed Item Average Latency" alias="Replayed Item Average Latency"/>
        <metric name="Database: Replay Bookmark Average Latency" alias="Replay Bookmark Average Latency"/>
        <metric name="Database: Transaction Pending Average Duration" alias="Transaction Pending Average Duration"/>
        <metric name="Database: Transaction Commit Soft Average Pending Duration" alias="Transaction Commit Soft Average Pending Duration"/>
        <metric name="Database: Transaction Commit Hard Pending Average Duration" alias="Transaction Commit Hard Pending Average Duration"/>
        <metric name="Database: Transaction Commit Async Average Pending Duration" alias="Transaction Commit Async Average Pending Duration"/>
    </metrics>
    
    <filter name="template" value="pdh:MSExchangeTransport Database(_total):${alias}"/>
    <metrics name="MSExchangeTransport_Database" include="MSExchangeTransport_Database_c">
        <metric name="Database: DataRow seeks total" alias="DataRow seeks total"/>
        <metric name="Database: DataRow seeks prefix total" alias="DataRow seeks prefix total"/>
        <metric name="Database: DataRow loads total" alias="DataRow loads total"/>
        <metric name="Database: DataRow updates total" alias="DataRow updates total"/>
        <metric name="Database: DataRow new inserts total" alias="DataRow new inserts total"/>
        <metric name="Database: DataRow clones total" alias="DataRow clones total"/>
        <metric name="Database: DataRow moves total" alias="DataRow moves total"/>
        <metric name="Database: DataRow deletes total" alias="DataRow deletes total"/>
        <metric name="Database: DataRow minimize memory total" alias="DataRow minimize memory total"/>
        <metric name="Database: Stream read total" alias="Stream read total"/>
        <metric name="Database: Stream bytes read total" alias="Stream bytes read total"/>
        <metric name="Database: Stream writes total" alias="Stream writes total"/>
        <metric name="Database: Stream bytes written total" alias="Stream bytes written total"/>
        <metric name="Database: Stream set length count" alias="Stream set length count"/>
        <metric name="Database: Lazy bytes load requested total" alias="Lazy bytes load requested total"/>
        <metric name="Database: Lazy bytes load performed total" alias="Lazy bytes load performed total"/>
        <metric name="Database: Column cache load total" alias="Column cache load total"/>
        <metric name="Database: Column cache loaded columns total" alias="Column cache loaded columns total"/>
        <metric name="Database: Column cache loaded bytes total" alias="Column cache loaded bytes total"/>
        <metric name="Database: Column cache save total" alias="Column cache save total"/>
        <metric name="Database: Column cache saved columns total" alias="Column cache saved columns total"/>
        <metric name="Database: Column cache saved bytes total" alias="Column cache saved bytes total"/>
        <metric name="Database: Extended property writes total" alias="Extended property writes total"/>
        <metric name="Database: Extended property bytes written total" alias="Extended property bytes written total"/>
        <metric name="Database: Extended property reads total" alias="Extended property reads total"/>
        <metric name="Database: Extended property bytes read total" alias="Extended property bytes read total"/>
        <metric name="Database: Transaction Pending Count" alias="Transaction Pending Count"/>
        <metric name="Database: Transaction Count" alias="Transaction Count"/>
        <metric name="Database: Transaction Pending 99 Percentile Duration" alias="Transaction Pending 99 Percentile Duration"/>
        <metric name="Database: Transaction Commit Soft Pending" alias="Transaction Commit Soft Pending"/>
        <metric name="Database: Transaction Commit Soft Count" alias="Transaction Commit Soft Count"/>
        <metric name="Database: Transaction Commit Hard Pending" alias="Transaction Commit Hard Pending"/>
        <metric name="Database: Transaction Commit Hard Count" alias="Transaction Commit Hard Count"/>
        <metric name="Database: Transaction Abort Count" alias="Transaction Abort Count"/>
        <metric name="Database: Transaction Commit Async Pending" alias="Transaction Commit Async Pending"/>
        <metric name="Database: Transaction Commit Async Count" alias="Transaction Commit Async Count"/>
        <metric name="Database: Transaction Durable Callback Count" alias="Transaction Durable Callback Count"/>
        <metric name="Database: MailItem new total" alias="MailItem new total"/>
        <metric name="Database: MailItem clone create total" alias="MailItem clone create total"/>
        <metric name="Database: MailItem dehydrate total" alias="MailItem dehydrate total"/>
        <metric name="Database: MailItem load total" alias="MailItem load total"/>
        <metric name="Database: MailItem commit immediate total" alias="MailItem commit immediate total"/>
        <metric name="Database: MailItem materialize" alias="MailItem materialize"/>
        <metric name="Database: MailItem begin commit total" alias="MailItem begin commit total"/>
        <metric name="Database: MailItem commit lazy total" alias="MailItem commit lazy total"/>
        <metric name="Database: MailItem delete lazy total" alias="MailItem delete lazy total"/>
        <metric name="Database: MailItem writeMimeTo total" alias="MailItem writeMimeTo total"/>
        <metric name="Database: MailItem Count" alias="MailItem Count"/>
        <metric name="Database: MailRecipient Count" alias="MailRecipient Count"/>
        <metric name="Database: MailRecipient Active Count" alias="MailRecipient Active Count"/>
        <metric name="Database: MailRecipient SafetyNet Count" alias="MailRecipient SafetyNet Count"/>
        <metric name="Database: MailRecipient SafetyNet Mdb Count" alias="MailRecipient SafetyNet Mdb Count"/>
        <metric name="Database: MailRecipient Shadow SafetyNet Count" alias="MailRecipient Shadow SafetyNet Count"/>
        <metric name="Database: Generation Count" alias="Generation Count"/>
        <metric name="Database: Generation Expired Count" alias="Generation Expired Count"/>
        <metric name="Database: Generation Last Cleanup Latency" alias="Generation Last Cleanup Latency"/>
        <metric name="Database: Bootloader Outstanding Items" alias="Bootloader Outstanding Items"/>
        <metric name="Database: Bootloaded Item Count" alias="Bootloaded Item Count"/>
        <metric name="Database: Replayed Item Count" alias="Replayed Item Count"/>
        <metric name="Database: Database connections current" alias="Database connections current"/>
        <metric name="Database: Database connections rejected total" alias="Database connections rejected total"/>
        <metric name="Database: Cursors opened total" alias="Cursors opened total"/>
        <metric name="Database: Cursors closed total" alias="Cursors closed total"/>
    </metrics>
    
    <filter name="template" value="pdh:MSExchangeTransport DSN(external):${alias}"/>
    <metrics name="MSExchangeTransport_DSN_external">
        <metric name="DNS external: Failure DSNs Total" alias="Failure DSNs Total"/>
        <metric name="DNS external: Delay DSNs" alias="Delay DSNs"/>
        <metric name="DNS external: Relay DSNs" alias="Relay DSNs"/>
        <metric name="DNS external: Delivered DSNs" alias="Delivered DSNs"/>
        <metric name="DNS external: Expanded DSNs" alias="Expanded DSNs"/>
        <metric name="DNS external: Failure DSNs within the last hour" alias="Failure DSNs within the last hour"/>
        <metric name="DNS external: Alertable failure DSNs within the last hour" alias="Alertable failure DSNs within the last hour"/>
        <metric name="DNS external: Delayed DSNs within the last hour" alias="Delayed DSNs within the last hour"/>
        <metric name="DNS external: NDRs generated for catch-all recipients." alias="NDRs generated for catch-all recipients."/>
    </metrics>
    
    <filter name="template" value="pdh:MSExchangeTransport DSN(internal):${alias}"/>
    <metrics name="MSExchangeTransport_DSN_internal">
        <metric name="DNS internal: Failure DSNs Total" alias="Failure DSNs Total"/>
        <metric name="DNS internal: Delay DSNs" alias="Delay DSNs"/>
        <metric name="DNS internal: Relay DSNs" alias="Relay DSNs"/>
        <metric name="DNS internal: Delivered DSNs" alias="Delivered DSNs"/>
        <metric name="DNS internal: Expanded DSNs" alias="Expanded DSNs"/>
        <metric name="DNS internal: Failure DSNs within the last hour" alias="Failure DSNs within the last hour"/>
        <metric name="DNS internal: Alertable failure DSNs within the last hour" alias="Alertable failure DSNs within the last hour"/>
        <metric name="DNS internal: Delayed DSNs within the last hour" alias="Delayed DSNs within the last hour"/>
        <metric name="DNS internal: NDRs generated for catch-all recipients." alias="NDRs generated for catch-all recipients."/>
    </metrics>
    
    
    <filter name="template" value="pdh_c:g=MSExchangeTransport Queues(_total):${alias}"/>
    <metrics name="MSExchangeTransport_Queues_c">
        <metric name="Queues: Items Completed Delivery Per Second" alias="Items Completed Delivery Per Second"/>
        <metric name="Queues: Items Queued for Delivery Per Second" alias="Items Queued for Delivery Per Second"/>
        <metric name="Queues: Messages Queued for Delivery Per Second" alias="Messages Queued for Delivery Per Second"/>
        <metric name="Queues: Messages Completed Delivery Per Second" alias="Messages Completed Delivery Per Second"/>
        <metric name="Queues: Messages Submitted Per Second" alias="Messages Submitted Per Second"/>
    </metrics>
    
    <filter name="template" value="pdh:MSExchangeTransport Queues(_total):${alias}"/>
    <metrics name="MSExchangeTransport_Queues" include="MSExchangeTransport_Queues_c">
        <metric name="Queues: External Active Remote Delivery Queue Length" alias="External Active Remote Delivery Queue Length"/>
        <metric name="Queues: Internal Active Remote Delivery Queue Length" alias="Internal Active Remote Delivery Queue Length"/>
        <metric name="Queues: External Retry Remote Delivery Queue Length" alias="External Retry Remote Delivery Queue Length"/>
        <metric name="Queues: Internal Retry Remote Delivery Queue Length" alias="Internal Retry Remote Delivery Queue Length"/>
        <metric name="Queues: Active Mailbox Delivery Queue Length" alias="Active Mailbox Delivery Queue Length" indicator="true"/>
        <metric name="Queues: Retry Mailbox Delivery Queue Length" alias="Retry Mailbox Delivery Queue Length"/>
        <metric name="Queues: Active Non-Smtp Delivery Queue Length" alias="Active Non-Smtp Delivery Queue Length"/>
        <metric name="Queues: Retry Non-Smtp Delivery Queue Length" alias="Retry Non-Smtp Delivery Queue Length"/>
        <metric name="Queues: Internal Aggregate Delivery Queue Length (All Internal Queues)" alias="Internal Aggregate Delivery Queue Length (All Internal Queues)"/>
        <metric name="Queues: External Aggregate Delivery Queue Length (All External Queues)" alias="External Aggregate Delivery Queue Length (All External Queues)"/>
        <metric name="Queues: Internal Largest Delivery Queue Length" alias="Internal Largest Delivery Queue Length"/>
        <metric name="Queues: External Largest Delivery Queue Length" alias="External Largest Delivery Queue Length"/>
        <metric name="Queues: Items Queued For Delivery Total" alias="Items Queued For Delivery Total"/>
        <metric name="Queues: Items Completed Delivery Total" alias="Items Completed Delivery Total"/>
        <metric name="Queues: Items Queued For Delivery Expired Total" alias="Items Queued For Delivery Expired Total"/>
        <metric name="Queues: Locks Expired In Delivery Total" alias="Locks Expired In Delivery Total"/>
        <metric name="Queues: Items Deleted By Admin Total" alias="Items Deleted By Admin Total"/>
        <metric name="Queues: Items Resubmitted Total" alias="Items Resubmitted Total"/>
        <metric name="Queues: Messages Deferred Due To Local Loop" alias="Messages Deferred Due To Local Loop"/>
        <metric name="Queues: Messages Queued For Delivery" alias="Messages Queued For Delivery"/>
        <metric name="Queues: Messages Queued For Delivery Total" alias="Messages Queued For Delivery Total"/>
        <metric name="Queues: Messages Completed Delivery Total" alias="Messages Completed Delivery Total"/>
        <metric name="Queues: Unreachable Queue Length" alias="Unreachable Queue Length"/>
        <metric name="Queues: Poison Queue Length" alias="Poison Queue Length"/>
        <metric name="Queues: Submission Queue Length" alias="Submission Queue Length" indicator="true"/>
        <metric name="Queues: Messages Submitted Total" alias="Messages Submitted Total"/>
        <metric name="Queues: Submission Queue Items Expired Total" alias="Submission Queue Items Expired Total"/>
        <metric name="Queues: Submission Queue Locks Expired Total" alias="Submission Queue Locks Expired Total"/>
        <metric name="Queues: Aggregate Shadow Queue Length" alias="Aggregate Shadow Queue Length"/>
        <metric name="Queues: Shadow Queue Auto Discards Total" alias="Shadow Queue Auto Discards Total"/>
        <metric name="Queues: Messages Completing Categorization" alias="Messages Completing Categorization"/>
        <metric name="Queues: Messages Deferred during Categorization" alias="Messages Deferred during Categorization"/>
        <metric name="Queues: Categorizer Job Availability" alias="Categorizer Job Availability"/>
    </metrics>
    
    <filter name="template" value="pdh_c:g=MSExchangeTransport SMTPReceive(_total):${alias}"/>
    <metrics name="MSExchangeTransport_SMTPReceive_c">
        <metric name="SMTPReceive: Connections Created/sec" alias="Connections Created/sec"/>
        <metric name="SMTPReceive: Disconnections by Agents/second" alias="Disconnections by Agents/second"/>
        <metric name="SMTPReceive: Messages Received/sec" alias="Messages Received/sec"/>
        <metric name="SMTPReceive: Message Bytes Received/sec" alias="Message Bytes Received/sec"/>
        <metric name="SMTPReceive: Average bytes/message" alias="Average bytes/message"/>
        <metric name="SMTPReceive: Average recipients/message" alias="Average recipients/message"/>
        <metric name="SMTPReceive: Average bytes/connection" alias="Average bytes/connection"/>
        <metric name="SMTPReceive: Average messages/connection" alias="Average messages/connection"/>
        <metric name="SMTPReceive: Bytes Received/sec" alias="Bytes Received/sec"/>
        <metric name="SMTPReceive: Tarpitting Delays Authenticated/sec" alias="Tarpitting Delays Authenticated/sec"/>
        <metric name="SMTPReceive: Tarpitting Delays Anonymous/sec" alias="Tarpitting Delays Anonymous/sec"/>
    </metrics>
    
    <filter name="template" value="pdh:MSExchangeTransport SMTPReceive(_total):${alias}"/>
    <metrics name="MSExchangeTransport_SMTPReceive" include="MSExchangeTransport_SMTPReceive_c">
        <metric name="SMTPReceive: Connections Current" alias="Connections Current"/>
        <metric name="SMTPReceive: Connections Total" alias="Connections Total"/>
        <metric name="SMTPReceive: Disconnections By Agents" alias="Disconnections By Agents"/>
        <metric name="SMTPReceive: Messages Received Total" alias="Messages Received Total"/>
        <metric name="SMTPReceive: Message Bytes Received Total" alias="Message Bytes Received Total"/>
        <metric name="SMTPReceive: Messages Refused for Size" alias="Messages Refused for Size"/>
        <metric name="SMTPReceive: Messages Received Containing Bare Linefeeds in the SMTP DATA Stream" alias="Messages Received Containing Bare Linefeeds in the SMTP DATA Stream"/>
        <metric name="SMTPReceive: Messages Rejected During SMTP DATA Due to Bare Linefeeds" alias="Messages Rejected During SMTP DATA Due to Bare Linefeeds"/>
        <metric name="SMTPReceive: Recipients accepted Total" alias="Recipients accepted Total"/>
        <metric name="SMTPReceive: Bytes Received Total" alias="Bytes Received Total"/>
        <metric name="SMTPReceive: Tarpitting Delays Authenticated" alias="Tarpitting Delays Authenticated"/>
        <metric name="SMTPReceive: Tarpitting Delays Anonymous" alias="Tarpitting Delays Anonymous"/>
    </metrics>
    
    <filter name="template" value="pdh_c:g=MSExchangeTransport SmtpSend(_total):${alias}"/>
    <metrics name="MSExchangeTransport_SmtpSend_c">
        <metric name="SmtpSend: Connections Created/sec" alias="Connections Created/sec"/>
        <metric name="SmtpSend: Messages Sent/sec" alias="Messages Sent/sec"/>
        <metric name="SmtpSend: Message Bytes Sent/sec" alias="Message Bytes Sent/sec"/>
        <metric name="SmtpSend: Bytes Sent/sec" alias="Bytes Sent/sec"/>
        <metric name="SmtpSend: Average recipients/message" alias="Average recipients/message"/>
        <metric name="SmtpSend: Average message bytes/message" alias="Average message bytes/message"/>
        <metric name="SmtpSend: Average messages/connection" alias="Average messages/connection"/>
        <metric name="SmtpSend: Average bytes/connection" alias="Average bytes/connection"/>
    </metrics>
    
    <filter name="template" value="pdh:MSExchangeTransport SmtpSend(_total):${alias}"/>
    <metrics name="MSExchangeTransport_SmtpSend" include="MSExchangeTransport_SmtpSend_c">
        <metric name="SmtpSend: Connections Current" alias="Connections Current"/>
        <metric name="SmtpSend: Connections Total" alias="Connections Total"/>
        <metric name="SmtpSend: Messages Sent Total" alias="Messages Sent Total" indicator="true" collectionType="trendsup"/>
        <metric name="SmtpSend: Message Bytes Sent Total" alias="Message Bytes Sent Total" indicator="true" units="B" collectionType="trendsup"/>
        <metric name="SmtpSend: Messages Suppressed Due to Bare Linefeeds" alias="Messages Suppressed Due to Bare Linefeeds"/>
        <metric name="SmtpSend: Bytes Sent Total" alias="Bytes Sent Total"/>
        <metric name="SmtpSend: Recipients sent" alias="Recipients sent"/>
        <metric name="SmtpSend: DNS Errors" alias="DNS Errors"/>
        <metric name="SmtpSend: Connection Failures" alias="Connection Failures"/>
        <metric name="SmtpSend: Socket Errors" alias="Socket Errors"/>
        <metric name="SmtpSend: Protocol Errors" alias="Protocol Errors"/>
    </metrics>
    
    <filter name="template" value="pdh_c:g=MSExchange Delivery Store Driver:${alias}"/>
    <metrics name="MSExchange_Delivery_Store_Driver_c">
        <metric name="Inbound: LocalDeliveryCallsPerSecond" alias="Inbound%3A LocalDeliveryCallsPerSecond"/>
        <metric name="Inbound: MessageDeliveryAttemptsPerSecond" alias="Inbound%3A MessageDeliveryAttemptsPerSecond"/>
        <metric name="Inbound: Recipients Delivered Per Second" alias="Inbound%3A Recipients Delivered Per Second"/>
        <metric name="Mailbox Rules: Active Directory queries per second" alias="Mailbox Rules%3A Active Directory queries per second"/>
        <metric name="Mailbox Rules: MAPI operations per second" alias="Mailbox Rules%3A MAPI operations per second"/>
        <metric name="SuccessfulDeliveriesPerSecond" alias="SuccessfulDeliveriesPerSecond"/>
        <metric name="FailedDeliveriesPerSecond" alias="FailedDeliveriesPerSecond"/>
    </metrics>
    
    <filter name="template" value="pdh:MSExchange Delivery Store Driver:${alias}"/>
    <metrics name="MSExchange_Delivery_Store_Driver_2">
        <metric name="Inbound: LocalDeliveryCalls" alias="Inbound%3A LocalDeliveryCalls"/>
        <metric name="Inbound: MessageDeliveryAttempts" alias="Inbound%3A MessageDeliveryAttempts"/>
        <metric name="Inbound: Recipients Delivered" alias="Inbound%3A Recipients Delivered"/>
        <metric name="Inbound: Bytes Delivered" alias="Inbound%3A Bytes Delivered"/>
        <metric name="Inbound: Number of Delivering Threads" alias="Inbound%3A Number of Delivering Threads"/>
        <metric name="Inbound: Retried Recipients" alias="Inbound%3A Retried Recipients"/>
        <metric name="Inbound: Rerouted Recipients" alias="Inbound%3A Rerouted Recipients"/>
        <metric name="Inbound: Duplicate Deliveries" alias="Inbound%3A Duplicate Deliveries"/>
        <metric name="Mailbox Rules: Active Directory queries" alias="Mailbox Rules%3A Active Directory queries"/>
        <metric name="Mailbox Rules: MAPI operations" alias="Mailbox Rules%3A MAPI operations"/>
        <metric name="Mailbox Rules: Average milliseconds spent processing rules." alias="Mailbox Rules%3A Average milliseconds spent processing rules."/>
        <metric name="Mailbox Rules: 90th percentile of milliseconds spent processing rules." alias="Mailbox Rules%3A 90th percentile of milliseconds spent processing rules."/>
        <metric name="Inbound: TotalMeetingMessages" alias="Inbound%3A TotalMeetingMessages"/>
        <metric name="Inbound: TotalMeetingFailures" alias="Inbound%3A TotalMeetingFailures"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange Delivery Store Driver:${name}"/>
    <metrics name="MSExchange_Delivery_Store_Driver" include="MSExchange_Delivery_Store_Driver_c,MSExchange_Delivery_Store_Driver_2">
        <metric name="Percent of Permanent Failed Deliveries within the last 5 minutes"/>
        <metric name="Percent of Temporary Failed Deliveries within the last 5 minutes"/>
        <metric name="Pending Deliveries"/>
        <metric name="Delivery attempts per minute over the last 5 minutes"/>
        <metric name="Delivery failures per minute over the last 5 minutes"/>
        <metric name="SuccessfulDeliveries"/>
        <metric name="FailedDeliveries"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchange Availability Service:${name}"/>
    <metrics name="MSExchange_Availability_Service_c">
        <metric name="Average Time to Process a Free Busy Request" indicator="true"/>
        <metric name="Average Time to Process a Meeting Suggestions Request"/>
        <metric name="Average Number of Mailboxes Processed per Request"/>
        <metric name="Average Time to Process a Cross-Site Free Busy Request"/>
        <metric name="Average Time to Process a Cross-Forest Free Busy Request"/>
        <metric name="Availability Requests (sec)"/>
        <metric name="Suggestions Requests (sec)"/>
        <metric name="Intra-Site Calendar Queries (sec)"/>
        <metric name="Cross-Site Calendar Queries (sec)"/>
        <metric name="Intra-Site Calendar Failures (sec)"/>
        <metric name="Cross-Site Calendar Failures (sec)"/>
        <metric name="Cross-Forest Calendar Failures (sec)"/>
        <metric name="Cross-Forest Calendar Queries (sec)"/>
        <metric name="Public Folder Request Failures (sec)"/>
        <metric name="Foreign Connector Request Failure Rate"/>
        <metric name="Public Folder Queries (sec)"/>
        <metric name="Foreign Connector Queries (sec)"/>
        <metric name="Average Time to Map External Caller to Internal Identity"/>
        <metric name="Federated Free Busy Calendar Queries (sec)"/>
        <metric name="Federated Free Busy Failures (sec)"/>
        <metric name="Average Time to Process a Federated Free Busy Request"/>
        <metric name="Intra-Site Proxy Free Busy Calendar Queries (sec)"/>
        <metric name="Intra-Site Proxy Free Busy Failures (sec)"/>
        <metric name="Average Time to Process an Intra-Site Free Busy Request"/>
    </metrics>
    
    <filter name="template" value="pdh:MSExchange Availability Service:${name}"/>
    <metrics name="MSExchange_Availability_Service" include="MSExchange_Availability_Service_c">
        <metric name="Availability" alias="Availability" category="AVAILABILITY" indicator="true" units="percentage" collectionType="dynamic"/>
        <metric name="Current Requests"/>
        <metric name="Client-Reported Failures - Total"/>
        <metric name="Client-Reported Failures - Autodiscover Failures"/>
        <metric name="Client-Reported Failures - Timeout Failures"/>
        <metric name="Client-Reported Failures - Connection Failures"/>
        <metric name="Client-Reported Failures - Partial or Other Failures"/>
        <metric name="Successful Client-Reported Requests - Total"/>
        <metric name="Successful Client-Reported Requests - Less than 5 seconds"/>
        <metric name="Successful Client-Reported Requests - Less than 10 seconds"/>
        <metric name="Successful Client-Reported Requests - Less than 20 seconds"/>
        <metric name="Successful Client-Reported Requests - Over 20 seconds"/>
    </metrics>
    
    <filter name="template" value="pdh_c:g=MSExchange Hygiene:${name}"/>
    <metrics name="MSExchange_Hygiene_c">
        <metric name="Scan Requests Rejected/sec"/>
        <metric name="Scan Requests Bytes/req"/>
        <metric name="Scan Requests Bytes Scanned/sec"/>
        <metric name="Scan Requests Processing Time/req"/>
        <metric name="Classification Processing Time/req"/>
        <metric name="Antimalware Processing Time/req"/>
        <metric name="Scan Time/req"/>
        <metric name="Scan Requests Processed/sec"/>
        <metric name="Scan Request Wait Time/req"/>
        <metric name="Scan Requests Submitted/sec"/>
    </metrics>
    
    <filter name="template" value="pdh:MSExchange Hygiene:${name}"/>
    <metrics name="MSExchange_Hygiene" include="MSExchange_Hygiene_c">
        <metric name="Scan Request Error Ratio"/>
        <metric name="Scan Request Errors"/>
        <metric name="Scan Error Rate"/>
        <metric name="Scan Errors"/>
        <metric name="Scan Detection Rate"/>
        <metric name="Scan Detection"/>
        <metric name="Scan Requests Processed"/>
        <metric name="Average Scan Time"/>
        <metric name="Scan Time Median"/>
        <metric name="Scan Requests Rejected"/>
        <metric name="Scan Requests Outstanding"/>
        <metric name="Scan Requests Being Scanned"/>
        <metric name="Scan Processes Restarted"/>
        <metric name="Unhealthy Antimalware engines"/>
        <metric name="Scan Requests Fatal Errors"/>
        <metric name="Scan Request Timeouts"/>
        <metric name="Scan Requests Retried"/>
        <metric name="Scan Process Crashes"/>
        <metric name="Scan Processes Running"/>
        <metric name="Scan Time in 90th Percentile"/>
        <metric name="Scan Time in 95th Percentile"/>
        <metric name="Scan Time in 99th Percentile"/>
        <metric name="Total Scan Requests Processed"/>
        <metric name="Scan Processes Below Configured Minimum"/>
        <metric name="Scan Requests Queued"/>
        <metric name="Scan Requests Submitted"/>
    </metrics>
    
    <filter name="template" value="pdh_c:g=MSExchange Hygiene Classification:${alias}"/>
    <metrics name="MSExchange_Hygiene_Classification_c">
        <metric name="Classification - Items Processed/sec" alias="Items Processed/sec"/>
        <metric name="Classification - Scan Time/item" alias="Scan Time/item"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange Hygiene Classification:${alias}"/>
    <metrics name="MSExchange_Hygiene_Classification" include="MSExchange_Hygiene_Classification_c">
        <metric name="Classification - Bytes Classified/ms" alias="Bytes Classified/ms"/>
        <metric name="Classification - Failed Scans" alias="Failed Scans"/>
        <metric name="Classification - Successful Scans" alias="Successful Scans"/>
        <metric name="Classification - Engine Load Time/load" alias="Engine Load Time/load"/>
        <metric name="Classification - Items with Classification Detections" alias="Items with Classification Detections"/>
        <metric name="Classification - Engine Errors" alias="Engine Errors"/>
        <metric name="Classification - Items Processed" alias="Items Processed"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange Hygiene Updates Engine(Microsoft):${alias}"/>
    <metrics name="MSExchange_Hygiene_Updates_Engine_Microsoft">
        <metric name="Engine - Microsoft - Consecutive Failed Updates" alias="Consecutive Failed Updates"/>
        <metric name="Engine - Microsoft - Total Failed Updates" alias="Total Failed Updates"/>
        <metric name="Engine - Microsoft - No Updates Available" alias="No Updates Available"/>
        <metric name="Engine - Microsoft - Updates Successful" alias="Updates Successful"/>
        <metric name="Engine - Microsoft - Updates Attempted" alias="Updates Attempted"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchange Hygiene Antimalware(Microsoft):${alias}"/>
    <metrics name="MSExchange_Hygiene_Antimalware_Microsoft_c">
        <metric name="Antimalware - Microsoft - Items Processed/sec" alias="Items Processed/sec"/>
        <metric name="Antimalware - Microsoft - Scan Time/item" alias="Scan Time/item"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange Hygiene Antimalware(Microsoft):${alias}"/>
    <metrics name="MSExchange_Hygiene_Antimalware_Microsoft" include="MSExchange_Hygiene_Antimalware_Microsoft_c">
        <metric name="Antimalware - Microsoft - Bytes Scanned/ms" alias="Bytes Scanned/ms"/>
        <metric name="Antimalware - Microsoft - Engine Load Time/load" alias="Engine Load Time/load"/>
        <metric name="Antimalware - Microsoft - Failed Scans" alias="Failed Scans"/>
        <metric name="Antimalware - Microsoft - Successful Scans" alias="Successful Scans"/>
        <metric name="Antimalware - Microsoft - Items with Malware Detections" alias="Items with Malware Detections"/>
        <metric name="Antimalware - Microsoft - Engine Errors" alias="Engine Errors"/>
        <metric name="Antimalware - Microsoft - Items Processed" alias="Items Processed"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchange Active Manager Server:${name}"/>
    <metrics name="MSExchange_Active_Manager_Server_c">
        <metric name="Server-Side Calls/sec"/>
        <metric name="Active Manager Database State writes to Persistent storage/sec"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange Active Manager Server:${name}"/>
    <metrics name="MSExchange_Active_Manager_Server" include="MSExchange_Active_Manager_Server_c">
        <metric name="GetServerForDatabase Server-Side Calls"/>
        <metric name="Active Manager Database State writes to Persistent storage"/>
        <metric name="Total Number of Databases"/>
        <metric name="Active Manager Role"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange Diagnostics Service:${name}"/>
    <metrics name="MSExchange_Diagnostics_Service">
        <metric name="Bytes left to be processed on disk"/>
        <metric name="Number of batches uploaded for the last hour"/>
        <metric name="Number of batches uploaded since service started"/>
        <metric name="Successful uploads in last hundred batches"/>
        <metric name="Failed uploads in last hundred batches"/>
        <metric name="Retry count since last successful upload"/>
        <metric name="Average connection open latency for last hundred batches"/>
        <metric name="Connection open latency for last batch"/>
        <metric name="Average upload latency for last hundred batches"/>
        <metric name="Upload latency for last batch"/>
        <metric name="Average upload size for last hundred batches"/>
        <metric name="Upload size for last batch"/>
    </metrics>

    <filter name="template" value="pdh:MSExchangeEdgeSync Synchronizer:${name}"/>
    <metrics name="MSExchangeEdgeSync_Synchronizer">
        <metric name="Total Objects Added"/>
        <metric name="Total objects updated"/>
        <metric name="Total objects deleted"/>
        <metric name="Objects Added per Synchronization Cycle"/>
        <metric name="Objects updated per synchronization cycle"/>
        <metric name="Objects deleted per synchronization cycle"/>
        <metric name="Number of full synchronizations"/>
    </metrics>

    <filter name="template" value="pdh:MSExchangeEdgeSync Topology:${name}"/>
    <metrics name="MSExchangeEdgeSync_Topology">
        <metric name="Total topology updates"/>
        <metric name="Exchange Servers total"/>
        <metric name="Edge Servers total"/>
        <metric name="Hub Transport Servers total"/>
        <metric name="Edge Servers leased total"/>
        <metric name="SyncNow started total"/>
        <metric name="SyncNow Edges not completed total"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchangeImap4(cas):${name}"/>
    <metrics name="MSExchangeImap4_cas_c">
        <metric name="Invalid Commands Rate"/>
        <metric name="Append Rate"/>
        <metric name="Authenticate Rate"/>
        <metric name="Capability Rate"/>
        <metric name="Check Rate"/>
        <metric name="Close Rate"/>
        <metric name="Copy Rate"/>
        <metric name="Create Rate"/>
        <metric name="Delete Rate"/>
        <metric name="Examine Rate"/>
        <metric name="Expunge Rate"/>
        <metric name="Fetch Rate"/>
        <metric name="Idle Rate"/>
        <metric name="List Rate"/>
        <metric name="Login Rate"/>
        <metric name="Logout Rate"/>
        <metric name="LSUB Rate"/>
        <metric name="Namespace Rate"/>
        <metric name="NOOP Rate"/>
        <metric name="Rename Rate"/>
        <metric name="Request Rate"/>
        <metric name="Search Rate"/>
        <metric name="Select Rate"/>
        <metric name="STARTTLS Rate"/>
        <metric name="Status Rate"/>
        <metric name="Store Rate"/>
        <metric name="Subscribe Rate"/>
        <metric name="Unsubscribe Rate"/>
        <metric name="XPROXY Rate"/>
        <metric name="Folder View Reload Rate"/>
        <metric name="SearchFolder Creation Rate"/>
        <metric name="Connections Rate"/>
        <metric name="Unauthenticated Connections/sec"/>
    </metrics>

    <filter name="template" value="pdh:MSExchangeImap4(cas):${name}"/>
    <metrics name="MSExchangeImap4_cas" include="MSExchangeImap4_cas_c">
        <metric name="Current Connections"/>
        <metric name="Connections Failed"/>
        <metric name="Connections Rejected"/>
        <metric name="Connections Total"/>
        <metric name="Current Unauthenticated Connections"/>
        <metric name="Proxy Current Connections"/>
        <metric name="Proxy Connections Failed"/>
        <metric name="Proxy Total Connections"/>
        <metric name="Active SSL Connections"/>
        <metric name="SSL Connections"/>
        <metric name="Invalid Commands"/>
        <metric name="Append Failures"/>
        <metric name="Append Total"/>
        <metric name="Authenticate Failures"/>
        <metric name="Authenticate Total"/>
        <metric name="Capability Failures"/>
        <metric name="Capability Total"/>
        <metric name="Check Failures"/>
        <metric name="Check Total"/>
        <metric name="Close Failures"/>
        <metric name="Close Total"/>
        <metric name="Copy Failures"/>
        <metric name="Copy Total"/>
        <metric name="Create Failures"/>
        <metric name="Create Total"/>
        <metric name="Delete Failures"/>
        <metric name="Delete Total"/>
        <metric name="Examine Failures"/>
        <metric name="Examine Total"/>
        <metric name="Expunge Failures"/>
        <metric name="Expunge Total"/>
        <metric name="Fetch Failures"/>
        <metric name="Fetch Total"/>
        <metric name="Idle Failures"/>
        <metric name="Idle Total"/>
        <metric name="List Failures"/>
        <metric name="List Total"/>
        <metric name="Login Failures"/>
        <metric name="Login Total"/>
        <metric name="Logout Failures"/>
        <metric name="Logout Total"/>
        <metric name="LSUB Failures"/>
        <metric name="LSUB Total"/>
        <metric name="Namespace Failures"/>
        <metric name="Namespace Total"/>
        <metric name="NOOP Failures"/>
        <metric name="NOOP Total"/>
        <metric name="Rename Failures"/>
        <metric name="Rename Total"/>
        <metric name="Request Failures"/>
        <metric name="Request Total"/>
        <metric name="Search Failures"/>
        <metric name="Search Total"/>
        <metric name="Select Failures"/>
        <metric name="Select Total"/>
        <metric name="STARTTLS Failures"/>
        <metric name="STARTTLS Total"/>
        <metric name="Status Failures"/>
        <metric name="Status Total"/>
        <metric name="Store Failures"/>
        <metric name="Store Total"/>
        <metric name="Subscribe Failures"/>
        <metric name="Subscribe Total"/>
        <metric name="Unsubscribe Failures"/>
        <metric name="Unsubscribe Total"/>
        <metric name="XPROXY Failures"/>
        <metric name="XPROXY Total"/>
        <metric name="Average Command Processing Time (milliseconds)"/>
        <metric name="SearchFolder Creation Total"/>
        <metric name="Folder View Reload Total"/>
        <metric name="Transient Mailbox Connection Failures/minute"/>
        <metric name="Mailbox Offline Errors/minute"/>
        <metric name="Transient Storage Errors/minute"/>
        <metric name="Permanent Storage Errors/minute"/>
        <metric name="Transient Active Directory Errors/minute"/>
        <metric name="Permanent Active Directory Errors/minute"/>
        <metric name="Transient Errors/minute"/>
        <metric name="Average RPC Latency"/>
        <metric name="Average LDAP Latency"/>
        <metric name="Total IMAP UID Fixes"/>
        <metric name="Current IMAP UID Fixes"/>
        <metric name="Total IMAP UID Items Fixed"/>
    </metrics>
    
    <filter name="template" value="pdh_c:g=MSExchangeImap4(mbx):${name}"/>
    <metrics name="MSExchangeImap4_mbx_c">
        <metric name="Invalid Commands Rate"/>
        <metric name="Append Rate"/>
        <metric name="Authenticate Rate"/>
        <metric name="Capability Rate"/>
        <metric name="Check Rate"/>
        <metric name="Close Rate"/>
        <metric name="Copy Rate"/>
        <metric name="Create Rate"/>
        <metric name="Delete Rate"/>
        <metric name="Examine Rate"/>
        <metric name="Expunge Rate"/>
        <metric name="Fetch Rate"/>
        <metric name="Idle Rate"/>
        <metric name="List Rate"/>
        <metric name="Login Rate"/>
        <metric name="Logout Rate"/>
        <metric name="LSUB Rate"/>
        <metric name="Namespace Rate"/>
        <metric name="NOOP Rate"/>
        <metric name="Rename Rate"/>
        <metric name="Request Rate"/>
        <metric name="Search Rate"/>
        <metric name="Select Rate"/>
        <metric name="STARTTLS Rate"/>
        <metric name="Status Rate"/>
        <metric name="Store Rate"/>
        <metric name="Subscribe Rate"/>
        <metric name="Unsubscribe Rate"/>
        <metric name="XPROXY Rate"/>
        <metric name="Folder View Reload Rate"/>
        <metric name="SearchFolder Creation Rate"/>
        <metric name="Connections Rate"/>
        <metric name="Unauthenticated Connections/sec"/>
    </metrics>

    <filter name="template" value="pdh:MSExchangeImap4(mbx):${name}"/>
    <metrics name="MSExchangeImap4_mbx" include="MSExchangeImap4_mbx_c">
        <metric name="Current Connections"/>
        <metric name="Connections Failed"/>
        <metric name="Connections Rejected"/>
        <metric name="Connections Total"/>
        <metric name="Current Unauthenticated Connections"/>
        <metric name="Proxy Current Connections"/>
        <metric name="Proxy Connections Failed"/>
        <metric name="Proxy Total Connections"/>
        <metric name="Active SSL Connections"/>
        <metric name="SSL Connections"/>
        <metric name="Invalid Commands"/>
        <metric name="Append Failures"/>
        <metric name="Append Total"/>
        <metric name="Authenticate Failures"/>
        <metric name="Authenticate Total"/>
        <metric name="Capability Failures"/>
        <metric name="Capability Total"/>
        <metric name="Check Failures"/>
        <metric name="Check Total"/>
        <metric name="Close Failures"/>
        <metric name="Close Total"/>
        <metric name="Copy Failures"/>
        <metric name="Copy Total"/>
        <metric name="Create Failures"/>
        <metric name="Create Total"/>
        <metric name="Delete Failures"/>
        <metric name="Delete Total"/>
        <metric name="Examine Failures"/>
        <metric name="Examine Total"/>
        <metric name="Expunge Failures"/>
        <metric name="Expunge Total"/>
        <metric name="Fetch Failures"/>
        <metric name="Fetch Total"/>
        <metric name="Idle Failures"/>
        <metric name="Idle Total"/>
        <metric name="List Failures"/>
        <metric name="List Total"/>
        <metric name="Login Failures"/>
        <metric name="Login Total"/>
        <metric name="Logout Failures"/>
        <metric name="Logout Total"/>
        <metric name="LSUB Failures"/>
        <metric name="LSUB Total"/>
        <metric name="Namespace Failures"/>
        <metric name="Namespace Total"/>
        <metric name="NOOP Failures"/>
        <metric name="NOOP Total"/>
        <metric name="Rename Failures"/>
        <metric name="Rename Total"/>
        <metric name="Request Failures"/>
        <metric name="Request Total"/>
        <metric name="Search Failures"/>
        <metric name="Search Total"/>
        <metric name="Select Failures"/>
        <metric name="Select Total"/>
        <metric name="STARTTLS Failures"/>
        <metric name="STARTTLS Total"/>
        <metric name="Status Failures"/>
        <metric name="Status Total"/>
        <metric name="Store Failures"/>
        <metric name="Store Total"/>
        <metric name="Subscribe Failures"/>
        <metric name="Subscribe Total"/>
        <metric name="Unsubscribe Failures"/>
        <metric name="Unsubscribe Total"/>
        <metric name="XPROXY Failures"/>
        <metric name="XPROXY Total"/>
        <metric name="Average Command Processing Time (milliseconds)"/>
        <metric name="SearchFolder Creation Total"/>
        <metric name="Folder View Reload Total"/>
        <metric name="Transient Mailbox Connection Failures/minute"/>
        <metric name="Mailbox Offline Errors/minute"/>
        <metric name="Transient Storage Errors/minute"/>
        <metric name="Permanent Storage Errors/minute"/>
        <metric name="Transient Active Directory Errors/minute"/>
        <metric name="Permanent Active Directory Errors/minute"/>
        <metric name="Transient Errors/minute"/>
        <metric name="Average RPC Latency"/>
        <metric name="Average LDAP Latency"/>
        <metric name="Total IMAP UID Fixes"/>
        <metric name="Current IMAP UID Fixes"/>
        <metric name="Total IMAP UID Items Fixed"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchange Mailbox Replication Service:${name}"/>
    <metrics name="MSExchange_Mailbox_Replication_Service_c">
        <metric name="PST Read Bytes/sec"/>
        <metric name="PST Write Bytes/sec"/>
        <metric name="PST Read Operations/sec"/>
        <metric name="PST Write Operations/sec"/>
        <metric name="PST Read Messages/sec"/>
        <metric name="PST Write Messages/sec"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange Mailbox Replication Service:${alias}"/>
    <metrics name="MSExchange_Mailbox_Replication_Service_2">
        <metric name="CPU Throttle: Raw write throttle due to Cpu resource" alias="CPU Throttle%3A Raw write throttle due to Cpu resource"/>
        <metric name="CPU Throttle: Raw read throttle due to Cpu resource" alias="CPU Throttle%3A Raw read throttle due to Cpu resource"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange Mailbox Replication Service:${name}"/>
    <metrics name="MSExchange_Mailbox_Replication_Service" include="MSExchange_Mailbox_Replication_Service_c,MSExchange_Mailbox_Replication_Service_2">
        <metric name="Unreachable Databases"/>
        <metric name="Last Scan Timestamp (UTC)"/>
        <metric name="Last Scan Duration (msec)"/>
        <metric name="Total jobs currently being processed by this server"/>
        <metric name="PST Heap Cache Bytes"/>
        <metric name="PST Block BTree Cache Bytes"/>
        <metric name="PST Node BTree Cache Bytes"/>
        <metric name="PST AMap Cache Bytes"/>
        <metric name="Named Property Cache Entries."/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchange Mailbox Replication Service Per Mdb:${alias}"/>
    <metrics name="MSExchange_Mailbox_Replication_Service_Per_Mdb_c">
        <metric name="Active Moves: Transfer Rate (KB/sec)" alias="Active Moves%3A Transfer Rate (KB/sec)"/>
        <metric name="Move Requests: Completed/hour" alias="Move Requests%3A Completed/hour"/>
        <metric name="Move Requests: Canceled/hour" alias="Move Requests%3A Canceled/hour"/>
        <metric name="Move Requests: Transient Failures/hour" alias="Move Requests%3A Transient Failures/hour"/>
        <metric name="Move Requests: Transient Failures (Network)/hour" alias="Move Requests%3A Transient Failures (Network)/hour"/>
        <metric name="Move Requests: Transient Failures (Proxy Backoff)/hour" alias="Move Requests%3A Transient Failures (Proxy Backoff)/hour"/>
        <metric name="Move Requests: Failed/hour" alias="Move Requests%3A Failed/hour"/>
        <metric name="Move Requests: Failed (Network)/hour" alias="Move Requests%3A Failed (Network)/hour"/>
        <metric name="Move Requests: Completed with Warnings/hour" alias="Move Requests%3A Completed with Warnings/hour"/>
        <metric name="Move Requests: Failed (MAPI)/hour" alias="Move Requests%3A Failed (MAPI)/hour"/>
        <metric name="Move Requests: Move Stalls/hour" alias="Move Requests%3A Move Stalls/hour"/>
        <metric name="Move Requests: Move Stalls (Content Indexing)/hour" alias="Move Requests%3A Move Stalls (Content Indexing)/hour"/>
        <metric name="Move Requests: Move Stalls (Database Replication)/hour" alias="Move Requests%3A Move Stalls (Database Replication)/hour"/>
        <metric name="Move Requests: Failed (Other)/hour" alias="Move Requests%3A Failed (Other)/hour"/>
        <metric name="Move Requests: Failed (Stall Database Replication)/hour" alias="Move Requests%3A Failed (Stall Database Replication)/hour"/>
        <metric name="Move Requests: Failed (Stall Content Indexing)/hour" alias="Move Requests%3A Failed (Stall Content Indexing)/hour"/>
        <metric name="Move Requests: Failed (Bad Item Limit)/hour" alias="Move Requests%3A Failed (Bad Item Limit)/hour"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange Mailbox Replication Service Per Mdb:${alias}"/>
    <metrics name="MSExchange_Mailbox_Replication_Service_Per_Mdb" include="MSExchange_Mailbox_Replication_Service_Per_Mdb_c">
        <metric name="Active Moves: Total Moves" alias="Active Moves%3A Total Moves"/>
        <metric name="Active Moves: Moves in Initial Seeding State" alias="Active Moves%3A Moves in Initial Seeding State"/>
        <metric name="Active Moves: Moves in Completion State" alias="Active Moves%3A Moves in Completion State"/>
        <metric name="Active Moves: Stalled Moves Total" alias="Active Moves%3A Stalled Moves Total"/>
        <metric name="Active Moves: Stalled Moves (Database Replication)" alias="Active Moves%3A Stalled Moves (Database Replication)"/>
        <metric name="Active Moves: Stalled Moves (Content Indexing)" alias="Active Moves%3A Stalled Moves (Content Indexing)"/>
        <metric name="Active Moves: Transient Failure (Total)" alias="Active Moves%3A Transient Failure (Total)"/>
        <metric name="Active Moves: Transient Failure (Network)" alias="Active Moves%3A Transient Failure (Network)"/>
        <metric name="Active Moves: Transient Failure (MDB Offline)" alias="Active Moves%3A Transient Failure (MDB Offline)"/>
        <metric name="Active Moves: Bytes Transferred" alias="Active Moves%3A Bytes Transferred"/>
        <metric name="Move Requests: Completed" alias="Move Requests%3A Completed"/>
        <metric name="Move Requests: Completed with Warnings" alias="Move Requests%3A Completed with Warnings"/>
        <metric name="Move Requests: Canceled" alias="Move Requests%3A Canceled"/>
        <metric name="Move Requests: Transient Failures" alias="Move Requests%3A Transient Failures"/>
        <metric name="Move Requests: Transient Failures (Network)" alias="Move Requests%3A Transient Failures (Network)"/>
        <metric name="Move Requests: Transient Failures (Proxy Backoff)" alias="Move Requests%3A Transient Failures (Proxy Backoff)"/>
        <metric name="Move Requests: Failed" alias="Move Requests%3A Failed"/>
        <metric name="Move Requests: Failed (Bad Item Limit)" alias="Move Requests%3A Failed (Bad Item Limit)"/>
        <metric name="Move Requests: Failed (Network)" alias="Move Requests%3A Failed (Network)"/>
        <metric name="Move Requests: Failed (Stall Content Indexing)" alias="Move Requests%3A Failed (Stall Content Indexing)"/>
        <metric name="Move Requests: Failed (Stall Database Replication)" alias="Move Requests%3A Failed (Stall Database Replication)"/>
        <metric name="Move Requests: Failed (MAPI)" alias="Move Requests%3A Failed (MAPI)"/>
        <metric name="Move Requests: Failed (Other)" alias="Move Requests%3A Failed (Other)"/>
        <metric name="Move Requests: Stalls" alias="Move Requests%3A Stalls"/>
        <metric name="Move Requests: Stalls (Database Replication)" alias="Move Requests%3A Stalls (Database Replication)"/>
        <metric name="Move Requests: Stalls (Content Indexing)" alias="Move Requests%3A Stalls (Content Indexing)"/>
        <metric name="Last Scan: Timestamp (UTC)" alias="Last Scan%3A Timestamp (UTC)"/>
        <metric name="Last Scan: Duration (msec)" alias="Last Scan%3A Duration (msec)"/>
        <metric name="MDB Health: Scan Failure" alias="MDB Health%3A Scan Failure"/>
        <metric name="MDB Health: Content Indexing Lagging" alias="MDB Health%3A Content Indexing Lagging"/>
        <metric name="MDB Health: Database Replication Lagging" alias="MDB Health%3A Database Replication Lagging"/>
        <metric name="MDB Throttle: Raw write throttle due to Mdb resource" alias="MDB Throttle%3A Raw write throttle due to Mdb resource"/>
        <metric name="MDB Throttle: Raw read throttle due to Mdb resource" alias="MDB Throttle%3A Raw read throttle due to Mdb resource"/>
        <metric name="MDB Throttle: Raw write throttle due to HA resource" alias="MDB Throttle%3A Raw write throttle due to HA resource"/>
        <metric name="MDB Throttle: Raw write throttle due to CI resource" alias="MDB Throttle%3A Raw write throttle due to CI resource"/>
        <metric name="MDB Health: Write Capacity" alias="MDB Health%3A Write Capacity"/>
        <metric name="MDB Health: Read Capacity" alias="MDB Health%3A Read Capacity"/>
        <metric name="MDB Health: Active Write Jobs" alias="MDB Health%3A Active Write Jobs"/>
        <metric name="MDB Health: Active Read Jobs" alias="MDB Health%3A Active Read Jobs"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchange Replication(_total):${name}"/>
    <metrics name="MSExchange_Replication_c">
        <metric name="Log Copy KB/Sec"/>
        <metric name="Log Generation Rate on Source (generations/sec)"/>
        <metric name="Log Inspection Rate (generations/sec)"/>
        <metric name="Log Replay Rate (generations/sec)"/>
        <metric name="GetCopyStatus Server-Side Calls/sec"/>    
        <metric name="Avg. Network sec/Read"/>
        <metric name="Avg. Block Mode Disk sec/Write"/>
        <metric name="Avg. File Mode Disk sec/Log Generation"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange Replication(_total):${name}"/>
    <metrics name="MSExchange_Replication" include="MSExchange_Replication_c">
        <metric name="CopyNotificationGenerationNumber"/>
        <metric name="CopyGenerationNumber"/>
        <metric name="InspectorGenerationNumber"/>
        <metric name="ReplayNotificationGenerationNumber"/>
        <metric name="ReplayGenerationNumber"/>
        <metric name="ReplayQueueLength"/>
        <metric name="CopyQueueLength"/>
        <metric name="CopyQueueLength excluding inspection"/>
        <metric name="Failed"/>
        <metric name="Initializing"/>
        <metric name="FailedSuspended"/>
        <metric name="Resynchronizing"/>
        <metric name="Disconnected"/>
        <metric name="SinglePageRestore"/>
        <metric name="ActivationSuspended"/>
        <metric name="Suspended"/>
        <metric name="Suspended and not Seeding"/>
        <metric name="Seeding"/>
        <metric name="ReplayLagDisabled"/>
        <metric name="ReplayLag Percent of Configured Lag"/>
        <metric name="CompressionEnabled"/>
        <metric name="EncryptionEnabled"/>
        <metric name="TruncatedGenerationNumber"/>
        <metric name="IncReseedDBPagesReadNumber"/>
        <metric name="IncReseedLogCopiedNumber"/>
        <metric name="Log Copying is Not Keeping Up"/>
        <metric name="Log Replay is Not Keeping Up"/>
        <metric name="Continuous replication - block mode Active"/>
        <metric name="Total Bytes Received Block Mode"/>
        <metric name="Average Bytes Per Log Generation - Block Mode"/>
        <metric name="SeedingSource"/>
        <metric name="GetCopyStatus Server-Side Calls"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchange RpcClientAccess:${name}"/>
    <metrics name="MSExchange_RpcClientAccess_c">
        <metric name="RpcHttpConnectionRegistration dispatch task operations/sec"/>
        <metric name="RPC Packets/sec"/>
        <metric name="RPC Operations/sec"/>
        <metric name="RPC dispatch task operations/sec"/>
        <metric name="XTC dispatch task operations/sec"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange RpcClientAccess:${alias}"/>
    <metrics name="MSExchange_RpcClientAccess_2">
        <metric name="Client: RPCs attempted" alias="Client%3A RPCs attempted"/>
        <metric name="Client: RPCs succeeded" alias="Client%3A RPCs succeeded"/>
        <metric name="Client: Background RPCs succeeded" alias="Client%3A Background RPCs succeeded"/>
        <metric name="Client: Foreground RPCs succeeded" alias="Client%3A Foreground RPCs succeeded"/>
        <metric name="Client: RPCs Failed" alias="Client%3A RPCs Failed"/>
        <metric name="Client: Background RPCs Failed" alias="Client%3A Background RPCs Failed"/>
        <metric name="Client: Foreground RPCs Failed" alias="Client%3A Foreground RPCs Failed"/>
        <metric name="Client: Latency > 2 sec RPCs" alias="Client%3A Latency > 2 sec RPCs"/>
        <metric name="Client: Latency > 5 sec RPCs" alias="Client%3A Latency > 5 sec RPCs"/>
        <metric name="Client: Latency > 10 sec RPCs" alias="Client%3A Latency > 10 sec RPCs"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange RpcClientAccess:${name}"/>
    <metrics name="MSExchange_RpcClientAccess" include="MSExchange_RpcClientAccess_c,MSExchange_RpcClientAccess_2">
        <metric name="RPC Requests" indicator="true"/>
        <metric name="RPC Averaged Latency" indicator="true"/>
        <metric name="RPC Clients Bytes Read"/>
        <metric name="RPC Clients Bytes Written"/>
        <metric name="RPC Clients Uncompressed Bytes Read"/>
        <metric name="RPC Clients Uncompressed Bytes Written"/>
        <metric name="Connection Count"/>
        <metric name="Active User Count"/>
        <metric name="User Count"/>
        <metric name="RPC dispatch task queue length"/>
        <metric name="RPC dispatch task threads"/>
        <metric name="RPC dispatch task active threads"/>
        <metric name="XTC dispatch task queue length"/>
        <metric name="XTC dispatch task threads"/>
        <metric name="XTC dispatch task active threads"/>
        <metric name="RpcHttpConnectionRegistration dispatch task queue length"/>
        <metric name="RpcHttpConnectionRegistration dispatch task threads"/>
        <metric name="RpcHttpConnectionRegistration dispatch task active threads"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange RpcClientAccess Per Server:${name}"/>
    <metrics name="MSExchange_RpcClientAccess_Per_Server">
        <metric name="RPC Average Latency (End To End)"/>
        <metric name="RPC Average Latency (End To End) - Online Mode"/>
        <metric name="RPC Average Latency (End To End) - Cached Mode"/>
        <metric name="RPC Average Latency (Backend)"/>
        <metric name="RPC Failed Backend Connections"/>
        <metric name="RPC Active Backend Connections (% of Limit)"/>
    </metrics>

    <filter name="template" value="pdh:MSExchangeFrontendTransport Proxy Routing Agent:${name}"/>
    <metrics name="MSExchangeFrontendTransport_Proxy_Routing_Agent">
        <metric name="MessagesSuccessfullyRouted"/>
        <metric name="MessagesFailedToRoute"/>
    </metrics>

    <filter name="template" value="pdh:MSExchangeFrontEndTransport ProxyHubSelector(_total):${name}"/>
    <metrics name="MSExchangeFrontEndTransport_ProxyHubSelector">
        <metric name="Hub Selection Requests Total"/>
        <metric name="Hub Selection Resolver Failures"/>
        <metric name="Hub Selection Organization Mailbox Failures"/>
        <metric name="Hub Selection Messages Without Mailbox Recipients"/>
        <metric name="Hub Selection Messages Without Organization Mailboxes"/>
        <metric name="Hub Selection Fallback Routing Requests"/>
        <metric name="Hub Selection Routing Failures"/>
    </metrics>

    <filter name="template" value="pdh:MSExchangeFrontEndTransport Routing(_total):${name}"/>
    <metrics name="MSExchangeFrontEndTransport_Routing">
        <metric name="Routing NDRs Total"/>
        <metric name="Routing Tables Calculated Total"/>
        <metric name="Routing Tables Changed Total"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchangeFrontEndTransport SmtpReceive(_total):${alias}"/>
    <metrics name="MSExchangeFrontEndTransport_SmtpReceive_c">
        <metric name="SMTPReceive: Connections Created/sec" alias="Connections Created/sec"/>
        <metric name="SMTPReceive: Connections Created/sec for inbound proxy messages" alias="Connections Created/sec for inbound proxy messages"/>
        <metric name="SMTPReceive: Disconnections by Agents/second" alias="Disconnections by Agents/second"/>
        <metric name="SMTPReceive: Inbound Messages Received/sec" alias="Inbound Messages Received/sec"/>
        <metric name="SMTPReceive: Inbound Message Bytes Received/sec" alias="Inbound Message Bytes Received/sec"/>
        <metric name="SMTPReceive: Bytes Received/sec" alias="Bytes Received/sec"/>
        <metric name="SMTPReceive: Tarpitting Delays Authenticated/sec" alias="Tarpitting Delays Authenticated/sec"/>
        <metric name="SMTPReceive: Tarpitting Delays Anonymous/sec" alias="Tarpitting Delays Anonymous/sec"/>
        <metric name="SMTPReceive: Average bytes/inbound message" alias="Average bytes/inbound message"/>
        <metric name="SMTPReceive: Average recipients/inbound message" alias="Average recipients/inbound message"/>
        <metric name="SMTPReceive: Average bytes/connection" alias="Average bytes/connection"/>
        <metric name="SMTPReceive: Average inbound messages/connection" alias="Average inbound messages/connection"/>
    </metrics>

    <filter name="template" value="pdh:MSExchangeFrontEndTransport SmtpReceive(_total):${alias}"/>
    <metrics name="MSExchangeFrontEndTransport_SmtpReceive" include="MSExchangeFrontEndTransport_SmtpReceive_c">
        <metric name="SMTPReceive: Connections Current" alias="Connections Current"/>
        <metric name="SMTPReceive: Connections Total" alias="Connections Total"/>
        <metric name="SMTPReceive: Inbound Message Connections Current" alias="Inbound Message Connections Current"/>
        <metric name="SMTPReceive: Inbound Message Connections Total" alias="Inbound Message Connections Total"/>
        <metric name="SMTPReceive: Disconnections By Agents" alias="Disconnections By Agents"/>
        <metric name="SMTPReceive: Inbound Messages Received Total" alias="Inbound Messages Received Total"/>
        <metric name="SMTPReceive: Inbound Message Bytes Received Total" alias="Inbound Message Bytes Received Total"/>
        <metric name="SMTPReceive: InboundMessages Refused for Size" alias="InboundMessages Refused for Size"/>
        <metric name="SMTPReceive: InboundRecipients accepted Total" alias="InboundRecipients accepted Total"/>
        <metric name="SMTPReceive: Bytes Received Total" alias="Bytes Received Total"/>
        <metric name="SMTPReceive: Tarpitting Delays Authenticated" alias="Tarpitting Delays Authenticated"/>
        <metric name="SMTPReceive: Tarpitting Delays Anonymous" alias="Tarpitting Delays Anonymous"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchangeFrontEndTransport SmtpSend(_total):${alias}"/>
    <metrics name="MSExchangeFrontEndTransport_SmtpSend_c">
        <metric name="SmtpSend: Connections Created/sec" alias="Connections Created/sec"/>
        <metric name="SmtpSend: Messages Sent/sec" alias="Messages Sent/sec"/>
        <metric name="SmtpSend: Message Bytes Sent/sec" alias="Message Bytes Sent/sec"/>
        <metric name="SmtpSend: Bytes Sent/sec" alias="Bytes Sent/sec"/>
        <metric name="SmtpSend: Average recipients/message" alias="Average recipients/message"/>
        <metric name="SmtpSend: Average message bytes/message" alias="Average message bytes/message"/>
        <metric name="SmtpSend: Average messages/connection" alias="Average messages/connection"/>
        <metric name="SmtpSend: Average bytes/connection" alias="Average bytes/connection"/>
    </metrics>

    <filter name="template" value="pdh:MSExchangeFrontEndTransport SmtpSend(_total):${alias}"/>
    <metrics name="MSExchangeFrontEndTransport_SmtpSend" include="MSExchangeFrontEndTransport_SmtpSend_c">
        <metric name="SmtpSend: Connections Current" alias="Connections Current"/>
        <metric name="SmtpSend: Connections Total" alias="Connections Total"/>
        <metric name="SmtpSend: Messages Sent Total" alias="Messages Sent Total" indicator="true" collectionType="trendsup"/>
        <metric name="SmtpSend: Message Bytes Sent Total" alias="Message Bytes Sent Total" indicator="true" units="B" collectionType="trendsup"/>
        <metric name="SmtpSend: Messages Suppressed Due to Bare Linefeeds" alias="Messages Suppressed Due to Bare Linefeeds"/>
        <metric name="SmtpSend: Bytes Sent Total" alias="Bytes Sent Total"/>
        <metric name="SmtpSend: Recipients sent" alias="Recipients sent"/>
        <metric name="SmtpSend: DNS Errors" alias="DNS Errors"/>
        <metric name="SmtpSend: Connection Failures" alias="Connection Failures"/>
        <metric name="SmtpSend: Socket Errors" alias="Socket Errors"/>
        <metric name="SmtpSend: Protocol Errors" alias="Protocol Errors"/>
    </metrics>

    <filter name="template" value="pdh:MSExchangeUMAvailability:${name}"/>
    <metrics name="MSExchangeUMAvailability">
        <metric name="Directory Access Failures" indicator="true"/>
        <metric name="Worker Process Recycled"/>
        <metric name="Total Inbound Calls Rejected by the UM Service" indicator="true"/>
        <metric name="% of Inbound Calls Rejected by the UM Service Over the Last Hour"/>
        <metric name="Total Inbound Calls Rejected by the UM Worker Process" indicator="true"/>
        <metric name="% of Inbound Calls Rejected by the UM Worker Process Over the Last Hour"/>
        <metric name="Total Worker Process Call Count"/>
        <metric name="Calls Disconnected on Irrecoverable Internal Error"/>
        <metric name="Incomplete Signaling Information"/>
        <metric name="Calls Disconnected by UM on Irrecoverable External Error"/>
        <metric name="Total Queued Messages"/>
        <metric name="Spoken Name Accessed"/>
        <metric name="Name TTSed"/>
        <metric name="% of Messages Successfully Processed Over the Last Hour"/>
        <metric name="Average Processing Time in seconds per Message (Over the Last 50 Messages)"/>
        <metric name="Failed Mailbox Connection Attempts %"/>
        <metric name="% of Failed Mailbox Connection Attempts Over the Last Hour"/>
        <metric name="Custom Prompt Download Failures %"/>
        <metric name="Call Answering Rules Download Failures %"/>
        <metric name="Average Voice Message Transcription Failures %"/>
        <metric name="Average Hub Transport Access Failures %"/>
        <metric name="% of Partner Voice Message Transcription Failures Over the Last Hour"/>
        <metric name="Average Partner Voice Message Transcription Failures %"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchange Store Interface(_Total):${alias}"/>
    <metrics name="MSExchange_Store_Interface_2_c">
        <metric name="RPC Pool: Average Latency" alias="RPC Pool%3A Average Latency"/>
        <metric name="RPC Pool: Session Notifications Received/sec" alias="RPC Pool%3A Session Notifications Received/sec"/>
        <metric name="RPC Pool: Async Notifications Received/sec" alias="RPC Pool%3A Async Notifications Received/sec"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange Store Interface(_Total):${alias}"/>
    <metrics name="MSExchange_Store_Interface_2" include="MSExchange_Store_Interface_2_c">
        <metric name="RPC Pool: Pools" alias="RPC Pool%3A Pools"/>
        <metric name="RPC Pool: RPC Context Handles" alias="RPC Pool%3A RPC Context Handles"/>
        <metric name="RPC Pool: Sessions" alias="RPC Pool%3A Sessions"/>
        <metric name="RPC Pool: Active Threads Ratio" alias="RPC Pool%3A Active Threads Ratio"/>
        <metric name="RPC Pool: Parked Async Notification Calls" alias="RPC Pool%3A Parked Async Notification Calls"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchange Store Interface(_Total):${name}"/>
    <metrics name="MSExchange_Store_Interface_c">
        <metric name="RPC Requests sent/sec"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange Store Interface(_Total):${name}"/>
    <metrics name="MSExchange_Store_Interface" include="MSExchange_Store_Interface_2,MSExchange_Store_Interface_c">
        <metric name="ConnectionCache num caches"/>
        <metric name="ConnectionCache total capacity"/>
        <metric name="ConnectionCache active connections"/>
        <metric name="ConnectionCache idle connections"/>
        <metric name="ConnectionCache out of limit creations"/>
        <metric name="ExRpcConnection creation events"/>
        <metric name="ExRpcConnection disposal events"/>
        <metric name="ExRpcConnection outstanding"/>
        <metric name="UNK Objects total"/>
        <metric name="UNK Logons"/>
        <metric name="UNK Folders"/>
        <metric name="UNK Messages"/>
        <metric name="RPC Requests sent"/>
        <metric name="RPC Requests succeeded"/>
        <metric name="RPC Requests failed"/>
        <metric name="RPC Requests failed with exception"/>
        <metric name="RPC Requests failed (%)"/>
        <metric name="RPC Requests outstanding"/>
        <metric name="RPC Latency total (msec)"/>
        <metric name="RPC Latency average (msec)" indicator="true"/>
        <metric name="RPC Slow requests"/>
        <metric name="RPC Slow requests (%)"/>
        <metric name="RPC Slow requests latency total (msec)"/>
        <metric name="RPC Slow requests latency average (msec)"/>
        <metric name="RPC Bytes sent"/>
        <metric name="RPC Bytes sent average"/>
        <metric name="RPC Bytes received"/>
        <metric name="RPC Bytes received average"/>
        <metric name="ROP Requests sent"/>
        <metric name="ROP Requests complete"/>
        <metric name="ROP Requests outstanding"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchange ADAccess Domain Controllers(%instance_name%):${name}"/>
    <metrics name="MSExchange_ADAccess_Domain_Controllers_c">
        <metric name="LDAP Read Calls/sec"/>
        <metric name="LDAP Search Calls/sec"/>
        <metric name="LDAP Searches Timed Out per Minute" indicator="true"/>
        <metric name="LDAP Searches Time Limit Exceeded per Minute"/>
        <metric name="LDAP Fatal Errors per Minute"/>
        <metric name="LDAP Disconnects per Minute"/>
        <metric name="User Searches Failed per Minute"/>
        <metric name="LDAP Modification Error per Minute"/>
        <metric name="Bind Failures per Minute"/>
        <metric name="Long Running LDAP Operations/min" indicator="true"/>
        <metric name="LDAP Pages/sec"/>
        <metric name="LDAP VLV Requests/sec"/>
        <metric name="LDAP Read Time" indicator="true"/>
        <metric name="LDAP Search Time" indicator="true"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange ADAccess Domain Controllers(%instance_name%):${name}"/>
    <metrics name="MSExchange_ADAccess_Domain_Controllers" include="MSExchange_ADAccess_Domain_Controllers_c">
        <metric name="Availability" alias="Availability" category="AVAILABILITY" indicator="true" units="percentage" collectionType="dynamic"/>
        <metric name="Number of Outstanding Requests"/>
        <metric name="DsGetDcName Elapsed Time"/>
        <metric name="GetHostByName Elapsed Time"/>
        <metric name="Kerberos Ticket Lifetime"/>
        <metric name="LDAP Connection Lifetime"/>
        <metric name="Local Site Flag"/>
        <metric name="Reachability Bitmask"/>
        <metric name="IsSynchronized Flag"/>
        <metric name="GC Capable Flag"/>
        <metric name="PDC Flag"/>
        <metric name="SACL Right Flag"/>
        <metric name="Critical Data Flag"/>
        <metric name="Netlogon Flag"/>
        <metric name="OS Version Flag"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchange Database(%instance_name%):${name}"/>
    <metrics name="MSExchange_Database_c">
        <metric name="Table Open Cache Hits/sec"/>
        <metric name="Table Open Cache Misses/sec"/>
        <metric name="Table Opens/sec"/>
        <metric name="Table Closes/sec"/>
        <metric name="Log Bytes Write/sec"/>
        <metric name="Log Bytes Generated/sec"/>
        <metric name="Log Writes/sec"/>
        <metric name="Log Record Stalls/sec" indicator="true"/>
        <metric name="Database Cache Requests/sec"/>
        <metric name="Database Page Faults/sec"/>
        <metric name="Database Page Evictions/sec"/>
        <metric name="Database Page Fault Stalls/sec" indicator="true"/>
        <metric name="I/O Database Reads (Attached)/sec"/>
        <metric name="I/O Database Reads (Attached) Average Latency"/>
        <metric name="I/O Database Reads (Recovery)/sec"/>
        <metric name="I/O Database Reads (Recovery) Average Latency"/>
        <metric name="I/O Database Reads/sec"/>
        <metric name="I/O Database Reads Average Latency" indicator="true"/>
        <metric name="I/O Log Reads/sec"/>
        <metric name="I/O Log Reads Average Latency"/>
        <metric name="I/O Database Writes (Attached)/sec"/>
        <metric name="I/O Database Writes (Attached) Average Latency"/>
        <metric name="I/O Database Writes (Recovery)/sec"/>
        <metric name="I/O Database Writes (Recovery) Average Latency"/>
        <metric name="I/O Database Writes/sec"/>
        <metric name="I/O Database Writes Average Latency" indicator="true"/>
        <metric name="I/O Log Writes/sec"/>
        <metric name="I/O Log Writes Average Latency"/>
        <metric name="Database Cache Misses/sec"/>
        <metric name="Database Cache % Hit" indicator="true"/>
        <metric name="Database Cache % Hit (Uncorrelated)"/>
        <metric name="Table Open Cache % Hit"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange Database(%instance_name%):${name}"/>
    <metrics name="MSExchange_Database" include="MSExchange_Database_c">
        <metric name="Availability" alias="Availability" category="AVAILABILITY" indicator="true" units="percentage" collectionType="dynamic"/>
        <metric name="Defragmentation Tasks"/>
        <metric name="Defragmentation Tasks Pending"/>
        <metric name="Sessions In Use"/>
        <metric name="Sessions % Used"/>
        <metric name="Tables Open"/>
        <metric name="Log Threads Waiting" indicator="true"/>
        <metric name="Version Buckets Allocated"/>
        <metric name="Database Cache Size (MB)"/>
        <metric name="Database Cache Size"/>
        <metric name="Database Cache Size Effective (MB)"/>
        <metric name="Database Cache Size Effective"/>
        <metric name="Database Cache Memory Committed (MB)"/>
        <metric name="Database Cache Memory Committed"/>
        <metric name="Database Cache Memory Reserved (MB)"/>
        <metric name="Database Cache Memory Reserved"/>
        <metric name="Database Cache Size Resident"/>
        <metric name="Database Cache Size Resident (MB)"/>
        <metric name="Database Cache % Dehydrated"/>
        <metric name="Database Maintenance Duration"/>
        <metric name="Database Maintenance Pages Bad Checksums"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchange Database ==> Instances(%instance_name%):${name}"/>
    <metrics name="MSExchange_Database_Instances_c">
        <metric name="Table Open Cache Hits/sec"/>
        <metric name="Table Open Cache Misses/sec"/>
        <metric name="Table Opens/sec"/>
        <metric name="Table Closes/sec"/>
        <metric name="Log Bytes Write/sec"/>
        <metric name="Log Bytes Generated/sec"/>
        <metric name="Log Writes/sec"/>
        <metric name="Log Record Stalls/sec" indicator="true"/>
        <metric name="Database Cache Misses/sec"/>
        <metric name="Database Cache Requests/sec"/>
        <metric name="Streaming Backup Pages Read/sec"/>
        <metric name="I/O Database Reads (Attached)/sec"/>
        <metric name="I/O Database Reads (Attached) Average Latency"/>
        <metric name="I/O Database Reads (Recovery)/sec"/>
        <metric name="I/O Database Reads (Recovery) Average Latency"/>
        <metric name="I/O Database Reads/sec"/>
        <metric name="I/O Database Reads Average Latency" indicator="true"/>
        <metric name="I/O Log Reads/sec"/>
        <metric name="I/O Log Reads Average Latency"/>
        <metric name="I/O Database Writes (Attached)/sec"/>
        <metric name="I/O Database Writes (Attached) Average Latency"/>
        <metric name="I/O Database Writes (Recovery)/sec"/>
        <metric name="I/O Database Writes (Recovery) Average Latency"/>
        <metric name="I/O Database Writes/sec"/>
        <metric name="I/O Database Writes Average Latency" indicator="true"/>
        <metric name="I/O Log Writes/sec"/>
        <metric name="I/O Log Writes Average Latency"/>
        <metric name="Database Cache % Hit"/>
        <metric name="Database Cache % Hit (Uncorrelated)"/>
        <metric name="Table Open Cache % Hit"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange Database ==> Instances(%instance_name%):${name}"/>
    <metrics name="MSExchange_Database_Instances" include="MSExchange_Database_Instances_c">
        <metric name="Availability" alias="Availability" category="AVAILABILITY" indicator="true" units="percentage" collectionType="dynamic"/>
        <metric name="Defragmentation Tasks"/>
        <metric name="Defragmentation Tasks Pending"/>
        <metric name="Sessions In Use"/>
        <metric name="Sessions % Used"/>
        <metric name="Tables Open"/>
        <metric name="Log Threads Waiting" indicator="true"/>
        <metric name="Log Generation Checkpoint Depth"/>
        <metric name="Log Generation Checkpoint Depth Target"/>
        <metric name="Log Checkpoint Depth as a % of Target"/>
        <metric name="Log Generation Checkpoint Depth Max"/>
        <metric name="Log Generation Loss Resiliency Depth"/>
        <metric name="Log Files Generated"/>
        <metric name="Log Files Generated Prematurely"/>
        <metric name="Log File Current Generation"/>
        <metric name="Version buckets allocated"/>
        <metric name="Database Cache Size (MB)"/>
        <metric name="Database Maintenance Duration"/>
        <metric name="Database Maintenance Pages Bad Checksums"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchange OWA:${name}"/>
    <metrics name="MSExchange_OWA_c">
        <metric name="Logons/sec"/>
        <metric name="Failed Requests/sec"/>
        <metric name="WSS Response Bytes/sec"/>
        <metric name="UNC Response Bytes/sec"/>
        <metric name="IM - Messages Sent/sec"/>
        <metric name="IM - Messages Received/sec"/>
        <metric name="IM - Presence Queries/sec"/>
        <metric name="IM - Message Delivery Failures/sec"/>
        <metric name="IM - Sign-In Failures/sec"/>
        <metric name="Sender Photos - LDAP calls/sec"/>
        <metric name="Mailbox Notifications/sec"/>
        <metric name="Logons/sec Light"/>
        <metric name="Logons/sec Premium"/>
        <metric name="Requests/sec" indicator="true"/>
        <metric name="Conversion Requests KB/sec"/>
        <metric name="Successful Conversion Requests KB/sec"/>
        <metric name="Conversion Responses KB/sec"/>
        <metric name="Proxy User Requests/sec"/>
    </metrics>

    <filter name="template" value="pdh:MSExchange OWA:${name}"/>
    <metrics name="MSExchange_OWA" include="MSExchange_OWA_c">
        <metric name="Availability" alias="Availability" category="AVAILABILITY" indicator="true" units="percentage" collectionType="dynamic"/>
        <metric name="Current Users"/>
        <metric name="Current Unique Users" indicator="true"/>
        <metric name="Total Users"/>
        <metric name="Total Unique Users"/>
        <metric name="Peak User Count"/>
        <metric name="Current Users Light"/>
        <metric name="Current Unique Users Light"/>
        <metric name="Total Users Light"/>
        <metric name="Total Unique Users Light"/>
        <metric name="Peak User Count Light"/>
        <metric name="Current Users Premium"/>
        <metric name="Current Unique Users Premium"/>
        <metric name="Total Users Premium"/>
        <metric name="Total Unique Users Premium"/>
        <metric name="Peak User Count Premium"/>
        <metric name="Average Response Time"/>
        <metric name="Sessions Ended by Logoff"/>
        <metric name="Sessions Ended by Time-out"/>
        <metric name="Calendar Views Loaded"/>
        <metric name="Calendar View Refreshed"/>
        <metric name="Items Created Since OWA Start"/>
        <metric name="Items Updated Since OWA Start"/>
        <metric name="Items Deleted Since OWA Start"/>
        <metric name="Attachments Uploaded Since OWA Start"/>
        <metric name="Mail Views Loaded"/>
        <metric name="Mail View Refreshes"/>
        <metric name="Messages Sent"/>
        <metric name="IRM-protected Messages Sent"/>
        <metric name="Average Search Time" indicator="true"/>
        <metric name="Searches"/>
        <metric name="Searches Timed Out"/>
        <metric name="Requests"/>
        <metric name="Requests Failed"/>
        <metric name="PID"/>
        <metric name="Average Check Spelling Time"/>
        <metric name="Spelling Checks"/>
        <metric name="Conversions"/>
        <metric name="Active Conversions"/>
        <metric name="Rejected Conversions"/>
        <metric name="Queued Conversion Requests"/>
        <metric name="Conversions Ended by Time-out"/>
        <metric name="Conversions Ended with Errors"/>
        <metric name="Average Conversion Time"/>
        <metric name="Average Conversion Queuing Time"/>
        <metric name="Invalid Canary Requests"/>
        <metric name="Names Checked"/>
        <metric name="Password Changes"/>
        <metric name="Current Proxy Users"/>
        <metric name="Proxy User Requests"/>
        <metric name="Proxy Response Time Average"/>
        <metric name="Proxy Request Bytes"/>
        <metric name="Proxy Response Bytes"/>
        <metric name="WSS Response Bytes"/>
        <metric name="UNC Response Bytes"/>
        <metric name="WSS Requests"/>
        <metric name="UNC Requests"/>
        <metric name="AS Queries"/>
        <metric name="AS Queries Failure %"/>
        <metric name="Store Logon Failure %"/>
        <metric name="CAS Intra-Site Redirection Later to Earlier Version"/>
        <metric name="CAS Intra-Site Redirection Earlier to Later Version"/>
        <metric name="CAS Cross-Site Redirection Later to Earlier Version"/>
        <metric name="CAS Cross-Site Redirection Earlier to Later Version"/>
        <metric name="Active Mailbox Subscriptions"/>
        <metric name="Total Mailbox Notifications"/>
        <metric name="Total Usercontext ReInitialization requests"/>
        <metric name="Mailbox Offline Exception Failure %"/>
        <metric name="Connection Failed Transient Exception %"/>
        <metric name="Storage Transient Exception Failure %"/>
        <metric name="Storage Permanent Exception Failure %"/>
        <metric name="IM - Total Messages Sent"/>
        <metric name="IM - Total Messages Received"/>
        <metric name="IM - Total Presence Queries"/>
        <metric name="IM - Total Message Delivery Failures"/>
        <metric name="IM - Sign-In Failures"/>
        <metric name="IM - Users Currently Signed In"/>
        <metric name="IM - Total Users"/>
        <metric name="IM - Average Sign-In Time"/>
        <metric name="IM - Sign-In Failure %"/>
        <metric name="IM - Sent Message Delivery Failure %"/>
        <metric name="Failure rate of requests from OWA to EWS."/>
        <metric name="Request Time-Outs"/>
        <metric name="Sender Photos - Total LDAP calls"/>
        <metric name="Sender Photos - Total LDAP calls returned non-empty image data"/>
        <metric name="Sender Photos - Total entries in Recipients Negative Cache"/>
        <metric name="Sender Photos - Total number of avoided LDAP calls due to cache"/>
    </metrics>

    <filter name="template" value="pdh_c:g=MSExchangeIS Client Type(_total):${alias}"/>
    <metrics name="MSExchangeIS_Client_Type_c">
        <metric name="Client: Administrative RPC requests/sec" alias="Administrative RPC requests/sec"/>
        <metric name="Client: Directory Access: LDAP Searches/sec" alias="Directory Access: LDAP Searches/sec"/>
        <metric name="Client: RPC Bytes Received/sec" alias="RPC Bytes Received/sec"/>
        <metric name="Client: RPC Bytes Sent/sec" alias="RPC Bytes Sent/sec"/>
        <metric name="Client: RPC Packets/sec" alias="RPC Packets/sec"/>
        <metric name="Client: RPC Operations/sec" alias="RPC Operations/sec"/>
        <metric name="Client: RPC Average Latency" alias="RPC Average Latency" indicator="true"/>
        <metric name="Client: Lazy indexes created/sec" alias="Lazy indexes created/sec"/>
        <metric name="Client: Lazy indexes deleted/sec" alias="Lazy indexes deleted/sec"/>
        <metric name="Client: Lazy index full refresh/sec" alias="Lazy index full refresh/sec"/>
        <metric name="Client: Lazy index incremental refresh/sec" alias="Lazy index incremental refresh/sec"/>
        <metric name="Client: Messages opened/sec" alias="Messages opened/sec"/>
        <metric name="Client: Messages created/sec" alias="Messages created/sec"/>
        <metric name="Client: Messages updated/sec" alias="Messages updated/sec"/>
        <metric name="Client: Messages deleted/sec" alias="Messages deleted/sec"/>
        <metric name="Client: Property promotions/sec" alias="Property promotions/sec"/>
        <metric name="Client: Jet Pages Referenced/sec" alias="Jet Pages Referenced/sec"/>
        <metric name="Client: Jet Pages Read/sec" alias="Jet Pages Read/sec"/>
        <metric name="Client: Jet Pages Preread/sec" alias="Jet Pages Preread/sec"/>
        <metric name="Client: Jet Pages Modified/sec" alias="Jet Pages Modified/sec"/>
        <metric name="Client: Jet Pages Remodified/sec" alias="Jet Pages Remodified/sec"/>
        <metric name="Client: Jet Log Records/sec" alias="Jet Log Records/sec"/>
        <metric name="Client: Jet Log Record Bytes/sec" alias="Jet Log Record Bytes/sec"/>
    </metrics>

    <filter name="template" value="pdh:MSExchangeIS Client Type(_total):${alias}"/>
    <metrics name="MSExchangeIS_Client_Type" include="MSExchangeIS_Client_Type_c">
        <metric name="Client: Admin RPC Requests" alias="Admin RPC Requests"/>
        <metric name="Client: RPC Requests" alias="RPC Requests"/>
    </metrics>

    <metrics name="Exchange 2013 Active Directory Topology" include="Windows Service"/>
    <metrics name="Exchange 2013 Anti-spam Update" include="Windows Service,MSExchange_Hygiene,MSExchange_Hygiene_Classification,MSExchange_Hygiene_Updates_Engine_Microsoft,MSExchange_Hygiene_Antimalware_Microsoft"/>
    <metrics name="Exchange 2013 Mailbox Transport Delivery" include="Windows Service,MSExchange_Delivery_Store_Driver"/>
    <metrics name="Exchange 2013 Diagnostics" include="Windows Service,MSExchange_Diagnostics_Service,MSExchangeEdgeSync_Topology"/>
    <metrics name="Exchange 2013 EdgeSync" include="Windows Service,MSExchangeEdgeSync_Synchronizer,MSExchangeEdgeSync_Topology"/>
    <metrics name="Exchange 2013 Search" include="Windows Service,MSExchangeSearch_MailboxSession_Cache,MSExchangeSearch_Mailbox_Operators,MSExchangeSearch_IndexAgent"/>
    <metrics name="Exchange 2013 Frontend Transport" include="Windows Service,MSExchangeFrontendTransport_Proxy_Routing_Agent,MSExchangeFrontEndTransport_ProxyHubSelector,MSExchangeFrontEndTransport_Routing,MSExchangeFrontEndTransport_SmtpSend,MSExchangeFrontEndTransport_SmtpReceive"/>
    <metrics name="Exchange 2013 Health Manager" include="Windows Service"/>
    <metrics name="Exchange 2013 IMAP4" include="Windows Service,MSExchangeImap4_cas"/>
    <metrics name="Exchange 2013 IMAP4 Backend" include="Windows Service,MSExchangeImap4_mbx"/>
    <metrics name="Exchange 2013 Information Store" include="Windows Service,MSExchangeIS_Store,MSExchange_Store_Interface,MSExchangeIS_Client_Type"/>
    <metrics name="Exchange 2013 Mailbox Assistants" include="Windows Service"/>
    <metrics name="Exchange 2013 Mailbox Replication" include="Windows Service,MSExchange_Active_Manager_Server,MSExchange_Mailbox_Replication_Service,MSExchange_Mailbox_Replication_Service_Per_Mdb"/>
    <metrics name="Exchange 2013 Monitoring" include="Windows Service"/>
    <metrics name="Exchange 2013 POP3" include="Windows Service,Exchange_2013_POP3"/>
    <metrics name="Exchange 2013 POP3 Backend" include="Windows Service,Exchange_2013_POP3_Backend"/>
    <metrics name="Exchange 2013 Replication" include="Windows Service,MSExchange_Replication"/>
    <metrics name="Exchange 2013 RPC Client Access" include="Windows Service,MSExchange_RpcClientAccess,MSExchange_RpcClientAccess_Per_Server"/>
    <metrics name="Exchange 2013 Service Host" include="Windows Service"/>
    <metrics name="Exchange 2013 Mailbox Transport Submission" include="Windows Service"/>
    <metrics name="Exchange 2013 Throttling" include="Windows Service"/>
    <metrics name="Exchange 2013 Transport" include="Windows Service,MSExchangeTransport_SmtpSend,MSExchangeTransport_SMTPReceive,MSExchangeTransport_Queues,MSExchangeTransport_DSN_internal,MSExchangeTransport_DSN_external,MSExchangeTransport_Database"/>
    <metrics name="Exchange 2013 Transport Log Search" include="Windows Service"/>
    <metrics name="Exchange 2013 Unified Messaging" include="Windows Service,MSExchangeUMAvailability"/>
    <metrics name="Exchange 2013 Unified Messaging Call Router" include="Windows Service"/>
    <metrics name="Exchange 2013 ADAccess Domain Controller" include="MSExchange_ADAccess_Domain_Controllers"/>
    <metrics name="Exchange 2013 Database" include="MSExchange_Database"/>
    <metrics name="Exchange 2013 Database Instance" include="MSExchange_Database_Instances"/>
    <metrics name="Exchange 2013 OWA" include="MSExchange_OWA"/>
    <metrics name="Exchange 2013 Availability Service" include="MSExchange_Availability_Service"/>

    <metrics name="Exchange 2013">
        <metric name="Availability" alias="Availability" template="exchange:services=%services%:${alias}" category="AVAILABILITY" indicator="true" units="percentage" collectionType="dynamic"/>
    </metrics>
    
    <server name="Exchange" version="2013" platforms="Win32">
        <property name="REG_PATH" value="SOFTWARE\Microsoft\ExchangeServer\v15\Setup" />
        <property name="REG_NAME" value="MsiProductMajor" />
        <property name="REG_VALUE" value="15" />
        <property name="REG_NAME_INSTALL_PATH" value="MsiInstallPath" />
        
        <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
        <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
        <plugin type="measurement" class="org.hyperic.hq.plugin.exchange.v2.ServerMeasurement" />

        <config>
            <option name="services" description="Required services" optional="true"/>
            <option name="Roles" description="Installation Roles name" optional="true"/>
            <option name="DAG_name" description="Data Availability Group name" optional="true"/>
            <option name="active_directory.site" description="Active Directory site name" optional="true"/>
        </config>
        
        <service name="Active Directory Topology">
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="Anti-spam Update">
            <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="Mailbox Transport Delivery">
            <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="Diagnostics">
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="EdgeSync">
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="Search">
            <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="Frontend Transport">
            <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="Health Manager">
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="IMAP4">
            <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="IMAP4 Backend">
            <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="Information Store">
            <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="Mailbox Assistants">
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="Mailbox Replication">
            <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="Monitoring">
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="POP3">
            <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="POP3 Backend">
            <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>

        <service name="Replication">
            <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="RPC Client Access">
            <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="Service Host">
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>

        <service name="Mailbox Transport Submission">
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="Throttling">
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>

        <service name="Transport">
            <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="Transport Log Search">
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="Unified Messaging">
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="Unified Messaging Call Router">
            <config>
                <option name="service_name" description="Service Name" />
            </config>
        </service>
        
        <service name="ADAccess Domain Controller">
            <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
            <config>
                <option name="instance_name" description="Domain Controller Name" />
            </config>
        </service>
        
        <service name="Database">
            <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
            <config>
                <option name="instance_name" description="Database Name" />
            </config>
        </service>
        
        <service name="Database Instance">
            <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
            <config>
                <option name="instance_name" description="Database Instance Name" />
            </config>
        </service>

        <service name="OWA">
            <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
        </service>

        <service name="Availability Service">
            <plugin type="autoinventory" class="org.hyperic.hq.plugin.exchange.v2.Detector" />
            <plugin type="collector" class="org.hyperic.hq.plugin.exchange.v2.ServerCollector" />
        </service>
        
    </server>
</plugin>
