<?xml version="1.0"?>

<!--
  NOTE: This copyright does *not* cover user programs that use HQ
  program services by normal system calls through the application
  program interfaces provided as part of the Hyperic Plug-in Development
  Kit or the Hyperic Client Development Kit - this is merely considered
  normal use of the program, and does *not* fall under the heading of
  "derived work".
  
  Copyright (C) [2004-2009], Hyperic, Inc.
  This file is part of HQ.
  
  HQ is free software; you can redistribute it and/or modify
  it under the terms version 2 of the GNU General Public License as
  published by the Free Software Foundation. This program is distributed
  in the hope that it will be useful, but WITHOUT ANY WARRANTY; without
  even the implied warranty of MERCHANTABILITY or FITNESS FOR A
  PARTICULAR PURPOSE. See the GNU General Public License for more
  details.
  
  You should have received a copy of the GNU General Public License
  along with this program; if not, write to the Free Software
  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307
  USA.
 -->

<!DOCTYPE plugin [
  <!ENTITY process-metrics SYSTEM "/pdk/plugins/process-metrics.xml">
]>

<plugin package="org.hyperic.hq.plugin.mysql_stats">
    <property name="PLUGIN_VERSION" value="@project.version@"/>
    <classpath>
      <include name="pdk/lib/jdbc/mysql-connector-java*5.1.10.jar"/>
    </classpath>
    <property name="PLUGIN_VERSION" value="@project.version@"/>
    <property name="template-config"
              value="jdbcUrl=%jdbcUrl%,jdbcUser=%jdbcUser%,jdbcPassword=%jdbcPassword%"/>
    <property name="domain"
              value="mysqlstats"/>
    <property name="properties"
              value="key=Variable_name,value=Value"/>
    <property name="showGlobal"
              value="query=show /*!50002 global */ status"/>
    <property name="showSlave"
              value="query=show slave status"/>
    <property name="showDatabases"
              value="query=show databases"/>

    <config name="mysql_stats_table_config">
        <option name="table"
                description="Table Name"/>
        <option name="database"
                description="Database Name"/>
    </config>

    <config name="mysql_stats_config">
        <option name="jdbcUrl"
                default="jdbc:mysql://localhost:3306"
                description="JDBC URL"/>
        <option name="jdbcUser"
                description="JDBC User"
                default="root"/>
        <option name="jdbcPassword"
                description="JDBC Password"
                type="secret"
                default="mysql"/>
        <option name="process.query"
                description="Process query"
                default="State.Name.eq=mysqld"/>
        <option name="tableRegex"
                optional="true"
                description="Regex of tables to monitor (blank for none)"/>
        <option name="listen.ports" description="Listening Ports" optional="true"/>
                
    </config>

    <config name="repl_slave_config">
      <option name="slaveAddress"
              description="slave address info ip:port"/>
    </config>

  <!--
    Metric groups.
    These need to be outside of any <server> or <service> elements, as the only
    allowed usage of the <metrics> tags within those elements is to include groups
    defined elsewhere (at the plugin top level)...
    
    It's also OK to just define individual metrics within a server or service
    (e.g. not within a <metrics>...</metrics> block) but of course then they
    wouldn't be reusable in more complicated use cases.
  -->

    <metrics name="master-slave-metrics">
        <metric name="Availability"
                template="${domain}:Type=SlaveStatus,slaveAddress=%slaveAddress%:${alias}"
                indicator="true"/>
        <metric name="Replication Process Time"
                template="${domain}:Type=SlaveStatus,slaveAddress=%slaveAddress%:${alias}"
                indicator="true"/>
    </metrics>

  <!-- Global Status metrics -->

  <!--
    We name these groups to identify the minimum MySQL version which supports
    the metrics in the group; later, when we define servers, we include the
    appropriate group for the version of the server.
  -->

  <!-- Filter for Global Status Metrics -->
    <filter name="template"
            value="${domain}:${showGlobal},${properties}:${alias}"/>
    <metrics name="global-4.0">
    <!--
      Must ALWAYS capture an Availability metric, or none of the other metrics for
      this service will be collected. :(
    -->
        <metric name="Availability"
            alias="Availability"
            category="AVAILABILITY"
            indicator="true"
            units="percentage"
            collectionType="dynamic" />

    <!--
      Metrics available in version 4.0

      A few metrics either don't exist at global level, or aren't useful
      and are omitted:
        Slave_running:
          Available in 3.23.16+, values are OFF or ON and Hyperic requires
          numeric metrics only.  Not useful as a monitored/graphed metric
          in the Global Status service, but can be used (by external automation
          scripting, or by a more advanced MySQL server/service detector)
          to see if a Replication service resource would be useful for the
          parent server.  Also see the same named metric exposed by the
          Replication service, computed by the data collector.

      Most of the exposed metrics are counters having a collectionType of
      'trendsup', and will also have a rate metric added (by Hyperic)
      as well reflecting values/minute; for more info see
      http://support.hyperic.com/confluence/display/DOC/Measurement+Plugin

      For a metric to have its indicator graph available for display in the
      'Indicators' tab when viewing a monitored resource, set the
      'indicator' attribute to "true".

      For an indicator metric to have its graph displayed by default, set
      'defaultOn' true also (default value for this attribute).

      I've made all metrics 'indicator' by default, with the majority having
      'defaultOn' to false.
    -->

        <metric name="Aborted Clients"
            alias="Aborted_clients"
            category="THROUGHPUT"
            group="Connection"
            indicator="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Aborted Connects"
            alias="Aborted_connects"
            category="THROUGHPUT"
            group="Connection"
            indicator="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Bytes Received"
            alias="Bytes_received"
            category="THROUGHPUT"
            group="Connection"
            indicator="false"
            units="B"
            collectionType="trendsup"/>

        <metric name="Bytes Sent"
            alias="Bytes_sent"
            category="THROUGHPUT"
            group="Connection"
            indicator="false"
            units="B"
            collectionType="trendsup"/>

        <metric name="Connections"
            alias="Connections"
            category="THROUGHPUT"
            group="Connection"
            indicator="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Temporary Disk Tables Created"
            alias="Created_tmp_disk_tables"
            category="UTILIZATION"
            group="Query/Runtime"
            indicator="true"
            units="none"
            collectionType="trendsup"/>

        <metric name="Temporary Memory Tables Created"
            alias="Created_tmp_tables"
            category="UTILIZATION"
            group="Query/Runtime"
            indicator="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Temporary Files Created"
            alias="Created_tmp_files"
            category="UTILIZATION"
            group="Query/Runtime"
            indicator="true"
            units="none"
            collectionType="trendsup"/>

        <metric name="Delayed Insert Threads"
            alias="Delayed_insert_threads"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Delayed Writes"
            alias="Delayed_writes"
            category="UTILIZATION"
            group="I/O"
            indicator="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Delayed Errors"
            alias="Delayed_errors"
            category="UTILIZATION"
            group="I/O"
            indicator="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of admin commands"
            alias="Com_admin_commands"
            category="UTILIZATION"
            group="DBA Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of ALTER TABLE commands"
            alias="Com_alter_table"
            category="UTILIZATION"
            group="DDL Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of ANALYZE commands"
            alias="Com_analyze"
            category="UTILIZATION"
            group="DBA Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of BEGIN commands"
            alias="Com_begin"
            category="UTILIZATION"
            group="Tx Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of CHANGE DATABASE commands"
            alias="Com_change_db"
            category="UTILIZATION"
            group="DBA Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of CHANGE MASTER commands"
            alias="Com_change_master"
            category="UTILIZATION"
            group="DBA Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of CHECK commands"
            alias="Com_check"
            category="UTILIZATION"
            group="DBA Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of COMMIT commands"
            alias="Com_commit"
            category="UTILIZATION"
            group="Tx Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of CREATE DATABASE commands"
            alias="Com_create_db"
            category="UTILIZATION"
            group="DBA Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of CREATE FUNCTION commands"
            alias="Com_create_function"
            category="UTILIZATION"
            group="DDL Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of CREATE INDEX commands"
            alias="Com_create_index"
            category="UTILIZATION"
            group="DDL Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of CREATE TABLE commands"
            alias="Com_create_table"
            category="UTILIZATION"
            group="DDL Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of DELETE commands"
            alias="Com_delete"
            category="UTILIZATION"
            group="DML Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of DROP DATABASE commands"
            alias="Com_drop_db"
            category="UTILIZATION"
            group="DBA Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of DROP FUNCTION commands"
            alias="Com_drop_function"
            category="UTILIZATION"
            group="DDL Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of DROP INDEX commands"
            alias="Com_drop_index"
            category="UTILIZATION"
            group="DDL Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of DROP TABLE commands"
            alias="Com_drop_table"
            category="UTILIZATION"
            group="DDL Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of FLUSH commands"
            alias="Com_flush"
            category="UTILIZATION"
            group="DBA Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of GRANT commands"
            alias="Com_grant"
            category="UTILIZATION"
            group="DBA Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of INSERT commands"
            alias="Com_insert"
            category="UTILIZATION"
            group="DML Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of INSERT SELECT commands"
            alias="Com_insert_select"
            category="UTILIZATION"
            group="DML Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of KILL commands"
            alias="Com_kill"
            category="UTILIZATION"
            group="DBA Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of LOAD commands"
            alias="Com_load"
            category="UTILIZATION"
            group="DML Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of LOCK TABLES commands"
            alias="Com_lock_tables"
            category="UTILIZATION"
            group="Tx Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of OPTIMIZE commands"
            alias="Com_optimize"
            category="UTILIZATION"
            group="DBA Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of PURGE commands"
            alias="Com_purge"
            category="UTILIZATION"
            group="DML Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of RENAME TABLE commands"
            alias="Com_rename_table"
            category="UTILIZATION"
            group="DDL Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of REPAIR commands"
            alias="Com_repair"
            category="UTILIZATION"
            group="DBA Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of REPLACE commands"
            alias="Com_replace"
            category="UTILIZATION"
            group="DML Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of REPLACE SELECT commands"
            alias="Com_replace_select"
            category="UTILIZATION"
            group="DML Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of RESET commands"
            alias="Com_reset"
            category="UTILIZATION"
            group="DBA Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of REVOKE commands"
            alias="Com_revoke"
            category="UTILIZATION"
            group="DBA Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of ROLLBACK commands"
            alias="Com_rollback"
            category="UTILIZATION"
            group="Tx Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of SELECT commands"
            alias="Com_select"
            category="UTILIZATION"
            group="General Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of SET OPTION commands"
            alias="Com_set_option"
            category="UTILIZATION"
            group="General Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of SHOW BINLOGS commands"
            alias="Com_show_binlogs"
            category="UTILIZATION"
            group="Show Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of SHOW DATABASES commands"
            alias="Com_show_databases"
            category="UTILIZATION"
            group="Show Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of SHOW FIELDS commands"
            alias="Com_show_fields"
            category="UTILIZATION"
            group="Show Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of SHOW GRANTS commands"
            alias="Com_show_grants"
            category="UTILIZATION"
            group="Show Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of SHOW KEYS commands"
            alias="Com_show_keys"
            category="UTILIZATION"
            group="Show Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of SHOW MASTER STATUS commands"
            alias="Com_show_master_status"
            category="UTILIZATION"
            group="Show Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of SHOW OPEN TABLES commands"
            alias="Com_show_open_tables"
            category="UTILIZATION"
            group="Show Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of SHOW PROCESSLIST commands"
            alias="Com_show_processlist"
            category="UTILIZATION"
            group="Show Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of SHOW SLAVE STATUS commands"
            alias="Com_show_slave_status"
            category="UTILIZATION"
            group="Show Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of SHOW STATUS commands"
            alias="Com_show_status"
            category="UTILIZATION"
            group="Show Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of SHOW TABLES commands"
            alias="Com_show_tables"
            category="UTILIZATION"
            group="Show Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of SHOW VARIABLES commands"
            alias="Com_show_variables"
            category="UTILIZATION"
            group="Show Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of START SLAVE commands"
            alias="Com_slave_start"
            category="UTILIZATION"
            group="General Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of STOP SLAVE commands"
            alias="Com_slave_stop"
            category="UTILIZATION"
            group="General Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of TRUNCATE commands"
            alias="Com_truncate"
            category="UTILIZATION"
            group="DML Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of UNLOCK TABLE commands"
            alias="Com_unlock_tables"
            category="UTILIZATION"
            group="Tx Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of UPDATE commands"
            alias="Com_update"
            category="UTILIZATION"
            group="DML Command"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 4.0.2+ -->
        <metric name="Number of internal commits (Handler_commit)"
            alias="Handler_commit"
            category="UTILIZATION"
            group="I/O"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of Rows Deleted (Handler_delete)"
            alias="Handler_delete"
            category="UTILIZATION"
            group="I/O"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of Rows Read from First Index (Handler_read_first)"
            alias="Handler_read_first"
            category="UTILIZATION"
            group="I/O"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of Rows Read from Key (Handler_read_key)"
            alias="Handler_read_key"
            category="UTILIZATION"
            group="I/O"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of Next Rows Read in Key Order (Handler_read_next)"
            alias="Handler_read_next"
            category="UTILIZATION"
            group="I/O"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of Prev Rows Read in Key Order (Handler_read_prev)"
            alias="Handler_read_prev"
            category="UTILIZATION"
            group="I/O"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of Rows Read from Fixed Position (Handler_read_rnd)"
            alias="Handler_read_rnd"
            category="UTILIZATION"
            group="I/O"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of Next Rows Read from Datafile (Handler_read_rnd_next)"
            alias="Handler_read_rnd_next"
            category="UTILIZATION"
            group="I/O"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of Rows Updated (Handler_update)"
            alias="Handler_update"
            category="UTILIZATION"
            group="I/O"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of Rows Inserted (Handler_write)"
            alias="Handler_write"
            category="UTILIZATION"
            group="I/O"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Key Blocks Used"
            alias="Key_blocks_used"
            category="UTILIZATION"
            group="I/O"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Key Read Requests"
            alias="Key_read_requests"
            category="UTILIZATION"
            group="I/O"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Key Reads"
            alias="Key_reads"
            category="UTILIZATION"
            group="I/O"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Key Write Requests"
            alias="Key_write_requests"
            category="UTILIZATION"
            group="I/O"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Key Writes"
            alias="Key_writes"
            category="UTILIZATION"
            group="I/O"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Max Used Connections"
            alias="Max_used_connections"
            category="THROUGHPUT"
            group="Connection"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Not Flushed Delayed Rows"
            alias="Not_flushed_delayed_rows"
            category="UTILIZATION"
            group="I/O"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Open Tables"
            alias="Open_tables"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="dynamic"/>

        <metric name="Open Files"
            alias="Open_files"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="dynamic"/>

        <metric name="Open Streams"
            alias="Open_streams"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="dynamic"/>

        <metric name="Opened Tables"
            alias="Opened_tables"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Query cache free blocks"
            alias="Qcache_free_blocks"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="dynamic"/>

        <metric name="Query cache free memory"
            alias="Qcache_free_memory"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="B"
            collectionType="dynamic"/>

        <metric name="Number of query cache hits"
            alias="Qcache_hits"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of query cache inserts"
            alias="Qcache_inserts"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of query cache low memory prunes"
            alias="Qcache_lowmem_prunes"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of queries not cached"
            alias="Qcache_not_cached"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of queries in cache"
            alias="Qcache_queries_in_cache"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="dynamic"/>

        <metric name="Number of blocks in query cache"
            alias="Qcache_total_blocks"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="dynamic"/>

        <metric name="Questions"
            alias="Questions"
            category="THROUGHPUT"
            group="Connection"
            indicator="false"
            units="none"
            collectionType="trendsup" />

        <metric name="Select Full Join"
            alias="Select_full_join"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Select Full Range Join"
            alias="Select_full_range_join"
            category="UTILIZATION"
            group="Query/Runtime"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Select Range"
            alias="Select_range"
            category="UTILIZATION"
            group="Query/Runtime"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Select Range Check"
            alias="Select_range_check"
            category="UTILIZATION"
            group="Query/Runtime"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Select Scan"
            alias="Select_scan"
            category="UTILIZATION"
            group="Query/Runtime"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Slave Open Temp Tables"
            alias="Slave_open_temp_tables"
            category="UTILIZATION"
            group="Query/Runtime"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="dynamic"/>

        <metric name="Slow Launch Threads"
            alias="Slow_launch_threads"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Slow Queries"
            alias="Slow_queries"
            category="UTILIZATION"
            group="Query/Runtime"
            indicator="true"
            units="none"
            collectionType="trendsup"/>

        <metric name="Sort Merge Passes"
            alias="Sort_merge_passes"
            category="UTILIZATION"
            group="Query/Runtime"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of sorts done with ranges"
            alias="Sort_range"
            category="UTILIZATION"
            group="Query/Runtime"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of sorted rows"
            alias="Sort_rows"
            category="UTILIZATION"
            group="Query/Runtime"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Number of sorts done with table scan"
            alias="Sort_scan"
            category="UTILIZATION"
            group="Query/Runtime"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Table Locks Immediate"
            alias="Table_locks_immediate"
            category="UTILIZATION"
            group="Query/Runtime"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Table Locks Waited"
            alias="Table_locks_waited"
            category="UTILIZATION"
            group="Query/Runtime"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

        <metric name="Threads Cached"
            alias="Threads_cached"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="dynamic"/>

        <metric name="Threads Created"
            alias="Threads_created"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="dynamic"/>

        <metric name="Threads Connected"
            alias="Threads_connected"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            units="none"
            collectionType="dynamic"/>

        <metric name="Threads Running"
            alias="Threads_running"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="dynamic"/>

    <!--
      3/3/08 - Had to change category from AVAILABILITY to PERFORMANCE,
      started getting complaints from HQ server about invalid alias
      (must be 'Availability', apparently there can only be one such
      metric in category AVAILABILITY...)
      Why did complaints just start after I added another
      metric after this one?

      Made 'trendsup' since this will always increase, but
      disabled the automagically added rate metric.
    -->
        <metric name="Up Time"
            alias="Uptime"
            category="PERFORMANCE"
            group="Reliability"
            indicator="false"
            defaultOn="false"
            units="sec"
            collectionType="trendsup"
            rate="none"/>

    <!--
      Some additional 'metrics' from system variables
      These will necessarily be 'static' collectionType.
      Values are emitted by collector script and queried
      along with global status; including because they're
      useful in setting alerts involving comparisons of
      dynamic variables against their limits, e.g.
      Threads_connected compared to Max_connections
      *Note* Turns out we can't set an alert comparing one metric
      to a different one...
    -->
        <!--metric name="Max Connections"
            alias="Max_connections"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="true"
            defaultOn="false"
            units="none"
            collectionType="static"/-->

    <!--
      A computed 'rollup' metric expressing current number of connections
      as a percentage of Max_connections, as this is the simplest way to
      be able to alert on a high connection threshold.
    -->
        <!--metric name="Connection Usage"
            alias="Connection_usage"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            units="percentage"
            collectionType="dynamic"/-->
    </metrics>

  <!--
    TODO:  Add additional metrics specific to later versions
  -->

    <metrics name="global-4.1" include="global-4.0">
    <!-- 4.1.2+ -->
        <metric name="Binlog Cache Disk Use"
            alias="Binlog_cache_disk_use"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 4.1.2+ -->
        <metric name="Binlog Cache Use"
            alias="Binlog_cache_use"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!--
      TODO:  MySQL docs are contradictory; the next several metrics shown as being
      available in 4.1.13+ are documented in the 4.1 manual, but the 5.0 manual
      lists them as being available starting with 5.0.8...
    -->
    <!-- 4.1.13+ -->
        <metric name="Number of PREPARE Statements and mysql_stmt_prepare() calls"
            alias="Com_stmt_prepare"
            category="UTILIZATION"
            group="Prepared Statement Commands"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 4.1.13+ -->
        <metric name="Number of EXECUTE Statements and mysql_stmt_execute() calls"
            alias="Com_stmt_execute"
            category="UTILIZATION"
            group="Prepared Statement Commands"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 4.1.13+ -->
        <metric name="Number of mysql_stmt_send_long_data() calls"
            alias="Com_stmt_send_long_data"
            category="UTILIZATION"
            group="Prepared Statement Commands"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 4.1.13+ -->
        <metric name="Number of mysql_stmt_reset() calls"
            alias="Com_stmt_reset"
            category="UTILIZATION"
            group="Prepared Statement Commands"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 4.1.13+ -->
        <metric name="Number of DEALLOCATE PREPARE Statements and mysql_stmt_close() calls"
            alias="Com_stmt_close"
            category="UTILIZATION"
            group="Prepared Statement Commands"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 4.1.3+ -->
        <metric name="Number of PREPARE statements"
            alias="Com_prepare_sql"
            category="UTILIZATION"
            group="Prepared Statement Commands"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 4.1.3+ -->
        <metric name="Number of EXECUTE statements"
            alias="Com_execute_sql"
            category="UTILIZATION"
            group="Prepared Statement Commands"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 4.1.3+ -->
        <metric name="Number of DEALLOCATE PREPARE statements"
            alias="Com_dealloc_sql"
            category="UTILIZATION"
            group="Prepared Statement Commands"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 4.1.1+  TODO: docs say this replaced 'Not_flushed_key_blocks' -->
        <metric name="Key Blocks Not Flushed"
            alias="Key_blocks_not_flushed"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="dynamic"/>

    <!-- 4.1.2+ -->
        <metric name="Key Blocks Unused"
            alias="Key_blocks_unused"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="dynamic"/>

    <!-- 4.1.23+  TODO:  5.0 docs claim added in 5.0.32 -->
        <metric name="Prepared Statement Count"
            alias="Prepared_stmt_count"
            category="UTILIZATION"
            group="Prepared Statement Commands"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="dynamic"/>

    <!-- 4.1.11+  TODO:  5.0 docs claim added in 5.0.4 -->
        <metric name="Slave Retried Transactions"
            alias="Slave_retried_transactions"
            category="UTILIZATION"
            group="Replication"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>
    </metrics>

    <metrics name="global-5.0" include="global-4.1">
    <!--
      Metrics added starting with 5.0

      A few metrics either don't exist at global level, or aren't useful
      and are omitted:
        Compression
        Last_query_cost
    -->

    <!-- 5.0.3+ -->
        <metric name="Prepare statements in two-phase commits"
            alias="Handler_prepare"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.3+ -->
        <metric name="Storage engine savepoints"
            alias="Handler_savepoint"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.3+ -->
        <metric name="Storage engine savepoint rollbacks"
            alias="Handler_savepoint_rollback"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!--
      InnoDB-specific metrics; according to MySQL docs, these were all
      added in 5.0 though InnoDB was available in earlier versions
    -->

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB buffer pool pages containing data"
            alias="Innodb_buffer_pool_pages_data"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="dynamic"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB buffer pool pages marked dirty"
            alias="Innodb_buffer_pool_pages_dirty"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="dynamic"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB buffer pool page flush requests"
            alias="Innodb_buffer_pool_pages_flushed"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of free InnoDB buffer pool pages"
            alias="Innodb_buffer_pool_pages_free"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="dynamic"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB buffer pool pages busy"
            alias="Innodb_buffer_pool_pages_misc"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="dynamic"/>

    <!-- 5.0.2+ -->
        <metric name="Total number of InnoDB buffer pool pages"
            alias="Innodb_buffer_pool_pages_total"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="static"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB random read-aheads"
            alias="Innodb_buffer_pool_read_ahead_rnd"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB buffer pool read requests"
            alias="Innodb_buffer_pool_read_requests"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB buffer pool reads"
            alias="Innodb_buffer_pool_reads"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB buffer pool waits for free pages"
            alias="Innodb_buffer_pool_wait_free"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB buffer pool write requests"
            alias="Innodb_buffer_pool_write_requests"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB data fsyncs"
            alias="Innodb_data_fsyncs"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB data pending fsyncs"
            alias="Innodb_data_pending_fsyncs"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB data pending reads"
            alias="Innodb_data_pending_reads"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB data pending writes"
            alias="Innodb_data_pending_writes"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Total InnoDB data bytes read"
            alias="Innodb_data_read"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="B"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB data reads"
            alias="Innodb_data_reads"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB data writes"
            alias="Innodb_data_writes"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Total InnoDB data bytes written"
            alias="Innodb_data_written"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="B"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB doublewrite operations"
            alias="Innodb_dblwr_writes"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB doublewrite pages written"
            alias="Innodb_dblwr_pages_written"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB log buffer waits"
            alias="Innodb_log_waits"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB log file write requests"
            alias="Innodb_log_write_requests"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB log file writes"
            alias="Innodb_log_writes"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB log file fsyncs"
            alias="Innodb_os_log_fsyncs"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB pending log file fsyncs"
            alias="Innodb_os_log_pending_fsyncs"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB pending log file writes"
            alias="Innodb_os_log_pending_writes"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Total InnoDB log file bytes written"
            alias="Innodb_os_log_written"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="B"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="InnoDB page size (bytes)"
            alias="Innodb_page_size"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="B"
            collectionType="static"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB pages created"
            alias="Innodb_pages_created"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB pages read"
            alias="Innodb_pages_read"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB pages written"
            alias="Innodb_pages_written"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.3+ -->
        <metric name="Number of InnoDB row lock current waits"
            alias="Innodb_row_lock_current_waits"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="dynamic"/>

    <!-- 5.0.3+ -->
        <metric name="Total InnoDB row lock time"
            alias="Innodb_row_lock_time"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="ms"
            collectionType="trendsup"/>

    <!-- 5.0.3+ -->
        <metric name="Average InnoDB row lock time"
            alias="Innodb_row_lock_time_avg"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="ms"
            collectionType="dynamic"/>

    <!-- 5.0.3+ -->
        <metric name="Maximum InnoDB row lock time"
            alias="Innodb_row_lock_time_max"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="ms"
            collectionType="dynamic"/>

    <!-- 5.0.3+ -->
        <metric name="Number of InnoDB row lock waits"
            alias="Innodb_row_lock_waits"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB rows deleted"
            alias="Innodb_rows_deleted"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB rows inserted"
            alias="Innodb_rows_inserted"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB rows read"
            alias="Innodb_rows_read"
            category="UTILIZATION"
            group="Resource Utilization"
            indicator="false"
            defaultOn="false"
            units="none"
            collectionType="trendsup"/>

    <!-- 5.0.2+ -->
        <metric name="Number of InnoDB rows updated"
                alias="Innodb_rows_updated"
                category="UTILIZATION"
                group="Resource Utilization"
                indicator="false"
                defaultOn="false"
                units="none"
                collectionType="trendsup"/>
    </metrics>

    <metrics name="global-5.1" include="global-5.0">
    <!-- 5.1.3+ -->
        <metric name="Open table definitions"
                alias="Open_table_definitions"
                category="UTILIZATION"
                group="Resource Utilization"
                indicator="false"
                defaultOn="false"
                units="none"
                collectionType="dynamic"/>

    </metrics>

    <metrics name="global-5.5" include="global-5.1"/>
    
    <metrics name="global-5.6" include="global-5.5"/>

  <!--
    TODO:  Add metric groups for InnoDB-specific status metrics
    to be used in an 'InnoDB' service
  -->

  <!-- Filter for Replication Metrics -->
    <filter name="template"
            value="${domain}:${showSlave},key=Master_Host,value=${alias}:${alias}"/>
  <!-- Replication metrics -->
    <metrics name="MySQL Status 4.0.x Replication">
    <!--
      Replication is "available" if the slave is running
    -->
        <metric name="Availability"
                category="AVAILABILITY"
                indicator="true"
                interval="300000"/>

    <!--
      MySQL 4.0.x lacks a 'Bytes_Behind_Master' metric.
      Additionally, at least one directly accessible metric differs in
      case name from 4.1 or later, but for our purposes we're only
      interested in the derived metrics representing absolute lag behind
      master's log position...
    -->
        <metric name="Bytes Behind Master"
                alias="Bytes_Behind_Master"
                category="PERFORMANCE"
                indicator="true"
                units="B"/>
        <metric name="Log Files Behind Master"
                alias="Log_Files_Behind_Master"
                category="PERFORMANCE"
                indicator="true"/>
    </metrics>

    <metrics name="MySQL Status 4.1.x Replication">
    <!--
      Replication is "available" if the slave is running
    -->

        <metric name="Availability"
                category="AVAILABILITY"
                indicator="true"
                interval="300000"/>

    <!--
      Replication lag behind master, measured in seconds; available with MySQL 4.1 and
      later.  This isn't a terribly accurate metric, as it compares current system time
      (of slave) with the timestamp of the statement's execution of the master; a
      consequence of this is the lag time includes any time interval during which
      replication was down.
    -->
        <metric name="Seconds Behind Master"
                category="PERFORMANCE"
                indicator="true"
                units="sec"
                alias="Seconds_Behind_Master"/>

    <!-- Slave_IO_Running and Slave_SQL_Running are YES/NO values that map to 1/0 -->

        <metric name="Slave IO Running"
                category="PERFORMANCE"
                indicator="false"
                units="none"
                alias="Slave_IO_Running"/>

        <metric name="Slave SQL Running"
                category="PERFORMANCE"
                indicator="false"
                units="none"
                alias="Slave_SQL_Running"/>

    <!-- Derived metrics representing slave's lag behind master log position -->

        <metric name="Bytes Behind Master"
                category="PERFORMANCE"
                indicator="true"
                units="B"
                alias="Bytes_Behind_Master"/>
        <metric name="Log Files Behind Master"
                category="PERFORMANCE"
                indicator="true"
                alias="Log_Files_Behind_Master"/> 
    </metrics>

    <metrics name="MySQL Status 5.0.x Replication"
             include="MySQL Status 4.1.x Replication"/>

    <metrics name="MySQL Status 5.1.x Replication"
             include="MySQL Status 5.0.x Replication"/>

    <metrics name="MySQL Status 5.5.x Replication"
             include="MySQL Status 5.1.x Replication"/>
             
 	<metrics name="MySQL Status 5.6.x Replication"
             include="MySQL Status 5.5.x Replication"/>             

    <filter name="template"
            value="${domain}:Type=Table,database=%database%,table=%table%:${alias}"/>
    <metrics name="mysql-table">
        <metric name="Availability"
                alias="Availability"
                category="AVAILABILITY"
                indicator="true"
                units="percentage"
                collectionType="dynamic"/>
        <metric name="Number of Rows"
                alias="TABLE_ROWS"
                category="UTILIZATION"
                indicator="true"
                units="none"
                collectionType="dynamic"/>
        <metric name="Average Row Length"
                alias="AVG_ROW_LENGTH"
                category="UTILIZATION"
                units="B"
                collectionType="dynamic"/>
        <metric name="Data Length"
                alias="DATA_LENGTH"
                category="UTILIZATION"
                indicator="true"
                units="B"
                collectionType="dynamic"/>
        <metric name="Max Data Length"
                alias="MAX_DATA_LENGTH"
                category="UTILIZATION"
                units="B"
                collectionType="dynamic"/>
        <metric name="Index Length"
                alias="INDEX_LENGTH"
                category="UTILIZATION"
                indicator="true"
                units="B"
                collectionType="dynamic"/>
        <metric name="Data Free"
                alias="DATA_FREE"
                category="UTILIZATION"
                units="B"
                collectionType="dynamic"/>
<!-- TODO scottmf, need to add index level stats
        <metric name="Number of Indicies"
                alias="NumIndicies"
                category="UTILIZATION"
                group="Index Usage"
                units="none"
                collectionType="dynamic"/>
        <metric name="Average Index Cardinality"
                alias="AvgCardinality"
                category="UTILIZATION"
                group="Index Usage"
                units="none"
                collectionType="dynamic"/>
-->
    </metrics>

    <property name="DEFAULT_DRIVER"
              value="com.mysql.jdbc.Driver"/>
    <property name="DEFAULT_URL"
              value="jdbc:mysql://%hostname%:%port%/mysql" />

    <server name="MySQL Stats" version="base">
        <plugin type="autoinventory"
                class="MySqlServerDetector"/>
        <plugin type="measurement"
                class="MySqlStatsMeasurementPlugin"/>
		<plugin type="config_track" class="org.hyperic.hq.product.FileChangeTrackPlugin" />

		<plugin type="config_track" class="org.hyperic.hq.product.FileChangeTrackPlugin"
			platform="Unix">
			<monitored>
				<folder path="/etc" recursive="false" filter="my\.cnf"/>
				<folder path="/etc/mysql" recursive="false" filter="my\.cnf"/>
				<folder path="" recursive="false" filter="my\.cnf"/>
				<folder path="~/" recursive="false" filter="\.my\.cnf"/>
				<!-- datadir: for versions before 5.1 -->
				<!-- note - cases where datadir is not in the default location have not been addressed -->
				<folder path="/usr/local/mysql/data" recursive="false" filter="my\.cnf"/>
				<folder path="/usr/local/var" recursive="false" filter="my\.cnf"/>
			</monitored>
		</plugin>
	
		<plugin type="config_track" class="org.hyperic.hq.product.FileChangeTrackPlugin"
			platform="Win32">
			<monitored>
	            <!-- system variable WINDIR -->
				<folder path="%WINDIR%" recursive="false" filter="my\.ini|my\.cnf"/>
				<folder path="c:" recursive="false" filter="my\.ini|my\.cnf"/>
				<folder path="" recursive="false" filter="my\.ini|my\.cnf"/>
			</monitored>
		</plugin>
		<property name="DEFAULT_CONFIG_TRACK_ENABLE" value="false" />
		
        <plugin type="log_track"
                class="MySqlStatsLogTrackPlugin"/>
        <properties>
            <property name="version"
                      description="MySQL Version"/>
        </properties>
        <config include="mysql_stats_config"/>
        <metric name="Availability"
                template="sigar:Type=ProcState,Arg=%process.query%:State"
                indicator="true"/>
                
        <metric name="Process Virtual Memory Size"
        	template="sigar:Type=ProcMem,Arg=%process.query%:Size"
        	units="B"/>
        
		<metric name="Process Resident Memory Size"
		        template="sigar:Type=ProcMem,Arg=%process.query%:Resident"
		        indicator="true"
		        units="B"/>
		
		<metric name="Process Page Faults"
		        template="sigar:Type=ProcMem,Arg=%process.query%:PageFaults"
		        collectionType="trendsup"/>
		
		<metric name="Process Cpu System Time"
		        template="sigar:Type=ProcCpu,Arg=%process.query%:Sys"
		        units="ms"
		        collectionType="trendsup"/>
		
		<metric name="Process Cpu User Time"
		        template="sigar:Type=ProcCpu,Arg=%process.query%:User"
		        units="ms"
		        collectionType="trendsup"/>
		
		<metric name="Process Cpu Total Time"
		        template="sigar:Type=ProcCpu,Arg=%process.query%:Total"
		        units="ms"
		        collectionType="trendsup"/>
		
		<metric name="Process Cpu Usage"
		        template="sigar:Type=ProcCpu,Arg=%process.query%:Percent"
		        indicator="true"
		        units="percentage"/>
		
		<metric name="Process Start Time"
		        template="sigar:Type=ProcTime,Arg=%process.query%:StartTime"
		        category="AVAILABILITY"
		        units="epoch-millis"
		        collectionType="static"/>
		
		<metric name="Process Open File Descriptors"
		        template="sigar:Type=ProcFd,Arg=%process.query%:Total"/>
		
		<metric name="Process Threads"
		        template="sigar:Type=ProcState,Arg=%process.query%:Threads"/>
		
        <service name="Slave Status">
            <config include="repl_slave_config"/>
            <metrics include="master-slave-metrics"/>
        </service>
    </server>

    <server name="MySQL Stats" version="baseWithTable" include="base">
        <service name="Table">
            <plugin type="measurement"
                    class="MySqlStatsMeasurementPlugin"/>
            <plugin type="control"
                    class="MySqlStatsControlPlugin"/>
            <actions include="Analyze,Check,Optimize,Repair"/>
            <config include="mysql_stats_table_config"/>
            <metrics include="mysql-table"/>
        </service>
    </server>

    <server name="MySQL Stats" version="4.0.x" include="base">
        <metrics include="global-4.0"/>
        <service name="Show Slave Status">
            <metrics include="MySQL Status 4.0.x Replication"/>
        </service>
    </server>

    <server name="MySQL Stats" version="4.1.x" include="base">
        <metrics include="global-4.1"/>
        <service name="Show Slave Status">
            <metrics include="MySQL Status 4.1.x Replication"/>
        </service>
    </server>

    <server name="MySQL Stats" version="5.0.x" include="baseWithTable">
        <metrics include="global-5.0"/>
        <service name="Show Slave Status">
            <metrics include="MySQL Status 5.0.x Replication"/>
        </service>
    </server>

    <server name="MySQL Stats" version="5.1.x" include="baseWithTable">
        <metrics include="global-5.1"/>
        <service name="Show Slave Status">
            <metrics include="MySQL Status 5.1.x Replication"/>
        </service>
    </server>

    <server name="MySQL Stats" version="5.5.x" include="baseWithTable">
        <metrics include="global-5.5"/>
        <service name="Show Slave Status">
            <metrics include="MySQL Status 5.5.x Replication"/>
        </service>
    </server>
    
    <server name="MySQL Stats" version="5.6.x" include="baseWithTable">
        <metrics include="global-5.6"/>
        <service name="Show Slave Status">
            <metrics include="MySQL Status 5.6.x Replication"/>
        </service>
    </server>

    <help name="mysql">
  <![CDATA[
  <p>
  <h3>Configure MySQL ${product.version} for Monitoring</h3>
  </p>
  <p>
  The MySQL ${product.version} plugin monitors the MySQL server
  using standard status queries.  The only prerequisites for enabling
  monitoring are:
  </p>
  <ul>
    <li>The configured mysql must have the ability to connect to the MySQL server specified by the ${jdbcUrl}</li>
    <li>
        The user ${jdbcUser} is able to execute the following statements:
        'SHOW GLOBAL STATUS', 'SHOW SLAVE STATUS', 'SHOW DATABASES'
        (minimal privileges needed: SELECT, REPLICATION CLIENT)
        <ul>
        Examples: <br>
        mysql> create user 'hqagent'@'localhost' identified by 'hqagent'; <br>
        mysql> grant show databases on *.* to 'hqagent'@'localhost'; <br>
        mysql> grant select on *.* to 'hqagent'@'localhost'; <br>
        </ul>
    </li>
    <li>To enable full process monitoring of the MySQL daemon the agent user must either own the process or have permissions to view all process stats.</li>
  </ul>
  <p>Shared properties (values propagate to child services):</p>
  <ul>
    <li><strong>process.query</strong> - The SIGAR process query detecting the MySQL instance.
      Ordinarily you will not need to change this.</li>
    <li><strong>jdbcUrl</strong> - The MySQL JDBC Url to connect to the server:port and database.
      This takes the form of &quot;jdbc:mysql://hostname:port/database&quot;.  To connect
      to a running server with default settings on localhost use &quot;jdbc:mysql://localhost:3306&quot;
      (port 3306 is MySQL default, specified in my.cnf)
    <li><strong>jdbcUser</strong> - Username for MySQL login for status checks (see above)</li>
    <li><strong>jdbcPassword</strong> - Password for MySQL login</li>
  </ul>
  <p>Monitoring properties affect log tracking, described below.</p>
  <p>The Table Service is specified by a regular expression see the <a href='http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html'>java.util.Pattern</a> class for more info on java regular expressions.  To monitor multiple tables use the | (or) delimiter, to monitor all tables use the &quot;.*&quot; regex.  To ignore Table Services leave the field blank.
  <br><b>Please Note:  information_schema tables are ignored.</b>
  </p>
  <p>Check <strong>Auto-Discover Global Statuses and Replications?</strong> if you want these child services auto-discovered.
  ]]>
    </help>

    <help name="MySQL Stats 4.0.x" include="mysql"/>

    <help name="MySQL Stats 4.1.x" include="mysql"/>

    <help name="MySQL Stats 5.0.x" include="mysql"/>

    <help name="MySQL Stats 5.1.x" include="mysql"/>

    <help name="MySQL Stats 5.5.x" include="mysql"/>
    
    <help name="MySQL Stats 5.6.x" include="mysql"/>
</plugin>

