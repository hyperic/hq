<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Hyperic 4.6 Documentation : WebLogic Server</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Hyperic 4.6 Documentation : WebLogic Server
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jun 21, 2011 by <font color="#0050B2">mmcgarry</font>.
				    </div>

				    <style type='text/css'>/*<![CDATA[*/
div.rbtoc1308679890216 {margin-left: 1.5em;padding: 0px;}
div.rbtoc1308679890216 ul {list-style: disc;margin-left: 0px;padding-left: 20px;}
div.rbtoc1308679890216 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='rbtoc1308679890216'>
<ul>
    <li><a href='#WebLogicServer-Introduction'>Introduction</a></li>
    <li><a href='#WebLogicServer-ConfigurationOverview'>Configuration Overview</a></li>
    <li><a href='#WebLogicServer-ConfigureWebLogicServerMonitoring'>Configure WebLogic Server Monitoring</a></li>
<ul>
    <li><a href='#WebLogicServer-SpecifyAgentJRE'>Specify Agent JRE</a></li>
    <li><a href='#WebLogicServer-RunAgentwithRequiredPermissions'>Run Agent with Required Permissions</a></li>
    <li><a href='#WebLogicServer-ConfigureWLSLocation'>Configure WLS Location</a></li>
    <li><a href='#WebLogicServer-ConfigureSSL'>Configure SSL</a></li>
    <li><a href='#WebLogicServer-RestartAgent'>Restart Agent</a></li>
    <li><a href='#WebLogicServer-VerifyAutoDiscoveryofAdministrationServer'>Verify Auto-Discovery of Administration Server</a></li>
    <li><a href='#WebLogicServer-ConfigureMonitoring'>Configure Monitoring</a></li>
    <li><a href='#WebLogicServer-VerifyManagedServerAutoDiscovery'>Verify Managed Server Auto-Discovery</a></li>
    <li><a href='#WebLogicServer-CompleteMonitoringConfiguration'>Complete Monitoring Configuration</a></li>
</ul>
    <li><a href='#WebLogicServer-TroubleshootWebLogicServerAutoDiscoveryProblems'>Troubleshoot WebLogic Server Auto-Discovery Problems</a></li>
<ul>
    <li><a href='#WebLogicServer-SolveAdministrationServerAutoDiscoveryProblems'>Solve Administration Server Auto-Discovery Problems</a></li>
    <li><a href='#WebLogicServer-SolveManagedServerAutoDiscoveryProblems'>Solve Managed Server Auto-Discovery Problems</a></li>
</ul>
    <li><a href='#WebLogicServer-Metrics'>Metrics</a></li>
</ul></div> 

<h1><a name="WebLogicServer-Introduction"></a>Introduction </h1>

<p>This document has instructions for configuring the HQ Agent to monitor WebLogic Server (WLS), and information to help you understand and solve problems with the WLS auto-discovery process. </p>

<h1><a name="WebLogicServer-ConfigurationOverview"></a>Configuration Overview </h1>

<p>This section is an overview of how you configure HQ to monitor a WebLogic Server domain. See the following section for detailed instructions. </p>
<ol>
	<li>The HQ Agent auto-discovers the WLS Administration Server. For this to happen:
	<ul>
		<li>The HQ Agent and the WLS plugin must be installed on Administration Server host. (The WLS plugin is part of the standard agent installation; you do not need to install it separately.)</li>
		<li>For WLS 9.0 and later, the agent must run on a 1.5 JRE.</li>
		<li>The agent must have correct permissions to access the admin server configuration file.</li>
		<li>If the admin server requires SSL, the agent must be configured accordingly.</li>
	</ul>
	</li>
	<li>You add the auto-discovered admin server to HQ inventory. In terms of the Hyperic inventory model, the inventory type of the admin server is "server". For information about the inventory model, see <a href="Resources, Resource Types and Inventory Types.html" title="Resources, Resource Types and Inventory Types">Resources, Resource Types and Inventory Types</a></li>
	<li>In HQ, you edit configuration properties for the newly-added server with the admin server's username and password.</li>
	<li>The agent determines the Managed Servers in the WLS domain from the domain configuration file and adds them to inventory. In terms of the Hyperic inventory model, the inventory type of the Managed Server is "server".
	<ul>
		<li>The agent adds a Managed Server as a child of an existing platform in inventory, which corresponds to the machine that hosts the Managed Server.</li>
	</ul>
	</li>
	<li>After the Administration and Managed Servers are added to inventory, you tailor the monitoring settings, as desired.</li>
</ol>


<h1><a name="WebLogicServer-ConfigureWebLogicServerMonitoring"></a>Configure WebLogic Server Monitoring </h1>

<p>Perform the steps in the follow sections for each WebLogic Server domain you want to monitor. </p>
<ul>
	<li><a href="#WebLogicServer-SpecifyAgentJRE">Specify Agent JRE</a></li>
	<li><a href="#WebLogicServer-RunAgentwithRequiredPermissions">Run Agent with Required Permissions</a></li>
	<li><a href="#WebLogicServer-ConfigureWLSLocation">Configure WLS Location</a></li>
	<li><a href="#WebLogicServer-ConfigureSSLPropertiesifNecessary">Configure SSL Properties if Necessary</a></li>
	<li><a href="#WebLogicServer-RestartAgent">Restart Agent</a></li>
	<li><a href="#WebLogicServer-VerifyAutoDiscoveryofAdministrationServer">Verify Auto-Discovery of Administration Server</a></li>
	<li><a href="#WebLogicServer-ConfigureMonitoring">Configure Monitoring</a></li>
	<li><a href="#WebLogicServer-VerifyManagedServerAutoDiscovery">Verify Managed Server Auto-Discovery</a></li>
	<li><a href="#WebLogicServer-CompleteMonitoringConfiguration">Complete Monitoring Configuration</a></li>
</ul>


<h2><a name="WebLogicServer-SpecifyAgentJRE"></a>Specify Agent JRE </h2>

<p>The HQ Agent must run on a 1.5 JRE to monitor WebLogic Server 9.0 and higher. For earlier versions, a 1.4 JRE is supported. </p>

<p>Hyperic recommends you run the agent using the same JRE as WebLogic Server. </p>

<p>On Unix-based platforms define the location of the WebLogic Server JRE using the HQ_JAVA_HOME environment variable, for example: </p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre> 
HQ_JAVA_HOME=/usr/local/bea/jdk150_04 
</pre>
</div></div> 

<p>For HQ Agent v4.x on Windows platforms you must specify HQ_JAVA_HOME as a <b>system</b> variable. For more information, see <a href="Before You Start.html#BeforeYouStart-HQAgentJRE">HQ Agent JRE</a>. </p>

<h2><a name="WebLogicServer-RunAgentwithRequiredPermissions"></a>Run Agent with Required Permissions </h2>

<p>In order to discover the WLS Administration Server, the HQ Agent must run under an account with permissions that allow it to obtain the Administration Server's process arguments, and its current working directory. </p>

<p>On Unix-based platforms, to ensure that the HQ Agent has the permissions it needs, either: </p>
<ul>
	<li>Run the HQ Agent as the same user id that runs the Administration Server, or</li>
	<li>Run the HQ agent as root</li>
</ul>


<p>See also: <a href="http://jira.hyperic.com/browse/HHQ-511">HHQ-511</a> </p>








<p>After the agent has discovered the Administration Server, it no longer needs the permissions required for process process discovery. (The agent uses JMX to discover the WLS Managed Servers.)&nbsp; After discovery of the admin server, you can update the permissions to the HQ Agent directory. As superuser, run this command in the agent directory: </p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">chown user -R</pre>
		</div>
</div></div> 
<p>where <em>user</em> is the username under which you will henceforth run the agent, for example, <em>hqadmin</em>.. </p>

<p><b>Note:&nbsp;</b> If you cannot run the agent as the Administration Server user or as root, follow the directions in <a href="#WebLogicServer-AddAdministrationServerManually">Add Administration Server Manually</a> </p>





<h2><a name="WebLogicServer-ConfigureWLSLocation"></a>Configure WLS Location </h2>

<p>To ensure the HQ Agent can find the WebLogic Server installation, define the installation path in agent.properties. For example: </p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">weblogic.installpath=/usr/local/bea/weblogic92</pre>
		</div>
</div></div> 
<p><b>Note:</b> if you add the Administration Server to inventory manually, you specify the installation path from HQ user interface, rather than in the properties file. </p>

<h2><a name="WebLogicServer-ConfigureSSL"></a>Configure SSL </h2>

<p>If the Administration Server is configured to use one-way SSL, add the properties in <a href="#WebLogicServer-OneWaySSL">One-Way SSL</a> to <tt>agent.properties</tt>. </p>

<p>If the Administration Server is configured to use two-way SSL, add the properties in <a href="#WebLogicServer-OneWaySSL">One-Way SSL</a> and also the properties in <a href="#WebLogicServer-TwoWaySSL">Two-Way SSL</a> to <tt>agent.properties</tt>. </p>

<h3><a name="WebLogicServer-OneWaySSL"></a>One-Way SSL </h3>

<p>In one-way SSL the HQ Agent needs the public key of the Administration Serves's cert in order to trust it and to decrypt/encrypt communications. This public key is stored in the TrustKeyStore. </p>

<p>Configure these properties in agent.properties: </p>

<ul>
	<li><tt>weblogic.security.TrustKeyStore=</tt><tt><em>IdentityKeyStore.jks</em></tt>
	<ul>
		<li>where <tt><em>IdentityKeyStore.jks</em></tt> is the Administration Server's identity keystore.</li>
	</ul>
	</li>
</ul>


<ul>
	<li><tt>weblogic.security.CustomTrustKeyStoreFileName=${installpath.escaped}/</tt><tt><em>DemoTrust.jks</em></tt>
	<ul>
		<li>where <tt><em>DemoTrust.jks</em></tt> is the Administration Server's certs keystore.</li>
	</ul>
	</li>
</ul>


<ul>
	<li><tt>weblogic.security.SSL.ignoreHostnameVerification=true</tt></li>
</ul>



<h3><a name="WebLogicServer-TwoWaySSL"></a>Two-Way SSL </h3>

<div class='panelMacro'><table class='infoMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/information.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Agent Properties for Two-Way-SSL with WLS Admin Server</b><br />In Two-Way SSL, each side presents an SSL certificate to the other - the client must trust the server cert and the server must trust the client cert. The process is:

<ol>
	<li>HQ Agent initiates a connection with the Administration Server.</li>
	<li>The Administration server presents its certificate and asks the HQ Agent for its certificate.</li>
	<li>The HQ Agent presents its certificate (<em>client2certs.pem</em>), using the private key (<em>clientkey.pem</em> and <em>clientkey</em>) to encrypt the communication.</li>
</ol>


<p>To enable the HQ Agent to use Two-Way-SSL with a Weblogic Administration Server, you specify the client cert the HQ Agent presents to the Administration Server by adding these properties to <tt>agent.properties</tt>.</p>

<ul>
	<li>weblogic.auth.method=ssl2ways</li>
	<li>weblogic.ssl2ways.key=<em>ClientKey.pem</em> (client private key)</li>
	<li>weblogic.ssl2ways.key.pass=<em>ClientKey</em> ï»¿(passphrase for client private key)</li>
	<li>weblogic.ssl2ways.cert=<em>Client2Certs.pem</em> (client certificate)</li>
</ul>


<p>Weblogic docs: <a href="http://download.oracle.com/docs/cd/E11035_01/wls100/security/SSL_client.html#wp1033891">Using Two-Way SSL Authentication</a></p></td></tr></table></div> 

<h2><a name="WebLogicServer-RestartAgent"></a>Restart Agent </h2>

<p>Restart the agent.&nbsp; </p>

<p><b>Note:</b> If you have not modified agent.properties, this step is not necessary.&nbsp; </p>

<h2><a name="WebLogicServer-VerifyAutoDiscoveryofAdministrationServer"></a>Verify Auto-Discovery of Administration Server </h2>

<p>After completing the previous steps, the HQ Agent should auto-discover the Administration Server. The Administration Server must be running for the agent to discover it. </p>

<p>Check the Auto-Discovery portlet in the dashboard to verify that the Administration Server was discovered. The agent scans the platform upon startup, so the Administration Server should appear in the portlet within a few minutes. The name of the server will be: </p>

<p><em>PlatformIdentifier ServerType DomainName AdminServerName</em> </p>

<p>where: </p>
<ul>
	<li><em>PlatformIdentifier -</em> is the first, or left-most, label of the FQDN of platform that hosts the admin server. (This&nbsp; comes from the platform FQDN property in HQ.)</li>
	<li><em>ServerType -</em> is "Weblogic Admin <em>n.n</em>", where <em>n.n</em> is the version of the admin server.&nbsp; (This is the server type property for the admin server in HQ.)</li>
	<li><em>DomainName -</em> is the name of the WebLogic Server domain that contains the admin server.</li>
	<li><em>AdminServerName</em> &#45; is the name configured for the admin server in WebLogic Server.</li>
</ul>


<p>If the admin server was not discovered, see <a href="#WebLogicServer-SolveAdministrationServerAutoDiscoveryProblems">Solve Administration Server Auto-Discovery Problems</a> </p>








<h2><a name="WebLogicServer-ConfigureMonitoring"></a>Configure Monitoring </h2>

<p>In this step, you configure the Administration Server in HQ with credentials that allow it to access the domain config.xml, which specifies the Managed Servers in the domain. You can specify monitoring options at this time, or do it later. </p>

<h3><a name="WebLogicServer-RequiredAdministrationServerConfiguration"></a>Required Administration Server Configuration </h3>

<p>These steps are required to enable discovery of the Managed Servers in the domain. </p>
<ol>
	<li>Navigate to the Admin Server in the HQ user interface.
	<ol>
		<li>Choose <b>Browse</b> from the Resources tab and click <b>Servers</b>.&nbsp;</li>
		<li>To narrow the list of servers displayed, enter WebLogic in the Keyword box and click <span class="image-wrap" style=""><img src="attachments/77463605/77660272.png" height="17" width="17" style="border: 0px solid black"/></span>.</li>
		<li>Select the admin server from the list to display its Inventory page.</li>
	</ol>
	</li>
	<li>Choose <b>Configure Server</b> from the Tools menu.</li>
	<li>In the "Shared" section, enter the WLS username and password in the admin.username and admin.password fields.</li>
</ol>


<p>Click OK and proceed directly to <a href="#WebLogicServer-VerifyManagedServerAutoDiscovery">Verify Managed Server Auto-Discovery</a>, or if desired, configure monitoring options for the new server, as described in the next paragraph.&nbsp; </p>

<h3><a name="WebLogicServer-ConfigureLogEventTrackingandServiceMonitoring"></a>Configure Log Event Tracking and Service Monitoring </h3>

<p>In the "Monitoring Section" of the server configuration page you specify desired log tracking options, and whether you want services on the server to be auto-discovered.&nbsp;&nbsp; </p>

<p><b>Note:</b>&nbsp; By default, services running on the server will NOT be autodiscovered. </p>
<ol>
	<li>Enable Log Tracking - Check to enable log tracking.</li>
	<li>Track event log level - Events greater than or equal to selected level will be tracked. The levels, in decreasing order of severity, are:
	<ul>
		<li>Error (maps to WLS "Error")</li>
		<li>Warn (maps to WLS "Warning")</li>
		<li>Info (maps to WLS "Info" and "Notice"</li>
		<li>Debug (maps to WLS "Debug")</li>
	</ul>
	</li>
	<li>Log Pattern Match - Enter a substring or regular expression to track only matching messages. See: <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/regex/Pattern.html">java.util.regex.Pattern</a>.</li>
	<li>Log Pattern Exclude - Enter a substring or regular expression to exclude matching messages.</li>
	<li>Log Files - Enter a comma delimited list of log files to track. Relative file specifications are resolved relative to the server's installation path.</li>
	<li>Enable Config Tracking - Check to enable configuration tracking.</li>
	<li>Auto-Discover Applications, Entity EJBs, and other services? - Enable if you wish to auto-discover and monitor WLS services.</li>
	<li>Click OK.</li>
</ol>


<h2><a name="WebLogicServer-VerifyManagedServerAutoDiscovery"></a>Verify Managed Server Auto-Discovery </h2>

<p>After you complete the steps in <a href="#WebLogicServer-RequiredAdministrationServerConfiguration">Required Administration Server Configuration</a> the Manager Servers currently running in the WLS domain should appear in HQ inventory and metric collection should commence. </p>

<p>Check the Recently Added portlet in the Dashboard for the Managed Servers.&nbsp; </p>

<p>If the Managed Servers have not been added to inventory, see <a href="#WebLogicServer-SolveManagedServerAutoDiscoveryProblems">Solve Managed Server Auto-Discovery Problems</a>. </p>

<h2><a name="WebLogicServer-CompleteMonitoringConfiguration"></a>Complete Monitoring Configuration </h2>

<p>Perform the steps in <a href="#WebLogicServer-ConfigureLogEventTrackingandServiceMonitoring">Configure Log Event Tracking and Service Monitoring</a> for the Managed Servers, and for the admin server, if you did not previously do so.</p>

<p>To view or modify the default metric collection settings for the WLS servers and their services, access the metric template for your WebLogic Server version: </p>
<ol>
	<li>Click <b>Administration</b>&nbsp; in the Masthead,</li>
	<li>Select the <b>Monitoring Defaults</b> link in the HQ Server Settings section of the Administration page.</li>
	<li>On the Monitoring Defaults page, click <b>Edit Metric Template</b> for your WebLogic Server version.</li>
</ol>


<h1><a name="WebLogicServer-TroubleshootWebLogicServerAutoDiscoveryProblems"></a>Troubleshoot WebLogic Server Auto-Discovery Problems </h1>

<p>The sections below contain information and tips that will help you understand and solve problems you may encounter with auto-discovery of WLS components. </p>
<ul>
	<li><a href="#WebLogicServer-SolveAdministrationServerAutoDiscoveryProblems">Solve Administration Server Auto-Discovery Problems</a><br/>
<a href="#WebLogicServer-AddAdministrationServerManually">Add Administration Server Manually</a> </li>
	<li><a href="#WebLogicServer-SolveManagedServerAutoDiscoveryProblems">Solve Managed Server Auto-Discovery Problems</a></li>
</ul>


<h2><a name="WebLogicServer-SolveAdministrationServerAutoDiscoveryProblems"></a>Solve Administration Server Auto-Discovery Problems </h2>

<p>Read this section if the admin server does not appear in the Auto-Discovery portlet, as described above in <a href="#WebLogicServer-VerifyAutoDiscoveryofAdministrationServer">Verify Auto-Discovery of Administration Server</a>. </p>

<h3><a name="WebLogicServer-TestAutoDiscovery"></a>Test Auto-Discovery </h3>

<p>You can check the results of the Admin Server auto-discovery process. </p>

<p>The Hyperic Plugin Development Kit (PDK) supports stand-alone invocation of plugins from a command shell. You can run auto-discovery, collect metrics, and perform supported control actions at the command line. </p>

<p>This is an example execution of the WLS plugin's "discover" function, including the results: </p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre> 
% java -jar pdk/lib/hq-product.jar \ 
-Dplugins.include=weblogic -Dadmin.username=weblogic -Dadmin.password=weblogic -m discover 
1 servers detected 

Server: bear Weblogic Admin 9.2 medrec MedRecServer [/usr/local/bea/weblogic92/samples/domains/medrec/servers/MedRecServer] 
AIID...../usr/local/bea/weblogic92/samples/domains/medrec/servers/MedRecServer 
config... 
product..{admin.username=weblogic, server.log_track.files=/usr/local/bea/weblogic92/samples/domains/medrec/servers/MedRecServer/logs/MedRecServer.log, admin.url=t3://bear:7011, domain=medrec, server=MedRecServer, admin.password=weblogic} 
metric...null 
control..{program=/usr/local/bea/weblogic92/samples/domains/medrec/startWebLogic.sh}
</pre>
</div></div> 
<p><b>Note:&nbsp;</b> Command usage is documented in <a href="http://support.hyperic.com/display/DOCS46/Invoking+Plugins+Standalone" title="Invoking Plugins Standalone">Invoking Plugins Standalone</a>. </p>

<p>The result above shows that a resource of type "server" was auto-discovered. The name of the newly discovered server in HQ is: </p>

<p>bear Weblogic Admin 9.2 medrec MedRecServer </p>

<p>The HQ naming convention for the WLS Administration Server is explained above in <a href="#WebLogicServer-VerifyAutoDiscoveryofAdministrationServer">Verify Auto-Discovery of Administration Server</a>. </p>

<h3><a name="WebLogicServer-CheckNetworkAccess"></a>Check Network Access </h3>

<p>Check to see if the location of the HQ Agent with respect to the WLS admin server is causing the problem.&nbsp; In the HQ User Forum thread <a href="http://forums.hyperic.com/jiveforums/thread.jspa?threadID=6366&amp;tstart=0">WebLogic 8.1 Admin Server configuration stalls</a> the user's admin server was on a different subnet than the HQ components. </p>

<h3><a name="WebLogicServer-VerifyPermissions"></a>Verify Permissions </h3>

<p>You can check whether auto-discovery failed because of a permissions problem.&nbsp; </p>

<p>This section show the query that the WLS plugin uses to obtain the Administration Server's arguments and its current working directory (cwd).&nbsp; Two examples are shown. The first example shows the results that are returned when the query fails to return the Admin Server arguments and cwd. The second example shows the results when the query is successful. </p>

<p><b>Note:&nbsp;</b> To run this query in your environment, replace "java" with "<em>HQ_JAVA_HOME"</em>/bin/java", where "<em>HQ_JAVA_HOME"</em> is the location of the JRE the agent uses - the same JRE as the Administration Server uses, if you followed the recommendation in <a href="#WebLogicServer-SpecifyAgentJRE">Specify Agent JRE</a>. </p>

<h4><a name="WebLogicServer-IfPluginLacksNecessaryPermissions"></a>If Plugin Lacks Necessary Permissions </h4>

<p>In the results below, the value returned for the current working directory (cwd) is "???", indicating that&nbsp; the user running the command lacked permission to obtain that information. </p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre> 
% java -jar pdk/lib/sigar.jar pargs State.Name.eq=java,Args.-1.eq=weblogic.Server 
pid=2317 
exe=??? 
cwd=??? 
0=&gt;/usr/local/bea/jrockit90_150_04/bin/java&lt;= 
1=&gt;-jrockit&lt;= 
2=&gt;-Xms256m&lt;= 
3=&gt;-Xmx512m&lt;= 
4=&gt;-Xverify:none&lt;= 
5=&gt;-da&lt;= 
6=&gt;-Dplatform.home=/usr/local/bea/weblogic92&lt;= 
7=&gt;-Dwls.home=/usr/local/bea/weblogic92/server&lt;= 
8=&gt;-Dwli.home=/usr/local/bea/weblogic92/integration&lt;= 
9=&gt;-Dcom.bea.medrec.xml.incoming=incoming&lt;= 
10=&gt;-Dlog4j.configuration=file:/usr/local/bea/weblogic92/samples/domains/medrec/log4jConfig.xml&lt;=
11=&gt;-Dweblogic.management.discover=true&lt;= 
12=&gt;-Dwlw.iterativeDev=&lt;= 
13=&gt;-Dwlw.testConsole=&lt;= 
14=&gt;-Dwlw.logErrorsToConsole=&lt;= 
15=&gt;-Dweblogic.ext.dirs=/usr/local/bea/patch_weblogic920/profiles/default/sysext_manifest_classpath&lt;=
16=&gt;-Dweblogic.Name=MedRecServer&lt;= 
17=&gt;-Djava.security.policy=/usr/local/bea/weblogic92/server/lib/weblogic.policy&lt;= 
18=&gt;weblogic.Server&lt;= 
</pre>
</div></div> 

<h4><a name="WebLogicServer-IfPluginHasNecessaryPermissions"></a>If Plugin Has Necessary Permissions </h4>

<p>If you run the query as the weblogic user or as root, the Administration Server's current working directory (cwd) is returned: </p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre> 
% java -jar pdk/lib/sigar.jar pargs State.Name.eq=java,Args.-1.eq=weblogic.Server 
pid=2317 
exe=/usr/local/bea/jrockit90_150_04/bin/java 
cwd=/usr/local/bea/weblogic92/samples/domains/medrec 
</pre>
</div></div> 

<h3><a name="WebLogicServer-AddAdministrationServerManually"></a>Add Administration Server Manually </h3>

<p>If you are unable to run the agent with sufficient permissions to auto-discover the WLS Administration Server, or you have problems with the auto-discovery process, you can add the admin server to inventory manually. </p>

<p>1.&nbsp; In the HQ user interface, navigate the the platform that hosts the Administration Server. </p>

<p>2.&nbsp; Choose <b>New Server</b> from the <b>Tools</b> menu. </p>

<p>3.&nbsp; On the New Server page, supply the required values. For example, </p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">Name: [Weblogic Admin 9.2 medrec MedRecServer] 
Server Type: [Weblogic Admin 9.2] 
Install Path: [/usr/local/bea/weblogic92/samples/domains/medrec/servers/MedRecServer]</pre>
		</div>
</div></div> 
<p>&nbsp;and click OK. </p>

<p>4.&nbsp; Select the server to display its Inventory page. </p>

<p>5.&nbsp; Choose <b>Configure Server</b> from the <b>Tools</b> menu. </p>

<p>6.&nbsp; In the Configuration Properties page, enter values for the properties in the "Shared" section, using the values that were returned by the <a href="#WebLogicServer-WebLogicConfig">WebLogicConfig</a> command above: 
<br class="atl-forced-newline" /> 
<br class="atl-forced-newline" /> </p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre> 
admin.url [t3://bear:7011] 
admin.username [weblogic] 
admin.password [weblogic] 
server [MedRecServer] 
domain [medrec] 
jvm.runtime [JVMRuntime] (choose JRockit or JVM (Sun)) 
</pre>
</div></div> 
<p>7.&nbsp; Click OK. </p>

<h2><a name="WebLogicServer-SolveManagedServerAutoDiscoveryProblems"></a>Solve Managed Server Auto-Discovery Problems </h2>

<p>Read this section if your Managed Servers were not discovered after you performed the <a href="#WebLogicServer-RequiredAdministrationServerConfiguration">Required Administration Server Configuration</a>. </p>

<p>To add a WLS Managed Server to inventory, the HQ Agent needs to locate the "platform" in HQ upon which the Managed Server runs. Because a Managed Server is a "server" in the HQ inventory hierarchy, adding it to inventory means making it the child of a platform. The agent determines the address of machine that hosts the Managed Server from config.xml and looks for a platform in inventory whose FQDN matches that address. If there is no platform in inventory with that FQDN, the agent will fail to add the Managed Server to inventory. &nbsp; </p>

<h3><a name="WebLogicServer-HowthePluginDiscoversManagedServers%26nbsp%3B"></a>How the Plugin Discovers Managed Servers&nbsp; </h3>

<p>For each Managed Server defined in config.xml, the plugin: </p>
<ul>
	<li>Connects to the host specified by the Managed Server's ListenAddress property as specified in config.xml.</li>
	<li>Obtains inventory attributes for the Managed Server.</li>
	<li>Creates a server in HQ inventory under the platform whose fully qualified domain name (FQDN) matches the Managed Server's ListenAddress.&nbsp;</li>
</ul>


<p>If a Managed Server's ListenAddress is specified in config.xml as an IP address, rather than a domain name, the plugin will not find the the platform in inventory. By default the plugin searches for the platform by FQDN only - it doesn't search the IP addresses associated with platforms in inventory. &nbsp;&nbsp; </p>

<p>For example, if a Managed Server whose ListenAddress=10.0.0.102 runs on a platform whose FQDN in HQ is&nbsp; appserver2.hyperic.com, the plugin will not find that platform in inventory, and will will fail to add the Managed Server to inventory. In this event, the plugin will log a message like this to the agent.log file in its /log directory: </p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre> 
[WeblogicRuntimeDiscoverer] Discovered server (Weblogic 9.2 medrec bear) hosted on another platform (fqdn=10.0.0.102) 
</pre>
</div></div> 

<h3><a name="WebLogicServer-CheckiftheAgentCanAccessconfig.xml"></a>Check if the Agent Can Access config.xml </h3>

<p>You can check whether the Agent is able to access the config.xml file, which specifies the domain configuration, including the Managed Servers in the domain. </p>

<p>This section shows an example execution of the "WebLogicConfig" <a name="WebLogicServer-WebLogicConfig"></a>query, which the WLS plugin uses to obtain the Administration Server's config.xml . </p>

<p>The plugin assumes that config.xml is in the Administration Server's /config directory). </p>

<p><b>Note:&nbsp;</b> To run this query in your environment, replace "java" with "<em>HQ_JAVA_HOME"</em>/bin/java", where "_HQ_JAVA_HOME"_is the location of the JRE the agent uses - the same JRE as the Administration Server uses, if you followed the recommendation in <a href="#WebLogicServer-SpecifyAgentJRE">Specify Agent JRE</a>. </p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre> 
% java -jar pdk/lib/hq-product.jar weblogic WeblogicConfig /usr/local/bea/weblogic92/samples/domains/medrec/config/config.xml 
/usr/local/bea/weblogic92/samples/domains/medrec/config/config.xml... 
9.2 
medrec 
admin=MedRecServer 
-- listing properties -- 
admin.url=t3://bear:7011 
version=9.2 
domain=medrec 
server=MedRecServer 
</pre>
</div></div> 

<h3><a name="WebLogicServer-ResolveManagedServerIPAddress%2FFQDNMismatch"></a>Resolve Managed Server IP Address/FQDN Mismatch </h3>

<p>If your Managed Server's ListenAddress is specified as an IP addess (rather than a domain name) in config.xml&nbsp; the HQ Agent will fail to add the Managed Server to inventory. There are two ways to solve this problem. </p>
<ul>
	<li>Option 1 - Configure the HQ Agent to add all the Managed Servers in the WLS domain to the HQ platform that hosts the HQ Agent, instead of adding each Managed Server to the HQ platforms that actually hosts it.&nbsp; To do this, add this property to agent.properties:</li>
</ul>


<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre> 
weblogic.discover.fqdn=same 
</pre>
</div></div> 
<ul>
	<li>Option 2 - For each Managed Server, define the mapping between its ListenAddress as defined in config.xml and its HQ FQDN. This method will allow the plugin to add the Managed Server to the platform in HQ for the machine that actually hosts it. To do this, for each Managed Server in the domain, add a line like this to agent.properties:</li>
</ul>


<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre> 
weblogic.discover.fqdn.ListenAddress=FQDN.fqdn 
where ListenAddress is the value of that property as defined for the Managed Server in config.xml and FQDN is the 
</pre>
</div></div> 
<p>&nbsp;&nbsp;&nbsp; where: </p>

<p>&nbsp;&nbsp;&nbsp; <em>ListenAddress</em> is the value of that property as defined for the Managed Server in config.xml, and </p>

<p>&nbsp;&nbsp;&nbsp; FQDN is the platform's fully qualified domain name in HQ.&nbsp; </p>

<p>&nbsp;&nbsp;&nbsp; For example: </p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre> 
weblogic.discover.fqdn.10.0.0.4=appserver2.hyperic.com 
</pre>
</div></div> 
<p>Restart the agent after making changes to agent.properties. </p>

<h1><a name="WebLogicServer-Metrics"></a>Metrics </h1>
<div class="error"><span class="error">Unable to render {include}</span> Couldn't find a page to include called: Oracle Weblogic Server 4.6</div>

				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://support.hyperic.com/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 27, 2011 16:38</font></td>
		    </tr>
	    </table>
    </body>
</html>
