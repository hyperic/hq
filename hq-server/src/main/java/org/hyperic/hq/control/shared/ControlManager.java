/*
 * Generated by XDoclet - Do not edit!
 */
package org.hyperic.hq.control.shared;

import java.util.List;

import org.hyperic.hq.appdef.shared.AgentNotFoundException;
import org.hyperic.hq.appdef.shared.AppdefEntityID;
import org.hyperic.hq.appdef.shared.AppdefEntityNotFoundException;
import org.hyperic.hq.appdef.shared.AppdefEntityTypeID;
import org.hyperic.hq.appdef.shared.ConfigFetchException;
import org.hyperic.hq.authz.server.session.AuthzSubject;
import org.hyperic.hq.authz.shared.PermissionException;
import org.hyperic.hq.grouping.shared.GroupNotCompatibleException;
import org.hyperic.hq.product.PluginException;
import org.hyperic.hq.product.PluginNotFoundException;
import org.hyperic.hq.scheduler.ScheduleValue;
import org.hyperic.util.config.ConfigResponse;
import org.quartz.SchedulerException;

/**
 * Local interface for ControlManager.
 */
public interface ControlManager {
    /**
     * Enable an entity for control
     */
    public void configureControlPlugin(AuthzSubject subject, AppdefEntityID id) throws PermissionException,
        PluginException, ConfigFetchException, AppdefEntityNotFoundException, AgentNotFoundException;

    /**
     * Execute a single control action on a given entity.
     */
    public void doAction(AuthzSubject subject, AppdefEntityID id, String action, String args) throws PluginException,
        PermissionException;

    /**
     * Execute a single control action on a given entity.
     */
    public void doAction(AuthzSubject subject, AppdefEntityID id, String action) throws PluginException,
        PermissionException;

    /**
     * Schedule a new control action.
     */
    public void doAction(AuthzSubject subject, AppdefEntityID id, String action, ScheduleValue schedule)
        throws PluginException, PermissionException, SchedulerException;

    /**
     * Single control action for a group of given entities.
     */
    public void doGroupAction(AuthzSubject subject, AppdefEntityID id, String action, String args, int[] order)
        throws PluginException, PermissionException, AppdefEntityNotFoundException, GroupNotCompatibleException;

    /**
     * Schedule a single control action for a group of given entities.
     * @throws SchedulerException
     */
    public void doGroupAction(AuthzSubject subject, AppdefEntityID id, String action, int[] order,
                              ScheduleValue schedule) throws PluginException, PermissionException, SchedulerException,
        GroupNotCompatibleException, AppdefEntityNotFoundException;

    /**
     * Get the supported actions for an appdef entity from the local
     * ControlPluginManager
     */
    public List<String> getActions(AuthzSubject subject, AppdefEntityID id) throws PermissionException,
        PluginNotFoundException, AppdefEntityNotFoundException, GroupNotCompatibleException;

    /**
     * Get the supported actions for an appdef entity from the local
     * ControlPluginManager
     */
    public List<String> getActions(AuthzSubject subject, AppdefEntityTypeID aetid) throws PluginNotFoundException;

    /**
     * Check if a compatible group's members have been enabled for control. A
     * group is enabled for control if and only if all of its members have been
     * enabled for control.
     * @return flag - true if group is enabled
     */
    public boolean isGroupControlEnabled(AuthzSubject subject, AppdefEntityID id) throws AppdefEntityNotFoundException,
        PermissionException;

    /**
     * Checks with the plugin manager to find out if an entity's resource
     * provides support for control.
     * @param resType - appdef entity (of all kinds inc. groups)
     * @return flag - true if supported
     */
    public boolean isControlSupported(AuthzSubject subject, String resType);

    /**
     * Checks with the plugin manager to find out if an entity's resource
     * provides support for control.
     * @param resType - appdef entity (of all kinds inc. groups)
     * @return flag - true if supported
     */
    public boolean isControlSupported(AuthzSubject subject, AppdefEntityID id, String resType);

    /**
     * Check if a an entity has been enabled for control.
     * @return flag - true if enabled
     */
    public boolean isControlEnabled(AuthzSubject subject, AppdefEntityID id);

    /**
     * Check if an entity has been enabled for control
     */
    public void checkControlEnabled(AuthzSubject subject, AppdefEntityID id) throws PluginException;

    /**
     * Get the control config response
     */
    public ConfigResponse getConfigResponse(AuthzSubject subject, AppdefEntityID id) throws PluginException;

    /**
     * Send an agent a plugin configuration. This is needed when agents restart,
     * since they do not persist control plugin configuration.
     * @param pluginName Name of the plugin to get the config for
     * @param merge If true, merge the product and control config data
     */
    public byte[] getPluginConfiguration(String pluginName, boolean merge) throws PluginException;

    /**
     * Receive status information about a previous control action
     */
    public void sendCommandResult(int id, int result, long startTime, long endTime, String message);

    /**
     * Accept an array of appdef entity Ids and verify control permission on
     * each entity for specified subject. Return only the set of entities that
     * have authorization.
     * @return List of entities subject is authz to control NOTE: Returns an
     *         empty list when no resources are found.
     */
    public List<AppdefEntityID> batchCheckControlPermissions(AuthzSubject caller, AppdefEntityID[] entities)
        throws AppdefEntityNotFoundException, PermissionException;

}
